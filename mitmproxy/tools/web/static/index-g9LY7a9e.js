import{c as xe,R as Jo,a as Ie,r as M,b as ye,d as De,j as r,e as E,f as Ti,u as Xo,g as Zo,h as Ri,s as Zt,i as ec,l as zt,k as tc,m as sc,n as nc,y as ic,o as rc,p as lc,q as bt,Q as oc,C as Ai,X as Ii,Y as vs,T as Cs,L as Ns,t as cc,v as ks,w as ac,P as dc,x as uc,z as fc,B as ti,A as pc,D as hc,E as mc}from"./vendor-CV_2_uTW.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const n of l)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function s(l){const n={};return l.integrity&&(n.integrity=l.integrity),l.referrerPolicy&&(n.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?n.credentials="include":l.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(l){if(l.ep)return;l.ep=!0;const n=s(l);fetch(l.href,n)}})();const gc={tab:"request",contentViewFor:{}},xc=xe({name:"ui/flow",initialState:gc,reducers:{selectTab(t,e){t.tab=e.payload},setContentViewFor(t,e){t.contentViewFor[e.payload.messageId]=e.payload.contentView}}}),{actions:vc,reducer:_c}=xc,{selectTab:Gt,setContentViewFor:Di}=vc;window.React=Jo;const Fi=function(t){if(t===0)return"0";const e=["b","kb","mb","gb","tb"];let s=0;for(;s<e.length&&!(Math.pow(1024,s+1)>t);s++);let i;return t%Math.pow(1024,s)===0?i=0:i=1,(t/Math.pow(1024,s)).toFixed(i)+e[s]},Li=function(t){let e=t;const s=["ms","s","min","h"],i=[1e3,60,60];let l=0;for(;Math.abs(e)>=i[l]&&l<i.length;)e=e/i[l],l++;return Math.round(e)+s[l]},mt=function(t,{includeMilliseconds:e=!0}={}){const s=new Date(t*1e3),i=String(s.getFullYear()),l=String(s.getMonth()+1).padStart(2,"0"),n=String(s.getDate()).padStart(2,"0"),o=String(s.getHours()).padStart(2,"0"),a=String(s.getMinutes()).padStart(2,"0"),d=String(s.getSeconds()).padStart(2,"0"),u=String(s.getMilliseconds()).padStart(3,"0");let h=`${i}-${l}-${n} ${o}:${a}:${d}`;return e&&(h+=`.${u}`),h};function si(t){return t[0].includes(":")?`[${t[0]}]:${t[1]}`:`${t[0]}:${t[1]}`}function jc(t){const e=document.cookie.match(new RegExp("\\b"+t+"=([^;]*)\\b"));return e?e[1]:void 0}let _s=()=>{const t=jc("_xsrf");return _s=()=>t,_s()};function oe(t,e={}){return e.method&&e.method!=="GET"&&(e.headers=e.headers||{},e.headers["X-XSRFToken"]=_s()),t.startsWith("/")&&(t="."+t),fetch(t,{credentials:"same-origin",...e})}oe.put=(t,e,s={})=>oe(t,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),...s});oe.post=(t,e,s={})=>oe(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),...s});async function Yt(t,...e){return await(await oe(`/commands/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({arguments:e})})).json()}async function Pi(t){try{await navigator.clipboard.write([new ClipboardItem({"text/plain":t})]);return}catch(i){console.warn(i)}const e=await t;try{await navigator.clipboard.writeText(e);return}catch(i){console.warn(i)}const s=document.createElement("textarea");s.value=e,s.style.position="absolute",s.style.opacity="0",document.body.appendChild(s);try{if(s.focus(),s.select(),!document.execCommand("copy"))throw"failed to copy"}catch{alert(e)}finally{s.remove()}}async function yc(t){await Pi(Promise.resolve(t?.text||""))}function js(t,e){const s=t.lastIndexOf(e);if(s===-1)return["",t];const i=t.slice(0,s),l=t.slice(s+e.length);return[i,l]}function Mi(t,e){const s=t.indexOf(e);if(s===-1)return[t,""];const i=t.slice(0,s),l=t.slice(s+e.length);return[i,l]}function It(t){throw new Error(`Unreachable: ${JSON.stringify(t)}`)}const qi={http:80,https:443},ni=new WeakMap;class Pe{static getContentType(e){const s=Pe.get_first_header(e,/^Content-Type$/i);if(s)return s.split(";")[0].trim()}static get_first_header(e,s){let i=ni.get(e);i||(i=new Map,ni.set(e,i));let l=i.get(s);if(l===void 0){const n=e.headers.find(([o,a])=>s.test(o));l=n?n[1]:!1,i.set(s,l)}return l!==!1?l:void 0}static match_header(e,s){const i=e.headers;if(!i)return!1;let l=i.length;for(;l--;)if(s.test(i[l].join(" ")))return i[l];return!1}static getContentURL(e,s,i,l){e.type==="http"&&s===e.request?s="request":e.type==="http"&&s===e.response&&(s="response");const n=l?`?lines=${l}`:"";return`./flows/${e.id}/${s}/`+(i?`content/${encodeURIComponent(i)}.json${n}`:"content.data")}}class ht extends Pe{static pretty_url(e){let s="";return qi[e.scheme]!==e.port&&(s=":"+e.port),e.scheme+"://"+e.pretty_host+s+e.path}}class jt extends Pe{}const bc=/^(?:(https?):\/\/)?([^/:]+)?(?::(\d+))?(\/.*)?$/i,Oi=function(t){const e=bc.exec(t);if(!e)return;const s=e[1],i=e[2],l=parseInt(e[3]),n=e[4],o=s?l||qi[s]:l,a={};return s&&(a.scheme=s),i&&(a.host=i),o&&(a.port=o),n&&(a.path=n),a},Sc=/^HTTP\/\d+(\.\d+)*$/i,Hi=function(t){return Sc.test(t)};function Jt(t){switch(t.type){case"http":return t.request.timestamp_start;case"tcp":case"udp":return t.client_conn.timestamp_start;case"dns":return t.request.timestamp}}function Vi(t){switch(t.type){case"http":if(t.websocket){if(t.websocket.timestamp_end)return t.websocket.timestamp_end;if(t.websocket.messages_meta.timestamp_last)return t.websocket.messages_meta.timestamp_last}return t.response?t.response.timestamp_end:void 0;case"tcp":return t.server_conn?.timestamp_end;case"udp":return t.messages_meta.timestamp_last;case"dns":return t.response?.timestamp}}const Ui=t=>{switch(t.type){case"http":{let e=t.request.contentLength||0;return t.response&&(e+=t.response.contentLength||0),t.websocket&&(e+=t.websocket.messages_meta.contentLength||0),e}case"tcp":case"udp":return t.messages_meta.contentLength||0;case"dns":return t.response?.size??0}},Es=t=>t.type==="http"&&!t.websocket,Bi=t=>t.modified,Ts=t=>t.intercepted,Ki=t=>{if(t.type!=="http")return t.client_conn.tls_version==="QUICv1"?"resource-icon-quic":`resource-icon-${t.type}`;if(t.websocket)return"resource-icon-websocket";if(!t.response)return"resource-icon-plain";const e=jt.getContentType(t.response)||"";return t.response.status_code===304?"resource-icon-not-modified":300<=t.response.status_code&&t.response.status_code<400?"resource-icon-redirect":e.indexOf("image")>=0?"resource-icon-image":e.indexOf("javascript")>=0?"resource-icon-js":e.indexOf("css")>=0?"resource-icon-css":e.indexOf("html")>=0?"resource-icon-document":"resource-icon-plain"},Wi=t=>{switch(t.type){case"http":return ht.pretty_url(t.request);case"tcp":case"udp":return`${t.client_conn.peername.join(":")} ↔ ${t.server_conn?.address?.join(":")}`;case"dns":return`${t.request.questions.map(e=>`${e.name} ${e.type}`).join(", ")} = ${(t.response?.answers.map(e=>e.data).join(", ")??"...")||"?"}`}},zi=t=>{switch(t.type){case"http":return t.response?.status_code;case"dns":return t.response?.response_code;default:return}},Qi=t=>{switch(t.type){case"http":return t.websocket?t.client_conn.tls_established?"WSS":"WS":t.request.method;case"dns":return t.request.op_code;default:return t.type.toUpperCase()}},Gi=t=>{switch(t.type){case"http":return t.request.http_version;default:return""}},Yi={tls:t=>t.type==="http"&&t.request.scheme,icon:Ki,index:()=>0,path:Wi,method:Qi,version:Gi,status:zi,size:Ui,time:t=>{const e=Jt(t),s=Vi(t);return e&&s&&s-e},timestamp:Jt,quickactions:()=>0,comment:t=>t.comment};function wc(t){return t in Yi}var Ae=(t=>(t.Search="search",t.Highlight="highlight",t))(Ae||{});const Ji={search:"",highlight:""},$c=xe({name:"ui/filters",initialState:Ji,reducers:{setFilter(t,e){t.search=e.payload},setHighlight(t,e){t.highlight=e.payload}}}),{actions:Cc,reducer:Nc}=$c,{setFilter:Xi,setHighlight:Zi}=Cc;function ds(t,e){return t.toSorted?t.toSorted(e):[...t].sort(e)}function Rs(t,...e){if(t.toSpliced)return t.toSpliced(...e);{const s=[...t];return s.splice(...e),s}}function Ct(t){return new Map(t.map((e,s)=>[e.id,s]))}function us(t){return new Set(t.map(e=>e.id))}function ii(t,e){return t.has(e)&&(t=new Set(t),t.delete(e)),t}function ri(t,e,s){const i=Rs(t,s,1),l=new Map(e);l.delete(t[s].id);for(let n=i.length-1;n>=s;n--)l.set(i[n].id,n);return{view:i,_viewIndex:l}}function kc(t,e,s,i){const l=[...t],n=l.length;let o=e,a=o.get(s.id);if(a+1<n&&i(s,l[a+1])>0){o=new Map(o);do{const d=l[a+1];l[a]=d,o.set(d.id,a),a++}while(a+1<n&&i(s,l[a+1])>0);o.set(s.id,a)}else if(a>0&&i(s,l[a-1])<0){o=new Map(o);do{const d=l[a-1];l[a]=d,o.set(d.id,a),a--}while(a>0&&i(s,l[a-1])<0);o.set(s.id,a)}return l[a]=s,{view:l,_viewIndex:o}}function li(t,e,s,i){const l=Ec(t,s,i),n=Rs(t,l,0,s),o=new Map(e);for(let a=n.length-1;a>=l;a--)o.set(n[a].id,a);return{view:n,_viewIndex:o}}function Ec(t,e,s){let i=0,l=t.length;if(l===0||s(t[l-1],e)<=0)return l;for(;i<l;){const n=i+l>>>1;s(e,t[n])>=0?i=n+1:l=n}return i}function As(t){return t=t.filter(Ts),()=>Promise.all(t.map(e=>oe(`/flows/${e.id}/resume`,{method:"POST"})))}function er(){return()=>oe("/flows/resume",{method:"POST"})}function tr(t){return t=t.filter(Ts),()=>Promise.all(t.map(e=>oe(`/flows/${e.id}/kill`,{method:"POST"})))}function Tc(){return()=>oe("/flows/kill",{method:"POST"})}function sr(t){return()=>Promise.all(t.map(e=>oe(`/flows/${e.id}`,{method:"DELETE"})))}function nr(t){return()=>Promise.all(t.map(e=>oe(`/flows/${e.id}/duplicate`,{method:"POST"})))}function Is(t){return t=t.filter(Es),()=>Promise.all(t.map(e=>oe(`/flows/${e.id}/replay`,{method:"POST"})))}function ir(t){return t=t.filter(Bi),()=>Promise.all(t.map(e=>oe(`/flows/${e.id}/revert`,{method:"POST"})))}function oi(t,e){return()=>Promise.all(t.map(s=>ze(s,{marked:e})()))}function ze(t,e){return()=>oe.put(`/flows/${t.id}`,e)}function Rc(t,e,s){const i=new FormData;return e=new window.Blob([e],{type:"plain/text"}),i.append("file",e),()=>oe(`/flows/${t.id}/${s}/content.data`,{method:"POST",body:i})}function rr(){return()=>oe("/clear",{method:"POST"})}function Ac(t){const e=new FormData;return e.append("file",t),()=>oe("/flows/dump",{method:"POST",body:e})}const lr=Ie("flows/add"),or=Ie("flows/update"),cr=Ie("flows/remove"),Ds=Ie("flows/receive"),ar=Ie("flows/filterUpdate"),dr=Ie("flows/sort"),Je=Ie("flows/select"),Ic={list:[],_listIndex:new Map,byId:new Map,view:[],_viewIndex:new Map,sort:{column:void 0,desc:!1},selected:[],selectedIds:new Set,highlightedIds:new Set};function Dc(t=Ic,e){if(Ds.match(e)){const{sort:s}=t,i=e.payload,l=Ct(i),n=new Map(i.map(p=>[p.id,p])),o=ds(i,vt(s)),a=Ct(o),d=t.selected.map(p=>n.get(p.id)).filter(p=>p!==void 0),u=us(d);return{list:i,_listIndex:l,byId:n,view:o,_viewIndex:a,sort:s,selected:d,selectedIds:u,highlightedIds:new Set}}else if(lr.match(e)){const{flow:s,matching_filters:i}=e.payload;if(t._listIndex.has(s.id))return t;const{sort:l,selected:n,selectedIds:o}=t;let{view:a,_viewIndex:d,highlightedIds:u}=t;const h=new Map(t._listIndex);h.set(s.id,t.list.length);const p=[...t.list,s],g=new Map(t.byId);return g.set(s.id,s),(i[Ae.Search]===!0||i[Ae.Search]===void 0)&&({view:a,_viewIndex:d}=li(a,d,s,vt(l))),i[Ae.Highlight]===!0&&(u=new Set(u),u.add(s.id)),{list:p,_listIndex:h,byId:g,view:a,_viewIndex:d,sort:l,selected:n,selectedIds:o,highlightedIds:u}}else if(or.match(e)){const{flow:s,matching_filters:i}=e.payload,{_listIndex:l,sort:n,selectedIds:o}=t;let{view:a,_viewIndex:d,selected:u,highlightedIds:h}=t;const p=t._listIndex.get(s.id),g=[...t.list];p!==void 0?g[p]=s:g.push(s);const x=new Map(t.byId);x.set(s.id,s);const j=d.get(s.id),y=j!==void 0,b=i[Ae.Search]===!0||i[Ae.Search]===void 0;return b&&!y?{view:a,_viewIndex:d}=li(a,d,s,vt(n)):!b&&y?{view:a,_viewIndex:d}=ri(a,d,j):b&&y&&({view:a,_viewIndex:d}=kc(a,d,s,vt(n))),o.has(s.id)&&(u=u.map($=>$.id===s.id?s:$)),i[Ae.Highlight]===!0?h.has(s.id)||(h=new Set(h),h.add(s.id)):h=ii(h,s.id),{list:g,_listIndex:l,byId:x,view:a,_viewIndex:d,sort:n,selected:u,selectedIds:o,highlightedIds:h}}else if(cr.match(e)){const s=e.payload,{sort:i}=t;let{view:l,_viewIndex:n,selected:o,selectedIds:a}=t;const d=t._listIndex.get(s);if(d===void 0)return t;const u=Rs(t.list,d,1),h=Ct(u),p=new Map(t.byId);p.delete(s);const g=n.get(s);if(g!==void 0&&({view:l,_viewIndex:n}=ri(l,n,g)),a.has(s)){if(o.length===1&&g!==void 0){const j=l[g]??l[g-1];o=j?[j]:[]}else o=o.filter(j=>j.id!==s);a=us(o)}const x=ii(t.highlightedIds,s);return{list:u,_listIndex:h,byId:p,view:l,_viewIndex:n,sort:i,selected:o,selectedIds:a,highlightedIds:x}}else if(ar.match(e)){const{name:s,matching_flow_ids:i}=e.payload;switch(s){case Ae.Search:{const l=ds(i===null?t.list:i.map(o=>t.byId.get(o)).filter(o=>o!==void 0),vt(t.sort)),n=Ct(l);return{...t,view:l,_viewIndex:n}}case Ae.Highlight:return{...t,highlightedIds:new Set(i)};default:It(s)}}else if(dr.match(e)){const s=e.payload;let i;s.column?i=ds(t.view,vt(s)):i=t.list.filter(n=>t._viewIndex.has(n.id));const l=Ct(i);return{...t,sort:s,view:i,_viewIndex:l}}else return Je.match(e)?{...t,selected:e.payload,selectedIds:us(e.payload)}:t}function vt({column:t,desc:e}){if(!t)return(i,l)=>0;const s=Yi[t];return(i,l)=>{const n=s(i),o=s(l);return n>o?e?-1:1:n<o?e?1:-1:0}}function _t(t,e){const s=t.selected[t.selected.length-1],i=t._viewIndex.get(s?.id),l=0,n=t.view.length-1;let o;i===void 0?o=e<0?l:n:(o=i+e,o=window.Math.max(o,l),o=window.Math.min(o,n));const a=t.view[o];return Je(a?[a]:[])}function Fc(t){return(e,s)=>{const{flows:i}=s();i.selectedIds.has(t.id)?e(Je(i.selected.filter(l=>l!==t))):e(Je([...i.selected,t]))}}function Lc(t){return(e,s)=>{const{flows:i}=s(),l=i.selected[i.selected.length-1],n=i._viewIndex.get(t.id),o=i._viewIndex.get(l?.id);if(n===void 0||o===void 0)return e(Je([t]));let a;return n<=o?a=i.view.slice(n,o+1):(a=i.view.slice(o+1,n+1),a.push(l)),e(Je(a))}}const Pc={activeModal:void 0},ur=xe({name:"ui/modal",initialState:Pc,reducers:{setActiveModal(t,e){t.activeModal=e.payload},hideModal(t){t.activeModal=void 0}}}),{actions:Mc,reducer:qc}=ur,Oc=ur.actions.hideModal.type,{setActiveModal:Hc,hideModal:fr}=Mc,ci=(()=>{const t=document.createElement("div");return t.setAttribute("contenteditable","PLAINTEXT-ONLY"),t.contentEditable==="plaintext-only"?"plaintext-only":"true"})();class pe extends M.Component{input=ye.createRef();render(){const e=De("inline-input",this.props.className);return r.jsx("span",{ref:this.input,tabIndex:0,className:e,placeholder:this.props.placeholder,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onInput:this.onInput,onPaste:this.onPaste,onMouseDown:this.onMouseDown,onClick:this.onClick,children:this.props.content})}componentDidUpdate(e){e.content!==this.props.content&&this.props.onInput?.(this.props.content)}isEditing=()=>this.input.current?.contentEditable===ci;startEditing=()=>{if(!this.input.current)return console.error("unreachable");this.isEditing()||(this.suppress_events=!0,this.input.current.blur(),this.input.current.contentEditable=ci,window.requestAnimationFrame(()=>{if(this.input.current){if(this.input.current.focus(),this.suppress_events=!1,this.props.selectAllOnClick){const e=document.createRange();e.selectNodeContents(this.input.current);const s=window.getSelection();s?.removeAllRanges(),s?.addRange(e)}this.props.onEditStart?.()}}))};resetValue=()=>{if(!this.input.current)return console.error("unreachable");this.input.current.textContent=this.props.content,this.props.onInput?.(this.props.content)};finishEditing=()=>{if(!this.input.current)return console.error("unreachable");this.props.onEditDone(this.input.current.textContent||""),this.input.current.blur(),this.input.current.contentEditable="inherit"};onPaste=e=>{e.preventDefault();const s=e.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,s)};suppress_events=!1;onMouseDown=e=>{this.suppress_events=!0,window.addEventListener("mouseup",this.onMouseUp,{once:!0})};onMouseUp=e=>{const s=e.target===this.input.current,i=!window.getSelection()?.toString();this.props.selectAllOnClick?s&&i&&this.startEditing():s&&this.startEditing(),this.suppress_events=!1};onClick=e=>{};onFocus=e=>{if(!this.input.current)throw"unreachable";this.suppress_events||this.startEditing()};onInput=e=>{this.props.onInput?.(this.input.current?.textContent||"")};onBlur=e=>{this.suppress_events||this.finishEditing()};onKeyDown=e=>{switch(e.stopPropagation(),e.key){case"Escape":e.preventDefault(),this.resetValue(),this.finishEditing();break;case"Enter":e.shiftKey||(e.preventDefault(),this.finishEditing());break}this.props.onKeyDown?.(e)}}function Tt(t){const e=E.c(15);let s;e[0]!==t.content||e[1]!==t.isValid?(s=t.isValid(t.content),e[0]=t.content,e[1]=t.isValid,e[2]=s):s=e[2];const[i,l]=M.useState(s),n=M.useRef(null);let o;e[3]!==t?(o=x=>{t.isValid(x)?t.onEditDone(x):n.current?.resetValue()},e[3]=t,e[4]=o):o=e[4];const a=o,d=i?"has-success":"has-warning";let u;e[5]!==t.className||e[6]!==d?(u=De(t.className,d),e[5]=t.className,e[6]=d,e[7]=u):u=e[7];const h=u;let p;e[8]!==t?(p=x=>l(t.isValid(x)),e[8]=t,e[9]=p):p=e[9];let g;return e[10]!==h||e[11]!==a||e[12]!==t||e[13]!==p?(g=r.jsx(pe,{...t,className:h,onInput:p,onEditDone:a,ref:n}),e[10]=h,e[11]=a,e[12]=t,e[13]=p,e[14]=g):g=e[14],g}const Z=()=>Xo(),F=Zo,Vc=Ti.withTypes(),Fs=Ie("EVENTS_ADD"),pr=Ie("EVENTS_RECEIVE"),es=Ie("events/toggleVisibility"),hr=Ie("events/toggleFilter");var mr=(t=>(t.debug="debug",t.info="info",t.web="web",t.warn="warn",t.error="error",t))(mr||{});const Uc={visible:!1,filters:{debug:!1,info:!0,web:!0,warn:!0,error:!0},list:[],view:[]};function Bc(t=Uc,e){if(Fs.match(e)){const s=e.payload;return{...t,list:[...t.list,s],view:t.filters[s.level]?[...t.view,s]:t.view}}else{if(pr.match(e))return{...t,list:e.payload,view:e.payload.filter(s=>t.filters[s.level])};if(es.match(e))return{...t,visible:!t.visible};if(hr.match(e)){const s={...t.filters,[e.payload]:!t.filters[e.payload]};return{...t,filters:s,view:t.list.filter(i=>s[i.level])}}else return t}}function Kc(t,e="web"){return Fs({id:Math.random().toString(),message:t,level:e})}const ai={},Wc=xe({name:"ui/optionsEditor",initialState:ai,reducers:{startUpdate(t,e){t[e.payload.option]={isUpdating:!0,value:e.payload.value,error:!1}},updateSuccess(t,e){t[e.payload.option]=void 0},updateError(t,e){let s=t[e.payload.option].value;typeof s=="boolean"&&(s=!s),t[e.payload.option]={value:s,isUpdating:!1,error:e.payload.error}}},extraReducers:t=>{t.addCase(Oc,()=>ai)}}),{actions:zc,reducer:Qc}=Wc,{startUpdate:Gc,updateSuccess:Yc,updateError:Jc}=zc;var me=(t=>(t[t.Capture=0]="Capture",t[t.FlowList=1]="FlowList",t[t.Options=2]="Options",t[t.Flow=3]="Flow",t[t.Metrics=4]="Metrics",t[t.AdTracking=5]="AdTracking",t))(me||{});const Xc=xe({name:"ui/tabs",initialState:{current:1},reducers:{setCurrent(t,e){t.current=e.payload}}}),{actions:Zc,reducer:ea}=Xc,{setCurrent:Qt}=Zc,ta=Ri({flow:_c,modal:qc,optionsEditor:Qc,tabs:ea,filter:Nc});var Et=(t=>(t.INIT="CONNECTION_INIT",t.FETCHING="CONNECTION_FETCHING",t.ESTABLISHED="CONNECTION_ESTABLISHED",t.ERROR="CONNECTION_ERROR",t))(Et||{});const sa={state:"CONNECTION_INIT",message:void 0},gr=xe({name:"connection",initialState:sa,reducers:{startFetching:t=>{t.state==="CONNECTION_INIT"&&(t.state="CONNECTION_FETCHING")},finishFetching:t=>{t.state==="CONNECTION_FETCHING"&&(t.state="CONNECTION_ESTABLISHED")},connectionError:(t,e)=>{t.state="CONNECTION_ERROR",t.message=e.payload}}}),{startFetching:na,finishFetching:ia,connectionError:ra}=gr.actions,la=gr.reducer,oa={add_upstream_certs_to_client_chain:!1,allow_hosts:[],anticache:!1,anticomp:!1,block_global:!0,block_list:[],block_private:!1,body_size_limit:void 0,cert_passphrase:void 0,certs:[],ciphers_client:void 0,ciphers_server:void 0,client_certs:void 0,client_replay:[],client_replay_concurrency:1,command_history:!0,confdir:"~/.mitmproxy",connect_addr:void 0,connection_strategy:"eager",console_focus_follow:!1,content_view_lines_cutoff:512,dns_name_servers:[],dns_use_hosts_file:!0,export_preserve_original_ip:!1,hardump:"",http2:!0,http2_ping_keepalive:58,http3:!0,http_connect_send_host_header:!0,ignore_hosts:[],intercept:void 0,intercept_active:!1,keep_alt_svc_header:!1,keep_host_header:!1,key_size:2048,listen_host:"",listen_port:void 0,map_local:[],map_remote:[],mode:["regular"],modify_body:[],modify_headers:[],normalize_outbound_headers:!0,onboarding:!0,onboarding_host:"mitm.it",protobuf_definitions:void 0,proxy_debug:!1,proxyauth:void 0,rawtcp:!0,readfile_filter:void 0,request_client_cert:!1,rfile:void 0,save_stream_file:void 0,save_stream_filter:void 0,scripts:[],server:!0,server_replay:[],server_replay_extra:"forward",server_replay_ignore_content:!1,server_replay_ignore_host:!1,server_replay_ignore_params:[],server_replay_ignore_payload_params:[],server_replay_ignore_port:!1,server_replay_kill_extra:!1,server_replay_nopop:!1,server_replay_refresh:!0,server_replay_reuse:!1,server_replay_use_headers:[],show_ignored_hosts:!1,showhost:!1,ssl_insecure:!1,ssl_verify_upstream_trusted_ca:void 0,ssl_verify_upstream_trusted_confdir:void 0,stickyauth:void 0,stickycookie:void 0,store_streamed_bodies:!1,stream_large_bodies:void 0,strip_ech:!0,tcp_hosts:[],tcp_timeout:600,termlog_verbosity:"info",tls_ecdh_curve_client:void 0,tls_ecdh_curve_server:void 0,tls_version_client_max:"UNBOUNDED",tls_version_client_min:"TLS1_2",tls_version_server_max:"UNBOUNDED",tls_version_server_min:"TLS1_2",udp_hosts:[],upstream_auth:void 0,upstream_cert:!0,validate_inbound_headers:!0,view_filter:void 0,view_order:"time",view_order_reversed:!1,web_columns:["tls","icon","path","method","status","size","time"],web_debug:!1,web_host:"127.0.0.1",web_open_browser:!0,web_password:"",web_port:8081,web_static_viewer:"",websocket:!0},ts=Ie("OPTIONS_RECEIVE"),Ls=Ie("OPTIONS_UPDATE"),ca=xe({name:"options",initialState:oa,reducers:{},extraReducers:t=>{t.addCase(ts,(e,s)=>{const i={};for(const[l,{value:n}]of Object.entries(s.payload))i[l]=n;return i}).addCase(Ls,(e,s)=>{for(const[i,{value:l}]of Object.entries(s.payload))e[i]=l})}}),aa=ca.reducer;async function da(t,e,s){try{const i=await oe.put("/options",{[t]:e});if(i.status===200)s(Yc({option:t}));else throw await i.text()}catch(i){s(Jc({option:t,error:i.toString()}))}}const ua=da;function Ps(t,e){return s=>{s(Gc({option:t,value:e})),ua(t,e,s)}}const fa={visible:!1},pa=xe({name:"commandBar",initialState:fa,reducers:{toggleVisibility(t){t.visible=!t.visible}}}),{actions:ha,reducer:ma}=pa,{toggleVisibility:xr}=ha,Xe=Ie("STATE_RECEIVE"),Ze=Ie("STATE_UPDATE"),ga={available:!1,version:"",contentViews:[],servers:{},platform:"",localModeUnavailable:null},xa=xe({name:"backendState",initialState:ga,reducers:{},extraReducers:t=>{t.addCase(Xe,(e,s)=>({...e,available:!0,...s.payload})).addCase(Ze,(e,s)=>({...e,...s.payload}))}}),va=xa.reducer,_a={},ja=xe({name:"optionsMeta",initialState:_a,reducers:{},extraReducers:t=>{t.addCase(ts,(e,s)=>s.payload).addCase(Ls,(e,s)=>({...e,...s.payload}))}}),ya=ja.reducer,gt=(t,e)=>e.listen_host&&e.listen_port?`${t}@${e.listen_host}:${e.listen_port}`:e.listen_port?`${t}@${e.listen_port}`:t,vr=t=>{let[e,s]=js(t,"@");e||(e=s,s="");const[i,l]=Mi(e,":");let n,o;if(s){let a;if(s.includes(":")?[n,a]=js(s,":"):(n="",a=s),a&&(o=parseInt(a,10),isNaN(o)||o<0||o>65535))throw new Error(`invalid port: ${a}`)}return{full_spec:t,name:i,data:l,listen_host:n,listen_port:o}},_r=t=>gt("regular",t),di=({listen_host:t,listen_port:e})=>({ui_id:Math.random(),active:!0,listen_host:t,listen_port:e}),jr=t=>t.selectedProcesses?`local:${t.selectedProcesses}`:"local",ui=({data:t})=>({ui_id:Math.random(),active:!0,selectedProcesses:t}),yr=t=>{const e=t.file_path?`wireguard:${t.file_path}`:"wireguard";return gt(e,t)},fi=({data:t,listen_host:e,listen_port:s})=>({ui_id:Math.random(),active:!0,listen_host:e,listen_port:s,file_path:t});var ss=(t=>(t.HTTP="http",t.HTTPS="https",t.HTTP3="http3",t.TLS="tls",t.DTLS="dtls",t.TCP="tcp",t.UDP="udp",t.DNS="dns",t.QUIC="quic",t))(ss||{}),ft=(t=>(t.CSS="css",t.JAVASCRIPT="javascript",t.XML="xml",t.YAML="yaml",t.NONE="none",t.ERROR="error",t))(ft||{});const ys=()=>({active:!1,protocol:ss.HTTPS,destination:"",ui_id:Math.random()}),Ms=t=>gt(`reverse:${t.protocol}://${t.destination}`,t),ba=({data:t,listen_host:e,listen_port:s})=>{let[i,l]=Mi(t,"://");return l||(l=i,i=ss.HTTPS),{ui_id:Math.random(),active:!0,protocol:i,destination:l,listen_host:e,listen_port:s}},br=t=>gt("transparent",t),pi=({listen_host:t,listen_port:e})=>({ui_id:Math.random(),active:!0,listen_host:t,listen_port:e}),Sr=t=>gt("socks5",t),hi=({listen_host:t,listen_port:e})=>({ui_id:Math.random(),active:!0,listen_host:t,listen_port:e}),wr=t=>gt(`upstream:${t.destination}`,t),mi=({data:t,listen_host:e,listen_port:s})=>({ui_id:Math.random(),active:!0,destination:t||"",listen_host:e,listen_port:s}),$r=t=>gt("dns",t),gi=({listen_host:t,listen_port:e})=>({ui_id:Math.random(),active:!0,listen_host:t,listen_port:e}),rt=t=>t.active&&!t.error;async function Sa(t,e){const s=e.getState().modes,i=[...s.regular.filter(rt).map(_r),...s.local.filter(rt).map(jr),...s.wireguard.filter(rt).map(yr),...s.reverse.filter(rt).map(Ms),...s.transparent.filter(rt).map(br),...s.socks.filter(rt).map(Sr),...s.upstream.filter(rt).map(wr),...s.dns.filter(rt).map($r)],l=await oe.put("/options",{mode:i});if(l.status!==200)throw new Error(await l.text())}function ce(t){return Vc(t,Sa)}function le(t,e,s){t.addCase(s.pending,(i,l)=>{const{server:n,value:o}=l.meta.arg,a=i.findIndex(d=>d.ui_id===n.ui_id);a>=0&&(i[a][e]=o,i[a].error=void 0)}),t.addCase(s.rejected,(i,l)=>{const{server:n}=l.meta.arg,o=i.findIndex(a=>a.ui_id===n.ui_id);o>=0&&(i[o].error=l.error.message)})}function Me(t,e){return function(i,l){if(l.payload.servers){const n=Object.values(l.payload.servers).filter(o=>o.type===t).map(o=>vr(o.full_spec));if(n.length>0)return n.map(e);for(const o of i)o.active=!1}}}const Cr=ce("modes/regular/setActive"),Nr=ce("modes/regular/setListenHost"),kr=ce("modes/regular/setListenPort"),wa=[{active:!0,ui_id:Math.random()}],$a=xe({name:"modes/regular",initialState:wa,reducers:{},extraReducers:t=>{le(t,"active",Cr),le(t,"listen_host",Nr),le(t,"listen_port",kr),t.addCase(Xe,Me("regular",di)),t.addCase(Ze,Me("regular",di))}}),Ca=$a.reducer,Er=ce("modes/local/setActive"),Rt=ce("modes/local/setSelectedProcesses"),Na=[{active:!1,selectedProcesses:"",ui_id:Math.random()}],ka=xe({name:"modes/local",initialState:Na,reducers:{},extraReducers:t=>{le(t,"active",Er),le(t,"selectedProcesses",Rt),t.addCase(Xe,Me("local",ui)),t.addCase(Ze,Me("local",ui))}}),Ea=ka.reducer,Tr=ce("modes/wireguard/setActive"),Rr=ce("modes/wireguard/setListenHost"),Ar=ce("modes/wireguard/setListenPort"),Ir=ce("modes/wireguard/setFilePath"),Ta=[{active:!1,ui_id:Math.random()}],Ra=xe({name:"modes/wireguard",initialState:Ta,reducers:{},extraReducers:t=>{le(t,"active",Tr),le(t,"listen_host",Rr),le(t,"listen_port",Ar),le(t,"file_path",Ir),t.addCase(Xe,Me("wireguard",fi)),t.addCase(Ze,Me("wireguard",fi))}}),Aa=Ra.reducer,bs=ce("modes/reverse/setActive"),Dr=ce("modes/reverse/setListenHost"),Fr=ce("modes/reverse/setListenPort"),Lr=ce("modes/reverse/setProtocol"),Pr=ce("modes/reverse/setDestination"),Ia=[ys()],Mr=xe({name:"modes/reverse",initialState:Ia,reducers:{addServer:t=>{t.push(ys())},removeServer:(t,e)=>{const s=t.findIndex(i=>i.ui_id===e.payload.ui_id);s!==-1&&(t[s].active&&console.error("servers should be deactivated before removal"),t.splice(s,1))}},extraReducers:t=>{le(t,"active",bs),le(t,"listen_host",Dr),le(t,"listen_port",Fr),le(t,"protocol",Lr),le(t,"destination",Pr),t.addCase(Xe,e),t.addCase(Ze,e);function e(s,i){if(i.payload.servers){const l=Object.fromEntries(Object.entries(i.payload.servers).filter(([o,a])=>a.type==="reverse").map(([o,a])=>[o,vr(o)])),n=[];for(const o of s){const a=Ms(o),d=a in l;delete l[a],n.push({...o,active:d})}for(const o of Object.values(l))n.push(ba(o));return n.length>1&&Zt({...n[0],ui_id:void 0},{...ys(),ui_id:void 0})&&n.shift(),n}}}}),{addServer:Da,removeServer:Fa}=Mr.actions,La=Mr.reducer,qr=ce("modes/transparent/setActive"),Or=ce("modes/transparent/setListenHost"),Hr=ce("modes/transparent/setListenPort"),Pa=[{active:!1,ui_id:Math.random()}],Ma=xe({name:"modes/transparent",initialState:Pa,reducers:{},extraReducers:t=>{le(t,"active",qr),le(t,"listen_host",Or),le(t,"listen_port",Hr),t.addCase(Xe,Me("transparent",pi)),t.addCase(Ze,Me("transparent",pi))}}),qa=Ma.reducer,Vr=ce("modes/socks5/setActive"),Ur=ce("modes/socks5/setListenHost"),Br=ce("modes/socks5/setListenPort"),Oa=[{active:!1,ui_id:Math.random()}],Ha=xe({name:"modes/socks5",initialState:Oa,reducers:{},extraReducers:t=>{le(t,"active",Vr),le(t,"listen_host",Ur),le(t,"listen_port",Br),t.addCase(Xe,Me("socks5",hi)),t.addCase(Ze,Me("socks5",hi))}}),Va=Ha.reducer,Kr=ce("modes/upstream/setActive"),Wr=ce("modes/upstream/setListenHost"),zr=ce("modes/upstream/setListenPort"),Qr=ce("modes/upstream/setDestination"),Ua=[{active:!1,destination:"",ui_id:Math.random()}],Ba=xe({name:"modes/upstream",initialState:Ua,reducers:{},extraReducers:t=>{le(t,"active",Kr),le(t,"listen_host",Wr),le(t,"listen_port",zr),le(t,"destination",Qr),t.addCase(Xe,Me("upstream",mi)),t.addCase(Ze,Me("upstream",mi))}}),Ka=Ba.reducer,Gr=ce("modes/dns/setActive"),Yr=ce("modes/dns/setListenHost"),Jr=ce("modes/dns/setListenPort"),Wa=[{active:!0,ui_id:Math.random()}],za=xe({name:"modes/dns",initialState:Wa,reducers:{},extraReducers:t=>{le(t,"active",Gr),le(t,"listen_host",Yr),le(t,"listen_port",Jr),t.addCase(Xe,Me("dns",gi)),t.addCase(Ze,Me("dns",gi))}}),Qa=za.reducer,Ga=Ri({regular:Ca,local:Ea,wireguard:Aa,reverse:La,transparent:qa,socks:Va,upstream:Ka,dns:Qa}),At=Ti("fetchProcesses",async(t,{rejectWithValue:e})=>{try{return(await oe("/processes")).json()}catch(s){return e(s.message)}}),Ya={currentProcesses:[],isLoading:!1},Ja=xe({name:"processes",initialState:Ya,reducers:{},extraReducers:t=>{t.addCase(At.pending,e=>{e.isLoading=!0,e.error=void 0}),t.addCase(At.fulfilled,(e,s)=>{e.isLoading=!1,e.currentProcesses=s.payload}),t.addCase(At.rejected,(e,s)=>{e.isLoading=!1,e.error=s.payload})}}),Xa=Ja.reducer,Za={commandBar:ma,eventLog:Bc,flows:Dc,connection:la,modes:Ga,ui:ta,options:aa,options_meta:ya,backendState:va,processes:Xa},ed={immutableCheck:{warnAfter:5e5},serializableCheck:{warnAfter:5e5,ignoredPaths:["flows"]}},Dt=ec({reducer:Za,middleware:t=>t(ed),devTools:!1});class td extends M.Component{container=ye.createRef();nameInput=ye.createRef();valueInput=ye.createRef();render=()=>{const[e,s]=this.props.item;return r.jsxs("div",{ref:this.container,className:"kv-row",onClick:this.onClick,onKeyDownCapture:this.onKeyDown,children:[r.jsx(pe,{ref:this.nameInput,className:"kv-key",content:e,onEditStart:this.props.onEditStart,onEditDone:i=>this.props.onEditDone([i,s]),selectAllOnClick:!0}),": ",r.jsx(pe,{ref:this.valueInput,className:"kv-value",content:s,onEditStart:this.props.onEditStart,onEditDone:i=>this.props.onEditDone([e,i]),placeholder:"empty",selectAllOnClick:!0})]})};onClick=e=>{e.target===this.container.current&&this.props.onClickEmptyArea()};onKeyDown=e=>{e.target===this.valueInput.current?.input.current&&e.key==="Tab"&&this.props.onTabNext()}}class Xr extends M.Component{rowRefs={};currentlyEditing;justFinishedEditing;state={currentList:this.props.data||[],initialList:this.props.data};static getDerivedStateFromProps(e,s){return e.data!==s.initialList?{currentList:e.data||[],initialList:e.data}:null}render=()=>{this.rowRefs={};const e=this.state.currentList.map((s,i)=>r.jsx(td,{item:s,onEditStart:()=>this.currentlyEditing=i,onEditDone:l=>this.onEditDone(i,l),onClickEmptyArea:()=>this.onClickEmptyArea(i),onTabNext:()=>this.onTabNext(i),ref:l=>{this.rowRefs[i]=l}},i));return r.jsxs("div",{className:De("kv-editor",this.props.className),onMouseDown:this.onMouseDown,children:[e,r.jsx("div",{onClick:s=>{s.preventDefault(),this.onClickEmptyArea(this.state.currentList.length-1)},className:"kv-add-row fa fa-plus-square-o",role:"button","aria-label":"Add"})]})};onEditDone=(e,s)=>{const i=[...this.state.currentList];s[0]?i[e]=s:i.splice(e,1),this.currentlyEditing=void 0,zt.isEqual(this.state.currentList,i)||this.props.onChange(i),this.setState({currentList:i})};onClickEmptyArea=e=>{if(this.justFinishedEditing)return;const s=[...this.state.currentList];s.splice(e+1,0,["",""]),this.setState({currentList:s},()=>this.rowRefs[e+1]?.nameInput.current?.startEditing())};onTabNext=e=>{e==this.state.currentList.length-1&&this.onClickEmptyArea(e)};onMouseDown=e=>{this.justFinishedEditing=this.currentlyEditing}}function Zr(t,e){const s=E.c(6),[i,l]=M.useState(),[n,o]=M.useState();let a;s[0]!==n||s[1]!==t?(a=()=>{n&&n.abort();const u=new AbortController;return oe(t,{signal:u.signal}).then(sd).then(h=>{l(h)}).catch(h=>{u.signal.aborted||l(`Error getting content: ${h}.`)}),o(u),()=>{u.signal.aborted||u.abort()}},s[0]=n,s[1]=t,s[2]=a):a=s[2];let d;return s[3]!==e||s[4]!==t?(d=[t,e],s[3]=e,s[4]=t,s[5]=d):d=s[5],M.useEffect(a,d),i}function sd(t){if(!t.ok)throw`${t.status} ${t.statusText}`.trim();return t.text()}function el(t,e,s,i,l){const n=E.c(11);let o;n[0]!==t||n[1]!==i||n[2]!==e||n[3]!==s?(o=Pe.getContentURL(t,e,s,i),n[0]=t,n[1]=i,n[2]=e,n[3]=s,n[4]=o):o=n[4];const d=Zr(o,l);let u;if(d)try{let h;n[5]!==d?(h=JSON.parse(d),n[5]=d,n[6]=h):h=n[6],u=h}catch{let h;n[7]!==d?(h={text:d,description:"Network Error",syntax_highlight:"error",view_name:"raw"},n[7]=d,n[8]=h):h=n[8];const p=h;if(e==="messages"){let g;n[9]!==p?(g=[p],n[9]=p,n[10]=g):g=n[10],u=g}else u=p}else u=void 0;return u}const tl=ye.memo(function({icon:e,text:s,className:i,title:l,onOpenFile:n,onClick:o}){let a;return r.jsxs("a",{href:"#",onClick:d=>{a.click(),o&&o(d)},className:i,title:l,children:[r.jsx("i",{className:"fa fa-fw "+e}),s,r.jsx("input",{ref:d=>{a=d},className:"hidden",type:"file",onChange:d=>{d.preventDefault(),d.target.files&&d.target.files.length>0&&n(d.target.files[0]),a.value=""}})]})});function be(t){const e=E.c(11),{onClick:s,children:i,icon:l,disabled:n,className:o,title:a}=t;let d;e[0]!==o?(d=De(o,"btn btn-default"),e[0]=o,e[1]=d):d=e[1];const u=n?void 0:s;let h;e[2]!==l?(h=l&&r.jsxs(r.Fragment,{children:[r.jsx("i",{className:"fa "+l})," "]}),e[2]=l,e[3]=h):h=e[3];let p;return e[4]!==i||e[5]!==n||e[6]!==d||e[7]!==u||e[8]!==h||e[9]!==a?(p=r.jsxs("button",{className:d,onClick:u,disabled:n,title:a,children:[h,i]}),e[4]=i,e[5]=n,e[6]=d,e[7]=u,e[8]=h,e[9]=a,e[10]=p):p=e[10],p}function nd(t){const e=E.c(11),{initialContent:s,onChange:i,language:l,readonly:n}=t,o=n===void 0?!1:n,a=id;let d;e:switch(l){case ft.YAML:{let p;e[0]===Symbol.for("react.memo_cache_sentinel")?(p=[ic()],e[0]=p):p=e[0],d=p;break e}case ft.XML:{let p;e[1]===Symbol.for("react.memo_cache_sentinel")?(p=[nc()],e[1]=p):p=e[1],d=p;break e}case ft.JAVASCRIPT:{let p;e[2]===Symbol.for("react.memo_cache_sentinel")?(p=[sc()],e[2]=p):p=e[2],d=p;break e}case ft.CSS:{let p;e[3]===Symbol.for("react.memo_cache_sentinel")?(p=[tc()],e[3]=p):p=e[3],d=p;break e}case void 0:case null:case ft.NONE:case ft.ERROR:{let p;e[4]===Symbol.for("react.memo_cache_sentinel")?(p=[],e[4]=p):p=e[4],d=p;break e}default:{console.error("Unexpected syntax highlighting language: ",l);let g;e[5]===Symbol.for("react.memo_cache_sentinel")?(g=[],e[5]=g):g=e[5],d=g}}const u=d;let h;return e[6]!==u||e[7]!==s||e[8]!==i||e[9]!==o?(h=r.jsx("div",{className:"codeeditor",onKeyDown:a,children:r.jsx(rc,{value:s,onChange:i,readOnly:o,extensions:u})}),e[6]=u,e[7]=s,e[8]=i,e[9]=o,e[10]=h):h=e[10],h}function id(t){return t.stopPropagation()}const sl=ye.memo(function(e){const s=E.c(9),{content:i,maxLines:l,showMore:n}=e;if(i.length===0)return null;let o;if(s[0]!==i||s[1]!==l||s[2]!==n){let d;s[4]!==l||s[5]!==n?(d=(u,h)=>h===l?r.jsxs("button",{onClick:n,className:"btn btn-xs btn-info",children:[r.jsx("i",{className:"fa fa-angle-double-down","aria-hidden":"true"})," ","Show more"]},"showmore"):r.jsx("div",{children:u},h),s[4]=l,s[5]=n,s[6]=d):d=s[6],o=i.split(`
`).map(d),s[0]=i,s[1]=l,s[2]=n,s[3]=o}else o=s[3];let a;return s[7]!==o?(a=r.jsx("pre",{children:o}),s[7]=o,s[8]=a):a=s[8],a}),rd=()=>{const t=E.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=r.jsx("li",{role:"separator",className:"divider"}),t[0]=e):e=t[0],e};function He(t){const e=E.c(8);let s,i,l;if(e[0]!==t){const{onClick:a,children:d,...u}=t;i=d,s=u,l=h=>{h.preventDefault(),a()},e[0]=t,e[1]=s,e[2]=i,e[3]=l}else s=e[1],i=e[2],l=e[3];const n=l;let o;return e[4]!==s||e[5]!==i||e[6]!==n?(o=r.jsx("li",{children:r.jsx("a",{href:"#",onClick:n,...s,children:i})}),e[4]=s,e[5]=i,e[6]=n,e[7]=o):o=e[7],o}const Lt=ye.memo(function({text:e,children:s,options:i,className:l,onOpen:n,...o}){const[a,d]=M.useState(!1),{refs:u,floatingStyles:h}=lc(i),p=x=>{d(x),n&&n(x)};M.useEffect(()=>{u.floating.current&&document.addEventListener("click",x=>{u.floating.current?.contains(x.target)?document.addEventListener("click",()=>p(!1),{once:!0}):(x.preventDefault(),x.stopPropagation(),p(!1))},{once:!0,capture:!0})},[u.floating.current]);let g;return a?g=r.jsx("ul",{className:"dropdown-menu show",ref:u.setFloating,style:h,children:s}):g=null,r.jsxs(r.Fragment,{children:[r.jsx("a",{href:"#",ref:u.setReference,className:De(l,{open:a}),onClick:x=>{x.preventDefault(),p(!0)},...o,children:e}),g]})});function nl(t){const e=E.c(16),{value:s,onChange:i}=t,l=F(ld);let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("i",{className:"fa fa-fw fa-files-o"}),e[0]=n):n=e[0];let o;e[1]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsx("b",{children:"View:"}),e[1]=o):o=e[1];let a;e[2]!==s?(a=s.toLowerCase(),e[2]=s,e[3]=a):a=e[3];let d;e[4]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx("span",{className:"caret"}),e[4]=d):d=e[4];let u;e[5]!==a?(u=r.jsxs("span",{children:[n," ",o," ",a," ",d]}),e[5]=a,e[6]=u):u=e[6];const h=u;let p;e[7]===Symbol.for("react.memo_cache_sentinel")?(p={placement:"top-end"},e[7]=p):p=e[7];let g;if(e[8]!==l||e[9]!==i){let j;e[11]!==i?(j=y=>r.jsx(He,{onClick:()=>i(y),children:y.toLowerCase().replace("_"," ")},y),e[11]=i,e[12]=j):j=e[12],g=l.map(j),e[8]=l,e[9]=i,e[10]=g}else g=e[10];let x;return e[13]!==h||e[14]!==g?(x=r.jsx(Lt,{text:h,className:"btn btn-default btn-xs",options:p,children:g}),e[13]=h,e[14]=g,e[15]=x):x=e[15],x}function ld(t){return t.backendState.contentViews||[]}function od(t){const e=E.c(8),{flow:s,message:i}=t,[l,n]=M.useState(!1);if(l){let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=()=>n(!1),e[0]=o):o=e[0];let a;return e[1]!==s||e[2]!==i?(a=r.jsx(cd,{flow:s,message:i,stopEdit:o}),e[1]=s,e[2]=i,e[3]=a):a=e[3],a}else{let o;e[4]===Symbol.for("react.memo_cache_sentinel")?(o=()=>n(!0),e[4]=o):o=e[4];let a;return e[5]!==s||e[6]!==i?(a=r.jsx(ad,{flow:s,message:i,startEdit:o}),e[5]=s,e[6]=i,e[7]=a):a=e[7],a}}function cd(t){const e=E.c(23),{flow:s,message:i,stopEdit:l}=t,n=Z(),o=s.request===i?"request":"response";let a;e[0]!==s||e[1]!==i?(a=Pe.getContentURL(s,i),e[0]=s,e[1]=i,e[2]=a):a=e[2];const u=Zr(a,i.contentHash),[h,p]=M.useState();let g;e[3]!==u||e[4]!==n||e[5]!==h||e[6]!==s||e[7]!==o||e[8]!==l?(g=async()=>{await n(ze(s,{[o]:{content:h||u||""}})),l()},e[3]=u,e[4]=n,e[5]=h,e[6]=s,e[7]=o,e[8]=l,e[9]=g):g=e[9];const x=g;let j;e[10]===Symbol.for("react.memo_cache_sentinel")?(j=r.jsx("h5",{children:"[Editing]"}),e[10]=j):j=e[10];let y;e[11]!==x?(y=r.jsx(be,{onClick:x,icon:"fa-check text-success",className:"btn-xs",children:"Done"}),e[11]=x,e[12]=y):y=e[12];let b;e[13]!==l?(b=r.jsx(be,{onClick:()=>l(),icon:"fa-times text-danger",className:"btn-xs",children:"Cancel"}),e[13]=l,e[14]=b):b=e[14];let $;e[15]!==y||e[16]!==b?($=r.jsxs("div",{className:"controls",children:[j,y," ",b]}),e[15]=y,e[16]=b,e[17]=$):$=e[17];const N=u||"";let k;e[18]!==N?(k=r.jsx(nd,{initialContent:N,onChange:p}),e[18]=N,e[19]=k):k=e[19];let T;return e[20]!==$||e[21]!==k?(T=r.jsxs("div",{className:"contentview",children:[$,k]},"edit"),e[20]=$,e[21]=k,e[22]=T):T=e[22],T}function ad(t){const e=E.c(43),{flow:s,message:i,startEdit:l}=t,n=Z(),o=s.request===i?"request":"response";let a;e[0]!==s.id||e[1]!==o?(a=H=>H.ui.flow.contentViewFor[s.id+o]||"Auto",e[0]=s.id,e[1]=o,e[2]=a):a=e[2];const d=F(a),[u,h]=M.useState(F(dd));let p;e[3]!==u?(p=()=>h(Math.max(1024,u*2)),e[3]=u,e[4]=p):p=e[4];const g=p,x=el(s,i,d,u+1,i.contentHash);let j;if(i.contentLength===0)j="No content";else if(x===void 0)j="Loading...";else{const H=`${x.view_name} ${x.description}`;let W;e[5]!==H?(W=H.trimEnd(),e[5]=H,e[6]=W):W=e[6],j=W}let y;e[7]!==j?(y=r.jsx("h5",{children:j}),e[7]=j,e[8]=y):y=e[8];let b;e[9]!==x||e[10]!==s||e[11]!==i?(b=x&&x?.text.length>0&&r.jsx(ud,{flow:s,message:i}),e[9]=x,e[10]=s,e[11]=i,e[12]=b):b=e[12];let $;e[13]!==l?($=r.jsx(be,{onClick:l,icon:"fa-edit",className:"btn-xs",children:"Edit"}),e[13]=l,e[14]=$):$=e[14];let N;e[15]!==n||e[16]!==s||e[17]!==o?(N=r.jsx(tl,{icon:"fa-upload",text:"Replace",title:"Upload a file to replace the content.",onOpenFile:H=>n(Rc(s,H,o)),className:"btn btn-default btn-xs"}),e[15]=n,e[16]=s,e[17]=o,e[18]=N):N=e[18];let k;e[19]!==n||e[20]!==s.id||e[21]!==o?(k=H=>n(Di({messageId:s.id+o,contentView:H})),e[19]=n,e[20]=s.id,e[21]=o,e[22]=k):k=e[22];let T;e[23]!==d||e[24]!==k?(T=r.jsx(nl,{value:d,onChange:k}),e[23]=d,e[24]=k,e[25]=T):T=e[25];let D;e[26]!==y||e[27]!==b||e[28]!==$||e[29]!==N||e[30]!==T?(D=r.jsxs("div",{className:"controls",children:[y,b," ",$," ",N," ",T]}),e[26]=y,e[27]=b,e[28]=$,e[29]=N,e[30]=T,e[31]=D):D=e[31];let I;e[32]!==s||e[33]!==i?(I=Ss.matches(i)&&r.jsx(Ss,{flow:s,message:i}),e[32]=s,e[33]=i,e[34]=I):I=e[34];const O=x?.text??"";let q;e[35]!==u||e[36]!==g||e[37]!==O?(q=r.jsx(sl,{content:O,maxLines:u,showMore:g}),e[35]=u,e[36]=g,e[37]=O,e[38]=q):q=e[38];let U;return e[39]!==I||e[40]!==q||e[41]!==D?(U=r.jsxs("div",{className:"contentview",children:[D,I,q]},"view"),e[39]=I,e[40]=q,e[41]=D,e[42]=U):U=e[42],U}function dd(t){return t.options.content_view_lines_cutoff}function ud({flow:t,message:e}){const s=t.request===e?"request":"response",i=F(u=>u.ui.flow.contentViewFor[t.id+s]||"Auto"),[l,n]=M.useState(!1),[o,a]=M.useState(!1),d=async()=>{try{const u=Pe.getContentURL(t,e,i);a(!0);const h=await oe(u);if(!h.ok)throw new Error(`${h.status} ${h.statusText}`.trim());const p=await h.json();await yc(p),n(!0),setTimeout(()=>n(!1),2e3)}catch(u){console.error(u)}finally{a(!1)}};return r.jsx(be,{onClick:d,icon:"fa-clipboard",className:"btn-xs",disabled:o,children:l?"Copied!":"Copy"})}const fd=/^image\/(png|jpe?g|gif|webp|vnc.microsoft.icon|x-icon|svg\+xml)$/i;Ss.matches=t=>fd.test(Pe.getContentType(t)||"");function Ss(t){const e=E.c(5),{flow:s,message:i}=t;let l;e[0]!==s||e[1]!==i?(l=Pe.getContentURL(s,i),e[0]=s,e[1]=i,e[2]=l):l=e[2];let n;return e[3]!==l?(n=r.jsx("div",{className:"flowview-image",children:r.jsx("img",{src:l,alt:"preview",className:"img-thumbnail"})}),e[3]=l,e[4]=n):n=e[4],n}function pd(t){const e=E.c(24),{flow:s}=t,i=Z();let l;e[0]!==i||e[1]!==s?(l=g=>i(ze(s,{request:{method:g}})),e[0]=i,e[1]=s,e[2]=l):l=e[2];let n;e[3]!==s.request.method||e[4]!==l?(n=r.jsx(Tt,{content:s.request.method,onEditDone:l,isValid:md,selectAllOnClick:!0}),e[3]=s.request.method,e[4]=l,e[5]=n):n=e[5];let o;e[6]!==s.request?(o=ht.pretty_url(s.request),e[6]=s.request,e[7]=o):o=e[7];let a;e[8]!==i||e[9]!==s?(a=g=>i(ze(s,{request:{path:"",...Oi(g)}})),e[8]=i,e[9]=s,e[10]=a):a=e[10];let d;e[11]!==o||e[12]!==a?(d=r.jsx(Tt,{content:o,onEditDone:a,isValid:hd}),e[11]=o,e[12]=a,e[13]=d):d=e[13];let u;e[14]!==i||e[15]!==s?(u=g=>i(ze(s,{request:{http_version:g}})),e[14]=i,e[15]=s,e[16]=u):u=e[16];let h;e[17]!==s.request.http_version||e[18]!==u?(h=r.jsx(Tt,{content:s.request.http_version,onEditDone:u,isValid:Hi,selectAllOnClick:!0}),e[17]=s.request.http_version,e[18]=u,e[19]=h):h=e[19];let p;return e[20]!==n||e[21]!==d||e[22]!==h?(p=r.jsx("div",{className:"first-line request-line",children:r.jsxs("div",{children:[n," ",d," ",h]})}),e[20]=n,e[21]=d,e[22]=h,e[23]=p):p=e[23],p}function hd(t){return!!Oi(t)?.host}function md(t){return t.length>0}function gd(t){const e=E.c(19),{flow:s}=t,i=Z();let l;e[0]!==i||e[1]!==s?(l=p=>i(ze(s,{response:{http_version:p}})),e[0]=i,e[1]=s,e[2]=l):l=e[2];let n;e[3]!==s.response.http_version||e[4]!==l?(n=r.jsx(Tt,{content:s.response.http_version,onEditDone:l,isValid:Hi,selectAllOnClick:!0}),e[3]=s.response.http_version,e[4]=l,e[5]=n):n=e[5];const o=s.response.status_code+"";let a;e[6]!==i||e[7]!==s?(a=p=>i(ze(s,{response:{code:parseInt(p)}})),e[6]=i,e[7]=s,e[8]=a):a=e[8];let d;e[9]!==o||e[10]!==a?(d=r.jsx(Tt,{content:o,onEditDone:a,isValid:xd,selectAllOnClick:!0}),e[9]=o,e[10]=a,e[11]=d):d=e[11];let u;e[12]!==i||e[13]!==s?(u=s.response.http_version!=="HTTP/2.0"&&r.jsxs(r.Fragment,{children:[" ",r.jsx(pe,{content:s.response.reason,onEditDone:p=>i(ze(s,{response:{msg:p}})),selectAllOnClick:!0})]}),e[12]=i,e[13]=s,e[14]=u):u=e[14];let h;return e[15]!==n||e[16]!==d||e[17]!==u?(h=r.jsxs("div",{className:"first-line response-line",children:[n," ",d,u]}),e[15]=n,e[16]=d,e[17]=u,e[18]=h):h=e[18],h}function xd(t){return/^\d+$/.test(t)}function vd(t){const e=E.c(7),{flow:s,message:i}=t,l=Z(),n=s.request===i?"request":"response";let o;e[0]!==l||e[1]!==s||e[2]!==n?(o=d=>l(ze(s,{[n]:{headers:d}})),e[0]=l,e[1]=s,e[2]=n,e[3]=o):o=e[3];let a;return e[4]!==i.headers||e[5]!==o?(a=r.jsx(Xr,{className:"headers",data:i.headers,onChange:o}),e[4]=i.headers,e[5]=o,e[6]=a):a=e[6],a}function _d(t){const e=E.c(9),{flow:s,message:i}=t,l=Z(),n=s.request===i?"request":"response";if(!!!Pe.get_first_header(i,/^trailer$/i))return null;let a,d;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("hr",{}),d=r.jsx("h5",{children:"HTTP Trailers"}),e[0]=a,e[1]=d):(a=e[0],d=e[1]);let u;e[2]!==l||e[3]!==s||e[4]!==n?(u=p=>l(ze(s,{[n]:{trailers:p}})),e[2]=l,e[3]=s,e[4]=n,e[5]=u):u=e[5];let h;return e[6]!==i.trailers||e[7]!==u?(h=r.jsxs(r.Fragment,{children:[a,d,r.jsx(Xr,{className:"trailers",data:i.trailers,onChange:u})]}),e[6]=i.trailers,e[7]=u,e[8]=h):h=e[8],h}const il=M.memo(function(e){const s=E.c(20),{flow:i,message:l}=e,n=i.request===l?"request":"response",o=i.request===l?pd:gd;let a;s[0]!==o||s[1]!==i?(a=r.jsx(o,{flow:i}),s[0]=o,s[1]=i,s[2]=a):a=s[2];let d;s[3]!==i||s[4]!==l?(d=r.jsx(vd,{flow:i,message:l}),s[3]=i,s[4]=l,s[5]=d):d=s[5];let u;s[6]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("hr",{}),s[6]=u):u=s[6];const h=i.id+n;let p;s[7]!==i||s[8]!==l||s[9]!==h?(p=r.jsx(od,{flow:i,message:l},h),s[7]=i,s[8]=l,s[9]=h,s[10]=p):p=s[10];let g;s[11]!==i||s[12]!==l?(g=r.jsx(_d,{flow:i,message:l}),s[11]=i,s[12]=l,s[13]=g):g=s[13];let x;return s[14]!==n||s[15]!==a||s[16]!==d||s[17]!==p||s[18]!==g?(x=r.jsxs("section",{className:n,children:[a,d,u,p,g]}),s[14]=n,s[15]=a,s[16]=d,s[17]=p,s[18]=g,s[19]=x):x=s[19],x});function rl(){const t=E.c(2),e=F(jd);let s;return t[0]!==e?(s=r.jsx(il,{flow:e,message:e.request}),t[0]=e,t[1]=s):s=t[1],s}function jd(t){return t.flows.selected[0]}rl.displayName="Request";function ll(){const t=E.c(2),e=F(yd);let s;return t[0]!==e?(s=r.jsx(il,{flow:e,message:e.response}),t[0]=e,t[1]=s):s=t[1],s}function yd(t){return t.flows.selected[0]}ll.displayName="Response";const bd=t=>{const e=E.c(3),{message:s}=t,i=s.query?s.op_code:s.response_code,l=s.truncation?"(Truncated)":"";let n;return e[0]!==i||e[1]!==l?(n=r.jsxs("div",{children:[i," ",l]}),e[0]=i,e[1]=l,e[2]=n):n=e[2],n},Sd=t=>{const e=E.c(10),{message:s}=t,i=s.recursion_desired?"Recursive ":"";let l;e[0]!==i?(l=r.jsxs("h5",{children:[i,"Question"]}),e[0]=i,e[1]=l):l=e[1];let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{children:"Type"}),r.jsx("th",{children:"Class"})]})}),e[2]=n):n=e[2];let o;e[3]!==s.questions?(o=s.questions.map(Cd),e[3]=s.questions,e[4]=o):o=e[4];let a;e[5]!==o?(a=r.jsxs("table",{children:[n,r.jsx("tbody",{children:o})]}),e[5]=o,e[6]=a):a=e[6];let d;return e[7]!==l||e[8]!==a?(d=r.jsxs(r.Fragment,{children:[l,a]}),e[7]=l,e[8]=a,e[9]=d):d=e[9],d},fs=t=>{const e=E.c(7),{name:s,values:i}=t;let l;e[0]!==s?(l=r.jsx("h5",{children:s}),e[0]=s,e[1]=l):l=e[1];let n;e[2]!==i?(n=i.length>0?r.jsxs("table",{children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{children:"Type"}),r.jsx("th",{children:"Class"}),r.jsx("th",{children:"TTL"}),r.jsx("th",{children:"Data"})]})}),r.jsx("tbody",{children:i.map(Nd)})]}):"—",e[2]=i,e[3]=n):n=e[3];let o;return e[4]!==l||e[5]!==n?(o=r.jsxs(r.Fragment,{children:[l,n]}),e[4]=l,e[5]=n,e[6]=o):o=e[6],o},ol=t=>{const e=E.c(24),{type:s,message:i}=t,l="dns-"+s,n=`first-line ${s}-line`;let o;e[0]!==i?(o=r.jsx(bd,{message:i}),e[0]=i,e[1]=o):o=e[1];let a;e[2]!==n||e[3]!==o?(a=r.jsx("div",{className:n,children:o}),e[2]=n,e[3]=o,e[4]=a):a=e[4];let d;e[5]!==i?(d=r.jsx(Sd,{message:i}),e[5]=i,e[6]=d):d=e[6];let u;e[7]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("hr",{}),e[7]=u):u=e[7];const h=`${i.authoritative_answer?"Authoritative ":""}${i.recursion_available?"Recursive ":""}Answer`;let p;e[8]!==i.answers||e[9]!==h?(p=r.jsx(fs,{name:h,values:i.answers}),e[8]=i.answers,e[9]=h,e[10]=p):p=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("hr",{}),e[11]=g):g=e[11];let x;e[12]!==i.authorities?(x=r.jsx(fs,{name:"Authority",values:i.authorities}),e[12]=i.authorities,e[13]=x):x=e[13];let j;e[14]===Symbol.for("react.memo_cache_sentinel")?(j=r.jsx("hr",{}),e[14]=j):j=e[14];let y;e[15]!==i.additionals?(y=r.jsx(fs,{name:"Additional",values:i.additionals}),e[15]=i.additionals,e[16]=y):y=e[16];let b;return e[17]!==l||e[18]!==x||e[19]!==y||e[20]!==a||e[21]!==d||e[22]!==p?(b=r.jsxs("section",{className:l,children:[a,d,u,p,g,x,j,y]}),e[17]=l,e[18]=x,e[19]=y,e[20]=a,e[21]=d,e[22]=p,e[23]=b):b=e[23],b};function cl(){const t=E.c(2),e=F(wd);let s;return t[0]!==e.request?(s=r.jsx(ol,{type:"request",message:e.request}),t[0]=e.request,t[1]=s):s=t[1],s}function wd(t){return t.flows.selected[0]}cl.displayName="Request";function al(){const t=E.c(2),e=F($d);let s;return t[0]!==e.response?(s=r.jsx(ol,{type:"response",message:e.response}),t[0]=e.response,t[1]=s):s=t[1],s}function $d(t){return t.flows.selected[0]}al.displayName="Response";function Cd(t,e){return r.jsxs("tr",{children:[r.jsx("td",{children:t.name}),r.jsx("td",{children:t.type}),r.jsx("td",{children:t.class})]},e)}function Nd(t,e){return r.jsxs("tr",{children:[r.jsx("td",{children:t.name}),r.jsx("td",{children:t.type}),r.jsx("td",{children:t.class}),r.jsx("td",{children:t.ttl}),r.jsx("td",{children:JSON.stringify(t.data).replace(/^"|"$/g,"")})]},e)}function Kt(t,e){return e?(e=[e[0],e[1]],e[0].includes(":")&&(e[0]=`[${e[0]}]`),r.jsxs("tr",{children:[r.jsxs("td",{children:[t,":"]}),r.jsx("td",{children:e.join(":")})]})):r.jsx(r.Fragment,{})}function xi(t){const e=E.c(26),{conn:s}=t;let i;if("address"in s){let u;e[0]!==s.address?(u=Kt("Address",s.address),e[0]=s.address,e[1]=u):u=e[1];let h;e[2]!==s.peername?(h=Kt("Resolved address",s.peername),e[2]=s.peername,e[3]=h):h=e[3];let p;e[4]!==s.sockname?(p=Kt("Source address",s.sockname),e[4]=s.sockname,e[5]=p):p=e[5];let g;e[6]!==u||e[7]!==h||e[8]!==p?(g=r.jsxs(r.Fragment,{children:[u,h,p]}),e[6]=u,e[7]=h,e[8]=p,e[9]=g):g=e[9],i=g}else{let u;e[10]!==s.peername?(u=Kt("Address",s.peername),e[10]=s.peername,e[11]=u):u=e[11],i=u}let l;e[12]!==s.sni?(l=s.sni?r.jsxs("tr",{children:[r.jsxs("td",{children:[r.jsx("abbr",{title:"TLS Server Name Indication",children:"SNI"}),":"]}),r.jsx("td",{children:s.sni})]}):null,e[12]=s.sni,e[13]=l):l=e[13];let n;e[14]!==s.alpn?(n=s.alpn?r.jsxs("tr",{children:[r.jsxs("td",{children:[r.jsx("abbr",{title:"ALPN protocol negotiated",children:"ALPN"}),":"]}),r.jsx("td",{children:s.alpn})]}):null,e[14]=s.alpn,e[15]=n):n=e[15];let o;e[16]!==s.tls_version?(o=s.tls_version?r.jsxs("tr",{children:[r.jsx("td",{children:"TLS Version:"}),r.jsx("td",{children:s.tls_version})]}):null,e[16]=s.tls_version,e[17]=o):o=e[17];let a;e[18]!==s.cipher?(a=s.cipher?r.jsxs("tr",{children:[r.jsx("td",{children:"TLS Cipher:"}),r.jsx("td",{children:s.cipher})]}):null,e[18]=s.cipher,e[19]=a):a=e[19];let d;return e[20]!==i||e[21]!==l||e[22]!==n||e[23]!==o||e[24]!==a?(d=r.jsx("table",{className:"connection-table",children:r.jsxs("tbody",{children:[i,l,n,o,a]})}),e[20]=i,e[21]=l,e[22]=n,e[23]=o,e[24]=a,e[25]=d):d=e[25],d}function vi(t){return r.jsx("dl",{className:"cert-attributes",children:t.map(([e,s])=>r.jsxs(M.Fragment,{children:[r.jsx("dt",{children:e}),r.jsx("dd",{children:s})]},e))})}function kd(t){const e=E.c(46),{flow:s}=t,i=s.server_conn?.cert;if(!i){let W;return e[0]===Symbol.for("react.memo_cache_sentinel")?(W=r.jsx(r.Fragment,{}),e[0]=W):W=e[0],W}let l;e[1]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("h4",{children:"Server Certificate"},"name"),e[1]=l):l=e[1];let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("td",{children:"Type"}),e[2]=n):n=e[2];let o;e[3]!==i.keyinfo[0]||e[4]!==i.keyinfo[1]?(o=r.jsxs("tr",{children:[n,r.jsxs("td",{children:[i.keyinfo[0],", ",i.keyinfo[1]," bits"]})]}),e[3]=i.keyinfo[0],e[4]=i.keyinfo[1],e[5]=o):o=e[5];let a;e[6]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("td",{children:"SHA256 digest"}),e[6]=a):a=e[6];let d;e[7]!==i.sha256?(d=r.jsxs("tr",{children:[a,r.jsx("td",{children:i.sha256})]}),e[7]=i.sha256,e[8]=d):d=e[8];let u;e[9]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("td",{children:"Valid from"}),e[9]=u):u=e[9];let h;e[10]!==i.notbefore?(h=mt(i.notbefore,{includeMilliseconds:!1}),e[10]=i.notbefore,e[11]=h):h=e[11];let p;e[12]!==h?(p=r.jsxs("tr",{children:[u,r.jsx("td",{children:h})]}),e[12]=h,e[13]=p):p=e[13];let g;e[14]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("td",{children:"Valid to"}),e[14]=g):g=e[14];let x;e[15]!==i.notafter?(x=mt(i.notafter,{includeMilliseconds:!1}),e[15]=i.notafter,e[16]=x):x=e[16];let j;e[17]!==x?(j=r.jsxs("tr",{children:[g,r.jsx("td",{children:x})]}),e[17]=x,e[18]=j):j=e[18];let y;e[19]===Symbol.for("react.memo_cache_sentinel")?(y=r.jsx("td",{children:"Subject Alternative Names"}),e[19]=y):y=e[19];let b;e[20]!==i.altnames?(b=i.altnames.join(", "),e[20]=i.altnames,e[21]=b):b=e[21];let $;e[22]!==b?($=r.jsxs("tr",{children:[y,r.jsx("td",{children:b})]}),e[22]=b,e[23]=$):$=e[23];let N;e[24]===Symbol.for("react.memo_cache_sentinel")?(N=r.jsx("td",{children:"Subject"}),e[24]=N):N=e[24];let k;e[25]!==i.subject?(k=vi(i.subject),e[25]=i.subject,e[26]=k):k=e[26];let T;e[27]!==k?(T=r.jsxs("tr",{children:[N,r.jsx("td",{children:k})]}),e[27]=k,e[28]=T):T=e[28];let D;e[29]===Symbol.for("react.memo_cache_sentinel")?(D=r.jsx("td",{children:"Issuer"}),e[29]=D):D=e[29];let I;e[30]!==i.issuer?(I=vi(i.issuer),e[30]=i.issuer,e[31]=I):I=e[31];let O;e[32]!==I?(O=r.jsxs("tr",{children:[D,r.jsx("td",{children:I})]}),e[32]=I,e[33]=O):O=e[33];let q;e[34]===Symbol.for("react.memo_cache_sentinel")?(q=r.jsx("td",{children:"Serial"}),e[34]=q):q=e[34];let U;e[35]!==i.serial?(U=r.jsxs("tr",{children:[q,r.jsx("td",{children:i.serial})]}),e[35]=i.serial,e[36]=U):U=e[36];let H;return e[37]!==j||e[38]!==$||e[39]!==T||e[40]!==O||e[41]!==U||e[42]!==o||e[43]!==d||e[44]!==p?(H=r.jsxs(r.Fragment,{children:[l,r.jsx("table",{className:"certificate-table",children:r.jsxs("tbody",{children:[o,d,p,j,$,T,O,U]})})]}),e[37]=j,e[38]=$,e[39]=T,e[40]=O,e[41]=U,e[42]=o,e[43]=d,e[44]=p,e[45]=H):H=e[45],H}function dl(t){const e=E.c(11),{flow:s}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=r.jsx("h4",{children:"Client Connection"}),e[0]=i):i=e[0];let l;e[1]!==s.client_conn?(l=r.jsx(xi,{conn:s.client_conn}),e[1]=s.client_conn,e[2]=l):l=e[2];let n;e[3]!==s.server_conn?(n=s.server_conn?.address&&r.jsxs(r.Fragment,{children:[r.jsx("h4",{children:"Server Connection"}),r.jsx(xi,{conn:s.server_conn})]}),e[3]=s.server_conn,e[4]=n):n=e[4];let o;e[5]!==s?(o=r.jsx(kd,{flow:s}),e[5]=s,e[6]=o):o=e[6];let a;return e[7]!==l||e[8]!==n||e[9]!==o?(a=r.jsxs("section",{className:"detail",children:[i,l,n,o]}),e[7]=l,e[8]=n,e[9]=o,e[10]=a):a=e[10],a}dl.displayName="Connection";function ul(t){const e=E.c(7),{flow:s}=t,i=s.error.msg;let l;e[0]!==s.error.timestamp?(l=mt(s.error.timestamp),e[0]=s.error.timestamp,e[1]=l):l=e[1];let n;e[2]!==l?(n=r.jsx("div",{children:r.jsx("small",{children:l})}),e[2]=l,e[3]=n):n=e[3];let o;return e[4]!==s.error.msg||e[5]!==n?(o=r.jsx("section",{className:"error",children:r.jsxs("div",{className:"alert alert-warning",children:[i,n]})}),e[4]=s.error.msg,e[5]=n,e[6]=o):o=e[6],o}ul.displayName="Error";function Ed(t){const e=E.c(4),{t:s,deltaTo:i,title:l}=t;let n;return e[0]!==i||e[1]!==s||e[2]!==l?(n=s?r.jsxs("tr",{children:[r.jsxs("td",{children:[l,":"]}),r.jsxs("td",{children:[mt(s),i&&r.jsxs("span",{className:"text-muted",children:["(",Li(1e3*(s-i)),")"]})]})]}):r.jsx("tr",{}),e[0]=i,e[1]=s,e[2]=l,e[3]=n):n=e[3],n}function fl(t){const e=E.c(26),{flow:s}=t;let i;s.type==="http"?i=s.request.timestamp_start:i=s.client_conn.timestamp_start;const l=s.server_conn?.timestamp_start;let n,o,a,d;if(e[0]!==s.client_conn.timestamp_end||e[1]!==s.client_conn.timestamp_start||e[2]!==s.client_conn.timestamp_tls_setup||e[3]!==s.request||e[4]!==s.response?.timestamp_end||e[5]!==s.response?.timestamp_start||e[6]!==s.server_conn?.timestamp_end||e[7]!==s.server_conn?.timestamp_tcp_setup||e[8]!==s.server_conn?.timestamp_tls_setup||e[9]!==s.type||e[10]!==i||e[11]!==l){const g=[{title:"Server conn. initiated",t:l,deltaTo:i},{title:"Server conn. TCP handshake",t:s.server_conn?.timestamp_tcp_setup,deltaTo:i},{title:"Server conn. TLS handshake",t:s.server_conn?.timestamp_tls_setup,deltaTo:i},{title:"Server conn. closed",t:s.server_conn?.timestamp_end,deltaTo:i},{title:"Client conn. established",t:s.client_conn.timestamp_start,deltaTo:s.type==="http"?i:void 0},{title:"Client conn. TLS handshake",t:s.client_conn.timestamp_tls_setup,deltaTo:i},{title:"Client conn. closed",t:s.client_conn.timestamp_end,deltaTo:i}];s.type==="http"&&g.push({title:"First request byte",t:s.request.timestamp_start},{title:"Request complete",t:s.request.timestamp_end,deltaTo:i},{title:"First response byte",t:s.response?.timestamp_start,deltaTo:i},{title:"Response complete",t:s.response?.timestamp_end,deltaTo:i}),a="timing",e[16]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx("h4",{children:"Timing"}),e[16]=d):d=e[16],o="timing-table",n=g.filter(Ad).sort(Rd).map(Td),e[0]=s.client_conn.timestamp_end,e[1]=s.client_conn.timestamp_start,e[2]=s.client_conn.timestamp_tls_setup,e[3]=s.request,e[4]=s.response?.timestamp_end,e[5]=s.response?.timestamp_start,e[6]=s.server_conn?.timestamp_end,e[7]=s.server_conn?.timestamp_tcp_setup,e[8]=s.server_conn?.timestamp_tls_setup,e[9]=s.type,e[10]=i,e[11]=l,e[12]=n,e[13]=o,e[14]=a,e[15]=d}else n=e[12],o=e[13],a=e[14],d=e[15];let u;e[17]!==n?(u=r.jsx("tbody",{children:n}),e[17]=n,e[18]=u):u=e[18];let h;e[19]!==o||e[20]!==u?(h=r.jsx("table",{className:o,children:u}),e[19]=o,e[20]=u,e[21]=h):h=e[21];let p;return e[22]!==a||e[23]!==d||e[24]!==h?(p=r.jsxs("section",{className:a,children:[d,h]}),e[22]=a,e[23]=d,e[24]=h,e[25]=p):p=e[25],p}function Td(t){const{title:e,t:s,deltaTo:i}=t;return r.jsx(Ed,{title:e,t:s,deltaTo:i},e)}function Rd(t,e){return t.t-e.t}function Ad(t){return!!t.t}fl.displayName="Timing";function qs({flow:t,messages_meta:e}){const s=Z(),i=F(u=>u.ui.flow.contentViewFor[t.id+"messages"]||"Auto"),[l,n]=M.useState(F(u=>u.options.content_view_lines_cutoff)),o=M.useCallback(()=>n(Math.max(1024,l*2)),[l]),a=el(t,"messages",i,l+1,t.id+e.count)??[];let d=l;return r.jsxs("div",{className:"contentview",children:[r.jsxs("div",{className:"controls",children:[r.jsxs("h5",{children:[e.count," Messages"]}),r.jsx(nl,{value:i,onChange:u=>s(Di({messageId:t.id+"messages",contentView:u}))})]}),a.map((u,h)=>{const p=`fa fa-fw fa-arrow-${u.from_client?"right text-primary":"left text-danger"}`,g=r.jsxs("div",{children:[r.jsxs("small",{children:[r.jsx("i",{className:p}),r.jsx("span",{className:"pull-right",children:u.timestamp&&mt(u.timestamp)})]}),r.jsx(sl,{content:u.text,maxLines:d,showMore:o})]},h);return d-=u.text.split(`
`).length,g})]})}function pl(t){const e=E.c(8),{flow:s}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=r.jsx("h4",{children:"WebSocket"}),e[0]=i):i=e[0];let l;e[1]!==s?(l=r.jsx(qs,{flow:s,messages_meta:s.websocket.messages_meta}),e[1]=s,e[2]=l):l=e[2];let n;e[3]!==s.websocket?(n=r.jsx(Id,{websocket:s.websocket}),e[3]=s.websocket,e[4]=n):n=e[4];let o;return e[5]!==l||e[6]!==n?(o=r.jsxs("section",{className:"websocket",children:[i,l,n]}),e[5]=l,e[6]=n,e[7]=o):o=e[7],o}pl.displayName="WebSocket";function Id(t){const e=E.c(10),{websocket:s}=t;if(!s.timestamp_end)return null;const i=s.close_reason?`(${s.close_reason})`:"";let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("i",{className:"fa fa-fw fa-window-close text-muted"}),e[0]=l):l=e[0];const n=s.closed_by_client?"client":"server",o=s.close_code;let a;e[1]!==s.timestamp_end?(a=mt(s.timestamp_end),e[1]=s.timestamp_end,e[2]=a):a=e[2];let d;e[3]!==a?(d=r.jsx("small",{className:"pull-right",children:a}),e[3]=a,e[4]=d):d=e[4];let u;return e[5]!==i||e[6]!==n||e[7]!==d||e[8]!==s.close_code?(u=r.jsxs("div",{children:[l,"  Closed by ",n," ","with code ",o," ",i,".",d]}),e[5]=i,e[6]=n,e[7]=d,e[8]=s.close_code,e[9]=u):u=e[9],u}function hl(t){const e=E.c(7),{flow:s}=t,i=Z();let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("h4",{children:"Comment"}),e[0]=l):l=e[0];let n;e[1]!==i||e[2]!==s?(n=a=>{i(ze(s,{comment:a}))},e[1]=i,e[2]=s,e[3]=n):n=e[3];let o;return e[4]!==s.comment||e[5]!==n?(o=r.jsxs("section",{className:"timing",children:[l,r.jsx(pe,{className:"kv-value",content:s.comment,onEditDone:n,placeholder:"empty",selectAllOnClick:!0})]}),e[4]=s.comment,e[5]=n,e[6]=o):o=e[6],o}hl.displayName="Comment";function ml(t){const e=E.c(2),{flow:s}=t;let i;return e[0]!==s?(i=r.jsx("section",{className:"tcp",children:r.jsx(qs,{flow:s,messages_meta:s.messages_meta})}),e[0]=s,e[1]=i):i=e[1],i}ml.displayName="Stream Data";function gl(t){const e=E.c(2),{flow:s}=t;let i;return e[0]!==s?(i=r.jsx("section",{className:"udp",children:r.jsx(qs,{flow:s,messages_meta:s.messages_meta})}),e[0]=s,e[1]=i):i=e[1],i}gl.displayName="Datagrams";const _i={request:rl,response:ll,error:ul,connection:dl,timing:fl,websocket:pl,tcpmessages:ml,udpmessages:gl,dnsrequest:cl,dnsresponse:al,comment:hl};function ws(t){let e;switch(t.type){case"http":e=["request","response","websocket"].filter(s=>t[s]);break;case"tcp":e=["tcpmessages"];break;case"udp":e=["udpmessages"];break;case"dns":e=["request","response"].filter(s=>t[s]).map(s=>"dns"+s);break}return t.error&&e.push("error"),e.push("connection"),e.push("timing"),e.push("comment"),e}function Dd(){const t=E.c(15),e=Z(),s=F(Ld);let i=F(Fd);if(s==null){let y;return t[0]===Symbol.for("react.memo_cache_sentinel")?(y=r.jsx(r.Fragment,{}),t[0]=y):y=t[0],y}const l=ws(s);l.indexOf(i)<0&&(i==="response"&&s.error?i="error":i==="error"&&"response"in s?i="response":i=l[0]);const n=_i[i],o="flow-detail",a="nav-tabs nav-tabs-sm";let d;t[1]!==e?(d=()=>e(Je([])),t[1]=e,t[2]=d):d=t[2];let u;t[3]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("i",{className:"fa fa-times-circle"}),t[3]=u):u=t[3];let h;t[4]!==d?(h=r.jsx("button",{"data-testid":"close-button-id",className:"close-button",onClick:d,children:u}),t[4]=d,t[5]=h):h=t[5];const p=l.map(y=>r.jsx("a",{href:"#",className:De({active:i===y}),onClick:b=>{b.preventDefault(),e(Gt(y))},children:_i[y].displayName},y));let g;t[6]!==h||t[7]!==p?(g=r.jsxs("nav",{className:a,children:[h,p]}),t[6]=h,t[7]=p,t[8]=g):g=t[8];let x;t[9]!==n||t[10]!==s?(x=r.jsx(n,{flow:s}),t[9]=n,t[10]=s,t[11]=x):x=t[11];let j;return t[12]!==g||t[13]!==x?(j=r.jsxs("div",{className:o,children:[g,x]}),t[12]=g,t[13]=x,t[14]=j):j=t[14],j}function Fd(t){return t.ui.flow.tab}function Ld(t){return t.flows.selected[0]}function Pd(t){if(t.ctrlKey||t.metaKey)return()=>{};const e=t.key;return t.preventDefault(),(s,i)=>{const{flows:l}=i(),n=l.selected,o=n[0];switch(e){case"k":case"ArrowUp":s(_t(l,-1));break;case"j":case"ArrowDown":s(_t(l,1));break;case" ":case"PageDown":s(_t(l,10));break;case"PageUp":s(_t(l,-10));break;case"End":s(_t(l,1e10));break;case"Home":s(_t(l,-1e10));break;case"Escape":i().ui.modal.activeModal?s(fr()):s(Je([]));break;case"ArrowLeft":{if(!o)break;const a=ws(o),d=i().ui.flow.tab,u=a[(Math.max(0,a.indexOf(d))-1+a.length)%a.length];s(Gt(u));break}case"Tab":case"ArrowRight":{if(!o)break;const a=ws(o),d=i().ui.flow.tab,u=a[(Math.max(0,a.indexOf(d))+1)%a.length];s(Gt(u));break}case"Delete":case"d":{s(sr(n));break}case"n":{Yt("view.flows.create","get","https://example.com/");break}case"D":{s(nr(n));break}case"a":{s(As(n));break}case"A":{s(er());break}case"r":{s(Is(n));break}case"v":{s(ir(n));break}case"x":{s(tr(n));break}case"X":{s(Tc());break}case"z":{s(rr());break}default:return}}}class Md extends M.Component{static defaultProps={axis:"x"};node=ye.createRef();constructor(e,s){super(e,s),this.state={applied:!1,startPos:0,dragPointer:.1},this.onLostPointerCapture=this.onLostPointerCapture.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this)}onPointerDown(e){this.state.dragPointer===.1&&(e.target.setPointerCapture(e.pointerId),this.setState({startPos:this.props.axis==="x"?e.pageX:e.pageY,dragPointer:e.pointerId}))}onLostPointerCapture(e){if(this.state.dragPointer!==e.pointerId)return;const s=this.node.current,i=s.previousElementSibling,l=s.nextElementSibling;s.style.transform="",i.style.flex=`0 0 ${Math.max(0,(this.props.axis==="x"?i.offsetWidth+e.pageX:i.offsetHeight+e.pageY)-this.state.startPos)}px`,l.style.flex="1 1 auto",this.setState({applied:!0,dragPointer:.1}),this.onResize()}onPointerMove(e){this.state.dragPointer===e.pointerId&&(this.node.current.style.transform=this.props.axis==="x"?`translateX(${e.pageX-this.state.startPos}px)`:`translateY(${e.pageY-this.state.startPos}px)`)}onResize(){window.setTimeout(()=>window.dispatchEvent(new CustomEvent("resize")),1)}reset(e){this.state.applied&&(this.node.current?.previousElementSibling instanceof HTMLElement&&(this.node.current.previousElementSibling.style.flex=""),this.node.current?.nextElementSibling instanceof HTMLElement&&(this.node.current.nextElementSibling.style.flex=""),e||this.setState({applied:!1}),this.onResize())}componentWillUnmount(){this.reset(!0)}render(){return r.jsx("div",{ref:this.node,className:De("splitter",this.props.axis==="x"?"splitter-x":"splitter-y"),children:r.jsx("div",{onLostPointerCapture:this.onLostPointerCapture,onPointerDown:this.onPointerDown,onPointerMove:this.onPointerMove})})}}const Os=t=>{const e=t.current;return e===null||e.scrollTop===0?!1:Math.ceil(e.scrollTop)+e.clientHeight>=e.scrollHeight},xl=t=>{t.current&&!Os(t)&&(t.current.scrollTop=t.current.scrollHeight)};function Ft(t=void 0){if(!t)return{start:0,end:0,paddingTop:0,paddingBottom:0};const{itemCount:e,rowHeight:s,viewportTop:i,viewportHeight:l,itemHeights:n}=t,o=i+l;let a=0,d=0,u=0,h=0;if(n){let p=0;for(let g=0;g<e;g++){const x=n[g]||s;p<=i&&g%2===0&&(u=p,a=g),p<=o?d=g+1:h+=x,p+=x}if(i>0&&p<i+l)return Ft({itemCount:e,rowHeight:s,viewportTop:p-l,viewportHeight:l,itemHeights:n})}else{const p=Math.min(i,Math.max(0,e*s-l));a=Math.max(0,Math.floor(p/s)-1)&-2,d=Math.min(e,a+Math.ceil(l/s)+2),u=a*s,h=(e-d)*s}return{start:a,end:d,paddingTop:u,paddingBottom:h}}const Hs=({flow:t})=>r.jsx("td",{className:De("col-tls",t.client_conn.tls_established?"col-tls-https":"col-tls-http")});Hs.headerName="";const Vs=({flow:t})=>{const e=F(s=>s.flows._listIndex.get(t.id));return r.jsx("td",{className:"col-index",children:e+1})};Vs.headerName="#";const Us=({flow:t})=>r.jsx("td",{className:"col-icon",children:r.jsx("div",{className:De("resource-icon",Ki(t))})});Us.headerName="";const Bs=({flow:t})=>{let e;return t.error&&(t.error.msg==="Connection killed."?e=r.jsx("i",{className:"fa fa-fw fa-times pull-right"}):e=r.jsx("i",{className:"fa fa-fw fa-exclamation pull-right"})),r.jsxs("td",{className:"col-path",children:[t.is_replay==="request"&&r.jsx("i",{className:"fa fa-fw fa-repeat pull-right"}),t.intercepted&&r.jsx("i",{className:"fa fa-fw fa-pause pull-right"}),e,r.jsx("span",{className:"marker pull-right",children:t.marked}),Wi(t)]})};Bs.headerName="Path";const Ks=({flow:t})=>r.jsx("td",{className:"col-method",children:Qi(t)});Ks.headerName="Method";const Ws=({flow:t})=>r.jsx("td",{className:"col-http-version",children:Gi(t)});Ws.headerName="Version";const zs=({flow:t})=>{let e="darkred";return t.type!=="http"&&t.type!="dns"||!t.response?r.jsx("td",{className:"col-status"}):(100<=t.response.status_code&&t.response.status_code<200?e="green":200<=t.response.status_code&&t.response.status_code<300?e="darkgreen":300<=t.response.status_code&&t.response.status_code<400?e="lightblue":(400<=t.response.status_code&&t.response.status_code<500||500<=t.response.status_code&&t.response.status_code<600)&&(e="red"),r.jsx("td",{className:"col-status",style:{color:e},children:zi(t)}))};zs.headerName="Status";const Qs=({flow:t})=>r.jsx("td",{className:"col-size",children:Fi(Ui(t))});Qs.headerName="Size";const Gs=({flow:t})=>{const e=Jt(t),s=Vi(t);return r.jsx("td",{className:"col-time",children:e&&s?Li(1e3*(s-e)):"..."})};Gs.headerName="Time";const Ys=({flow:t})=>{const e=Jt(t);return r.jsx("td",{className:"col-timestamp",children:e?mt(e):"..."})};Ys.headerName="Start time";const ns=({flow:t})=>{const e=Z();let s=null;return t.intercepted?s=r.jsx("a",{href:"#",className:"quickaction",onClick:()=>e(As([t])),children:r.jsx("i",{className:"fa fa-fw fa-play text-success"})}):Es(t)&&(s=r.jsx("a",{href:"#",className:"quickaction",onClick:()=>e(Is([t])),children:r.jsx("i",{className:"fa fa-fw fa-repeat text-primary"})})),r.jsx("td",{className:"col-quickactions",children:s?r.jsx("div",{children:s}):r.jsx(r.Fragment,{})})};ns.headerName="";const Js=({flow:t})=>{const e=t.comment;return r.jsx("td",{className:"col-comment",children:e})};Js.headerName="Comment";const vl={icon:Us,index:Vs,method:Ks,version:Ws,path:Bs,quickactions:ns,size:Qs,status:zs,time:Gs,timestamp:Ys,tls:Hs,comment:Js},qd=Object.freeze(Object.defineProperty({__proto__:null,comment:Js,default:vl,icon:Us,index:Vs,method:Ks,path:Bs,quickactions:ns,size:Qs,status:zs,time:Gs,timestamp:Ys,tls:Hs,version:Ws},Symbol.toStringTag,{value:"Module"})),Od=M.memo(function(){const e=E.c(13),s=Z(),i=F(Hd),l=F(Vd),n=F(Ud),o=i?"sort-desc":"sort-asc";let a;if(e[0]!==s||e[1]!==n||e[2]!==l||e[3]!==i||e[4]!==o){const u=n.filter(wc).concat("quickactions");let h;e[6]!==s||e[7]!==l||e[8]!==i||e[9]!==o?(h=p=>r.jsx("th",{className:De(`col-${p}`,l===p&&o),onClick:()=>s(dr({column:p===l&&i?void 0:p,desc:p!==l?!1:!i})),children:vl[p].headerName},p),e[6]=s,e[7]=l,e[8]=i,e[9]=o,e[10]=h):h=e[10],a=u.map(h),e[0]=s,e[1]=n,e[2]=l,e[3]=i,e[4]=o,e[5]=a}else a=e[5];let d;return e[11]!==a?(d=r.jsx("tr",{children:a}),e[11]=a,e[12]=d):d=e[12],d});function Hd(t){return t.flows.sort.desc}function Vd(t){return t.flows.sort.column}function Ud(t){return t.options.web_columns}const Bd=ye.memo(function({flow:e,selected:s,highlighted:i}){const l=Z(),n=F(u=>u.options.web_columns),o=De({selected:s,highlighted:i,intercepted:e.intercepted,"has-request":e.type==="http"&&e.request,"has-response":e.type==="http"&&e.response}),a=M.useCallback(u=>{let h=u.target;for(;h.parentNode;){if(h.classList.contains("col-quickactions"))return;h=h.parentNode}u.metaKey||u.ctrlKey?l(Fc(e)):u.shiftKey?(window.getSelection()?.empty(),l(Lc(e))):l(Je([e]))},[e]),d=n.map(u=>qd[u]).filter(u=>u).concat(ns);return r.jsx("tr",{className:o,onClick:a,children:d.map(u=>r.jsx(u,{flow:e},u.name))})});class Kd extends M.Component{static defaultProps={rowHeight:32};viewport=M.createRef();head=M.createRef();constructor(e,s){super(e,s),this.state={vScroll:Ft(),viewportTop:0},this.onViewportUpdate=this.onViewportUpdate.bind(this)}componentDidMount(){window.addEventListener("resize",this.onViewportUpdate),this.onViewportUpdate()}componentWillUnmount(){window.removeEventListener("resize",this.onViewportUpdate)}getSnapshotBeforeUpdate(){return Os(this.viewport)}componentDidUpdate(e,s,i){i&&xl(this.viewport),this.onViewportUpdate();const{onlySelectedId:l}=this.props;if(l&&l!==e.onlySelectedId){const{rowHeight:o,firstSelectedIndex:a}=this.props,d=this.viewport.current,u=this.head.current,h=u?u.offsetHeight:0,p=a*o+h,g=p+o,x=d.scrollTop,j=d.offsetHeight;p-h<x?d.scrollTop=p-h:g>x+j&&(d.scrollTop=g-j),this.onViewportUpdate()}}onViewportUpdate(){const e=this.viewport.current,s=e.scrollTop||0,i=Ft({viewportTop:s,viewportHeight:e.offsetHeight||0,itemCount:this.props.flowView.length,rowHeight:this.props.rowHeight});if(this.state.viewportTop!==s||!Zt(this.state.vScroll,i)){const l=Math.min(s,i.end*this.props.rowHeight);this.setState({vScroll:i,viewportTop:l})}}render(){const{vScroll:e,viewportTop:s}=this.state,{flowView:i,selectedIds:l,highlightedIds:n}=this.props;return r.jsx("div",{className:"flow-table",onScroll:this.onViewportUpdate,ref:this.viewport,children:r.jsxs("table",{children:[r.jsx("thead",{ref:this.head,style:{transform:`translateY(${s}px)`},children:r.jsx(Od,{})}),r.jsxs("tbody",{children:[r.jsx("tr",{style:{height:e.paddingTop}}),i.slice(e.start,e.end).map(o=>r.jsx(Bd,{flow:o,selected:l.has(o.id),highlighted:n.has(o.id)},o.id)),r.jsx("tr",{style:{height:e.paddingBottom}})]})]})})}}const Wd=bt(t=>({flowView:t.flows.view,highlightedIds:t.flows.highlightedIds,selectedIds:t.flows.selectedIds,onlySelectedId:t.flows.selected.length===1&&t.flows.selected[0].id,firstSelectedIndex:t.flows._viewIndex.get(t.flows.selected[0]?.id)}))(Kd);function zd(){const t=E.c(3);let e,s;t[0]===Symbol.for("react.memo_cache_sentinel")?(e={padding:"1em 2em"},s=r.jsx("h3",{children:"mitmproxy is running."}),t[0]=e,t[1]=s):(e=t[0],s=t[1]);let i;return t[2]===Symbol.for("react.memo_cache_sentinel")?(i=r.jsxs("div",{style:e,children:[s,r.jsxs("p",{children:["No flows have been recorded yet.",r.jsx("br",{}),"To start capturing traffic, please configure your settings in the Capture tab."]})]}),t[2]=i):i=t[2],i}function Qd(t){const e=E.c(20);let{description:s,listen_addrs:i,is_running:l,wireguard_conf:n,type:o}=t;const a=M.useRef(null);let d,u;e[0]!==n?(d=()=>{n&&a.current&&oc.toCanvas(a.current,n,{margin:0,scale:3})},u=[n],e[0]=n,e[1]=d,e[2]=u):(d=e[1],u=e[2]),M.useEffect(d,u);let h;const p=i.length===1||i.length===2&&i[0][1]===i[1][1],g=i.every(Gd);if(p&&g){let y;e[3]!==i[0][1]?(y=si(["*",i[0][1]]),e[3]=i[0][1],e[4]=y):y=e[4],h=y}else{let y;e[5]!==i?(y=i.map(si).join(" and "),e[5]=i,e[6]=y):y=e[6],h=y}s=s[0].toUpperCase()+s.substr(1);let x;if(l){let y;e[9]!==s||e[10]!==h||e[11]!==o?(y=o==="local"?r.jsxs("div",{className:"text-success",children:[s," is active."]}):r.jsxs("div",{className:"text-success",children:[s," listening at ",h,"."]}),e[9]=s,e[10]=h,e[11]=o,e[12]=y):y=e[12];let b;e[13]!==n?(b=n&&r.jsxs("div",{className:"wireguard-config",children:[r.jsx("pre",{children:n}),r.jsx("canvas",{ref:a})]}),e[13]=n,e[14]=b):b=e[14];let $;e[15]!==y||e[16]!==b?($=r.jsxs(r.Fragment,{children:[y,b]}),e[15]=y,e[16]=b,e[17]=$):$=e[17],x=$}else{let y;e[7]!==s?(y=r.jsx(r.Fragment,{children:r.jsxs("div",{className:"text-warning",children:[s," starting..."]})}),e[7]=s,e[8]=y):y=e[8],x=y}let j;return e[18]!==x?(j=r.jsx("div",{children:x}),e[18]=x,e[19]=j):j=e[19],j}function Gd(t){return["::","0.0.0.0"].includes(t[0])}function ot(t){const e=E.c(5),{error:s,backendState:i}=t;let l;e[0]!==i||e[1]!==s?(l=s?r.jsx("div",{className:"text-danger",children:s}):i&&r.jsx(Qd,{...i}),e[0]=i,e[1]=s,e[2]=l):l=e[2];let n;return e[3]!==l?(n=r.jsx("div",{className:"mode-status",children:l}),e[3]=l,e[4]=n):n=e[4],n}function ct(t){const e=E.c(13),{value:s,onChange:i,children:l,label:n}=t,o=M.useId(),a=`mode-checkbox-${o}`,d=`mode-checkbox-${o}`;let u;e[0]!==i||e[1]!==a||e[2]!==d||e[3]!==s?(u=r.jsx("input",{type:"checkbox",name:a,id:d,checked:s,onChange:i}),e[0]=i,e[1]=a,e[2]=d,e[3]=s,e[4]=u):u=e[4];const h=`mode-checkbox-${o}`;let p;e[5]===Symbol.for("react.memo_cache_sentinel")?(p={marginBottom:0,fontWeight:"normal"},e[5]=p):p=e[5];let g;e[6]!==n||e[7]!==h?(g=r.jsx("label",{htmlFor:h,style:p,children:n}),e[6]=n,e[7]=h,e[8]=g):g=e[8];let x;return e[9]!==l||e[10]!==u||e[11]!==g?(x=r.jsxs("div",{className:"mode-entry",children:[u,g,l]}),e[9]=l,e[10]=u,e[11]=g,e[12]=x):x=e[12],x}function at(t){const e=E.c(22),{children:s,iconClass:i,classname:l,isVisible:n}=t,o=M.useId();let a;e[0]!==o?(a=[...o].map(Yd),e[0]=o,e[1]=a):a=e[1];const d="--"+a.join(""),u=M.useRef(null),h=M.useRef(null);let p;e[2]!==d?(p=()=>{u.current.style.anchorName=d,h.current.style.positionAnchor=d},e[2]=d,e[3]=p):p=e[3];let g;e[4]===Symbol.for("react.memo_cache_sentinel")?(g=[],e[4]=g):g=e[4],M.useEffect(p,g);let x;e[5]!==o||e[6]!==n?(x=()=>{n===!0&&document.getElementById(o)?.showPopover()},e[5]=o,e[6]=n,e[7]=x):x=e[7];let j;e[8]!==n?(j=[n],e[8]=n,e[9]=j):j=e[9],M.useEffect(x,j);const y=l?`mode-popover ${l}`:"mode-popover";let b;e[10]!==i?(b=r.jsx("i",{className:i,"aria-hidden":"true"}),e[10]=i,e[11]=b):b=e[11];let $;e[12]!==o||e[13]!==b?($=r.jsx("button",{popoverTarget:o,ref:u,children:b}),e[12]=o,e[13]=b,e[14]=$):$=e[14];let N;e[15]!==s||e[16]!==o?(N=r.jsx("div",{id:o,popover:"auto",ref:h,children:s}),e[15]=s,e[16]=o,e[17]=N):N=e[17];let k;return e[18]!==y||e[19]!==$||e[20]!==N?(k=r.jsxs("div",{className:y,children:[$,N]}),e[18]=y,e[19]=$,e[20]=N,e[21]=k):k=e[21],k}function Yd(t){return t.charCodeAt(0).toString(16)}function Jd(t){const e=E.c(44),{server:s}=t,{currentProcesses:i,isLoading:l}=F(eu),{selectedProcesses:n}=F(Zd);let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=[],e[0]=o):o=e[0];const[a,d]=M.useState(o),[u,h]=M.useState(""),p=Z(),{platform:g}=F(Xd);let x;e[1]===Symbol.for("react.memo_cache_sentinel")?(x=z=>{h(z.target.value)},e[1]=x):x=e[1];const j=x;let y;e[2]!==g?(y=z=>{const ie=g.startsWith("win32")?"\\":"/";return js(z.executable,ie)[1]},e[2]=g,e[3]=y):y=e[3];const b=y;let $;e[4]!==p||e[5]!==b||e[6]!==n||e[7]!==s?($=z=>{const ie=typeof z=="string"?z:b(z),V=n?`${n}, ${ie}`:ie;p(Rt({server:s,value:V}))},e[4]=p,e[5]=b,e[6]=n,e[7]=s,e[8]=$):$=e[8];const N=$;let k;e[9]!==p||e[10]!==b||e[11]!==n||e[12]!==s?(k=z=>{const ie=n?.split(/,\s*/).filter(V=>V!==b(z)).join(", ");p(Rt({server:s,value:ie}))},e[9]=p,e[10]=b,e[11]=n,e[12]=s,e[13]=k):k=e[13];const T=k,D=z=>{I(z)&&n?T(z):N(z)},I=z=>{const ie=b(z);return n?.includes(ie)};let O;e[14]!==i||e[15]!==p?(O=()=>{i.length===0&&p(At())},e[14]=i,e[15]=p,e[16]=O):O=e[16];let q;e[17]===Symbol.for("react.memo_cache_sentinel")?(q=[],e[17]=q):q=e[17],M.useEffect(O,q);let U;e[18]!==i||e[19]!==u||e[20]!==b||e[21]!==a?(U=()=>{if(u){const z=i.filter(ie=>b(ie).toLowerCase().includes(u.toLowerCase()));d(z)}else a!==i&&d(i)},e[18]=i,e[19]=u,e[20]=b,e[21]=a,e[22]=U):U=e[22];let H;e[23]!==i||e[24]!==u?(H=[u,i],e[23]=i,e[24]=u,e[25]=H):H=e[25],M.useEffect(U,H);let W;e[26]!==N||e[27]!==u?(W=z=>{z.stopPropagation(),z.key==="Enter"&&(N(u),h(""))},e[26]=N,e[27]=u,e[28]=W):W=e[28];const Q=W,[K,G]=M.useState(!1),Y="local-dropdown",ee="dropdown-header",te=n&&n?.length>0?"Add more":"all applications";let se,ue;e[29]===Symbol.for("react.memo_cache_sentinel")?(se=()=>G(!0),ue=()=>G(!1),e[29]=se,e[30]=ue):(se=e[29],ue=e[30]);let fe;e[31]!==u||e[32]!==Q||e[33]!==te?(fe=r.jsx("input",{type:"text",className:"autocomplete-input",placeholder:te,value:u,onChange:j,onKeyDown:Q,onClick:se,onBlur:ue}),e[31]=u,e[32]=Q,e[33]=te,e[34]=fe):fe=e[34];const ve=at,ke="fa fa-chevron-down",Re="local-popover";let ge;e[35]===Symbol.for("react.memo_cache_sentinel")?(ge=r.jsx("h4",{children:"Current Applications running on machine"}),e[35]=ge):ge=e[35];const we=l?r.jsx("i",{className:"fa fa-spinner","aria-hidden":"true"}):a.length>0?r.jsxs("ul",{className:"dropdown-list",children:[r.jsxs("li",{className:`dropdown-item ${n===""?"selected":""}`,onClick:()=>{p(Rt({server:s,value:""}))},role:"menuitem",children:[r.jsxs("div",{className:"process-details",children:[r.jsx("div",{className:"process-icon"}),r.jsx("span",{className:"process-name",children:"All applications"})]}),n===""&&r.jsx("i",{className:"fa fa-check","aria-hidden":"true"})]}),r.jsx("hr",{className:"process-separator"}),a.map((z,ie)=>r.jsxs("li",{className:`dropdown-item ${I(z)?"selected":""}`,onClick:()=>D(z),role:"menuitem",children:[r.jsxs("div",{className:"process-details",children:[r.jsx("img",{className:"process-icon",src:`./executable-icon?path=${z.executable}`,loading:"lazy"}),r.jsx("span",{className:"process-name",children:b(z)})]}),I(z)&&r.jsx("i",{className:"fa fa-check","aria-hidden":"true"})]},ie))]}):r.jsxs("span",{children:["Press ",r.jsx("strong",{children:"Enter"})," to capture traffic for programs matching: ",r.jsx("strong",{children:u})]});let C;e[36]!==ve||e[37]!==K||e[38]!==ge||e[39]!==we?(C=r.jsxs(ve,{iconClass:ke,classname:Re,isVisible:K,children:[ge,we]}),e[36]=ve,e[37]=K,e[38]=ge,e[39]=we,e[40]=C):C=e[40];let ae;return e[41]!==fe||e[42]!==C?(ae=r.jsx("div",{className:Y,children:r.jsxs("div",{className:ee,children:[fe,C]})}),e[41]=fe,e[42]=C,e[43]=ae):ae=e[43],ae}function Xd(t){return t.backendState}function Zd(t){return t.modes.local[0]}function eu(t){return t.processes}function tu(){const t=E.c(9),e=F(nu),s=F(su);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(iu,{server:u,backendState:s[jr(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n,o;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"Local Applications"}),o=r.jsx("p",{className:"mode-description",children:"Transparently Intercept local application(s)."}),t[5]=n,t[6]=o):(n=t[5],o=t[6]);let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function su(t){return t.backendState.servers}function nu(t){return t.modes.local}function iu(t){const e=E.c(31),{server:s,backendState:i}=t,l=Z(),n=F(lu),o=s.error||i?.last_exception||n||void 0;let a;e[0]!==l||e[1]!==s?(a=k=>{const T=s.selectedProcesses?.split(/,\s*/).filter(D=>D!==k).join(", ");l(Rt({server:s,value:T}))},e[0]=l,e[1]=s,e[2]=a):a=e[2];const d=a;let u;e[3]!==l||e[4]!==s?(u=()=>l(Er({server:s,value:!s.active})),e[3]=l,e[4]=s,e[5]=u):u=e[5];let h;e[6]!==d||e[7]!==s.selectedProcesses?(h=s.selectedProcesses?.split(/,\s*/).filter(ru).map(k=>r.jsxs("div",{className:"selected-process",children:[k,r.jsx("i",{className:"fa fa-times","aria-hidden":"true",onClick:()=>d(k)})]},k)),e[6]=d,e[7]=s.selectedProcesses,e[8]=h):h=e[8];let p;e[9]!==h?(p=r.jsx("div",{className:"selected-processes",children:h}),e[9]=h,e[10]=p):p=e[10];let g;e[11]!==s?(g=r.jsx(Jd,{server:s}),e[11]=s,e[12]=g):g=e[12];let x;e[13]!==l?(x=r.jsx("i",{className:"fa fa-refresh","aria-hidden":"true",onClick:()=>l(At())}),e[13]=l,e[14]=x):x=e[14];let j;e[15]!==g||e[16]!==x?(j=r.jsxs("div",{className:"dropdown-container",children:[g,x]}),e[15]=g,e[16]=x,e[17]=j):j=e[17];let y;e[18]!==p||e[19]!==j?(y=r.jsxs("div",{className:"processes-container",children:[p,j]}),e[18]=p,e[19]=j,e[20]=y):y=e[20];let b;e[21]!==s.active||e[22]!==u||e[23]!==y?(b=r.jsx(ct,{value:s.active,label:"Intercept traffic for",onChange:u,children:y}),e[21]=s.active,e[22]=u,e[23]=y,e[24]=b):b=e[24];let $;e[25]!==i||e[26]!==o?($=r.jsx(ot,{error:o,backendState:i}),e[25]=i,e[26]=o,e[27]=$):$=e[27];let N;return e[28]!==$||e[29]!==b?(N=r.jsxs("div",{className:"mode-local",children:[b,$]}),e[28]=$,e[29]=b,e[30]=N):N=e[30],N}function ru(t){return t.trim()!==""}function lu(t){return t.processes.error}function ou(){const t=E.c(9),e=F(au),s=F(cu);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(du,{server:u,backendState:s[_r(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n,o;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"Explicit HTTP(S) Proxy"}),o=r.jsx("p",{className:"mode-description",children:"You manually configure your client application or device to use an HTTP(S) proxy."}),t[5]=n,t[6]=o):(n=t[5],o=t[6]);let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function cu(t){return t.backendState.servers}function au(t){return t.modes.regular}function du(t){const e=E.c(33),{server:s,backendState:i}=t,l=Z(),n=s.error||i?.last_exception||void 0;let o;e[0]!==l||e[1]!==s?(o=()=>l(Cr({server:s,value:!s.active})),e[0]=l,e[1]=s,e[2]=o):o=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("h4",{children:"Advanced Configuration"}),d=r.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const u=s.listen_host||"";let h;e[5]!==l||e[6]!==s?(h=T=>l(Nr({server:s,value:T})),e[5]=l,e[6]=s,e[7]=h):h=e[7];let p;e[8]!==u||e[9]!==h?(p=r.jsx(pe,{className:"mode-input",content:u,onEditDone:h}),e[8]=u,e[9]=h,e[10]=p):p=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==l||e[15]!==s?(j=T=>l(kr({server:s,value:parseInt(T)})),e[14]=l,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=r.jsx(pe,{className:"mode-input",content:x,placeholder:"8080",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]!==y||e[21]!==p?(b=r.jsxs(at,{iconClass:"fa fa-cog",children:[a,d,p,g,y]}),e[20]=y,e[21]=p,e[22]=b):b=e[22];let $;e[23]!==s.active||e[24]!==o||e[25]!==b?($=r.jsx(ct,{value:s.active,label:"Run HTTP/S Proxy",onChange:o,children:b}),e[23]=s.active,e[24]=o,e[25]=b,e[26]=$):$=e[26];let N;e[27]!==i||e[28]!==n?(N=r.jsx(ot,{error:n,backendState:i}),e[27]=i,e[28]=n,e[29]=N):N=e[29];let k;return e[30]!==$||e[31]!==N?(k=r.jsxs("div",{children:[$,N]}),e[30]=$,e[31]=N,e[32]=k):k=e[32],k}function uu(){const t=E.c(9),e=F(pu),s=F(fu);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(hu,{server:u,backendState:s[yr(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n,o;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"WireGuard Server"}),o=r.jsx("p",{className:"mode-description",children:"Start a WireGuard™ server and connect an external device for transparent proxying."}),t[5]=n,t[6]=o):(n=t[5],o=t[6]);let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function fu(t){return t.backendState.servers}function pu(t){return t.modes.wireguard}function hu(t){const e=E.c(41),{server:s,backendState:i}=t,l=Z(),n=s.error||i?.last_exception||void 0;let o;e[0]!==l||e[1]!==s?(o=()=>l(Tr({server:s,value:!s.active})),e[0]=l,e[1]=s,e[2]=o):o=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("h4",{children:"Advanced Configuration"}),d=r.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const u=s.listen_host||"";let h;e[5]!==l||e[6]!==s?(h=q=>l(Rr({server:s,value:q})),e[5]=l,e[6]=s,e[7]=h):h=e[7];let p;e[8]!==u||e[9]!==h?(p=r.jsx(pe,{className:"mode-input",content:u,placeholder:"(all interfaces)",onEditDone:h}),e[8]=u,e[9]=h,e[10]=p):p=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==l||e[15]!==s?(j=q=>l(Ar({server:s,value:parseInt(q)})),e[14]=l,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=r.jsx(pe,{className:"mode-input",content:x,placeholder:"51820",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]===Symbol.for("react.memo_cache_sentinel")?(b=r.jsx("p",{children:"Configuration File"}),e[20]=b):b=e[20];const $=s.file_path||"";let N;e[21]!==l||e[22]!==s?(N=q=>l(Ir({server:s,value:q})),e[21]=l,e[22]=s,e[23]=N):N=e[23];let k;e[24]!==$||e[25]!==N?(k=r.jsx(pe,{className:"mode-input",content:$,placeholder:"~/.mitmproxy/wireguard.conf",onEditDone:N}),e[24]=$,e[25]=N,e[26]=k):k=e[26];let T;e[27]!==y||e[28]!==k||e[29]!==p?(T=r.jsxs(at,{iconClass:"fa fa-cog",children:[a,d,p,g,y,b,k]}),e[27]=y,e[28]=k,e[29]=p,e[30]=T):T=e[30];let D;e[31]!==s.active||e[32]!==o||e[33]!==T?(D=r.jsx(ct,{value:s.active,label:"Run WireGuard Server",onChange:o,children:T}),e[31]=s.active,e[32]=o,e[33]=T,e[34]=D):D=e[34];let I;e[35]!==i||e[36]!==n?(I=r.jsx(ot,{error:n,backendState:i}),e[35]=i,e[36]=n,e[37]=I):I=e[37];let O;return e[38]!==D||e[39]!==I?(O=r.jsxs("div",{children:[D,I]}),e[38]=D,e[39]=I,e[40]=O):O=e[40],O}function mu(){const t=E.c(15),e=Z(),s=F(xu),i=F(gu);let l,n;t[0]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("h4",{className:"mode-title",children:"Reverse Proxy"}),n=r.jsx("p",{className:"mode-description",children:"Requests are forwarded to a preconfigured destination."}),t[0]=l,t[1]=n):(l=t[0],n=t[1]);let o;if(t[2]!==i||t[3]!==s){let p;t[5]!==i?(p=(g,x)=>r.jsx(vu,{removable:x>0,server:g,backendState:i[Ms(g)]},g.ui_id),t[5]=i,t[6]=p):p=t[6],o=s.map(p),t[2]=i,t[3]=s,t[4]=o}else o=t[4];let a;t[7]!==e?(a=()=>e(Da()),t[7]=e,t[8]=a):a=t[8];let d;t[9]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx("i",{className:"fa fa-plus-square-o","aria-hidden":"true"}),t[9]=d):d=t[9];let u;t[10]!==a?(u=r.jsxs("div",{className:"mode-reverse-add-server",onClick:a,children:[d,"Add additional server"]}),t[10]=a,t[11]=u):u=t[11];let h;return t[12]!==o||t[13]!==u?(h=r.jsxs("div",{children:[l,n,r.jsxs("div",{className:"mode-reverse-servers",children:[o,u]})]}),t[12]=o,t[13]=u,t[14]=h):h=t[14],h}function gu(t){return t.backendState.servers}function xu(t){return t.modes.reverse}function vu(t){const e=E.c(56),{removable:s,server:i,backendState:l}=t,n=Z();let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=Object.values(ss),e[0]=o):o=e[0];const a=o;let d;e[1]!==n||e[2]!==i?(d=async()=>{i.active&&await n(bs({server:i,value:!1})).unwrap(),await n(Fa(i))},e[1]=n,e[2]=i,e[3]=d):d=e[3];const u=d,h=i.error||l?.last_exception||void 0,p=i.active;let g;e[4]!==n||e[5]!==i?(g=()=>{n(bs({server:i,value:!i.active}))},e[4]=n,e[5]=i,e[6]=g):g=e[6];const x=i.protocol;let j;e[7]!==n||e[8]!==i?(j=se=>{n(Lr({server:i,value:se.target.value}))},e[7]=n,e[8]=i,e[9]=j):j=e[9];let y;e[10]===Symbol.for("react.memo_cache_sentinel")?(y=a.map(_u),e[10]=y):y=e[10];let b;e[11]!==i.protocol||e[12]!==j?(b=r.jsx("select",{name:"protocols",className:"mode-reverse-dropdown",value:x,onChange:j,children:y}),e[11]=i.protocol,e[12]=j,e[13]=b):b=e[13];let $;e[14]!==i.destination?($=i.destination?.toString()||"",e[14]=i.destination,e[15]=$):$=e[15];let N;e[16]!==n||e[17]!==i?(N=se=>n(Pr({server:i,value:se})),e[16]=n,e[17]=i,e[18]=N):N=e[18];let k;e[19]!==N||e[20]!==$?(k=r.jsx(pe,{className:"mode-reverse-input",content:$,onEditDone:N,placeholder:"example.com"}),e[19]=N,e[20]=$,e[21]=k):k=e[21];let T,D;e[22]===Symbol.for("react.memo_cache_sentinel")?(T=r.jsx("h4",{children:"Advanced Configuration"}),D=r.jsx("p",{children:"Listen Host"}),e[22]=T,e[23]=D):(T=e[22],D=e[23]);const I=i.listen_host||"";let O;e[24]!==n||e[25]!==i?(O=se=>n(Dr({server:i,value:se})),e[24]=n,e[25]=i,e[26]=O):O=e[26];let q;e[27]!==I||e[28]!==O?(q=r.jsx(pe,{className:"mode-input",content:I,onEditDone:O,placeholder:"*"}),e[27]=I,e[28]=O,e[29]=q):q=e[29];let U;e[30]===Symbol.for("react.memo_cache_sentinel")?(U=r.jsx("p",{children:"Listen Port"}),e[30]=U):U=e[30];const H=String(i.listen_port||"");let W;e[31]!==n||e[32]!==i?(W=se=>n(Fr({server:i,value:se})),e[31]=n,e[32]=i,e[33]=W):W=e[33];let Q;e[34]!==H||e[35]!==W?(Q=r.jsx(pe,{className:"mode-input",content:H,onEditDone:W,placeholder:"8080"}),e[34]=H,e[35]=W,e[36]=Q):Q=e[36];let K;e[37]!==q||e[38]!==Q?(K=r.jsxs(at,{iconClass:"fa fa-cog",children:[T,D,q,U,Q]}),e[37]=q,e[38]=Q,e[39]=K):K=e[39];let G;e[40]!==u||e[41]!==s?(G=s&&r.jsx("i",{className:"fa fa-fw fa-trash fa-lg","aria-hidden":"true",onClick:u}),e[40]=u,e[41]=s,e[42]=G):G=e[42];let Y;e[43]!==i.active||e[44]!==k||e[45]!==K||e[46]!==G||e[47]!==g||e[48]!==b?(Y=r.jsxs(ct,{value:p,label:"Forward",onChange:g,children:[b,"traffic to",k,K,G]}),e[43]=i.active,e[44]=k,e[45]=K,e[46]=G,e[47]=g,e[48]=b,e[49]=Y):Y=e[49];let ee;e[50]!==l||e[51]!==h?(ee=r.jsx(ot,{error:h,backendState:l}),e[50]=l,e[51]=h,e[52]=ee):ee=e[52];let te;return e[53]!==Y||e[54]!==ee?(te=r.jsxs("div",{children:[Y,ee]}),e[53]=Y,e[54]=ee,e[55]=te):te=e[55],te}function _u(t){return r.jsx("option",{value:t,children:t},t)}function ju(){const t=E.c(9),e=F(bu),s=F(yu);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(Su,{server:u,backendState:s[br(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"Transparent Proxy"}),t[5]=n):n=t[5];let o;t[6]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsxs("p",{className:"mode-description",children:["You"," ",r.jsx("a",{href:"https://docs.mitmproxy.org/stable/howto-transparent/",style:{textDecoration:"underline",color:"inherit"},children:"configure your routing table"})," ","to send traffic through mitmproxy."]}),t[6]=o):o=t[6];let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function yu(t){return t.backendState.servers}function bu(t){return t.modes.transparent}function Su(t){const e=E.c(33),{server:s,backendState:i}=t,l=Z(),n=s.error||i?.last_exception||void 0;let o;e[0]!==l||e[1]!==s?(o=()=>l(qr({server:s,value:!s.active})),e[0]=l,e[1]=s,e[2]=o):o=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("h4",{children:"Advanced Configuration"}),d=r.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const u=s.listen_host||"";let h;e[5]!==l||e[6]!==s?(h=T=>l(Or({server:s,value:T})),e[5]=l,e[6]=s,e[7]=h):h=e[7];let p;e[8]!==u||e[9]!==h?(p=r.jsx(pe,{className:"mode-input",content:u,onEditDone:h}),e[8]=u,e[9]=h,e[10]=p):p=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==l||e[15]!==s?(j=T=>l(Hr({server:s,value:parseInt(T)})),e[14]=l,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=r.jsx(pe,{className:"mode-input",content:x,placeholder:"8080",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]!==y||e[21]!==p?(b=r.jsxs(at,{iconClass:"fa fa-cog",children:[a,d,p,g,y]}),e[20]=y,e[21]=p,e[22]=b):b=e[22];let $;e[23]!==s.active||e[24]!==o||e[25]!==b?($=r.jsx(ct,{value:s.active,label:"Run Transparent Proxy",onChange:o,children:b}),e[23]=s.active,e[24]=o,e[25]=b,e[26]=$):$=e[26];let N;e[27]!==i||e[28]!==n?(N=r.jsx(ot,{error:n,backendState:i}),e[27]=i,e[28]=n,e[29]=N):N=e[29];let k;return e[30]!==$||e[31]!==N?(k=r.jsxs("div",{children:[$,N]}),e[30]=$,e[31]=N,e[32]=k):k=e[32],k}function wu(){const t=E.c(9),e=F(Cu),s=F($u);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(Nu,{server:u,backendState:s[Sr(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n,o;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"SOCKS Proxy"}),o=r.jsx("p",{className:"mode-description",children:"You manually configure your client application or device to use a SOCKS5 proxy."}),t[5]=n,t[6]=o):(n=t[5],o=t[6]);let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function $u(t){return t.backendState.servers}function Cu(t){return t.modes.socks}function Nu(t){const e=E.c(33),{server:s,backendState:i}=t,l=Z(),n=s.error||i?.last_exception||void 0;let o;e[0]!==l||e[1]!==s?(o=()=>l(Vr({server:s,value:!s.active})),e[0]=l,e[1]=s,e[2]=o):o=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("h4",{children:"Advanced Configuration"}),d=r.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const u=s.listen_host||"";let h;e[5]!==l||e[6]!==s?(h=T=>l(Ur({server:s,value:T})),e[5]=l,e[6]=s,e[7]=h):h=e[7];let p;e[8]!==u||e[9]!==h?(p=r.jsx(pe,{className:"mode-input",content:u,onEditDone:h}),e[8]=u,e[9]=h,e[10]=p):p=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==l||e[15]!==s?(j=T=>l(Br({server:s,value:parseInt(T)})),e[14]=l,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=r.jsx(pe,{className:"mode-input",content:x,placeholder:"8080",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]!==y||e[21]!==p?(b=r.jsxs(at,{iconClass:"fa fa-cog",children:[a,d,p,g,y]}),e[20]=y,e[21]=p,e[22]=b):b=e[22];let $;e[23]!==s.active||e[24]!==o||e[25]!==b?($=r.jsx(ct,{value:s.active,label:"Run SOCKS Proxy",onChange:o,children:b}),e[23]=s.active,e[24]=o,e[25]=b,e[26]=$):$=e[26];let N;e[27]!==i||e[28]!==n?(N=r.jsx(ot,{error:n,backendState:i}),e[27]=i,e[28]=n,e[29]=N):N=e[29];let k;return e[30]!==$||e[31]!==N?(k=r.jsxs("div",{children:[$,N]}),e[30]=$,e[31]=N,e[32]=k):k=e[32],k}function ku(){const t=E.c(9),e=F(Tu),s=F(Eu);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(Ru,{server:u,backendState:s[wr(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n,o;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"Explicit HTTP(S) Proxy (With Upstream Proxy)"}),o=r.jsx("p",{className:"mode-description",children:"All requests are forwarded to a second HTTP(S) proxy server."}),t[5]=n,t[6]=o):(n=t[5],o=t[6]);let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function Eu(t){return t.backendState.servers}function Tu(t){return t.modes.upstream}function Ru(t){const e=E.c(42),{server:s,backendState:i}=t,l=Z(),n=s.error||i?.last_exception||void 0;let o;e[0]!==l||e[1]!==s?(o=()=>{l(Kr({server:s,value:!s.active}))},e[0]=l,e[1]=s,e[2]=o):o=e[2];let a;e[3]!==s.destination?(a=s.destination?.toString()||"",e[3]=s.destination,e[4]=a):a=e[4];let d;e[5]!==l||e[6]!==s?(d=O=>l(Qr({server:s,value:O})),e[5]=l,e[6]=s,e[7]=d):d=e[7];let u;e[8]!==a||e[9]!==d?(u=r.jsx(pe,{className:"mode-upstream-input",content:a,onEditDone:d,placeholder:"http://example.com:8080"}),e[8]=a,e[9]=d,e[10]=u):u=e[10];let h,p;e[11]===Symbol.for("react.memo_cache_sentinel")?(h=r.jsx("h4",{children:"Advanced Configuration"}),p=r.jsx("p",{children:"Listen Host"}),e[11]=h,e[12]=p):(h=e[11],p=e[12]);const g=s.listen_host||"";let x;e[13]!==l||e[14]!==s?(x=O=>l(Wr({server:s,value:O})),e[13]=l,e[14]=s,e[15]=x):x=e[15];let j;e[16]!==g||e[17]!==x?(j=r.jsx(pe,{className:"mode-input",content:g,onEditDone:x}),e[16]=g,e[17]=x,e[18]=j):j=e[18];let y;e[19]===Symbol.for("react.memo_cache_sentinel")?(y=r.jsx("p",{children:"Listen Port"}),e[19]=y):y=e[19];let b;e[20]!==s.listen_port?(b=s.listen_port?s.listen_port.toString():"",e[20]=s.listen_port,e[21]=b):b=e[21];let $;e[22]!==l||e[23]!==s?($=O=>l(zr({server:s,value:parseInt(O)})),e[22]=l,e[23]=s,e[24]=$):$=e[24];let N;e[25]!==b||e[26]!==$?(N=r.jsx(pe,{className:"mode-input",content:b,placeholder:"8080",onEditDone:$}),e[25]=b,e[26]=$,e[27]=N):N=e[27];let k;e[28]!==N||e[29]!==j?(k=r.jsxs(at,{iconClass:"fa fa-cog",children:[h,p,j,y,N]}),e[28]=N,e[29]=j,e[30]=k):k=e[30];let T;e[31]!==s.active||e[32]!==o||e[33]!==k||e[34]!==u?(T=r.jsxs(ct,{value:s.active,label:"Run HTTP/S Proxy and forward requests to",onChange:o,children:[u,k]}),e[31]=s.active,e[32]=o,e[33]=k,e[34]=u,e[35]=T):T=e[35];let D;e[36]!==i||e[37]!==n?(D=r.jsx(ot,{error:n,backendState:i}),e[36]=i,e[37]=n,e[38]=D):D=e[38];let I;return e[39]!==T||e[40]!==D?(I=r.jsxs("div",{children:[T,D]}),e[39]=T,e[40]=D,e[41]=I):I=e[41],I}function Au(){const t=E.c(9),e=F(Du),s=F(Iu);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(Fu,{server:u,backendState:s[$r(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n,o;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"DNS Server"}),o=r.jsx("p",{className:"mode-description",children:"A recursive DNS resolver using the host's DNS configuration."}),t[5]=n,t[6]=o):(n=t[5],o=t[6]);let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function Iu(t){return t.backendState.servers}function Du(t){return t.modes.dns}function Fu(t){const e=E.c(33),{server:s,backendState:i}=t,l=Z(),n=s.error||i?.last_exception||void 0;let o;e[0]!==l||e[1]!==s?(o=()=>l(Gr({server:s,value:!s.active})),e[0]=l,e[1]=s,e[2]=o):o=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("h4",{children:"Advanced Configuration"}),d=r.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const u=s.listen_host||"";let h;e[5]!==l||e[6]!==s?(h=T=>l(Yr({server:s,value:T})),e[5]=l,e[6]=s,e[7]=h):h=e[7];let p;e[8]!==u||e[9]!==h?(p=r.jsx(pe,{className:"mode-input",content:u,onEditDone:h}),e[8]=u,e[9]=h,e[10]=p):p=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==l||e[15]!==s?(j=T=>l(Jr({server:s,value:parseInt(T)})),e[14]=l,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=r.jsx(pe,{className:"mode-input",content:x,placeholder:"8080",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]!==y||e[21]!==p?(b=r.jsxs(at,{iconClass:"fa fa-cog",children:[a,d,p,g,y]}),e[20]=y,e[21]=p,e[22]=b):b=e[22];let $;e[23]!==s.active||e[24]!==o||e[25]!==b?($=r.jsx(ct,{value:s.active,label:"Run DNS Server",onChange:o,children:b}),e[23]=s.active,e[24]=o,e[25]=b,e[26]=$):$=e[26];let N;e[27]!==i||e[28]!==n?(N=r.jsx(ot,{error:n,backendState:i}),e[27]=i,e[28]=n,e[29]=N):N=e[29];let k;return e[30]!==$||e[31]!==N?(k=r.jsxs("div",{children:[$,N]}),e[30]=$,e[31]=N,e[32]=k):k=e[32],k}function ji(t){const e=E.c(10),{title:s,description:i}=t;let l;e[0]!==s?(l=r.jsx("h4",{className:"mode-title",children:s}),e[0]=s,e[1]=l):l=e[1];let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("i",{className:"fa fa-exclamation-triangle","aria-hidden":"true"}),e[2]=n):n=e[2];let o;e[3]!==l?(o=r.jsxs("div",{className:"title-icon-container",children:[l,n]}),e[3]=l,e[4]=o):o=e[4];let a;e[5]!==i?(a=r.jsx("p",{className:"mode-description",children:i}),e[5]=i,e[6]=a):a=e[6];let d;return e[7]!==o||e[8]!==a?(d=r.jsxs("div",{className:"missing-mode-container",children:[o,a]}),e[7]=o,e[8]=a,e[9]=d):d=e[9],d}function Lu(){const t=E.c(19),{platform:e,localModeUnavailable:s}=F(Pu);let i,l;t[0]===Symbol.for("react.memo_cache_sentinel")?(i=r.jsx("h2",{children:"Intercept Traffic"}),l=r.jsx("p",{children:"Configure how you want to intercept traffic with mitmproxy."}),t[0]=i,t[1]=l):(i=t[0],l=t[1]);let n;t[2]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h3",{children:"Recommended"}),t[2]=n):n=t[2];let o;t[3]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsx(ou,{}),t[3]=o):o=t[3];let a;t[4]!==s?(a=s!==null?r.jsx(ji,{title:"Local Redirect Mode",description:s}):r.jsx(tu,{}),t[4]=s,t[5]=a):a=t[5];let d,u;t[6]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx(uu,{}),u=r.jsx(mu,{}),t[6]=d,t[7]=u):(d=t[6],u=t[7]);let h;t[8]!==a?(h=r.jsxs("div",{className:"modes-category green-left-border",children:[n,r.jsxs("div",{className:"modes-container",children:[o,a,d,u]})]}),t[8]=a,t[9]=h):h=t[9];let p;t[10]===Symbol.for("react.memo_cache_sentinel")?(p=r.jsx("h3",{children:"Advanced"}),t[10]=p):p=t[10];let g,x,j;t[11]===Symbol.for("react.memo_cache_sentinel")?(j=r.jsx(wu,{}),g=r.jsx(ku,{}),x=r.jsx(Au,{}),t[11]=g,t[12]=x,t[13]=j):(g=t[11],x=t[12],j=t[13]);let y;t[14]!==e?(y=r.jsxs("div",{className:"modes-category gray-left-border",children:[p,r.jsxs("div",{className:"modes-container",children:[j,g,x,e.startsWith("win32")?r.jsx(ji,{title:"Transparent Proxy",description:"This mode is only supported on Linux and MacOS."}):r.jsx(ju,{})]})]}),t[14]=e,t[15]=y):y=t[15];let b;return t[16]!==y||t[17]!==h?(b=r.jsxs("div",{className:"modes",children:[i,l,h,y]}),t[16]=y,t[17]=h,t[18]=b):b=t[18],b}function Pu(t){return t.backendState}function Mu(t){const e=t.filter(d=>d.type==="http"),s=e.length,i=e.filter(d=>d.response&&d.response.status_code>=400).length,l=s>0?i/s*100:0,n=e.filter(d=>d.response?.timestamp_end&&d.request?.timestamp_start).map(d=>{const u=d.request.timestamp_start;return(d.response.timestamp_end-u)*1e3}),o=n.length>0?n.reduce((d,u)=>d+u,0)/n.length:0,a=n.filter(d=>d>1e3).length;return{totalRequests:s,errorRate:l,avgResponseTime:o,slowQueries:a}}function qu(t){const e=t.filter(i=>i.type==="http"),s=new Map;return e.forEach(i=>{if(i.response){const l=i.response.status_code;s.set(l,(s.get(l)||0)+1)}}),Array.from(s.entries()).map(([i,l])=>({code:i,count:l})).sort((i,l)=>l.count-i.count).slice(0,10)}function Ou(t){const e=t.filter(i=>i.type==="http"),s=new Map;return e.forEach(i=>{const l=i.request.pretty_host,n=s.get(l)||{count:0,totalTime:0};if(n.count+=1,i.response?.timestamp_end&&i.request?.timestamp_start){const o=(i.response.timestamp_end-i.request.timestamp_start)*1e3;n.totalTime+=o}s.set(l,n)}),Array.from(s.entries()).map(([i,l])=>({domain:i,count:l.count,avgTime:l.count>0?l.totalTime/l.count:0})).sort((i,l)=>l.count-i.count).slice(0,10)}function Hu(t,e=5e3){const s=t.filter(l=>l.type==="http"),i=new Map;return s.forEach(l=>{if(l.response?.timestamp_end&&l.request?.timestamp_start){const n=Math.floor(l.request.timestamp_start*1e3),o=Math.floor(n/e)*e,a=(l.response.timestamp_end-l.request.timestamp_start)*1e3;i.has(o)||i.set(o,[]),i.get(o).push(a)}}),Array.from(i.entries()).map(([l,n])=>({timestamp:l,time:n.reduce((o,a)=>o+a,0)/n.length})).sort((l,n)=>l.timestamp-n.timestamp).slice(-50)}function ps(t){return t.toLocaleString()}function Vu(t){return t<1e3?`${Math.round(t)}ms`:`${(t/1e3).toFixed(2)}s`}function Uu(t){return`${t.toFixed(1)}%`}function Bu(t){const e=E.c(13),{flows:s}=t;let i;e[0]!==s?(i=Hu(s),e[0]=s,e[1]=i):i=e[1];const l=i;if(l.length===0){let j;return e[2]===Symbol.for("react.memo_cache_sentinel")?(j=r.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"No response time data available"}),e[2]=j):j=e[2],j}let n;e[3]===Symbol.for("react.memo_cache_sentinel")?(n={width:"100%",height:300},e[3]=n):n=e[3];let o,a;e[4]===Symbol.for("react.memo_cache_sentinel")?(o={top:5,right:30,left:20,bottom:5},a=r.jsx(Ai,{strokeDasharray:"3 3"}),e[4]=o,e[5]=a):(o=e[4],a=e[5]);let d;e[6]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx(Ii,{dataKey:"timestamp",tickFormatter:zu,label:{value:"Time",position:"insideBottom",offset:-5}}),e[6]=d):d=e[6];let u,h,p,g;e[7]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx(vs,{label:{value:"Response Time (ms)",angle:-90,position:"insideLeft"}}),h=r.jsx(Cs,{labelFormatter:Wu,formatter:Ku}),p=r.jsx(Ns,{}),g=r.jsx(cc,{type:"monotone",dataKey:"time",stroke:"#8884d8",strokeWidth:2,dot:!1,name:"Response Time"}),e[7]=u,e[8]=h,e[9]=p,e[10]=g):(u=e[7],h=e[8],p=e[9],g=e[10]);let x;return e[11]!==l?(x=r.jsx("div",{style:n,children:r.jsx(ks,{children:r.jsxs(ac,{data:l,margin:o,children:[a,d,u,h,p,g]})})}),e[11]=l,e[12]=x):x=e[12],x}function Ku(t){return[`${t.toFixed(2)}ms`,"Avg Response Time"]}function Wu(t){return new Date(t).toLocaleTimeString()}function zu(t){const e=new Date(t);return`${e.getHours()}:${String(e.getMinutes()).padStart(2,"0")}`}const Nt={"2xx":"#10b981","3xx":"#3b82f6","4xx":"#f59e0b","5xx":"#ef4444",default:"#6b7280"};function Qu(t){return t>=200&&t<300?Nt["2xx"]:t>=300&&t<400?Nt["3xx"]:t>=400&&t<500?Nt["4xx"]:t>=500&&t<600?Nt["5xx"]:Nt.default}function Gu(t){const e=E.c(13),{flows:s}=t;let i;e[0]!==s?(i=qu(s).map(ef),e[0]=s,e[1]=i):i=e[1];const l=i;if(l.length===0){let p;return e[2]===Symbol.for("react.memo_cache_sentinel")?(p=r.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"No status code data available"}),e[2]=p):p=e[2],p}let n;e[3]===Symbol.for("react.memo_cache_sentinel")?(n={width:"100%",height:300},e[3]=n):n=e[3];let o;e[4]!==l?(o=l.map(Xu),e[4]=l,e[5]=o):o=e[5];let a;e[6]!==l||e[7]!==o?(a=r.jsx(dc,{data:l,cx:"50%",cy:"50%",labelLine:!1,label:Zu,outerRadius:80,fill:"#8884d8",dataKey:"value",children:o}),e[6]=l,e[7]=o,e[8]=a):a=e[8];let d,u;e[9]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx(Cs,{formatter:Ju}),u=r.jsx(Ns,{formatter:Yu}),e[9]=d,e[10]=u):(d=e[9],u=e[10]);let h;return e[11]!==a?(h=r.jsx("div",{style:n,children:r.jsx(ks,{children:r.jsxs(uc,{children:[a,d,u]})})}),e[11]=a,e[12]=h):h=e[12],h}function Yu(t,e){return`${t} (${e.payload.value})`}function Ju(t,e){return[`${t} requests`,`Status ${e}`]}function Xu(t,e){return r.jsx(fc,{fill:t.fill},`cell-${e}`)}function Zu(t){const{name:e,percent:s}=t;return`${e} (${(s*100).toFixed(0)}%)`}function ef(t){return{name:`${t.code}`,value:t.count,fill:Qu(t.code)}}function tf(t){const e=E.c(15),{flows:s}=t;let i;e[0]!==s?(i=Ou(s),e[0]=s,e[1]=i):i=e[1];const l=i;if(l.length===0){let b;return e[2]===Symbol.for("react.memo_cache_sentinel")?(b=r.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"No domain data available"}),e[2]=b):b=e[2],b}let n;e[3]===Symbol.for("react.memo_cache_sentinel")?(n={width:"100%",height:300},e[3]=n):n=e[3];let o,a;e[4]===Symbol.for("react.memo_cache_sentinel")?(o={top:5,right:30,left:20,bottom:60},a=r.jsx(Ai,{strokeDasharray:"3 3"}),e[4]=o,e[5]=a):(o=e[4],a=e[5]);let d;e[6]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx(Ii,{dataKey:"domain",angle:-45,textAnchor:"end",height:100,interval:0,tick:{fontSize:10}}),e[6]=d):d=e[6];let u;e[7]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx(vs,{yAxisId:"left",label:{value:"Request Count",angle:-90,position:"insideLeft"}}),e[7]=u):u=e[7];let h,p,g,x,j;e[8]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx(vs,{yAxisId:"right",orientation:"right",label:{value:"Avg Time (ms)",angle:90,position:"insideRight"}}),x=r.jsx(Cs,{formatter:sf}),j=r.jsx(Ns,{}),h=r.jsx(ti,{yAxisId:"left",dataKey:"count",fill:"#8884d8",name:"Request Count"}),p=r.jsx(ti,{yAxisId:"right",dataKey:"avgTime",fill:"#82ca9d",name:"Avg Response Time"}),e[8]=h,e[9]=p,e[10]=g,e[11]=x,e[12]=j):(h=e[8],p=e[9],g=e[10],x=e[11],j=e[12]);let y;return e[13]!==l?(y=r.jsx("div",{style:n,children:r.jsx(ks,{children:r.jsxs(pc,{data:l,margin:o,children:[a,d,u,g,x,j,h,p]})})}),e[13]=l,e[14]=y):y=e[14],y}function sf(t,e){return e==="count"?[`${t} requests`,"Count"]:[`${t.toFixed(2)}ms`,"Avg Time"]}function nf(t){const e=E.c(52),{flows:s}=t;let i;e[0]!==s?(i=Mu(s),e[0]=s,e[1]=i):i=e[1];const l=i;let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h2",{children:"📊 Network Metrics"}),e[2]=n):n=e[2];let o;e[3]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsx("div",{className:"metric-label",children:"Total Requests"}),e[3]=o):o=e[3];let a;e[4]!==l.totalRequests?(a=ps(l.totalRequests),e[4]=l.totalRequests,e[5]=a):a=e[5];let d;e[6]!==a?(d=r.jsxs("div",{className:"metric-card",children:[o,r.jsx("div",{className:"metric-value",children:a})]}),e[6]=a,e[7]=d):d=e[7];let u;e[8]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("div",{className:"metric-label",children:"Error Rate"}),e[8]=u):u=e[8];let h;e[9]!==l.errorRate?(h=Uu(l.errorRate),e[9]=l.errorRate,e[10]=h):h=e[10];let p;e[11]!==h?(p=r.jsxs("div",{className:"metric-card",children:[u,r.jsx("div",{className:"metric-value",children:h})]}),e[11]=h,e[12]=p):p=e[12];let g;e[13]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("div",{className:"metric-label",children:"Avg Response Time"}),e[13]=g):g=e[13];let x;e[14]!==l.avgResponseTime?(x=Vu(l.avgResponseTime),e[14]=l.avgResponseTime,e[15]=x):x=e[15];let j;e[16]!==x?(j=r.jsxs("div",{className:"metric-card",children:[g,r.jsx("div",{className:"metric-value",children:x})]}),e[16]=x,e[17]=j):j=e[17];let y;e[18]===Symbol.for("react.memo_cache_sentinel")?(y=r.jsx("div",{className:"metric-label",children:"Slow Queries (>1s)"}),e[18]=y):y=e[18];let b;e[19]!==l.slowQueries?(b=ps(l.slowQueries),e[19]=l.slowQueries,e[20]=b):b=e[20];let $;e[21]!==b?($=r.jsxs("div",{className:"metric-card",children:[y,r.jsx("div",{className:"metric-value",children:b})]}),e[21]=b,e[22]=$):$=e[22];let N;e[23]!==j||e[24]!==$||e[25]!==d||e[26]!==p?(N=r.jsxs("div",{className:"metrics-grid",children:[d,p,j,$]}),e[23]=j,e[24]=$,e[25]=d,e[26]=p,e[27]=N):N=e[27];let k;e[28]===Symbol.for("react.memo_cache_sentinel")?(k=r.jsx("h3",{children:"Response Time Over Time"}),e[28]=k):k=e[28];let T;e[29]!==s?(T=r.jsxs("div",{className:"chart-container",children:[k,r.jsx(Bu,{flows:s})]}),e[29]=s,e[30]=T):T=e[30];let D;e[31]===Symbol.for("react.memo_cache_sentinel")?(D=r.jsx("h3",{children:"Status Code Distribution"}),e[31]=D):D=e[31];let I;e[32]!==s?(I=r.jsxs("div",{className:"chart-container",children:[D,r.jsx(Gu,{flows:s})]}),e[32]=s,e[33]=I):I=e[33];let O;e[34]===Symbol.for("react.memo_cache_sentinel")?(O=r.jsx("h3",{children:"Top Domains by Request Count"}),e[34]=O):O=e[34];let q;e[35]!==s?(q=r.jsxs("div",{className:"chart-container",children:[O,r.jsx(tf,{flows:s})]}),e[35]=s,e[36]=q):q=e[36];let U;e[37]!==I||e[38]!==q?(U=r.jsxs("div",{className:"charts-row",children:[I,q]}),e[37]=I,e[38]=q,e[39]=U):U=e[39];let H;e[40]!==T||e[41]!==U?(H=r.jsxs("div",{className:"charts-section",children:[T,U]}),e[40]=T,e[41]=U,e[42]=H):H=e[42];let W;e[43]===Symbol.for("react.memo_cache_sentinel")?(W=r.jsx("p",{children:"✨ Kidsnote mitmweb - Network Debugging Tool"}),e[43]=W):W=e[43];let Q;e[44]!==s.length?(Q=ps(s.length),e[44]=s.length,e[45]=Q):Q=e[45];let K;e[46]!==Q?(K=r.jsxs("div",{className:"metrics-info",children:[W,r.jsxs("p",{children:["🚀 Phase 1: MVP - Real-time metrics from ",Q," ","flows"]})]}),e[46]=Q,e[47]=K):K=e[47];let G;return e[48]!==N||e[49]!==H||e[50]!==K?(G=r.jsxs("div",{className:"kidsnote-metrics-panel",children:[n,N,H,K]}),e[48]=N,e[49]=H,e[50]=K,e[51]=G):G=e[51],G}const rf=bt(t=>({flows:t.flows.list}))(nf);var Ve=(t=>(t.REQUEST="request",t.IMPRESSION="impression",t.CLICK="click",t))(Ve||{}),Se=(t=>(t.REQUESTED="requested",t.IMPRESSED="impressed",t.CLICKED="clicked",t))(Se||{});const lf="ads-api-kcsandbox-01.kidsnote.com",Xs={REQUEST:/\/req(\?|$)/,IMPRESSION:/\/imp(\?|$)/,CLICK:/\/click(\?|$)/};function is(t){return t.type!=="http"?!1:t.request.pretty_host===lf}function _l(t){if(!is(t))return!1;const e=t.request.path;return Xs.REQUEST.test(e)}function Zs(t){if(!is(t))return!1;const e=t.request.path;return Xs.IMPRESSION.test(e)}function en(t){if(!is(t))return!1;const e=t.request.path;return Xs.CLICK.test(e)}function jl(t){const e=new Map;try{new URL(t,"http://dummy.com").searchParams.forEach((i,l)=>{e.set(l,i)})}catch{}return e}function $s(t){if(!Zs(t)&&!en(t))return null;try{const e=`${t.request.scheme}://${t.request.pretty_host}${t.request.path}`;return jl(e).get("adsid")||null}catch(e){return console.error("Failed to extract adsid:",e),null}}function yi(t,e){return{type:e,timestamp:t.request.timestamp_start*1e3,flowId:t.id}}function Xt(t){return t?new Date(t).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3}):"-"}function of(t){switch(t){case Se.REQUESTED:return"요청됨";case Se.IMPRESSED:return"노출됨";case Se.CLICKED:return"클릭됨";default:return t}}function cf(t){switch(t){case Se.REQUESTED:return"#6b7280";case Se.IMPRESSED:return"#3b82f6";case Se.CLICKED:return"#10b981";default:return"#6b7280"}}function af(t){return _l(t)?Ve.REQUEST:Zs(t)?Ve.IMPRESSION:en(t)?Ve.CLICK:null}function df(t){const e=af(t);if(!e)return null;const s=`${t.request.scheme}://${t.request.pretty_host}${t.request.path}`,i=jl(s),l=$s(t);return{id:t.id,timestamp:t.request.timestamp_start*1e3,type:e,adsid:l||void 0,method:t.request.method,url:s,path:t.request.path,queryParams:i,statusCode:t.response?.status_code,responseSize:t.response?.content?.length}}function bi(t){switch(t){case Ve.REQUEST:return"광고 요청";case Ve.IMPRESSION:return"노출";case Ve.CLICK:return"클릭";default:return t}}function Si(t){switch(t){case Ve.REQUEST:return"#8b5cf6";case Ve.IMPRESSION:return"#3b82f6";case Ve.CLICK:return"#10b981";default:return"#6b7280"}}const uf="stat.tiara.daum.net";function ff(t){return t.type!=="http"?!1:t.request.pretty_host===uf}function pf(t){try{const e=t.request.content;if(!e)return null;let s;if(typeof e=="string")s=e;else if(e instanceof Uint8Array)s=new TextDecoder().decode(e);else return null;return JSON.parse(s)}catch(e){return console.error("Failed to parse Tiara request body:",e),null}}function hf(t){const e=[];if(t.viewimp_contents&&t.viewimp_contents.length>0){const s=t.viewimp_contents.map(l=>l.imp_id).filter(Boolean).slice(0,3);s.length>0&&e.push(`imp_id: ${s.join(", ")}`);const i=t.viewimp_contents.map(l=>l.copy).filter(Boolean).slice(0,2);i.length>0&&e.push(`copy: ${i.join(", ")}`)}if(t.click_contents&&t.click_contents.length>0){const s=t.click_contents.map(l=>l.imp_id).filter(Boolean).slice(0,3);s.length>0&&e.push(`click_imp_id: ${s.join(", ")}`);const i=t.click_contents.map(l=>l.copy).filter(Boolean).slice(0,2);i.length>0&&e.push(`click_copy: ${i.join(", ")}`)}return e.join(" | ")||"-"}function mf(t){if(!ff(t))return[];const e=pf(t);if(!e||!Array.isArray(e))return[];const s=[];return e.forEach((i,l)=>{try{if(!i.action||!i.common)return;const n={id:`${t.id}-${l}`,timestamp:i.common.access_timestamp||Date.now(),actionType:i.action.type||"-",actionName:i.action.name||"-",page:i.common.page||"-",section:i.common.section||"-",summary:hf(i),rawData:i};s.push(n)}catch(n){console.error("Failed to parse Tiara event data:",n,i)}}),s}function gf(t){const e=new Set;return t.forEach(s=>{s.actionType&&s.actionType!=="-"&&e.add(s.actionType)}),Array.from(e).sort()}function wi(t){return t?new Date(t).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3}):"-"}function xf(t){const e=new Map;return t.forEach(s=>{if(s.type!=="http")return;const i=s;if(_l(i)&&i.response,Zs(i)){const l=$s(i);if(l){const n=e.get(l)||{adsid:l,title:`Ad ${l.substring(0,8)}...`,status:Se.REQUESTED},o=yi(i,Ve.IMPRESSION);e.set(l,{...n,impressionEvent:o,impressionTime:o.timestamp,status:Se.IMPRESSED})}}if(en(i)){const l=$s(i);if(l){const n=e.get(l)||{adsid:l,title:`Ad ${l.substring(0,8)}...`,status:Se.REQUESTED},o=yi(i,Ve.CLICK);e.set(l,{...n,clickEvent:o,clickTime:o.timestamp,status:Se.CLICKED})}}}),e}function vf(t){const e=E.c(89),{flows:s}=t,[i,l]=ye.useState(""),[n,o]=ye.useState("all"),[a,d]=ye.useState("ads"),[u,h]=ye.useState(null),[p,g]=ye.useState(null),[x,j]=ye.useState("all");let y;e[0]!==s?(y=xf(s),e[0]=s,e[1]=y):y=e[1];const b=y;let $;if(e[2]!==b||e[3]!==i||e[4]!==n){let L=Array.from(b.values());if(i){const re=i.toLowerCase();L=L.filter(Ce=>Ce.adsid.toLowerCase().includes(re)||Ce.title.toLowerCase().includes(re))}n!=="all"&&(L=L.filter(re=>re.status===n)),$=L.sort(Ef),e[2]=b,e[3]=i,e[4]=n,e[5]=$}else $=e[5];const N=$;let k;if(e[6]!==s){const L=[];s.forEach(re=>{if(re.type!=="http")return;const Ce=re;if(is(Ce)){const Le=df(Ce);Le&&L.push(Le)}}),k=L.sort(kf),e[6]=s,e[7]=k}else k=e[7];const T=k;let D;if(e[8]!==s){const L=[];s.forEach(re=>{if(re.type!=="http")return;const Le=mf(re);L.push(...Le)}),D=L.sort(Nf),e[8]=s,e[9]=D}else D=e[9];const I=D;let O;e:{if(x==="all"){O=I;break e}let L;if(e[10]!==x||e[11]!==I){let re;e[13]!==x?(re=Ce=>Ce.actionType===x,e[13]=x,e[14]=re):re=e[14],L=I.filter(re),e[10]=x,e[11]=I,e[12]=L}else L=e[12];O=L}const q=O;let U;e[15]!==I?(U=gf(I),e[15]=I,e[16]=U):U=e[16];const H=U,W=Cf;let Q;e[17]===Symbol.for("react.memo_cache_sentinel")?(Q=r.jsxs("div",{className:"ad-tracking-header",children:[r.jsx("h2",{children:"📱 Kidsnote Ad Tracking Analysis"}),r.jsx("p",{className:"description",children:"키즈노트 광고 트래킹 분석 대시보드 - 광고 요청(req), 노출(imp), 클릭(click)을 자동으로 추적합니다"})]}),e[17]=Q):Q=e[17];let K;e[18]===Symbol.for("react.memo_cache_sentinel")?(K=L=>l(L.target.value),e[18]=K):K=e[18];let G;e[19]!==i?(G=r.jsx("div",{className:"search-box",children:r.jsx("input",{type:"text",placeholder:"🔍 Ad ID 또는 제목 검색...",value:i,onChange:K,className:"search-input"})}),e[19]=i,e[20]=G):G=e[20];let Y;e[21]===Symbol.for("react.memo_cache_sentinel")?(Y=L=>o(L.target.value),e[21]=Y):Y=e[21];let ee,te,se,ue;e[22]===Symbol.for("react.memo_cache_sentinel")?(ee=r.jsx("option",{value:"all",children:"모든 상태"}),te=r.jsx("option",{value:Se.REQUESTED,children:"요청됨"}),se=r.jsx("option",{value:Se.IMPRESSED,children:"노출됨"}),ue=r.jsx("option",{value:Se.CLICKED,children:"클릭됨"}),e[22]=ee,e[23]=te,e[24]=se,e[25]=ue):(ee=e[22],te=e[23],se=e[24],ue=e[25]);let fe;e[26]!==n?(fe=r.jsx("div",{className:"filter-box",children:r.jsxs("select",{value:n,onChange:Y,className:"status-filter",children:[ee,te,se,ue]})}),e[26]=n,e[27]=fe):fe=e[27];let ve;e[28]===Symbol.for("react.memo_cache_sentinel")?(ve=r.jsx("button",{onClick:W,className:"clear-button",children:"🗑️ 초기화"}),e[28]=ve):ve=e[28];let ke;e[29]!==fe||e[30]!==G?(ke=r.jsxs("div",{className:"ad-tracking-controls",children:[G,fe,ve]}),e[29]=fe,e[30]=G,e[31]=ke):ke=e[31];let Re;e[32]===Symbol.for("react.memo_cache_sentinel")?(Re=r.jsx("div",{className:"stat-label",children:"총 광고"}),e[32]=Re):Re=e[32];let ge;e[33]!==b.size?(ge=r.jsxs("div",{className:"stat-card",children:[Re,r.jsx("div",{className:"stat-value",children:b.size})]}),e[33]=b.size,e[34]=ge):ge=e[34];let we;e[35]===Symbol.for("react.memo_cache_sentinel")?(we=r.jsx("div",{className:"stat-label",children:"노출됨"}),e[35]=we):we=e[35];let C;e[36]!==b?(C=Array.from(b.values()).filter($f),e[36]=b,e[37]=C):C=e[37];let ae;e[38]!==C.length?(ae=r.jsxs("div",{className:"stat-card",children:[we,r.jsx("div",{className:"stat-value",children:C.length})]}),e[38]=C.length,e[39]=ae):ae=e[39];let z;e[40]===Symbol.for("react.memo_cache_sentinel")?(z=r.jsx("div",{className:"stat-label",children:"클릭됨"}),e[40]=z):z=e[40];let ie;e[41]!==b?(ie=Array.from(b.values()).filter(wf),e[41]=b,e[42]=ie):ie=e[42];let V;e[43]!==ie.length?(V=r.jsxs("div",{className:"stat-card",children:[z,r.jsx("div",{className:"stat-value",children:ie.length})]}),e[43]=ie.length,e[44]=V):V=e[44];let _e;e[45]===Symbol.for("react.memo_cache_sentinel")?(_e=r.jsx("div",{className:"stat-label",children:"CTR"}),e[45]=_e):_e=e[45];let Ee;e[46]!==b?(Ee=b.size>0?(Array.from(b.values()).filter(Sf).length/b.size*100).toFixed(1)+"%":"-",e[46]=b,e[47]=Ee):Ee=e[47];let $e;e[48]!==Ee?($e=r.jsxs("div",{className:"stat-card",children:[_e,r.jsx("div",{className:"stat-value",children:Ee})]}),e[48]=Ee,e[49]=$e):$e=e[49];let X;e[50]!==ge||e[51]!==ae||e[52]!==V||e[53]!==$e?(X=r.jsxs("div",{className:"ad-tracking-stats",children:[ge,ae,V,$e]}),e[50]=ge,e[51]=ae,e[52]=V,e[53]=$e,e[54]=X):X=e[54];const Fe=`view-tab ${a==="ads"?"active":""}`;let Te;e[55]===Symbol.for("react.memo_cache_sentinel")?(Te=()=>d("ads"),e[55]=Te):Te=e[55];let ne;e[56]!==Fe?(ne=r.jsx("button",{className:Fe,onClick:Te,children:"📊 광고 요약"}),e[56]=Fe,e[57]=ne):ne=e[57];const de=`view-tab ${a==="packets"?"active":""}`;let he;e[58]===Symbol.for("react.memo_cache_sentinel")?(he=()=>d("packets"),e[58]=he):he=e[58];let je;e[59]!==de?(je=r.jsx("button",{className:de,onClick:he,children:"📦 패킷 상세"}),e[59]=de,e[60]=je):je=e[60];const Ue=`view-tab ${a==="tiara"?"active":""}`;let qe;e[61]===Symbol.for("react.memo_cache_sentinel")?(qe=()=>d("tiara"),e[61]=qe):qe=e[61];let Qe;e[62]!==Ue?(Qe=r.jsx("button",{className:Ue,onClick:qe,children:"📈 티아라"}),e[62]=Ue,e[63]=Qe):Qe=e[63];let S;e[64]!==ne||e[65]!==je||e[66]!==Qe?(S=r.jsxs("div",{className:"view-tabs",children:[ne,je,Qe]}),e[64]=ne,e[65]=je,e[66]=Qe,e[67]=S):S=e[67];let w;e[68]!==x||e[69]!==N||e[70]!==a||e[71]!==q||e[72]!==T||e[73]!==I||e[74]!==H?(w=a==="ads"?N.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("p",{children:"📭 광고 트래킹 데이터가 없습니다"}),r.jsx("p",{className:"hint",children:"키즈노트 앱에서 광고를 요청하면 자동으로 추적됩니다"})]}):r.jsxs("table",{className:"ad-tracking-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Ad ID"}),r.jsx("th",{children:"광고 제목"}),r.jsx("th",{children:"상태"}),r.jsx("th",{children:"노출 시간"}),r.jsx("th",{children:"클릭 시간"})]})}),r.jsx("tbody",{children:N.map(bf)})]}):a==="packets"?T.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("p",{children:"📭 패킷 데이터가 없습니다"}),r.jsx("p",{className:"hint",children:"키즈노트 앱에서 광고 API를 호출하면 자동으로 추적됩니다"})]}):r.jsxs("table",{className:"ad-tracking-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"시간"}),r.jsx("th",{children:"타입"}),r.jsx("th",{children:"Method"}),r.jsx("th",{children:"URL"}),r.jsx("th",{children:"Ad ID"}),r.jsx("th",{children:"Status"})]})}),r.jsx("tbody",{children:T.map(L=>r.jsxs("tr",{onClick:()=>h(L),children:[r.jsx("td",{className:"ad-time",children:Xt(L.timestamp)}),r.jsx("td",{children:r.jsx("span",{className:"packet-type-badge",style:{backgroundColor:Si(L.type)},children:bi(L.type)})}),r.jsx("td",{children:r.jsx("span",{className:"packet-method",children:L.method})}),r.jsx("td",{className:"packet-url",children:L.path}),r.jsx("td",{className:"ad-id",children:L.adsid?r.jsx("code",{children:L.adsid}):"-"}),r.jsx("td",{children:L.statusCode?r.jsx("span",{className:`packet-status-code ${L.statusCode>=200&&L.statusCode<300?"success":"error"}`,children:L.statusCode}):"-"})]},L.id))})]}):a==="tiara"?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"tiara-filter-section",style:{padding:"16px",borderBottom:"1px solid #e5e7eb"},children:[r.jsx("label",{style:{marginRight:"8px",fontWeight:"500"},children:"Action Type:"}),r.jsxs("select",{value:x,onChange:L=>j(L.target.value),className:"status-filter",style:{minWidth:"150px"},children:[r.jsxs("option",{value:"all",children:["All (",I.length,")"]}),H.map(L=>{const re=I.filter(Ce=>Ce.actionType===L).length;return r.jsxs("option",{value:L,children:[L," (",re,")"]},L)})]}),r.jsxs("span",{style:{marginLeft:"16px",color:"#6b7280"},children:["Showing ",q.length," events"]})]}),q.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("p",{children:"📭 Tiara 이벤트가 없습니다"}),r.jsx("p",{className:"hint",children:"키즈노트 앱에서 사용자 행동이 발생하면 자동으로 추적됩니다"})]}):r.jsxs("table",{className:"ad-tracking-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Timestamp"}),r.jsx("th",{children:"Action Type"}),r.jsx("th",{children:"Action Name"}),r.jsx("th",{children:"Page"}),r.jsx("th",{children:"Section"}),r.jsx("th",{children:"Summary"})]})}),r.jsx("tbody",{children:q.map(L=>r.jsxs("tr",{onClick:()=>g(L),style:{cursor:"pointer"},children:[r.jsx("td",{className:"ad-time",children:wi(L.timestamp)}),r.jsx("td",{children:r.jsx("span",{className:"packet-type-badge",style:{backgroundColor:"#8b5cf6"},children:L.actionType})}),r.jsx("td",{children:L.actionName}),r.jsx("td",{children:L.page}),r.jsx("td",{children:L.section}),r.jsx("td",{style:{maxWidth:"300px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:L.summary})]},L.id))})]})]}):null,e[68]=x,e[69]=N,e[70]=a,e[71]=q,e[72]=T,e[73]=I,e[74]=H,e[75]=w):w=e[75];let R;e[76]!==w?(R=r.jsx("div",{className:"ad-tracking-table-container",children:w}),e[76]=w,e[77]=R):R=e[77];let B;e[78]!==u?(B=u&&r.jsx("div",{className:"packet-detail-modal",onClick:()=>h(null),children:r.jsxs("div",{className:"packet-detail-content",onClick:yf,children:[r.jsxs("div",{className:"packet-detail-header",children:[r.jsx("h3",{children:"📦 패킷 상세 정보"}),r.jsx("button",{className:"close-button",onClick:()=>h(null),children:"✕"})]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("strong",{children:"타입:"})," ",r.jsx("span",{className:"packet-type-badge",style:{backgroundColor:Si(u.type),marginLeft:"8px"},children:bi(u.type)})]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("strong",{children:"시간:"})," ",Xt(u.timestamp)]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("strong",{children:"Method:"})," ",r.jsx("span",{className:"packet-method",children:u.method})]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("strong",{children:"Full URL:"}),r.jsx("div",{className:"packet-url",style:{marginTop:"8px",padding:"8px",background:"#f3f4f6",borderRadius:"4px"},children:u.url})]}),u.adsid&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("strong",{children:"Ad ID:"})," ",r.jsx("code",{style:{background:"#f3f4f6",padding:"4px 8px",borderRadius:"4px"},children:u.adsid})]}),u.statusCode&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("strong",{children:"Status Code:"})," ",r.jsx("span",{className:`packet-status-code ${u.statusCode>=200&&u.statusCode<300?"success":"error"}`,children:u.statusCode})]}),u.queryParams.size>0&&r.jsxs("div",{children:[r.jsx("strong",{children:"Query Parameters:"}),r.jsx("ul",{className:"query-params-list",children:Array.from(u.queryParams.entries()).map(jf)})]})]})}),e[78]=u,e[79]=B):B=e[79];let Be;e[80]!==p?(Be=p&&r.jsx("div",{className:"packet-detail-modal",onClick:()=>g(null),children:r.jsxs("div",{className:"packet-detail-content",onClick:_f,style:{maxWidth:"800px"},children:[r.jsxs("div",{className:"packet-detail-header",children:[r.jsx("h3",{children:"📈 Tiara 이벤트 상세"}),r.jsx("button",{className:"close-button",onClick:()=>g(null),children:"✕"})]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("strong",{children:"Timestamp:"})," ",wi(p.timestamp)]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("strong",{children:"Action Type:"})," ",r.jsx("span",{className:"packet-type-badge",style:{backgroundColor:"#8b5cf6",marginLeft:"8px"},children:p.actionType})]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("strong",{children:"Action Name:"})," ",p.actionName]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("strong",{children:"Page:"})," ",p.page]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("strong",{children:"Section:"})," ",p.section]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("strong",{children:"Summary:"})," ",p.summary]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Raw Event Data:"}),r.jsx("pre",{style:{marginTop:"8px",padding:"12px",background:"#f3f4f6",borderRadius:"4px",overflow:"auto",maxHeight:"400px",fontSize:"12px"},children:JSON.stringify(p.rawData,null,2)})]})]})}),e[80]=p,e[81]=Be):Be=e[81];let nt;return e[82]!==ke||e[83]!==X||e[84]!==S||e[85]!==R||e[86]!==B||e[87]!==Be?(nt=r.jsxs("div",{className:"kidsnote-ad-tracking-panel",children:[Q,ke,X,S,R,B,Be]}),e[82]=ke,e[83]=X,e[84]=S,e[85]=R,e[86]=B,e[87]=Be,e[88]=nt):nt=e[88],nt}function _f(t){return t.stopPropagation()}function jf(t){const[e,s]=t;return r.jsxs("li",{children:[r.jsxs("span",{className:"query-param-key",children:[e,":"]}),r.jsx("span",{className:"query-param-value",children:s})]},e)}function yf(t){return t.stopPropagation()}function bf(t){return r.jsxs("tr",{children:[r.jsx("td",{className:"ad-id",children:r.jsx("code",{children:t.adsid})}),r.jsx("td",{className:"ad-title",children:t.title}),r.jsx("td",{className:"ad-status",children:r.jsx("span",{className:"status-badge",style:{backgroundColor:cf(t.status)},children:of(t.status)})}),r.jsx("td",{className:"ad-time",children:Xt(t.impressionTime)}),r.jsx("td",{className:"ad-time",children:Xt(t.clickTime)})]},t.adsid)}function Sf(t){return t.status===Se.CLICKED}function wf(t){return t.status===Se.CLICKED}function $f(t){return t.status===Se.IMPRESSED||t.status===Se.CLICKED}function Cf(){confirm("모든 광고 트래킹 데이터를 삭제하시겠습니까?")&&window.location.reload()}function Nf(t,e){return e.timestamp-t.timestamp}function kf(t,e){return e.timestamp-t.timestamp}function Ef(t,e){const s=t.requestTime||t.impressionTime||t.clickTime||0;return(e.requestTime||e.impressionTime||e.clickTime||0)-s}const Tf=bt(t=>({flows:t.flows.list}))(vf);function Rf(){const t=E.c(4),e=F(Df),s=F(If),i=F(Af);let l;return t[0]!==i||t[1]!==s||t[2]!==e?(l=r.jsx("div",{className:"main-view",children:i===me.Capture?r.jsx(Lu,{}):i===me.Metrics?r.jsx(rf,{}):i===me.AdTracking?r.jsx(Tf,{}):r.jsxs(r.Fragment,{children:[s?r.jsx(Wd,{}):r.jsx(zd,{}),e&&r.jsxs(r.Fragment,{children:[r.jsx(Md,{},"splitter"),r.jsx(Dd,{},"flowDetails")]})]})}),t[0]=i,t[1]=s,t[2]=e,t[3]=l):l=t[3],l}function Af(t){return t.ui.tabs.current}function If(t){return t.flows.list.length>0}function Df(t){return t.flows.selected.length===1}function yt(t){const e=E.c(2),{children:s}=t;let i;return e[0]!==s?(i=window.MITMWEB_STATIC?null:r.jsx(r.Fragment,{children:s}),e[0]=s,e[1]=i):i=e[1],i}const Ff=M.memo(function(){const e=E.c(20),s=Z(),i=F(Lf);let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l={placement:"bottom-start"},e[0]=l):l=e[0];let n;e[1]!==s?(n=r.jsx("li",{children:r.jsx(tl,{icon:"fa-folder-open",text:" Open...",onClick:Pf,onOpenFile:b=>{s(Ac(b)),document.body.click()}})}),e[1]=s,e[2]=n):n=e[2];let o;e[3]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsxs(He,{onClick:Mf,children:[r.jsx("i",{className:"fa fa-fw fa-floppy-o"})," Save"]}),e[3]=o):o=e[3];let a;e[4]!==i?(a=()=>location.replace("/flows/dump?filter="+i),e[4]=i,e[5]=a):a=e[5];let d;e[6]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx("i",{className:"fa fa-fw fa-floppy-o"}),e[6]=d):d=e[6];let u;e[7]!==a?(u=r.jsxs(He,{onClick:a,children:[d," Save filtered"]}),e[7]=a,e[8]=u):u=e[8];let h;e[9]!==s?(h=()=>confirm("Delete all flows?")&&s(rr()),e[9]=s,e[10]=h):h=e[10];let p;e[11]===Symbol.for("react.memo_cache_sentinel")?(p=r.jsx("i",{className:"fa fa-fw fa-trash"}),e[11]=p):p=e[11];let g;e[12]!==h?(g=r.jsxs(He,{onClick:h,children:[p," Clear All"]}),e[12]=h,e[13]=g):g=e[13];let x;e[14]===Symbol.for("react.memo_cache_sentinel")?(x=r.jsx(rd,{}),e[14]=x):x=e[14];let j;e[15]===Symbol.for("react.memo_cache_sentinel")?(j=r.jsxs(yt,{children:[x,r.jsx("li",{children:r.jsxs("a",{href:"http://mitm.it/",target:"_blank",rel:"noreferrer",children:[r.jsx("i",{className:"fa fa-fw fa-external-link"})," Install Certificates..."]})})]}),e[15]=j):j=e[15];let y;return e[16]!==n||e[17]!==u||e[18]!==g?(y=r.jsxs(Lt,{className:"pull-left special",text:"File",options:l,children:[n,o,u,g,j]}),e[16]=n,e[17]=u,e[18]=g,e[19]=y):y=e[19],y});function Lf(t){return t.ui.filter[Ae.Search]}function Pf(t){return t.stopPropagation()}function Mf(){return location.replace("/flows/dump")}const qf=M.memo(function(){const e=E.c(5),s=F(Of),i=F(Hf);switch(s){case Et.INIT:{let l;return e[0]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("span",{className:"connection-indicator init",children:"connecting…"}),e[0]=l):l=e[0],l}case Et.FETCHING:{let l;return e[1]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("span",{className:"connection-indicator fetching",children:"fetching data…"}),e[1]=l):l=e[1],l}case Et.ESTABLISHED:{let l;return e[2]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("span",{className:"connection-indicator established",children:"connected"}),e[2]=l):l=e[2],l}case Et.ERROR:{let l;return e[3]!==i?(l=r.jsx("span",{className:"connection-indicator error",title:i,children:"connection lost"}),e[3]=i,e[4]=l):l=e[4],l}default:It(s)}});function Of(t){return t.connection.state}function Hf(t){return t.connection.message}yl.title="Capture";function yl(){const t=E.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=r.jsx(r.Fragment,{}),t[0]=e):e=t[0],e}const $i=function(){function t(i,l){function n(){this.constructor=i}n.prototype=l.prototype,i.prototype=new n}function e(i,l,n,o){this.message=i,this.expected=l,this.found=n,this.location=o,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,e)}t(e,Error);function s(i){var l=arguments.length>1?arguments[1]:{},n={},o={start:In},a=In,d={type:"other",description:"filter expression"},u=function(c){return c},h={type:"other",description:"whitespace"},p=/^[ \t\n\r]/,g={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},x={type:"other",description:"control character"},j=/^[|&!()~"]/,y={type:"class",value:'[|&!()~"]',description:'[|&!()~"]'},b={type:"other",description:"optional whitespace"},$="|",N={type:"literal",value:"|",description:'"|"'},k=function(c,f){return Eo(c,f)},T="&",D={type:"literal",value:"&",description:'"&"'},I=function(c,f){return To(c,f)},O="!",q={type:"literal",value:"!",description:'"!"'},U=function(c){return Ro(c)},H="(",W={type:"literal",value:"(",description:'"("'},Q=")",K={type:"literal",value:")",description:'")"'},G=function(c){return Ao(c)},Y="~all",ee={type:"literal",value:"~all",description:'"~all"'},te=function(){return Mn},se="~a",ue={type:"literal",value:"~a",description:'"~a"'},fe=function(){return On},ve="~b",ke={type:"literal",value:"~b",description:'"~b"'},Re=function(c){return Io(c)},ge="~bq",we={type:"literal",value:"~bq",description:'"~bq"'},C=function(c){return Do(c)},ae="~bs",z={type:"literal",value:"~bs",description:'"~bs"'},ie=function(c){return Fo(c)},V="~c",_e={type:"literal",value:"~c",description:'"~c"'},Ee=function(c){return Lo(c)},$e="~comment",X={type:"literal",value:"~comment",description:'"~comment"'},Fe=function(c){return Po(c)},Te="~d",ne={type:"literal",value:"~d",description:'"~d"'},de=function(c){return Mo(c)},he="~dns",je={type:"literal",value:"~dns",description:'"~dns"'},Ue=function(){return Hn},qe="~dst",Qe={type:"literal",value:"~dst",description:'"~dst"'},S=function(c){return qo(c)},w="~e",R={type:"literal",value:"~e",description:'"~e"'},B=function(){return Vn},Be="~h",nt={type:"literal",value:"~h",description:'"~h"'},L=function(c){return Oo(c)},re="~hq",Ce={type:"literal",value:"~hq",description:'"~hq"'},Le=function(c){return Ho(c)},St="~hs",Pt={type:"literal",value:"~hs",description:'"~hs"'},dt=function(c){return Vo(c)},Mt="~http",xt={type:"literal",value:"~http",description:'"~http"'},Ke=function(){return Un},nn="~marked",kl={type:"literal",value:"~marked",description:'"~marked"'},El=function(){return Bn},rn="~marker",Tl={type:"literal",value:"~marker",description:'"~marker"'},Rl=function(c){return Uo(c)},ln="~m",Al={type:"literal",value:"~m",description:'"~m"'},Il=function(c){return Bo(c)},on="~q",Dl={type:"literal",value:"~q",description:'"~q"'},Fl=function(){return Kn},cn="~replayq",Ll={type:"literal",value:"~replayq",description:'"~replayq"'},Pl=function(){return Wn},an="~replays",Ml={type:"literal",value:"~replays",description:'"~replays"'},ql=function(){return zn},dn="~replay",Ol={type:"literal",value:"~replay",description:'"~replay"'},Hl=function(){return Qn},un="~src",Vl={type:"literal",value:"~src",description:'"~src"'},Ul=function(c){return Ko(c)},fn="~s",Bl={type:"literal",value:"~s",description:'"~s"'},Kl=function(){return Gn},pn="~tcp",Wl={type:"literal",value:"~tcp",description:'"~tcp"'},zl=function(){return Yn},hn="~udp",Ql={type:"literal",value:"~udp",description:'"~udp"'},Gl=function(){return Jn},mn="~tq",Yl={type:"literal",value:"~tq",description:'"~tq"'},Jl=function(c){return Wo(c)},gn="~ts",Xl={type:"literal",value:"~ts",description:'"~ts"'},Zl=function(c){return zo(c)},xn="~t",eo={type:"literal",value:"~t",description:'"~t"'},to=function(c){return Qo(c)},vn="~u",so={type:"literal",value:"~u",description:'"~u"'},_n=function(c){return Go(c)},jn="~websocket",no={type:"literal",value:"~websocket",description:'"~websocket"'},io=function(){return Xn},ro={type:"other",description:"integer"},yn=/^['"]/,bn={type:"class",value:`['"]`,description:`['"]`},Sn=/^[0-9]/,wn={type:"class",value:"[0-9]",description:"[0-9]"},lo=function(c){return parseInt(c.join(""),10)},oo={type:"other",description:"string"},$n='"',Cn={type:"literal",value:'"',description:'"\\""'},ls=function(c){return c.join("")},Nn="'",kn={type:"literal",value:"'",description:`"'"`},co=/^["\\]/,ao={type:"class",value:'["\\\\]',description:'["\\\\]'},os={type:"any",description:"any character"},wt=function(c){return c},En="\\",Tn={type:"literal",value:"\\",description:'"\\\\"'},uo=/^['\\]/,fo={type:"class",value:"['\\\\]",description:"['\\\\]"},po=/^['"\\]/,ho={type:"class",value:`['"\\\\]`,description:`['"\\\\]`},mo="n",go={type:"literal",value:"n",description:'"n"'},xo=function(){return`
`},vo="r",_o={type:"literal",value:"r",description:'"r"'},jo=function(){return"\r"},yo="t",bo={type:"literal",value:"t",description:'"t"'},So=function(){return"	"},m=0,qt=[{line:1,column:1,seenCR:!1}],Ge=0,cs=[],A=0,Ot;if("startRule"in l){if(!(l.startRule in o))throw new Error(`Can't start parsing from rule "`+l.startRule+'".');a=o[l.startRule]}function Rn(c){var f=qt[c],v,_;if(f)return f;for(v=c-1;!qt[v];)v--;for(f=qt[v],f={line:f.line,column:f.column,seenCR:f.seenCR};v<c;)_=i.charAt(v),_===`
`?(f.seenCR||f.line++,f.column=1,f.seenCR=!1):_==="\r"||_==="\u2028"||_==="\u2029"?(f.line++,f.column=1,f.seenCR=!0):(f.column++,f.seenCR=!1),v++;return qt[c]=f,f}function An(c,f){var v=Rn(c),_=Rn(f);return{start:{offset:c,line:v.line,column:v.column},end:{offset:f,line:_.line,column:_.column}}}function P(c){m<Ge||(m>Ge&&(Ge=m,cs=[]),cs.push(c))}function wo(c,f,v,_){function Ye(We){var it=1;for(We.sort(function(Ut,ut){return Ut.description<ut.description?-1:Ut.description>ut.description?1:0});it<We.length;)We[it-1]===We[it]?We.splice(it,1):it++}function Oe(We,it){function Ut(Yo){function Bt(tt){return tt.charCodeAt(0).toString(16).toUpperCase()}return Yo.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(tt){return"\\x0"+Bt(tt)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(tt){return"\\x"+Bt(tt)}).replace(/[\u0100-\u0FFF]/g,function(tt){return"\\u0"+Bt(tt)}).replace(/[\u1000-\uFFFF]/g,function(tt){return"\\u"+Bt(tt)})}var ut=new Array(We.length),Zn,ei,$t;for($t=0;$t<We.length;$t++)ut[$t]=We[$t].description;return Zn=We.length>1?ut.slice(0,-1).join(", ")+" or "+ut[We.length-1]:ut[0],ei=it?'"'+Ut(it)+'"':"end of input","Expected "+Zn+" but "+ei+" found."}return f!==null&&Ye(f),new e(Oe(f,v),f,v,_)}function In(){var c,f,v,_;return A++,c=m,f=et(),f!==n?(v=as(),v!==n?(_=et(),_!==n?(f=u(v),c=f):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),A--,c===n&&(f=n,A===0&&P(d)),c}function J(){var c;return A++,p.test(i.charAt(m))?(c=i.charAt(m),m++):(c=n,A===0&&P(g)),A--,c===n&&A===0&&P(h),c}function $o(){var c;return A++,j.test(i.charAt(m))?(c=i.charAt(m),m++):(c=n,A===0&&P(y)),A--,c===n&&A===0&&P(x),c}function et(){var c,f;for(A++,c=[],f=J();f!==n;)c.push(f),f=J();return A--,c===n&&(f=n,A===0&&P(b)),c}function as(){var c,f,v,_,Ye,Oe;return c=m,f=Ht(),f!==n?(v=et(),v!==n?(i.charCodeAt(m)===124?(_=$,m++):(_=n,A===0&&P(N)),_!==n?(Ye=et(),Ye!==n?(Oe=as(),Oe!==n?(f=k(f,Oe),c=f):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),c===n&&(c=Ht()),c}function Ht(){var c,f,v,_,Ye,Oe;if(c=m,f=Vt(),f!==n?(v=et(),v!==n?(i.charCodeAt(m)===38?(_=T,m++):(_=n,A===0&&P(D)),_!==n?(Ye=et(),Ye!==n?(Oe=Ht(),Oe!==n?(f=I(f,Oe),c=f):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),c===n){if(c=m,f=Vt(),f!==n){if(v=[],_=J(),_!==n)for(;_!==n;)v.push(_),_=J();else v=n;v!==n?(_=Ht(),_!==n?(f=I(f,_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;c===n&&(c=Vt())}return c}function Vt(){var c,f,v,_;return c=m,i.charCodeAt(m)===33?(f=O,m++):(f=n,A===0&&P(q)),f!==n?(v=et(),v!==n?(_=Vt(),_!==n?(f=U(_),c=f):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),c===n&&(c=Co()),c}function Co(){var c,f,v,_,Ye,Oe;return c=m,i.charCodeAt(m)===40?(f=H,m++):(f=n,A===0&&P(W)),f!==n?(v=et(),v!==n?(_=as(),_!==n?(Ye=et(),Ye!==n?(i.charCodeAt(m)===41?(Oe=Q,m++):(Oe=n,A===0&&P(K)),Oe!==n?(f=G(_),c=f):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),c===n&&(c=No()),c}function No(){var c,f,v,_;if(c=m,i.substr(m,4)===Y?(f=Y,m+=4):(f=n,A===0&&P(ee)),f!==n&&(f=te()),c=f,c===n&&(c=m,i.substr(m,2)===se?(f=se,m+=2):(f=n,A===0&&P(ue)),f!==n&&(f=fe()),c=f,c===n)){if(c=m,i.substr(m,2)===ve?(f=ve,m+=2):(f=n,A===0&&P(ke)),f!==n){if(v=[],_=J(),_!==n)for(;_!==n;)v.push(_),_=J();else v=n;v!==n?(_=Ne(),_!==n?(f=Re(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===ge?(f=ge,m+=3):(f=n,A===0&&P(we)),f!==n){if(v=[],_=J(),_!==n)for(;_!==n;)v.push(_),_=J();else v=n;v!==n?(_=Ne(),_!==n?(f=C(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===ae?(f=ae,m+=3):(f=n,A===0&&P(z)),f!==n){if(v=[],_=J(),_!==n)for(;_!==n;)v.push(_),_=J();else v=n;v!==n?(_=Ne(),_!==n?(f=ie(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===V?(f=V,m+=2):(f=n,A===0&&P(_e)),f!==n){if(v=[],_=J(),_!==n)for(;_!==n;)v.push(_),_=J();else v=n;v!==n?(_=ko(),_!==n?(f=Ee(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,8)===$e?(f=$e,m+=8):(f=n,A===0&&P(X)),f!==n){if(v=[],_=J(),_!==n)for(;_!==n;)v.push(_),_=J();else v=n;v!==n?(_=Ne(),_!==n?(f=Fe(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===Te?(f=Te,m+=2):(f=n,A===0&&P(ne)),f!==n){if(v=[],_=J(),_!==n)for(;_!==n;)v.push(_),_=J();else v=n;v!==n?(_=Ne(),_!==n?(f=de(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,4)===he?(f=he,m+=4):(f=n,A===0&&P(je)),f!==n&&(f=Ue()),c=f,c===n)){if(c=m,i.substr(m,4)===qe?(f=qe,m+=4):(f=n,A===0&&P(Qe)),f!==n){if(v=[],_=J(),_!==n)for(;_!==n;)v.push(_),_=J();else v=n;v!==n?(_=Ne(),_!==n?(f=S(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,2)===w?(f=w,m+=2):(f=n,A===0&&P(R)),f!==n&&(f=B()),c=f,c===n)){if(c=m,i.substr(m,2)===Be?(f=Be,m+=2):(f=n,A===0&&P(nt)),f!==n){if(v=[],_=J(),_!==n)for(;_!==n;)v.push(_),_=J();else v=n;v!==n?(_=Ne(),_!==n?(f=L(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===re?(f=re,m+=3):(f=n,A===0&&P(Ce)),f!==n){if(v=[],_=J(),_!==n)for(;_!==n;)v.push(_),_=J();else v=n;v!==n?(_=Ne(),_!==n?(f=Le(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===St?(f=St,m+=3):(f=n,A===0&&P(Pt)),f!==n){if(v=[],_=J(),_!==n)for(;_!==n;)v.push(_),_=J();else v=n;v!==n?(_=Ne(),_!==n?(f=dt(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,5)===Mt?(f=Mt,m+=5):(f=n,A===0&&P(xt)),f!==n&&(f=Ke()),c=f,c===n&&(c=m,i.substr(m,7)===nn?(f=nn,m+=7):(f=n,A===0&&P(kl)),f!==n&&(f=El()),c=f,c===n))){if(c=m,i.substr(m,7)===rn?(f=rn,m+=7):(f=n,A===0&&P(Tl)),f!==n){if(v=[],_=J(),_!==n)for(;_!==n;)v.push(_),_=J();else v=n;v!==n?(_=Ne(),_!==n?(f=Rl(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===ln?(f=ln,m+=2):(f=n,A===0&&P(Al)),f!==n){if(v=[],_=J(),_!==n)for(;_!==n;)v.push(_),_=J();else v=n;v!==n?(_=Ne(),_!==n?(f=Il(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,2)===on?(f=on,m+=2):(f=n,A===0&&P(Dl)),f!==n&&(f=Fl()),c=f,c===n&&(c=m,i.substr(m,8)===cn?(f=cn,m+=8):(f=n,A===0&&P(Ll)),f!==n&&(f=Pl()),c=f,c===n&&(c=m,i.substr(m,8)===an?(f=an,m+=8):(f=n,A===0&&P(Ml)),f!==n&&(f=ql()),c=f,c===n&&(c=m,i.substr(m,7)===dn?(f=dn,m+=7):(f=n,A===0&&P(Ol)),f!==n&&(f=Hl()),c=f,c===n))))){if(c=m,i.substr(m,4)===un?(f=un,m+=4):(f=n,A===0&&P(Vl)),f!==n){if(v=[],_=J(),_!==n)for(;_!==n;)v.push(_),_=J();else v=n;v!==n?(_=Ne(),_!==n?(f=Ul(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,2)===fn?(f=fn,m+=2):(f=n,A===0&&P(Bl)),f!==n&&(f=Kl()),c=f,c===n&&(c=m,i.substr(m,4)===pn?(f=pn,m+=4):(f=n,A===0&&P(Wl)),f!==n&&(f=zl()),c=f,c===n&&(c=m,i.substr(m,4)===hn?(f=hn,m+=4):(f=n,A===0&&P(Ql)),f!==n&&(f=Gl()),c=f,c===n)))){if(c=m,i.substr(m,3)===mn?(f=mn,m+=3):(f=n,A===0&&P(Yl)),f!==n){if(v=[],_=J(),_!==n)for(;_!==n;)v.push(_),_=J();else v=n;v!==n?(_=Ne(),_!==n?(f=Jl(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===gn?(f=gn,m+=3):(f=n,A===0&&P(Xl)),f!==n){if(v=[],_=J(),_!==n)for(;_!==n;)v.push(_),_=J();else v=n;v!==n?(_=Ne(),_!==n?(f=Zl(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===xn?(f=xn,m+=2):(f=n,A===0&&P(eo)),f!==n){if(v=[],_=J(),_!==n)for(;_!==n;)v.push(_),_=J();else v=n;v!==n?(_=Ne(),_!==n?(f=to(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===vn?(f=vn,m+=2):(f=n,A===0&&P(so)),f!==n){if(v=[],_=J(),_!==n)for(;_!==n;)v.push(_),_=J();else v=n;v!==n?(_=Ne(),_!==n?(f=_n(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;c===n&&(c=m,i.substr(m,10)===jn?(f=jn,m+=10):(f=n,A===0&&P(no)),f!==n&&(f=io()),c=f,c===n&&(c=m,f=Ne(),f!==n&&(f=_n(f)),c=f))}}}}}}}}}}}}}}}}}return c}function ko(){var c,f,v,_;if(A++,c=m,yn.test(i.charAt(m))?(f=i.charAt(m),m++):(f=n,A===0&&P(bn)),f===n&&(f=null),f!==n){if(v=[],Sn.test(i.charAt(m))?(_=i.charAt(m),m++):(_=n,A===0&&P(wn)),_!==n)for(;_!==n;)v.push(_),Sn.test(i.charAt(m))?(_=i.charAt(m),m++):(_=n,A===0&&P(wn));else v=n;v!==n?(yn.test(i.charAt(m))?(_=i.charAt(m),m++):(_=n,A===0&&P(bn)),_===n&&(_=null),_!==n?(f=lo(v),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;return A--,c===n&&(f=n,A===0&&P(ro)),c}function Ne(){var c,f,v,_;if(A++,c=m,i.charCodeAt(m)===34?(f=$n,m++):(f=n,A===0&&P(Cn)),f!==n){for(v=[],_=Dn();_!==n;)v.push(_),_=Dn();v!==n?(i.charCodeAt(m)===34?(_=$n,m++):(_=n,A===0&&P(Cn)),_!==n?(f=ls(v),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.charCodeAt(m)===39?(f=Nn,m++):(f=n,A===0&&P(kn)),f!==n){for(v=[],_=Fn();_!==n;)v.push(_),_=Fn();v!==n?(i.charCodeAt(m)===39?(_=Nn,m++):(_=n,A===0&&P(kn)),_!==n?(f=ls(v),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n)if(c=m,f=m,A++,v=$o(),A--,v===n?f=void 0:(m=f,f=n),f!==n){if(v=[],_=Ln(),_!==n)for(;_!==n;)v.push(_),_=Ln();else v=n;v!==n?(f=ls(v),c=f):(m=c,c=n)}else m=c,c=n}return A--,c===n&&(f=n,A===0&&P(oo)),c}function Dn(){var c,f,v;return c=m,f=m,A++,co.test(i.charAt(m))?(v=i.charAt(m),m++):(v=n,A===0&&P(ao)),A--,v===n?f=void 0:(m=f,f=n),f!==n?(i.length>m?(v=i.charAt(m),m++):(v=n,A===0&&P(os)),v!==n?(f=wt(v),c=f):(m=c,c=n)):(m=c,c=n),c===n&&(c=m,i.charCodeAt(m)===92?(f=En,m++):(f=n,A===0&&P(Tn)),f!==n?(v=Pn(),v!==n?(f=wt(v),c=f):(m=c,c=n)):(m=c,c=n)),c}function Fn(){var c,f,v;return c=m,f=m,A++,uo.test(i.charAt(m))?(v=i.charAt(m),m++):(v=n,A===0&&P(fo)),A--,v===n?f=void 0:(m=f,f=n),f!==n?(i.length>m?(v=i.charAt(m),m++):(v=n,A===0&&P(os)),v!==n?(f=wt(v),c=f):(m=c,c=n)):(m=c,c=n),c===n&&(c=m,i.charCodeAt(m)===92?(f=En,m++):(f=n,A===0&&P(Tn)),f!==n?(v=Pn(),v!==n?(f=wt(v),c=f):(m=c,c=n)):(m=c,c=n)),c}function Ln(){var c,f,v;return c=m,f=m,A++,v=J(),A--,v===n?f=void 0:(m=f,f=n),f!==n?(i.length>m?(v=i.charAt(m),m++):(v=n,A===0&&P(os)),v!==n?(f=wt(v),c=f):(m=c,c=n)):(m=c,c=n),c}function Pn(){var c,f;return po.test(i.charAt(m))?(c=i.charAt(m),m++):(c=n,A===0&&P(ho)),c===n&&(c=m,i.charCodeAt(m)===110?(f=mo,m++):(f=n,A===0&&P(go)),f!==n&&(f=xo()),c=f,c===n&&(c=m,i.charCodeAt(m)===114?(f=vo,m++):(f=n,A===0&&P(_o)),f!==n&&(f=jo()),c=f,c===n&&(c=m,i.charCodeAt(m)===116?(f=yo,m++):(f=n,A===0&&P(bo)),f!==n&&(f=So()),c=f))),c}function Eo(c,f){function v(){return c.apply(this,arguments)||f.apply(this,arguments)}return v.desc=c.desc+" or "+f.desc,v}function To(c,f){function v(){return c.apply(this,arguments)&&f.apply(this,arguments)}return v.desc=c.desc+" and "+f.desc,v}function Ro(c){function f(){return!c.apply(this,arguments)}return f.desc="not "+c.desc,f}function Ao(c){function f(){return c.apply(this,arguments)}return f.desc="("+c.desc+")",f}function Mn(c){return!0}Mn.desc="all flows";var qn=[new RegExp("text/javascript"),new RegExp("application/x-javascript"),new RegExp("application/javascript"),new RegExp("text/css"),new RegExp("image/.*"),new RegExp("font/.*"),new RegExp("application/font.*")];function On(c){if(c.response){for(var f=jt.getContentType(c.response),v=qn.length;v--;)if(qn[v].test(f))return!0}return!1}On.desc="is asset";function Io(c){c=new RegExp(c,"i");function f(v){return!0}return f.desc="body matches "+c,f}function Do(c){c=new RegExp(c,"i");function f(v){return!0}return f.desc="body request matches "+c,f}function Fo(c){c=new RegExp(c,"i");function f(v){return!0}return f.desc="body response matches "+c,f}function Lo(c){function f(v){return v.response&&v.response.status_code===c}return f.desc="resp. code is "+c,f}function Po(c){c=new RegExp(c,"i");function f(v){return c.test(v.comment)}return f.desc="comment matches "+c,f}function Mo(c){c=new RegExp(c,"i");function f(v){return v.request&&(c.test(v.request.host)||c.test(v.request.pretty_host))}return f.desc="domain matches "+c,f}function Hn(c){return c.type==="dns"}Hn.desc="is a DNS Flow";function qo(c){c=new RegExp(c,"i");function f(v){return!!v.server_conn.address&&c.test(v.server_conn.address[0]+":"+v.server_conn.address[1])}return f.desc="destination address matches "+c,f}function Vn(c){return!!c.error}Vn.desc="has error";function Oo(c){c=new RegExp(c,"i");function f(v){return v.request&&ht.match_header(v.request,c)||v.response&&jt.match_header(v.response,c)}return f.desc="header matches "+c,f}function Ho(c){c=new RegExp(c,"i");function f(v){return v.request&&ht.match_header(v.request,c)}return f.desc="req. header matches "+c,f}function Vo(c){c=new RegExp(c,"i");function f(v){return v.response&&jt.match_header(v.response,c)}return f.desc="resp. header matches "+c,f}function Un(c){return c.type==="http"}Un.desc="is an HTTP Flow";function Bn(c){return c.marked}Bn.desc="is marked";function Uo(c){c=new RegExp(c,"i");function f(v){return c.test(v.marked)}return f.desc="marker matches "+c,f}function Bo(c){c=new RegExp(c,"i");function f(v){return v.request&&c.test(v.request.method)}return f.desc="method matches "+c,f}function Kn(c){return c.request&&!c.response}Kn.desc="has no response";function Wn(c){return c.is_replay==="request"}Wn.desc="request has been replayed";function zn(c){return c.is_replay==="response"}zn.desc="response has been replayed";function Qn(c){return!!c.is_replay}Qn.desc="flow has been replayed";function Ko(c){c=new RegExp(c,"i");function f(v){return!!v.client_conn.peername&&c.test(v.client_conn.peername[0]+":"+v.client_conn.peername[1])}return f.desc="source address matches "+c,f}function Gn(c){return!!c.response}Gn.desc="has response";function Yn(c){return c.type==="tcp"}Yn.desc="is a TCP Flow";function Jn(c){return c.type==="udp"}Jn.desc="is a UDP Flow";function Wo(c){c=new RegExp(c,"i");function f(v){return v.request&&c.test(ht.getContentType(v.request))}return f.desc="req. content type matches "+c,f}function zo(c){c=new RegExp(c,"i");function f(v){return v.response&&c.test(jt.getContentType(v.response))}return f.desc="resp. content type matches "+c,f}function Qo(c){c=new RegExp(c,"i");function f(v){return v.request&&c.test(ht.getContentType(v.request))||v.response&&c.test(jt.getContentType(v.response))}return f.desc="content type matches "+c,f}function Go(c){c=new RegExp(c,"i");function f(v){if(v.type==="dns"){const _=v.request?.questions[0];return _&&c.test(_.name)}return v.request&&c.test(ht.pretty_url(v.request))}return f.desc="url matches "+c,f}function Xn(c){return!!c.websocket}if(Xn.desc="is a Websocket Flow",Ot=a(),Ot!==n&&m===i.length)return Ot;throw Ot!==n&&m<i.length&&P({type:"end",description:"end of input"}),wo(null,cs,Ge<i.length?i.charAt(Ge):null,Ge<i.length?An(Ge,Ge+1):An(Ge,Ge))}return{SyntaxError:e,parse:s}}();class st extends M.Component{static xhr;static doc;constructor(e,s){super(e,s),this.state={doc:st.doc}}componentDidMount(){st.xhr||(st.xhr=oe("/filter-help").then(e=>e.json()),st.xhr.catch(()=>{st.xhr=null})),this.state.doc||st.xhr.then(e=>{st.doc=e,this.setState({doc:e})})}render(){const{doc:e}=this.state;return e?r.jsx("table",{className:"table table-condensed",children:r.jsxs("tbody",{children:[e.commands.map(s=>r.jsxs("tr",{onClick:()=>this.props.selectHandler(s[0].split(" ")[0]+" "),children:[r.jsx("td",{children:s[0].replace(" "," ")}),r.jsx("td",{children:s[1]})]},s[1])),r.jsx("tr",{children:r.jsx("td",{colSpan:2,children:r.jsxs("a",{href:"https://mitmproxy.org/docs/latest/concepts-filters/",target:"_blank",rel:"noreferrer",children:[r.jsx("i",{className:"fa fa-external-link"}),"  mitmproxy docs"]})})},"docs-link")]})}):r.jsx("i",{className:"fa fa-spinner fa-spin"})}}var rs=(t=>(t.SEARCH="search",t.HIGHLIGHT="tag",t.INTERCEPT="pause",t))(rs||{});class tn extends M.Component{inputRef=ye.createRef();constructor(e,s){super(e,s),this.state={value:this.props.value,focus:!1,mousefocus:!1},this.onChange=this.onChange.bind(this),this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.selectFilter=this.selectFilter.bind(this)}UNSAFE_componentWillReceiveProps(e){this.setState({value:e.value})}isValid(e){try{return e&&$i.parse(e),!0}catch{return!1}}getDesc(){if(!this.state.value)return r.jsx(st,{selectHandler:this.selectFilter});try{return $i.parse(this.state.value).desc}catch(e){return""+e}}onChange(e){const s=e.target.value;this.setState({value:s}),this.isValid(s)&&this.props.onChange(s)}onFocus(){this.setState({focus:!0})}onBlur(){this.setState({focus:!1})}onMouseEnter(){this.setState({mousefocus:!0})}onMouseLeave(){this.setState({mousefocus:!1})}onKeyDown(e){(e.key==="Escape"||e.key==="Enter")&&(this.blur(),this.setState({mousefocus:!1})),e.stopPropagation()}selectFilter(e){this.setState({value:e}),this.inputRef.current?.focus()}blur(){this.inputRef.current?.blur()}select(){this.inputRef.current?.select()}render(){const{icon:e,color:s,placeholder:i}=this.props,{value:l,focus:n,mousefocus:o}=this.state;return r.jsxs("div",{className:De("filter-input input-group",{"has-error":!this.isValid(l)}),children:[r.jsx("span",{className:"input-group-addon",children:r.jsx("i",{className:"fa fa-fw fa-"+e,style:{color:s}})}),r.jsx("input",{type:"text",ref:this.inputRef,placeholder:i,className:"form-control",value:l,onChange:this.onChange,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown}),(n||o)&&r.jsxs("div",{className:"popover bottom",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[r.jsx("div",{className:"arrow"}),r.jsx("div",{className:"popover-content",children:this.getDesc()})]})]})}}bl.title="Flow List";function bl(){const t=E.c(2);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=r.jsxs("div",{className:"menu-group",children:[r.jsxs("div",{className:"menu-content",children:[r.jsx(Bf,{}),r.jsx(Wf,{})]}),r.jsx("div",{className:"menu-legend",children:"Find"})]}),t[0]=e):e=t[0];let s;return t[1]===Symbol.for("react.memo_cache_sentinel")?(s=r.jsxs("div",{className:"main-menu",children:[e,r.jsxs("div",{className:"menu-group",children:[r.jsxs("div",{className:"menu-content",children:[r.jsx(Vf,{}),r.jsx(Qf,{})]}),r.jsx("div",{className:"menu-legend",children:"Intercept"})]})]}),t[1]=s):s=t[1],s}function Vf(){const t=E.c(5),e=Z(),i=F(Uf)||"";let l;t[0]!==e?(l=o=>e(Ps("intercept",o)),t[0]=e,t[1]=l):l=t[1];let n;return t[2]!==i||t[3]!==l?(n=r.jsx(tn,{value:i,placeholder:"Intercept",icon:rs.INTERCEPT,color:"hsl(208, 56%, 53%)",onChange:l}),t[2]=i,t[3]=l,t[4]=n):n=t[4],n}function Uf(t){return t.options.intercept}function Bf(){const t=E.c(5),e=Z(),s=F(Kf);let i;t[0]!==e?(i=n=>e(Xi(n)),t[0]=e,t[1]=i):i=t[1];let l;return t[2]!==i||t[3]!==s?(l=r.jsx(tn,{value:s,placeholder:"Search",icon:rs.SEARCH,color:"black",onChange:i}),t[2]=i,t[3]=s,t[4]=l):l=t[4],l}function Kf(t){return t.ui.filter[Ae.Search]}function Wf(){const t=E.c(5),e=Z(),s=F(zf);let i;t[0]!==e?(i=n=>e(Zi(n)),t[0]=e,t[1]=i):i=t[1];let l;return t[2]!==i||t[3]!==s?(l=r.jsx(tn,{value:s,placeholder:"Highlight",icon:rs.HIGHLIGHT,color:"hsl(48, 100%, 50%)",onChange:i}),t[2]=i,t[3]=s,t[4]=l):l=t[4],l}function zf(t){return t.ui.filter[Ae.Highlight]}function Qf(){const t=E.c(2),e=Z();let s;return t[0]!==e?(s=r.jsx(be,{className:"btn-sm",title:"[a]ccept all",icon:"fa-forward text-success",onClick:()=>e(er()),children:"Resume All"}),t[0]=e,t[1]=s):s=t[1],s}function sn(t){const e=E.c(6),{value:s,onChange:i,children:l}=t;let n;e[0]!==i||e[1]!==s?(n=r.jsx("input",{type:"checkbox",checked:s,onChange:i}),e[0]=i,e[1]=s,e[2]=n):n=e[2];let o;return e[3]!==l||e[4]!==n?(o=r.jsx("div",{className:"menu-entry",children:r.jsxs("label",{children:[n,l]})}),e[3]=l,e[4]=n,e[5]=o):o=e[5],o}function hs(t){const e=E.c(10),{name:s,children:i}=t,l=Z();let n;e[0]!==s?(n=h=>h.options[s],e[0]=s,e[1]=n):n=e[1];const o=F(n),a=!!o;let d;e[2]!==l||e[3]!==s||e[4]!==o?(d=()=>l(Ps(s,!o)),e[2]=l,e[3]=s,e[4]=o,e[5]=d):d=e[5];let u;return e[6]!==i||e[7]!==a||e[8]!==d?(u=r.jsx(sn,{value:a,onChange:d,children:i}),e[6]=i,e[7]=a,e[8]=d,e[9]=u):u=e[9],u}function Gf(){const t=E.c(5),e=Z(),s=F(Yf);let i;t[0]!==e?(i=()=>e(es()),t[0]=e,t[1]=i):i=t[1];let l;return t[2]!==i||t[3]!==s?(l=r.jsx(sn,{value:s,onChange:i,children:"Display Event Log"}),t[2]=i,t[3]=s,t[4]=l):l=t[4],l}function Yf(t){return t.eventLog.visible}function Jf(){const t=E.c(5),e=Z(),s=F(Xf);let i;t[0]!==e?(i=()=>e(xr()),t[0]=e,t[1]=i):i=t[1];let l;return t[2]!==i||t[3]!==s?(l=r.jsx(sn,{value:s,onChange:i,children:"Display Command Bar"}),t[2]=i,t[3]=s,t[4]=l):l=t[4],l}function Xf(t){return t.commandBar.visible}function ms(t){const e=E.c(5),{children:s,resource:i}=t,l=`https://docs.mitmproxy.org/stable/${i}`;let n;e[0]!==s?(n=s||r.jsx("i",{className:"fa fa-question-circle"}),e[0]=s,e[1]=n):n=e[1];let o;return e[2]!==n||e[3]!==l?(o=r.jsx("a",{target:"_blank",href:l,rel:"noreferrer",children:n}),e[2]=n,e[3]=l,e[4]=o):o=e[4],o}Sl.title="Options";function Sl(){const t=E.c(16),e=Z(),s=Zf;let i;t[0]!==e?(i=()=>e(s()),t[0]=e,t[1]=i):i=t[1];let l;t[2]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("sup",{children:"alpha"}),t[2]=l):l=t[2];let n;t[3]!==i?(n=r.jsx("div",{className:"menu-content",children:r.jsxs(be,{title:"Open Options",icon:"fa-cogs text-primary",onClick:i,children:["Edit Options ",l]})}),t[3]=i,t[4]=n):n=t[4];let o;t[5]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsx("div",{className:"menu-legend",children:"Options Editor"}),t[5]=o):o=t[5];let a;t[6]!==n?(a=r.jsxs("div",{className:"menu-group",children:[n,o]}),t[6]=n,t[7]=a):a=t[7];let d;t[8]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsxs(hs,{name:"anticache",children:["Strip cache headers"," ",r.jsx(ms,{resource:"overview/features/#anticache"})]}),t[8]=d):d=t[8];let u;t[9]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsxs(hs,{name:"showhost",children:["Use host header for display"," ",r.jsx(ms,{resource:"concepts/options/#showhost"})]}),t[9]=u):u=t[9];let h;t[10]===Symbol.for("react.memo_cache_sentinel")?(h=r.jsxs("div",{className:"menu-group",children:[r.jsxs("div",{className:"menu-content",children:[d,u,r.jsxs(hs,{name:"ssl_insecure",children:["Don't verify server certificates"," ",r.jsx(ms,{resource:"concepts/options/#ssl_insecure"})]})]}),r.jsx("div",{className:"menu-legend",children:"Quick Options"})]}),t[10]=h):h=t[10];let p;t[11]!==a?(p=r.jsxs(yt,{children:[a,h]}),t[11]=a,t[12]=p):p=t[12];let g;t[13]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsxs("div",{className:"menu-group",children:[r.jsxs("div",{className:"menu-content",children:[r.jsx(Gf,{}),r.jsx(Jf,{})]}),r.jsx("div",{className:"menu-legend",children:"View Options"})]}),t[13]=g):g=t[13];let x;return t[14]!==p?(x=r.jsxs("div",{children:[p,g]}),t[14]=p,t[15]=x):x=t[15],x}function Zf(){return Hc("OptionModal")}const kt=async(t,e)=>{const s=(async()=>{const i=await Yt("export",e,`@${t.id}`);if(i.value)return i.value;throw i.error?i.error:i})();try{await Pi(s)}catch(i){alert(i)}};wl.title="Flow";function wl(){const t=E.c(63),e=Z(),s=F(ep),i=s[0];let l;t[0]!==s?(l=s.some(Ts),t[0]=s,t[1]=l):l=t[1];const n=l;if(s.length===0){let te;return t[2]===Symbol.for("react.memo_cache_sentinel")?(te=r.jsx("div",{}),t[2]=te):te=t[2],te}let o;t[3]!==e||t[4]!==s?(o=()=>e(Is(s)),t[3]=e,t[4]=s,t[5]=o):o=t[5];let a;t[6]!==s?(a=s.some(Es),t[6]=s,t[7]=a):a=t[7];const d=!a;let u;t[8]!==o||t[9]!==d?(u=r.jsx(be,{title:"[r]eplay flow",icon:"fa-repeat text-primary",onClick:o,disabled:d,children:"Replay"}),t[8]=o,t[9]=d,t[10]=u):u=t[10];let h;t[11]!==e||t[12]!==s?(h=r.jsx(be,{title:"[D]uplicate flow",icon:"fa-copy text-info",onClick:()=>e(nr(s)),children:"Duplicate"}),t[11]=e,t[12]=s,t[13]=h):h=t[13];let p;t[14]!==s?(p=s.some(Bi),t[14]=s,t[15]=p):p=t[15];const g=!p;let x;t[16]!==e||t[17]!==s?(x=()=>e(ir(s)),t[16]=e,t[17]=s,t[18]=x):x=t[18];let j;t[19]!==g||t[20]!==x?(j=r.jsx(be,{disabled:g,title:"revert changes to flow [V]",icon:"fa-history text-warning",onClick:x,children:"Revert"}),t[19]=g,t[20]=x,t[21]=j):j=t[21];let y;t[22]!==e||t[23]!==s?(y=r.jsx(be,{title:"[d]elete flow",icon:"fa-trash text-danger",onClick:()=>{e(sr(s))},children:"Delete"}),t[22]=e,t[23]=s,t[24]=y):y=t[24];let b;t[25]!==s?(b=r.jsx(ap,{flows:s}),t[25]=s,t[26]=b):b=t[26];let $;t[27]!==y||t[28]!==b||t[29]!==u||t[30]!==h||t[31]!==j?($=r.jsxs("div",{className:"menu-content",children:[u,h,j,y,b]}),t[27]=y,t[28]=b,t[29]=u,t[30]=h,t[31]=j,t[32]=$):$=t[32];let N;t[33]===Symbol.for("react.memo_cache_sentinel")?(N=r.jsx("div",{className:"menu-legend",children:"Flow Modification"}),t[33]=N):N=t[33];let k;t[34]!==$?(k=r.jsx(yt,{children:r.jsxs("div",{className:"menu-group",children:[$,N]})}),t[34]=$,t[35]=k):k=t[35];let T;t[36]!==i?(T=r.jsxs("div",{className:"menu-content",children:[r.jsx(tp,{flow:i}),r.jsx(rp,{flow:i})]}),t[36]=i,t[37]=T):T=t[37];let D;t[38]===Symbol.for("react.memo_cache_sentinel")?(D=r.jsx("div",{className:"menu-legend",children:"Export"}),t[38]=D):D=t[38];let I;t[39]!==T?(I=r.jsxs("div",{className:"menu-group",children:[T,D]}),t[39]=T,t[40]=I):I=t[40];const O=!n;let q;t[41]!==e||t[42]!==s?(q=()=>e(As(s)),t[41]=e,t[42]=s,t[43]=q):q=t[43];let U;t[44]!==O||t[45]!==q?(U=r.jsx(be,{disabled:O,title:"[a]ccept intercepted flow",icon:"fa-play text-success",onClick:q,children:"Resume"}),t[44]=O,t[45]=q,t[46]=U):U=t[46];const H=!n;let W;t[47]!==e||t[48]!==s?(W=()=>e(tr(s)),t[47]=e,t[48]=s,t[49]=W):W=t[49];let Q;t[50]!==H||t[51]!==W?(Q=r.jsx(be,{disabled:H,title:"kill intercepted flow [x]",icon:"fa-times text-danger",onClick:W,children:"Abort"}),t[50]=H,t[51]=W,t[52]=Q):Q=t[52];let K;t[53]!==U||t[54]!==Q?(K=r.jsxs("div",{className:"menu-content",children:[U,Q]}),t[53]=U,t[54]=Q,t[55]=K):K=t[55];let G;t[56]===Symbol.for("react.memo_cache_sentinel")?(G=r.jsx("div",{className:"menu-legend",children:"Interception"}),t[56]=G):G=t[56];let Y;t[57]!==K?(Y=r.jsx(yt,{children:r.jsxs("div",{className:"menu-group",children:[K,G]})}),t[57]=K,t[58]=Y):Y=t[58];let ee;return t[59]!==k||t[60]!==I||t[61]!==Y?(ee=r.jsxs("div",{className:"flow-menu",children:[k,I,Y]}),t[59]=k,t[60]=I,t[61]=Y,t[62]=ee):ee=t[62],ee}function ep(t){return t.flows.selected}const Wt=t=>{const e=window.open(t,"_blank","noopener,noreferrer");e&&(e.opener=null)};function tp(t){const e=E.c(24),{flow:s}=t,i=F(ip);if(s.type!=="http"){let l;return e[0]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx(be,{icon:"fa-download",onClick:np,disabled:!0,children:"Download"}),e[0]=l):l=e[0],l}if(s.request.contentLength&&!s.response?.contentLength){let l;e[1]!==s?(l=()=>Wt(Pe.getContentURL(s,s.request)),e[1]=s,e[2]=l):l=e[2];const n=!i;let o;return e[3]!==l||e[4]!==n?(o=r.jsx(be,{icon:"fa-download",onClick:l,disabled:n,children:"Download"}),e[3]=l,e[4]=n,e[5]=o):o=e[5],o}if(s.response){const l=s.response;if(!s.request.contentLength&&s.response.contentLength){let n;e[6]!==s||e[7]!==l?(n=()=>Wt(Pe.getContentURL(s,l)),e[6]=s,e[7]=l,e[8]=n):n=e[8];const o=!i;let a;return e[9]!==n||e[10]!==o?(a=r.jsx(be,{icon:"fa-download",onClick:n,disabled:o,children:"Download"}),e[9]=n,e[10]=o,e[11]=a):a=e[11],a}if(s.request.contentLength&&s.response.contentLength){const n=!i;let o;e[12]!==n?(o=r.jsx(be,{icon:"fa-download",onClick:sp,disabled:n,children:"Download▾"}),e[12]=n,e[13]=o):o=e[13];let a;e[14]===Symbol.for("react.memo_cache_sentinel")?(a={placement:"bottom-start"},e[14]=a):a=e[14];let d;e[15]!==s?(d=r.jsx(He,{onClick:()=>Wt(Pe.getContentURL(s,s.request)),children:"Download request"}),e[15]=s,e[16]=d):d=e[16];let u;e[17]!==s||e[18]!==l?(u=r.jsx(He,{onClick:()=>Wt(Pe.getContentURL(s,l)),children:"Download response"}),e[17]=s,e[18]=l,e[19]=u):u=e[19];let h;return e[20]!==o||e[21]!==d||e[22]!==u?(h=r.jsxs(Lt,{text:o,options:a,children:[d,u]}),e[20]=o,e[21]=d,e[22]=u,e[23]=h):h=e[23],h}}return null}function sp(){return 1}function np(){return 0}function ip(t){return t.flows.selected.length===1}function rp(t){const e=E.c(20),{flow:s}=t,i=F(op),l=s.type!=="http"||!i;let n;e[0]!==l?(n=r.jsx(be,{title:"Export flow.",icon:"fa-clone",onClick:lp,disabled:l,children:"Export▾"}),e[0]=l,e[1]=n):n=e[1];let o;e[2]===Symbol.for("react.memo_cache_sentinel")?(o={placement:"bottom-start"},e[2]=o):o=e[2];let a;e[3]!==s?(a=r.jsx(He,{onClick:()=>kt(s,"raw_request"),children:"Copy raw request"}),e[3]=s,e[4]=a):a=e[4];let d;e[5]!==s?(d=r.jsx(He,{onClick:()=>kt(s,"raw_response"),children:"Copy raw response"}),e[5]=s,e[6]=d):d=e[6];let u;e[7]!==s?(u=r.jsx(He,{onClick:()=>kt(s,"raw"),children:"Copy raw request and response"}),e[7]=s,e[8]=u):u=e[8];let h;e[9]!==s?(h=r.jsx(He,{onClick:()=>kt(s,"curl"),children:"Copy as cURL"}),e[9]=s,e[10]=h):h=e[10];let p;e[11]!==s?(p=r.jsx(He,{onClick:()=>kt(s,"httpie"),children:"Copy as HTTPie"}),e[11]=s,e[12]=p):p=e[12];let g;return e[13]!==n||e[14]!==a||e[15]!==d||e[16]!==u||e[17]!==h||e[18]!==p?(g=r.jsxs(Lt,{className:"",text:n,options:o,children:[a,d,u,h,p]}),e[13]=n,e[14]=a,e[15]=d,e[16]=u,e[17]=h,e[18]=p,e[19]=g):g=e[19],g}function lp(){return 1}function op(t){return t.flows.selected.length===1}const cp={":red_circle:":"🔴",":orange_circle:":"🟠",":yellow_circle:":"🟡",":green_circle:":"🟢",":large_blue_circle:":"🔵",":purple_circle:":"🟣",":brown_circle:":"🟤"};function ap(t){const e=E.c(5),{flows:s}=t,i=Z();let l,n;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx(be,{title:"mark flow",icon:"fa-paint-brush text-success",onClick:dp,children:"Mark▾"}),n={placement:"bottom-start"},e[0]=l,e[1]=n):(l=e[0],n=e[1]);let o;return e[2]!==i||e[3]!==s?(o=r.jsxs(Lt,{className:"",text:l,options:n,children:[r.jsx(He,{onClick:()=>i(oi(s,"")),children:"⚪ (no marker)"}),Object.entries(cp).map(a=>{const[d,u]=a;return r.jsxs(He,{onClick:()=>i(oi(s,d)),children:[u," ",d.replace(/[:_]/g," ")]},d)})]}),e[2]=i,e[3]=s,e[4]=o):o=e[4],o}function dp(){return 1}function $l(){const t=E.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=r.jsx("div",{className:"menu-row",children:r.jsx("div",{className:"menu-group",children:r.jsx("div",{className:"menu-content",children:r.jsx("span",{className:"menu-legend",children:"📊 Network Metrics Dashboard"})})})}),t[0]=e):e=t[0],e}$l.title="Metrics";function Cl(){const t=E.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=r.jsx("div",{className:"menu-row",children:r.jsx("div",{className:"menu-group",children:r.jsx("div",{className:"menu-content",children:r.jsx("span",{className:"menu-legend",children:"📱 Kidsnote Ad Tracking Analysis"})})})}),t[0]=e):e=t[0],e}Cl.title="Ad Tracking";const Ci={[me.Capture]:yl,[me.FlowList]:bl,[me.Options]:Sl,[me.Flow]:wl,[me.Metrics]:$l,[me.AdTracking]:Cl};function up(){const t=E.c(26),e=Z(),s=F(pp),i=F(fp),[l,n]=M.useState(!1);let o;t[0]!==i.length?(o=[me.Capture,me.FlowList,me.Options,me.Metrics,me.AdTracking],i.length>0&&o.push(me.Flow),t[0]=i.length,t[1]=o):o=t[1];let a;t[2]!==s||t[3]!==e||t[4]!==i.length||t[5]!==l?(a=()=>{i.length>0&&!l?(e(Qt(me.Flow)),n(!0)):i.length===0&&(l&&n(!1),s===me.Flow&&e(Qt(me.FlowList)))},t[2]=s,t[3]=e,t[4]=i.length,t[5]=l,t[6]=a):a=t[6];let d;t[7]!==s||t[8]!==i||t[9]!==l?(d=[i,l,s],t[7]=s,t[8]=i,t[9]=l,t[10]=d):d=t[10],M.useEffect(a,d);let u;t[11]!==e?(u=function(k,T){T.preventDefault(),e(Qt(k))},t[11]=e,t[12]=u):u=t[12];const h=u,p=Ci[s];let g;t[13]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx(Ff,{}),t[13]=g):g=t[13];let x;t[14]!==s||t[15]!==o||t[16]!==h?(x=o.map(N=>r.jsx("a",{href:"#",className:De({active:N===s}),onClick:k=>h(N,k),children:Ci[N].title},N)),t[14]=s,t[15]=o,t[16]=h,t[17]=x):x=t[17];let j;t[18]===Symbol.for("react.memo_cache_sentinel")?(j=r.jsx(yt,{children:r.jsx(qf,{})}),t[18]=j):j=t[18];let y;t[19]!==x?(y=r.jsxs("nav",{className:"nav-tabs nav-tabs-lg",children:[g,x,j]}),t[19]=x,t[20]=y):y=t[20];let b;t[21]!==p?(b=r.jsx("div",{children:r.jsx(p,{})}),t[21]=p,t[22]=b):b=t[22];let $;return t[23]!==y||t[24]!==b?($=r.jsxs("header",{children:[y,b]}),t[23]=y,t[24]=b,t[25]=$):$=t[25],$}function fp(t){return t.flows.selected}function pp(t){return t.ui.tabs.current}const gs=function(){function t(i,l){function n(){this.constructor=i}n.prototype=l.prototype,i.prototype=new n}function e(i,l,n,o){this.message=i,this.expected=l,this.found=n,this.location=o,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,e)}t(e,Error);function s(i){var l=arguments.length>1?arguments[1]:{},n={},o={Expr:Te},a=Te,d=function(S,w){return[S,...w]},u=function(S){return[S]},h=function(){return""},p={type:"other",description:"string"},g='"',x={type:"literal",value:'"',description:'"\\""'},j=function(S){return S.join("")},y="'",b={type:"literal",value:"'",description:`"'"`},$=/^["\\]/,N={type:"class",value:'["\\\\]',description:'["\\\\]'},k={type:"any",description:"any character"},T=function(S){return S},D="\\",I={type:"literal",value:"\\",description:'"\\\\"'},O=/^['\\]/,q={type:"class",value:"['\\\\]",description:"['\\\\]"},U=/^['"\\]/,H={type:"class",value:`['"\\\\]`,description:`['"\\\\]`},W="n",Q={type:"literal",value:"n",description:'"n"'},K=function(){return`
`},G="r",Y={type:"literal",value:"r",description:'"r"'},ee=function(){return"\r"},te="t",se={type:"literal",value:"t",description:'"t"'},ue=function(){return"	"},fe={type:"other",description:"whitespace"},ve=/^[ \t\n\r]/,ke={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},Re={type:"other",description:"control character"},ge=/^[|&!()~"]/,we={type:"class",value:'[|&!()~"]',description:'[|&!()~"]'},C=0,ae=[{line:1,column:1,seenCR:!1}],z=0,ie=[],V=0,_e;if("startRule"in l){if(!(l.startRule in o))throw new Error(`Can't start parsing from rule "`+l.startRule+'".');a=o[l.startRule]}function Ee(S){var w=ae[S],R,B;if(w)return w;for(R=S-1;!ae[R];)R--;for(w=ae[R],w={line:w.line,column:w.column,seenCR:w.seenCR};R<S;)B=i.charAt(R),B===`
`?(w.seenCR||w.line++,w.column=1,w.seenCR=!1):B==="\r"||B==="\u2028"||B==="\u2029"?(w.line++,w.column=1,w.seenCR=!0):(w.column++,w.seenCR=!1),R++;return ae[S]=w,w}function $e(S,w){var R=Ee(S),B=Ee(w);return{start:{offset:S,line:R.line,column:R.column},end:{offset:w,line:B.line,column:B.column}}}function X(S){C<z||(C>z&&(z=C,ie=[]),ie.push(S))}function Fe(S,w,R,B){function Be(L){var re=1;for(L.sort(function(Ce,Le){return Ce.description<Le.description?-1:Ce.description>Le.description?1:0});re<L.length;)L[re-1]===L[re]?L.splice(re,1):re++}function nt(L,re){function Ce(Mt){function xt(Ke){return Ke.charCodeAt(0).toString(16).toUpperCase()}return Mt.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(Ke){return"\\x0"+xt(Ke)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(Ke){return"\\x"+xt(Ke)}).replace(/[\u0100-\u0FFF]/g,function(Ke){return"\\u0"+xt(Ke)}).replace(/[\u1000-\uFFFF]/g,function(Ke){return"\\u"+xt(Ke)})}var Le=new Array(L.length),St,Pt,dt;for(dt=0;dt<L.length;dt++)Le[dt]=L[dt].description;return St=L.length>1?Le.slice(0,-1).join(", ")+" or "+Le[L.length-1]:Le[0],Pt=re?'"'+Ce(re)+'"':"end of input","Expected "+St+" but "+Pt+" found."}return w!==null&&Be(w),new e(nt(w,R),w,R,B)}function Te(){var S,w,R,B;if(S=C,w=ne(),w!==n){if(R=[],B=qe(),B!==n)for(;B!==n;)R.push(B),B=qe();else R=n;R!==n?(B=Te(),B!==n?(w=d(w,B),S=w):(C=S,S=n)):(C=S,S=n)}else C=S,S=n;if(S===n&&(S=C,w=ne(),w!==n&&(w=u(w)),S=w,S===n)){for(S=C,w=[],R=qe();R!==n;)w.push(R),R=qe();w!==n&&(w=h()),S=w}return S}function ne(){var S,w,R,B;if(V++,S=C,i.charCodeAt(C)===34?(w=g,C++):(w=n,V===0&&X(x)),w!==n){for(R=[],B=de();B!==n;)R.push(B),B=de();R!==n?(i.charCodeAt(C)===34?(B=g,C++):(B=n,V===0&&X(x)),B!==n?(w=j(R),S=w):(C=S,S=n)):(C=S,S=n)}else C=S,S=n;if(S===n){if(S=C,i.charCodeAt(C)===39?(w=y,C++):(w=n,V===0&&X(b)),w!==n){for(R=[],B=he();B!==n;)R.push(B),B=he();R!==n?(i.charCodeAt(C)===39?(B=y,C++):(B=n,V===0&&X(b)),B!==n?(w=j(R),S=w):(C=S,S=n)):(C=S,S=n)}else C=S,S=n;if(S===n){if(S=C,w=C,V++,R=Qe(),V--,R===n?w=void 0:(C=w,w=n),w!==n){if(R=[],B=je(),B!==n)for(;B!==n;)R.push(B),B=je();else R=n;R!==n?(w=j(R),S=w):(C=S,S=n)}else C=S,S=n;if(S===n){if(S=C,i.charCodeAt(C)===34?(w=g,C++):(w=n,V===0&&X(x)),w!==n){for(R=[],B=de();B!==n;)R.push(B),B=de();R!==n?(w=j(R),S=w):(C=S,S=n)}else C=S,S=n;if(S===n)if(S=C,i.charCodeAt(C)===39?(w=y,C++):(w=n,V===0&&X(b)),w!==n){for(R=[],B=he();B!==n;)R.push(B),B=he();R!==n?(w=j(R),S=w):(C=S,S=n)}else C=S,S=n}}}return V--,S===n&&(w=n,V===0&&X(p)),S}function de(){var S,w,R;return S=C,w=C,V++,$.test(i.charAt(C))?(R=i.charAt(C),C++):(R=n,V===0&&X(N)),V--,R===n?w=void 0:(C=w,w=n),w!==n?(i.length>C?(R=i.charAt(C),C++):(R=n,V===0&&X(k)),R!==n?(w=T(R),S=w):(C=S,S=n)):(C=S,S=n),S===n&&(S=C,i.charCodeAt(C)===92?(w=D,C++):(w=n,V===0&&X(I)),w!==n?(R=Ue(),R!==n?(w=T(R),S=w):(C=S,S=n)):(C=S,S=n)),S}function he(){var S,w,R;return S=C,w=C,V++,O.test(i.charAt(C))?(R=i.charAt(C),C++):(R=n,V===0&&X(q)),V--,R===n?w=void 0:(C=w,w=n),w!==n?(i.length>C?(R=i.charAt(C),C++):(R=n,V===0&&X(k)),R!==n?(w=T(R),S=w):(C=S,S=n)):(C=S,S=n),S===n&&(S=C,i.charCodeAt(C)===92?(w=D,C++):(w=n,V===0&&X(I)),w!==n?(R=Ue(),R!==n?(w=T(R),S=w):(C=S,S=n)):(C=S,S=n)),S}function je(){var S,w,R;return S=C,w=C,V++,R=qe(),V--,R===n?w=void 0:(C=w,w=n),w!==n?(i.length>C?(R=i.charAt(C),C++):(R=n,V===0&&X(k)),R!==n?(w=T(R),S=w):(C=S,S=n)):(C=S,S=n),S}function Ue(){var S,w;return U.test(i.charAt(C))?(S=i.charAt(C),C++):(S=n,V===0&&X(H)),S===n&&(S=C,i.charCodeAt(C)===110?(w=W,C++):(w=n,V===0&&X(Q)),w!==n&&(w=K()),S=w,S===n&&(S=C,i.charCodeAt(C)===114?(w=G,C++):(w=n,V===0&&X(Y)),w!==n&&(w=ee()),S=w,S===n&&(S=C,i.charCodeAt(C)===116?(w=te,C++):(w=n,V===0&&X(se)),w!==n&&(w=ue()),S=w))),S}function qe(){var S;return V++,ve.test(i.charAt(C))?(S=i.charAt(C),C++):(S=n,V===0&&X(ke)),V--,S===n&&V===0&&X(fe),S}function Qe(){var S;return V++,ge.test(i.charAt(C))?(S=i.charAt(C),C++):(S=n,V===0&&X(we)),V--,S===n&&V===0&&X(Re),S}if(_e=a(),_e!==n&&C===i.length)return _e;throw _e!==n&&C<i.length&&X({type:"end",description:"end of input"}),Fe(null,ie,z<i.length?i.charAt(z):null,z<i.length?$e(z,z+1):$e(z,z))}return{SyntaxError:e,parse:s}}();function xs(t,e=""){if(!t)return[];const s=[];for(const i of Object.keys(t))i.startsWith(e)&&s.push(i);return s}function hp(t){const e=E.c(6),{results:s}=t,i=M.useRef(null);let l,n;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=()=>{i&&i.current.addEventListener("DOMNodeInserted",gp)},n=[],e[0]=l,e[1]=n):(l=e[0],n=e[1]),M.useEffect(l,n);let o;e[2]!==s?(o=s.map(mp),e[2]=s,e[3]=o):o=e[3];let a;return e[4]!==o?(a=r.jsx("div",{className:"command-result",ref:i,children:o}),e[4]=o,e[5]=a):a=e[5],a}function mp(t,e){return r.jsxs("div",{children:[r.jsx("div",{children:r.jsxs("strong",{children:["$ ",t.command]})}),t.result]},e)}function gp(t){const e=t.currentTarget;e.scroll({top:e.scrollHeight,behavior:"auto"})}function xp(t){const e=E.c(20),{nextArgs:s,currentArg:i,help:l,description:n,availableCommands:o}=t;let a;if(e[0]!==i||e[1]!==s){a=[];for(let b=0;b<s.length;b++){if(b==i){a.push(r.jsx("mark",{children:s[b]},b));continue}a.push(r.jsxs("span",{children:[s[b]," "]},b))}e[0]=i,e[1]=s,e[2]=a}else a=e[2];let d;e[3]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx("div",{className:"arrow"}),e[3]=d):d=e[3];let u;e[4]!==a?(u=a.length>0&&r.jsxs("div",{children:[r.jsx("strong",{children:"Argument suggestion:"})," ",a]}),e[4]=a,e[5]=u):u=e[5];let h;e[6]!==l?(h=l?.includes("->")&&r.jsxs("div",{children:[r.jsx("strong",{children:"Signature help: "}),l]}),e[6]=l,e[7]=h):h=e[7];let p;e[8]!==n?(p=n&&r.jsxs("div",{children:["# ",n]}),e[8]=n,e[9]=p):p=e[9];let g;e[10]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("strong",{children:"Available Commands: "}),e[10]=g):g=e[10];let x;e[11]!==o?(x=JSON.stringify(o),e[11]=o,e[12]=x):x=e[12];let j;e[13]!==x?(j=r.jsxs("div",{children:[g,r.jsx("p",{className:"available-commands",children:x})]}),e[13]=x,e[14]=j):j=e[14];let y;return e[15]!==u||e[16]!==h||e[17]!==p||e[18]!==j?(y=r.jsxs("div",{className:"argument-suggestion popover top",children:[d,r.jsxs("div",{className:"popover-content",children:[u,h,p,j]})]}),e[15]=u,e[16]=h,e[17]=p,e[18]=j,e[19]=y):y=e[19],y}function vp(){const t=E.c(45),[e,s]=M.useState(""),[i,l]=M.useState(""),[n,o]=M.useState(0);let a;t[0]===Symbol.for("react.memo_cache_sentinel")?(a=[],t[0]=a):a=t[0];const[d,u]=M.useState(a);let h;t[1]===Symbol.for("react.memo_cache_sentinel")?(h=[],t[1]=h):h=t[1];const[p,g]=M.useState(h);let x;t[2]===Symbol.for("react.memo_cache_sentinel")?(x={},t[2]=x):x=t[2];const[j,y]=M.useState(x);let b;t[3]===Symbol.for("react.memo_cache_sentinel")?(b=[],t[3]=b):b=t[3];const[$,N]=M.useState(b),[k,T]=M.useState(0),[D,I]=M.useState(""),[O,q]=M.useState("");let U;t[4]===Symbol.for("react.memo_cache_sentinel")?(U=[],t[4]=U):U=t[4];const[H,W]=M.useState(U);let Q;t[5]===Symbol.for("react.memo_cache_sentinel")?(Q=[],t[5]=Q):Q=t[5];const[K,G]=M.useState(Q),[Y,ee]=M.useState(void 0);let te,se;t[6]===Symbol.for("react.memo_cache_sentinel")?(te=()=>{oe("/commands",{method:"GET"}).then(wp).then(ne=>{y(ne),u(xs(ne)),g(Object.keys(ne))}).catch(Sp)},se=[],t[6]=te,t[7]=se):(te=t[6],se=t[7]),M.useEffect(te,se);let ue,fe;t[8]===Symbol.for("react.memo_cache_sentinel")?(ue=()=>{Yt("commands.history.get").then(ne=>{G(ne.value)}).catch(bp)},fe=[],t[8]=ue,t[9]=fe):(ue=t[8],fe=t[9]),M.useEffect(ue,fe);let ve;t[10]!==j?(ve=(ne,de)=>{const he=gs.parse(de),je=gs.parse(ne);I(j[he[0]]?.signature_help),q(j[he[0]]?.help||""),u(xs(j,je[0])),g(xs(j,he[0]));const Ue=j[he[0]]?.parameters.map(yp);Ue&&(N([he[0],...Ue]),T(he.length-1))},t[10]=j,t[11]=ve):ve=t[11];const ke=ve;let Re;t[12]===Symbol.for("react.memo_cache_sentinel")?(Re=ne=>{s(ne.target.value),l(ne.target.value),o(0)},t[12]=Re):Re=t[12];const ge=Re;let we;t[13]!==p||t[14]!==d||t[15]!==n||t[16]!==Y||t[17]!==K||t[18]!==e||t[19]!==H?(we=ne=>{if(ne.key==="Enter"){const[de,...he]=gs.parse(e);G([...K,e]),Yt("commands.history.add",e).catch(jp),oe.post(`/commands/${de}`,{arguments:he}).then(_p).then(je=>{ee(void 0),N([]),W([...H,{command:e,result:JSON.stringify(je.value||je.error)}])}).catch(je=>{ee(void 0),N([]),W([...H,{command:e,result:je.toString()}])}),I(""),q(""),s(""),l(""),o(0),u(p)}if(ne.key==="ArrowUp"){let de;Y===void 0?de=K.length-1:de=Math.max(0,Y-1),s(K[de]),l(K[de]),ee(de)}if(ne.key==="ArrowDown"){if(Y===void 0)return;if(Y==K.length-1)s(""),l(""),ee(void 0);else{const de=Y+1;s(K[de]),l(K[de]),ee(de)}}ne.key==="Tab"&&(s(d[n]),o((n+1)%d.length),ne.preventDefault()),ne.stopPropagation()},t[13]=p,t[14]=d,t[15]=n,t[16]=Y,t[17]=K,t[18]=e,t[19]=H,t[20]=we):we=t[20];const C=we;let ae;t[21]!==j||t[22]!==e||t[23]!==i||t[24]!==ke?(ae=ne=>{if(!e){g(Object.keys(j));return}ke(i,e),ne.stopPropagation()},t[21]=j,t[22]=e,t[23]=i,t[24]=ke,t[25]=ae):ae=t[25];const z=ae;let ie;t[26]===Symbol.for("react.memo_cache_sentinel")?(ie=r.jsx("div",{className:"command-title",children:"Command Result"}),t[26]=ie):ie=t[26];let V;t[27]!==H?(V=r.jsx(hp,{results:H}),t[27]=H,t[28]=V):V=t[28];let _e;t[29]!==p||t[30]!==k||t[31]!==O||t[32]!==$||t[33]!==D?(_e=r.jsx(xp,{nextArgs:$,currentArg:k,help:D,description:O,availableCommands:p}),t[29]=p,t[30]=k,t[31]=O,t[32]=$,t[33]=D,t[34]=_e):_e=t[34];let Ee;t[35]===Symbol.for("react.memo_cache_sentinel")?(Ee=De("command-input input-group"),t[35]=Ee):Ee=t[35];let $e;t[36]===Symbol.for("react.memo_cache_sentinel")?($e=r.jsx("span",{className:"input-group-addon",children:r.jsx("i",{className:"fa fa-fw fa-terminal"})}),t[36]=$e):$e=t[36];const X=e||"";let Fe;t[37]!==C||t[38]!==z||t[39]!==X?(Fe=r.jsxs("div",{className:Ee,children:[$e,r.jsx("input",{type:"text",placeholder:"Enter command",className:"form-control",value:X,onChange:ge,onKeyDown:C,onKeyUp:z})]}),t[37]=C,t[38]=z,t[39]=X,t[40]=Fe):Fe=t[40];let Te;return t[41]!==V||t[42]!==_e||t[43]!==Fe?(Te=r.jsxs("div",{className:"command",children:[ie,V,_e,Fe]}),t[41]=V,t[42]=_e,t[43]=Fe,t[44]=Te):Te=t[44],Te}function _p(t){return t.json()}function jp(){return 0}function yp(t){return t.name}function bp(t){return console.error(t)}function Sp(t){return console.error(t)}function wp(t){return t.json()}function $p(t){const e=E.c(7),{checked:s,onToggle:i,text:l}=t,n="btn btn-toggle "+(s?"btn-primary":"btn-default"),o="fa fa-fw "+(s?"fa-check-square-o":"fa-square-o");let a;e[0]!==o?(a=r.jsx("i",{className:o}),e[0]=o,e[1]=a):a=e[1];let d;return e[2]!==i||e[3]!==n||e[4]!==a||e[5]!==l?(d=r.jsxs("div",{className:n,onClick:i,children:[a," ",l]}),e[2]=i,e[3]=n,e[4]=a,e[5]=l,e[6]=d):d=e[6],d}class Cp extends M.Component{static defaultProps={rowHeight:18};heights;viewport=ye.createRef();constructor(e){super(e),this.heights={},this.state={vScroll:Ft()},this.onViewportUpdate=this.onViewportUpdate.bind(this)}componentDidMount(){window.addEventListener("resize",this.onViewportUpdate),this.onViewportUpdate()}componentWillUnmount(){window.removeEventListener("resize",this.onViewportUpdate)}getSnapshotBeforeUpdate(){return Os(this.viewport)}componentDidUpdate(e,s,i){i&&xl(this.viewport),this.onViewportUpdate()}onViewportUpdate(){const e=this.viewport.current,s=Ft({itemCount:this.props.events.length,rowHeight:this.props.rowHeight,viewportTop:e.scrollTop,viewportHeight:e.offsetHeight,itemHeights:this.props.events.map(i=>this.heights[i.id])});Zt(this.state.vScroll,s)||this.setState({vScroll:s})}setHeight(e,s){if(s&&!this.heights[e]){const i=s.offsetHeight;this.heights[e]!==i&&(this.heights[e]=i,this.onViewportUpdate())}}render(){const{vScroll:e}=this.state,{events:s}=this.props;return r.jsxs("pre",{ref:this.viewport,onScroll:this.onViewportUpdate,children:[r.jsx("div",{style:{height:e.paddingTop}}),s.slice(e.start,e.end).map(i=>r.jsxs("div",{ref:l=>{this.setHeight(i.id,l)},children:[r.jsx(Np,{event:i}),i.message]},i.id)),r.jsx("div",{style:{height:e.paddingBottom}})]})}}function Np(t){const e=E.c(4),{event:s}=t;let i;e[0]!==s.level?(i={web:"html5",debug:"bug",warn:"exclamation-triangle",error:"ban"}[s.level]||"info",e[0]=s.level,e[1]=i):i=e[1];const n=`fa fa-fw fa-${i}`;let o;return e[2]!==n?(o=r.jsx("i",{className:n}),e[2]=n,e[3]=o):o=e[3],o}class kp extends M.Component{static defaultProps={defaultHeight:200};dragStart;constructor(e,s){super(e,s),this.state={height:this.props.defaultHeight},this.onDragStart=this.onDragStart.bind(this),this.onDragMove=this.onDragMove.bind(this),this.onDragStop=this.onDragStop.bind(this)}onDragStart(e){e.preventDefault(),this.dragStart=this.state.height+e.pageY,window.addEventListener("mousemove",this.onDragMove),window.addEventListener("mouseup",this.onDragStop),window.addEventListener("dragend",this.onDragStop)}onDragMove(e){e.preventDefault(),this.setState({height:this.dragStart-e.pageY})}onDragStop(e){e.preventDefault(),window.removeEventListener("mousemove",this.onDragMove)}render(){const{height:e}=this.state,{filters:s,events:i,toggleFilter:l,close:n}=this.props;return r.jsxs("div",{className:"eventlog",style:{height:e},children:[r.jsxs("div",{onMouseDown:this.onDragStart,children:["Eventlog",r.jsxs("div",{className:"pull-right",children:[Object.values(mr).map(o=>r.jsx($p,{text:o,checked:s[o],onToggle:()=>l(o)},o)),r.jsx("i",{onClick:n,className:"fa fa-close"})]})]}),r.jsx(Cp,{events:i})]})}}const Ep=bt(t=>({filters:t.eventLog.filters,events:t.eventLog.view}),{close:es,toggleFilter:hr})(kp);function Tp(){const t=E.c(52),e=F(Ap),{mode:s,intercept:i,showhost:l,upstream_cert:n,rawtcp:o,http2:a,websocket:d,anticache:u,anticomp:h,stickyauth:p,stickycookie:g,stream_large_bodies:x,listen_host:j,listen_port:y,server:b,ssl_insecure:$}=F(Rp);let N;t[0]!==s?(N=s&&(s.length!==1||s[0]!=="regular")&&r.jsx("span",{className:"label label-success",children:s.join(",")}),t[0]=s,t[1]=N):N=t[1];let k;t[2]!==i?(k=i&&r.jsxs("span",{className:"label label-success",children:["Intercept: ",i]}),t[2]=i,t[3]=k):k=t[3];let T;t[4]!==$?(T=$&&r.jsx("span",{className:"label label-danger",children:"ssl_insecure"}),t[4]=$,t[5]=T):T=t[5];let D;t[6]!==l?(D=l&&r.jsx("span",{className:"label label-success",children:"showhost"}),t[6]=l,t[7]=D):D=t[7];let I;t[8]!==n?(I=!n&&r.jsx("span",{className:"label label-success",children:"no-upstream-cert"}),t[8]=n,t[9]=I):I=t[9];let O;t[10]!==o?(O=!o&&r.jsx("span",{className:"label label-success",children:"no-raw-tcp"}),t[10]=o,t[11]=O):O=t[11];let q;t[12]!==a?(q=!a&&r.jsx("span",{className:"label label-success",children:"no-http2"}),t[12]=a,t[13]=q):q=t[13];let U;t[14]!==d?(U=!d&&r.jsx("span",{className:"label label-success",children:"no-websocket"}),t[14]=d,t[15]=U):U=t[15];let H;t[16]!==u?(H=u&&r.jsx("span",{className:"label label-success",children:"anticache"}),t[16]=u,t[17]=H):H=t[17];let W;t[18]!==h?(W=h&&r.jsx("span",{className:"label label-success",children:"anticomp"}),t[18]=h,t[19]=W):W=t[19];let Q;t[20]!==p?(Q=p&&r.jsxs("span",{className:"label label-success",children:["stickyauth: ",p]}),t[20]=p,t[21]=Q):Q=t[21];let K;t[22]!==g?(K=g&&r.jsxs("span",{className:"label label-success",children:["stickycookie: ",g]}),t[22]=g,t[23]=K):K=t[23];let G;t[24]!==x?(G=x&&r.jsxs("span",{className:"label label-success",children:["stream: ",Fi(x)]}),t[24]=x,t[25]=G):G=t[25];let Y;t[26]!==j||t[27]!==y||t[28]!==b?(Y=b&&r.jsxs("span",{className:"label label-primary",title:"HTTP Proxy Server Address",children:[j||"*",":",y||8080]}),t[26]=j,t[27]=y,t[28]=b,t[29]=Y):Y=t[29];let ee;t[30]!==Y?(ee=r.jsx(yt,{children:Y}),t[30]=Y,t[31]=ee):ee=t[31];let te;t[32]!==e?(te=r.jsxs("span",{className:"label label-default",title:"Mitmproxy Version",children:["mitmproxy ",e]}),t[32]=e,t[33]=te):te=t[33];let se;t[34]!==ee||t[35]!==te?(se=r.jsxs("div",{className:"pull-right",children:[ee,te]}),t[34]=ee,t[35]=te,t[36]=se):se=t[36];let ue;return t[37]!==N||t[38]!==k||t[39]!==Q||t[40]!==K||t[41]!==G||t[42]!==se||t[43]!==T||t[44]!==D||t[45]!==I||t[46]!==O||t[47]!==q||t[48]!==U||t[49]!==H||t[50]!==W?(ue=r.jsxs("footer",{children:[N,k,T,D,I,O,q,U,H,W,Q,K,G,se]}),t[37]=N,t[38]=k,t[39]=Q,t[40]=K,t[41]=G,t[42]=se,t[43]=T,t[44]=D,t[45]=I,t[46]=O,t[47]=q,t[48]=U,t[49]=H,t[50]=W,t[51]=ue):ue=t[51],ue}function Rp(t){return t.options}function Ap(t){return t.backendState.version}function Ip(t){const e=E.c(3),{children:s}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=r.jsx("div",{className:"modal-backdrop fade in"}),e[0]=i):i=e[0];let l;return e[1]!==s?(l=r.jsxs("div",{children:[i,r.jsx("div",{className:"modal modal-visible",id:"optionsModal",tabIndex:-1,role:"dialog","aria-labelledby":"options",children:r.jsx("div",{className:"modal-dialog modal-lg",role:"document",children:r.jsx("div",{className:"modal-content",children:s})})})]}),e[1]=s,e[2]=l):l=e[2],l}const Dp=t=>{t.key!=="Escape"&&t.stopPropagation()};function Nl(t){const e=E.c(10);let s,i,l;e[0]!==t?({value:l,onChange:s,...i}=t,e[0]=t,e[1]=s,e[2]=i,e[3]=l):(s=e[1],i=e[2],l=e[3]);let n;e[4]!==s?(n=a=>s(a.target.checked),e[4]=s,e[5]=n):n=e[5];let o;return e[6]!==i||e[7]!==n||e[8]!==l?(o=r.jsx("div",{className:"checkbox",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",checked:l,onChange:n,...i}),"Enable"]})}),e[6]=i,e[7]=n,e[8]=l,e[9]=o):o=e[9],o}function Ni(t){const e=E.c(10);let s,i,l;e[0]!==t?({value:l,onChange:s,...i}=t,e[0]=t,e[1]=s,e[2]=i,e[3]=l):(s=e[1],i=e[2],l=e[3]);const n=l||"";let o;e[4]!==s?(o=d=>s(d.target.value),e[4]=s,e[5]=o):o=e[5];let a;return e[6]!==i||e[7]!==n||e[8]!==o?(a=r.jsx("input",{type:"text",value:n,onChange:o,...i}),e[6]=i,e[7]=n,e[8]=o,e[9]=a):a=e[9],a}function ki(t){return function({onChange:s,...i}){return r.jsx(t,{onChange:l=>s(l||null),...i})}}function Ei(t){const e=E.c(10);let s,i,l;e[0]!==t?({value:l,onChange:s,...i}=t,e[0]=t,e[1]=s,e[2]=i,e[3]=l):(s=e[1],i=e[2],l=e[3]);let n;e[4]!==s?(n=a=>s(parseInt(a.target.value)),e[4]=s,e[5]=n):n=e[5];let o;return e[6]!==i||e[7]!==n||e[8]!==l?(o=r.jsx("input",{type:"number",value:l,onChange:n,...i}),e[6]=i,e[7]=n,e[8]=l,e[9]=o):o=e[9],o}function Fp(t){const e=E.c(12);let s,i,l,n;if(e[0]!==t){const{value:d,onChange:u,choices:h,...p}=t;n=d,s=h,i=p,l=g=>u(g.target.value),e[0]=t,e[1]=s,e[2]=i,e[3]=l,e[4]=n}else s=e[1],i=e[2],l=e[3],n=e[4];let o;e[5]!==s?(o=s.map(Lp),e[5]=s,e[6]=o):o=e[6];let a;return e[7]!==i||e[8]!==l||e[9]!==o||e[10]!==n?(a=r.jsx("select",{onChange:l,value:n,...i,children:o}),e[7]=i,e[8]=l,e[9]=o,e[10]=n,e[11]=a):a=e[11],a}function Lp(t){return r.jsx("option",{value:t,children:t},t)}function Pp(t){const e=E.c(13);let s,i,l;e[0]!==t?({value:l,onChange:s,...i}=t,e[0]=t,e[1]=s,e[2]=i,e[3]=l):(s=e[1],i=e[2],l=e[3]);const n=Math.max(l.length,1);let o;e[4]!==l?(o=l.join(`
`),e[4]=l,e[5]=o):o=e[5];const[a,d]=ye.useState(o);let u;e[6]!==s?(u=g=>{const x=g.target.value;d(x),s(x.split(`
`).map(qp).filter(Mp))},e[6]=s,e[7]=u):u=e[7];const h=u;let p;return e[8]!==h||e[9]!==n||e[10]!==i||e[11]!==a?(p=r.jsx("textarea",{rows:n,value:a,onChange:h,...i}),e[8]=h,e[9]=n,e[10]=i,e[11]=a,e[12]=p):p=e[12],p}function Mp(t){return t!==""}function qp(t){return t.trim()}const Op={bool:Nl,str:Ni,int:Ei,"optional str":ki(Ni),"optional int":ki(Ei),"sequence of str":Pp};function Hp(t){const e=E.c(16),{choices:s,type:i,value:l,onChange:n,name:o,error:a}=t;let d,u;if(e[0]!==d||e[1]!==s||e[2]!==n||e[3]!==i||e[4]!==l){if(u={onChange:n,value:l},s)d=Fp,u.choices=s;else if(d=Op[i],!d)throw`unknown option type ${i}`;d!==Nl&&(u.className="form-control"),e[0]=d,e[1]=s,e[2]=n,e[3]=i,e[4]=l,e[5]=u,e[6]=d}else u=e[5],d=e[6];let h;e[7]!==a?(h=De({"has-error":a}),e[7]=a,e[8]=h):h=e[8];let p;e[9]!==d||e[10]!==o||e[11]!==u?(p=r.jsx(d,{name:o,onKeyDown:Dp,...u}),e[9]=d,e[10]=o,e[11]=u,e[12]=p):p=e[12];let g;return e[13]!==h||e[14]!==p?(g=r.jsx("div",{className:h,children:p}),e[13]=h,e[14]=p,e[15]=g):g=e[15],g}function Vp(t){const e=E.c(18),{name:s}=t,i=Z();let l;e[0]!==s?(l=j=>j.options_meta[s]?.choices,e[0]=s,e[1]=l):l=e[1];const n=F(l);let o;e[2]!==s?(o=j=>j.options_meta[s]?.type,e[2]=s,e[3]=o):o=e[3];const a=F(o);let d;e[4]!==s?(d=j=>{const y=j.ui.optionsEditor[s];return y?y.value:j.options_meta[s]?.value},e[4]=s,e[5]=d):d=e[5];const u=F(d);let h;e[6]!==s?(h=j=>j.ui.optionsEditor[s]?.error,e[6]=s,e[7]=h):h=e[7];const p=F(h);let g;e[8]!==i||e[9]!==s?(g=j=>i(Ps(s,j)),e[8]=i,e[9]=s,e[10]=g):g=e[10];let x;return e[11]!==n||e[12]!==p||e[13]!==s||e[14]!==g||e[15]!==a||e[16]!==u?(x=r.jsx(Hp,{name:s,choices:n,type:a,value:u,error:p,onChange:g}),e[11]=n,e[12]=p,e[13]=s,e[14]=g,e[15]=a,e[16]=u,e[17]=x):x=e[17],x}function Up(t){const e=E.c(4),{name:s}=t;let i;e[0]!==s?(i=o=>o.options_meta[s]?.help,e[0]=s,e[1]=i):i=e[1];const l=F(i);let n;return e[2]!==l?(n=r.jsx("div",{className:"help-block small",children:l}),e[2]=l,e[3]=n):n=e[3],n}function Bp(t){const e=E.c(4),{name:s}=t;let i;e[0]!==s?(i=o=>o.options_meta[s]?.error,e[0]=s,e[1]=i):i=e[1];const l=F(i);if(!l)return null;let n;return e[2]!==l?(n=r.jsx("div",{className:"small text-danger",children:l}),e[2]=l,e[3]=n):n=e[3],n}function Kp(t){const e=E.c(2);let{value:s,defaultVal:i}=t;if(s===i)return null;{if(typeof i=="boolean")i=i?"true":"false";else if(Array.isArray(i)){if(zt.isEmpty(zt.compact(s))&&zt.isEmpty(i))return null;i="[ ]"}else i===""?i='""':i===null&&(i="null");let l;return e[0]!==i?(l=r.jsxs("div",{className:"small",children:["Default: ",r.jsxs("strong",{children:[" ",i," "]})," "]}),e[0]=i,e[1]=l):l=e[1],l}}const Wp=bt((t,{name:e})=>({value:t.options[e],defaultVal:t.options_meta[e]?.default}))(Kp);function zp(){const t=E.c(24),e=Z(),s=F(Gp,Zt);let i,l,n,o;if(t[0]!==e||t[1]!==s){const p=s.sort();let g;t[6]!==e?(g=()=>e(fr()),t[6]=e,t[7]=g):g=t[7];let x;t[8]===Symbol.for("react.memo_cache_sentinel")?(x=r.jsx("i",{className:"fa fa-fw fa-times"}),t[8]=x):x=t[8];let j;t[9]!==g?(j=r.jsx("button",{type:"button",className:"close","data-dismiss":"modal",onClick:g,children:x}),t[9]=g,t[10]=j):j=t[10];let y;t[11]===Symbol.for("react.memo_cache_sentinel")?(y=r.jsx("div",{className:"modal-title",children:r.jsx("h4",{children:"Options"})}),t[11]=y):y=t[11],t[12]!==j?(o=r.jsxs("div",{className:"modal-header",children:[j,y]}),t[12]=j,t[13]=o):o=t[13],n="modal-body",i="form-horizontal",l=p.map(Qp),t[0]=e,t[1]=s,t[2]=i,t[3]=l,t[4]=n,t[5]=o}else i=t[2],l=t[3],n=t[4],o=t[5];let a;t[14]!==i||t[15]!==l?(a=r.jsx("div",{className:i,children:l}),t[14]=i,t[15]=l,t[16]=a):a=t[16];let d;t[17]!==n||t[18]!==a?(d=r.jsx("div",{className:n,children:a}),t[17]=n,t[18]=a,t[19]=d):d=t[19];let u;t[20]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("div",{className:"modal-footer"}),t[20]=u):u=t[20];let h;return t[21]!==o||t[22]!==d?(h=r.jsxs("div",{children:[o,d,u]}),t[21]=o,t[22]=d,t[23]=h):h=t[23],h}function Qp(t){return r.jsxs("div",{className:"form-group",children:[r.jsxs("div",{className:"col-xs-6",children:[r.jsx("label",{htmlFor:t,children:t}),r.jsx(Up,{name:t})]}),r.jsxs("div",{className:"col-xs-6",children:[r.jsx(Vp,{name:t}),r.jsx(Bp,{name:t}),r.jsx(Wp,{name:t})]})]},t)}function Gp(t){return Object.keys(t.options_meta)}function Yp(){const t=E.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=r.jsx(Ip,{children:r.jsx(zp,{})}),t[0]=e):e=t[0],e}const Jp={OptionModal:Yp};function Xp(){const t=E.c(3),e=F(Zp),s=e?Jp[e]:void 0;if(s){let i;return t[0]!==s?(i=r.jsx(s,{}),t[0]=s,t[1]=i):i=t[1],i}else{let i;return t[2]===Symbol.for("react.memo_cache_sentinel")?(i=r.jsx(r.Fragment,{}),t[2]=i):i=t[2],i}}function Zp(t){return t.ui.modal.activeModal}class eh extends M.Component{state={};render=()=>{const{showEventLog:e,showCommandBar:s}=this.props;return this.state.error?(console.log("ERR",this.state),r.jsxs("div",{className:"container",children:[r.jsx("h1",{children:"mitmproxy has crashed."}),r.jsxs("pre",{children:[this.state.error.stack,r.jsx("br",{}),r.jsx("br",{}),"Component Stack:",this.state.errorInfo?.componentStack]}),r.jsxs("p",{children:["Please lodge a bug report at"," ",r.jsx("a",{href:"https://github.com/mitmproxy/mitmproxy/issues",children:"https://github.com/mitmproxy/mitmproxy/issues"}),"."]})]})):r.jsxs("div",{id:"container",tabIndex:0,children:[r.jsx(up,{}),r.jsx(Rf,{}),s&&r.jsx(vp,{},"commandbar"),e&&r.jsx(Ep,{},"eventlog"),r.jsx(Tp,{}),r.jsx(Xp,{})]})};componentDidMount(){window.addEventListener("keydown",this.props.onKeyDown)}componentWillUnmount(){window.removeEventListener("keydown",this.props.onKeyDown)}componentDidCatch(e,s){this.setState({error:e,errorInfo:s})}}const th=bt(t=>({showEventLog:t.eventLog.visible,showCommandBar:t.commandBar.visible}),{onKeyDown:Pd})(eh),lt={SEARCH:"s",HIGHLIGHT:"h",SHOW_EVENTLOG:"e",SHOW_COMMANDBAR:"c"};function sh(t){const[e,s]=window.location.hash.substr(1).split("?",2),i=e.substr(1).split("/");if(i[0]==="flows"){if(i.length==3){const[l,n]=i.slice(1);t.dispatch(Gt(n));const o=()=>{const d=t.getState().flows.byId.get(l);d!==void 0&&(a(),t.dispatch(Je([d])))},a=t.subscribe(o);o()}}else i[0]==="capture"&&t.dispatch(Qt(me.Capture));s&&s.split("&").forEach(l=>{const[n,o]=l.split("=",2),a=decodeURIComponent(o);switch(n){case lt.SEARCH:t.dispatch(Xi(a));break;case lt.HIGHLIGHT:t.dispatch(Zi(a));break;case lt.SHOW_EVENTLOG:t.getState().eventLog.visible||t.dispatch(es());break;case lt.SHOW_COMMANDBAR:t.getState().commandBar.visible||t.dispatch(xr());break;default:console.error(`unimplemented query arg: ${l}`)}})}function nh(t){const e=t.getState(),s={[lt.SEARCH]:e.ui.filter[Ae.Search],[lt.HIGHLIGHT]:e.ui.filter[Ae.Highlight],[lt.SHOW_EVENTLOG]:e.eventLog.visible,[lt.SHOW_COMMANDBAR]:e.commandBar.visible},i=Object.keys(s).filter(o=>s[o]).map(o=>`${o}=${encodeURIComponent(s[o])}`).join("&");let l;e.ui.tabs.current===me.Capture?l="/capture":e.flows.selected.length>0?l=`/flows/${e.flows.selected[0].id}/${e.ui.flow.tab}`:l="/flows",i&&(l+="?"+i);let n=window.location.pathname;n==="blank"&&(n="/"),window.location.hash.substr(1)!==l&&history.replaceState(void 0,"",`${n}#${l}`)}function ih(t){sh(t),t.subscribe(()=>nh(t))}var pt=(t=>(t.State="state",t.Flows="flows",t.Events="events",t.Options="options",t))(pt||{});class rh{activeFetches;store;filterState;socket;messageQueue;constructor(e){this.activeFetches={},this.store=e,this.filterState=Ji,this.messageQueue=[],this.connect(),this.store.subscribe(this.onStoreUpdate.bind(this))}connect(){this.socket=new WebSocket(location.origin.replace("http","ws")+location.pathname.replace(/\/$/,"")+"/updates"),this.socket.addEventListener("open",()=>this.onOpen()),this.socket.addEventListener("close",e=>this.onClose(e)),this.socket.addEventListener("message",e=>this.onMessage(JSON.parse(e.data))),this.socket.addEventListener("error",e=>this.onError(e))}async onOpen(){for(const e of this.messageQueue)this.socket.send(JSON.stringify(e));this.messageQueue=[],this.store.dispatch(na()),await Promise.all([this.fetchData("state"),this.fetchData("flows"),this.fetchData("events"),this.fetchData("options")]),this.store.dispatch(ia())}onStoreUpdate(){const e=this.store.getState().ui.filter;if(e!==this.filterState){for(const s of Object.values(Ae))this.filterState[s]!==e[s]&&this.sendMessage({type:"flows/updateFilter",payload:{name:s,expr:e[s]}});this.filterState=e}}fetchData(e){const s=[];return this.activeFetches[e]=s,oe(`./${e}`).then(i=>i.json()).then(i=>{this.activeFetches[e]===s&&this.receive(e,i)})}onMessage(e){switch(e.type){case"flows/add":return this.queueOrDispatch("flows",lr(e.payload));case"flows/update":return this.queueOrDispatch("flows",or(e.payload));case"flows/filterUpdate":return this.queueOrDispatch("flows",ar(e.payload));case"flows/remove":return this.queueOrDispatch("flows",cr(e.payload));case"events/add":return this.queueOrDispatch("events",Fs(e.payload));case"options/update":return this.queueOrDispatch("options",Ls(e.payload));case"state/update":return this.queueOrDispatch("state",Ze(e.payload));case"flows/reset":return this.fetchData("flows");case"events/reset":return this.fetchData("events");default:It(e.type)}}sendMessage(e){this.socket.readyState===WebSocket.OPEN?this.socket.send(JSON.stringify(e)):this.socket.readyState===WebSocket.CONNECTING?this.messageQueue.push(e):console.error("WebSocket is not open. Cannot send:",e)}queueOrDispatch(e,s){const i=this.activeFetches[e];i!==void 0?i.push(s):this.store.dispatch(s)}receive(e,s){switch(e){case"state":this.store.dispatch(Xe(s));break;case"options":this.store.dispatch(ts(s));break;case"events":this.store.dispatch(pr(s));break;case"flows":this.store.dispatch(Ds(s));break;default:It(e)}const i=this.activeFetches[e];delete this.activeFetches[e],i.forEach(l=>this.store.dispatch(l))}onClose(e){this.store.dispatch(ra(`Connection closed at ${new Date().toUTCString()} with error code ${e.code}.`)),console.error("websocket connection closed",e)}onError(...e){console.error("websocket connection errored",e)}}class lh{store;constructor(e){this.store=e,this.onOpen()}onOpen(){this.fetchData(pt.Flows),this.fetchData(pt.Options)}fetchData(e){oe(`./${e}`).then(s=>s.json()).then(s=>{this.receive(e,s)})}receive(e,s){switch(e){case pt.Flows:this.store.dispatch(Ds(s));break;case pt.Options:this.store.dispatch(ts(s));break;case pt.State:throw"unreachable";case pt.Events:throw"unreachable";default:It(e)}}}window.MITMWEB_STATIC?window.backend=new lh(Dt):window.backend=new rh(Dt);ih(Dt);window.addEventListener("error",t=>{Dt.dispatch(Kc(`${t.message}
${t.error.stack}`))});document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("mitmproxy");hc.createRoot(t).render(r.jsx(mc,{store:Dt,children:r.jsx(th,{})}))});
