import{c as xe,R as Yo,a as Te,r as P,b as ke,d as Re,j as r,e as E,f as Ei,u as Jo,g as Xo,h as Ti,s as Jt,i as Zo,l as Kt,k as ec,m as tc,n as sc,y as nc,o as ic,p as rc,q as _t,Q as lc,C as Ri,X as Ai,Y as vs,T as Cs,L as Ns,t as oc,v as ks,w as cc,P as ac,x as dc,z as uc,B as ti,A as fc,D as pc,E as hc}from"./vendor-CV_2_uTW.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const n of l)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function s(l){const n={};return l.integrity&&(n.integrity=l.integrity),l.referrerPolicy&&(n.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?n.credentials="include":l.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(l){if(l.ep)return;l.ep=!0;const n=s(l);fetch(l.href,n)}})();const mc={tab:"request",contentViewFor:{}},gc=xe({name:"ui/flow",initialState:mc,reducers:{selectTab(t,e){t.tab=e.payload},setContentViewFor(t,e){t.contentViewFor[e.payload.messageId]=e.payload.contentView}}}),{actions:xc,reducer:vc}=gc,{selectTab:zt,setContentViewFor:Ii}=xc;window.React=Yo;const Di=function(t){if(t===0)return"0";const e=["b","kb","mb","gb","tb"];let s=0;for(;s<e.length&&!(Math.pow(1024,s+1)>t);s++);let i;return t%Math.pow(1024,s)===0?i=0:i=1,(t/Math.pow(1024,s)).toFixed(i)+e[s]},Fi=function(t){let e=t;const s=["ms","s","min","h"],i=[1e3,60,60];let l=0;for(;Math.abs(e)>=i[l]&&l<i.length;)e=e/i[l],l++;return Math.round(e)+s[l]},ut=function(t,{includeMilliseconds:e=!0}={}){const s=new Date(t*1e3),i=String(s.getFullYear()),l=String(s.getMonth()+1).padStart(2,"0"),n=String(s.getDate()).padStart(2,"0"),o=String(s.getHours()).padStart(2,"0"),a=String(s.getMinutes()).padStart(2,"0"),d=String(s.getSeconds()).padStart(2,"0"),u=String(s.getMilliseconds()).padStart(3,"0");let h=`${i}-${l}-${n} ${o}:${a}:${d}`;return e&&(h+=`.${u}`),h};function si(t){return t[0].includes(":")?`[${t[0]}]:${t[1]}`:`${t[0]}:${t[1]}`}function _c(t){const e=document.cookie.match(new RegExp("\\b"+t+"=([^;]*)\\b"));return e?e[1]:void 0}let _s=()=>{const t=_c("_xsrf");return _s=()=>t,_s()};function le(t,e={}){return e.method&&e.method!=="GET"&&(e.headers=e.headers||{},e.headers["X-XSRFToken"]=_s()),t.startsWith("/")&&(t="."+t),fetch(t,{credentials:"same-origin",...e})}le.put=(t,e,s={})=>le(t,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),...s});le.post=(t,e,s={})=>le(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),...s});async function Qt(t,...e){return await(await le(`/commands/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({arguments:e})})).json()}async function Li(t){try{await navigator.clipboard.write([new ClipboardItem({"text/plain":t})]);return}catch(i){console.warn(i)}const e=await t;try{await navigator.clipboard.writeText(e);return}catch(i){console.warn(i)}const s=document.createElement("textarea");s.value=e,s.style.position="absolute",s.style.opacity="0",document.body.appendChild(s);try{if(s.focus(),s.select(),!document.execCommand("copy"))throw"failed to copy"}catch{alert(e)}finally{s.remove()}}async function jc(t){await Li(Promise.resolve(t?.text||""))}function js(t,e){const s=t.lastIndexOf(e);if(s===-1)return["",t];const i=t.slice(0,s),l=t.slice(s+e.length);return[i,l]}function Pi(t,e){const s=t.indexOf(e);if(s===-1)return[t,""];const i=t.slice(0,s),l=t.slice(s+e.length);return[i,l]}function Tt(t){throw new Error(`Unreachable: ${JSON.stringify(t)}`)}const Mi={http:80,https:443},ni=new WeakMap;class Ae{static getContentType(e){const s=Ae.get_first_header(e,/^Content-Type$/i);if(s)return s.split(";")[0].trim()}static get_first_header(e,s){let i=ni.get(e);i||(i=new Map,ni.set(e,i));let l=i.get(s);if(l===void 0){const n=e.headers.find(([o,a])=>s.test(o));l=n?n[1]:!1,i.set(s,l)}return l!==!1?l:void 0}static match_header(e,s){const i=e.headers;if(!i)return!1;let l=i.length;for(;l--;)if(s.test(i[l].join(" ")))return i[l];return!1}static getContentURL(e,s,i,l){e.type==="http"&&s===e.request?s="request":e.type==="http"&&s===e.response&&(s="response");const n=l?`?lines=${l}`:"";return`./flows/${e.id}/${s}/`+(i?`content/${encodeURIComponent(i)}.json${n}`:"content.data")}}class dt extends Ae{static pretty_url(e){let s="";return Mi[e.scheme]!==e.port&&(s=":"+e.port),e.scheme+"://"+e.pretty_host+s+e.path}}class xt extends Ae{}const yc=/^(?:(https?):\/\/)?([^/:]+)?(?::(\d+))?(\/.*)?$/i,Oi=function(t){const e=yc.exec(t);if(!e)return;const s=e[1],i=e[2],l=parseInt(e[3]),n=e[4],o=s?l||Mi[s]:l,a={};return s&&(a.scheme=s),i&&(a.host=i),o&&(a.port=o),n&&(a.path=n),a},bc=/^HTTP\/\d+(\.\d+)*$/i,qi=function(t){return bc.test(t)};function Gt(t){switch(t.type){case"http":return t.request.timestamp_start;case"tcp":case"udp":return t.client_conn.timestamp_start;case"dns":return t.request.timestamp}}function Hi(t){switch(t.type){case"http":if(t.websocket){if(t.websocket.timestamp_end)return t.websocket.timestamp_end;if(t.websocket.messages_meta.timestamp_last)return t.websocket.messages_meta.timestamp_last}return t.response?t.response.timestamp_end:void 0;case"tcp":return t.server_conn?.timestamp_end;case"udp":return t.messages_meta.timestamp_last;case"dns":return t.response?.timestamp}}const Vi=t=>{switch(t.type){case"http":{let e=t.request.contentLength||0;return t.response&&(e+=t.response.contentLength||0),t.websocket&&(e+=t.websocket.messages_meta.contentLength||0),e}case"tcp":case"udp":return t.messages_meta.contentLength||0;case"dns":return t.response?.size??0}},Es=t=>t.type==="http"&&!t.websocket,Ui=t=>t.modified,Ts=t=>t.intercepted,Bi=t=>{if(t.type!=="http")return t.client_conn.tls_version==="QUICv1"?"resource-icon-quic":`resource-icon-${t.type}`;if(t.websocket)return"resource-icon-websocket";if(!t.response)return"resource-icon-plain";const e=xt.getContentType(t.response)||"";return t.response.status_code===304?"resource-icon-not-modified":300<=t.response.status_code&&t.response.status_code<400?"resource-icon-redirect":e.indexOf("image")>=0?"resource-icon-image":e.indexOf("javascript")>=0?"resource-icon-js":e.indexOf("css")>=0?"resource-icon-css":e.indexOf("html")>=0?"resource-icon-document":"resource-icon-plain"},Ki=t=>{switch(t.type){case"http":return dt.pretty_url(t.request);case"tcp":case"udp":return`${t.client_conn.peername.join(":")} ↔ ${t.server_conn?.address?.join(":")}`;case"dns":return`${t.request.questions.map(e=>`${e.name} ${e.type}`).join(", ")} = ${(t.response?.answers.map(e=>e.data).join(", ")??"...")||"?"}`}},Wi=t=>{switch(t.type){case"http":return t.response?.status_code;case"dns":return t.response?.response_code;default:return}},zi=t=>{switch(t.type){case"http":return t.websocket?t.client_conn.tls_established?"WSS":"WS":t.request.method;case"dns":return t.request.op_code;default:return t.type.toUpperCase()}},Qi=t=>{switch(t.type){case"http":return t.request.http_version;default:return""}},Gi={tls:t=>t.type==="http"&&t.request.scheme,icon:Bi,index:()=>0,path:Ki,method:zi,version:Qi,status:Wi,size:Vi,time:t=>{const e=Gt(t),s=Hi(t);return e&&s&&s-e},timestamp:Gt,quickactions:()=>0,comment:t=>t.comment};function Sc(t){return t in Gi}var Ee=(t=>(t.Search="search",t.Highlight="highlight",t))(Ee||{});const Yi={search:"",highlight:""},wc=xe({name:"ui/filters",initialState:Yi,reducers:{setFilter(t,e){t.search=e.payload},setHighlight(t,e){t.highlight=e.payload}}}),{actions:$c,reducer:Cc}=wc,{setFilter:Ji,setHighlight:Xi}=$c;function ds(t,e){return t.toSorted?t.toSorted(e):[...t].sort(e)}function Rs(t,...e){if(t.toSpliced)return t.toSpliced(...e);{const s=[...t];return s.splice(...e),s}}function St(t){return new Map(t.map((e,s)=>[e.id,s]))}function us(t){return new Set(t.map(e=>e.id))}function ii(t,e){return t.has(e)&&(t=new Set(t),t.delete(e)),t}function ri(t,e,s){const i=Rs(t,s,1),l=new Map(e);l.delete(t[s].id);for(let n=i.length-1;n>=s;n--)l.set(i[n].id,n);return{view:i,_viewIndex:l}}function Nc(t,e,s,i){const l=[...t],n=l.length;let o=e,a=o.get(s.id);if(a+1<n&&i(s,l[a+1])>0){o=new Map(o);do{const d=l[a+1];l[a]=d,o.set(d.id,a),a++}while(a+1<n&&i(s,l[a+1])>0);o.set(s.id,a)}else if(a>0&&i(s,l[a-1])<0){o=new Map(o);do{const d=l[a-1];l[a]=d,o.set(d.id,a),a--}while(a>0&&i(s,l[a-1])<0);o.set(s.id,a)}return l[a]=s,{view:l,_viewIndex:o}}function li(t,e,s,i){const l=kc(t,s,i),n=Rs(t,l,0,s),o=new Map(e);for(let a=n.length-1;a>=l;a--)o.set(n[a].id,a);return{view:n,_viewIndex:o}}function kc(t,e,s){let i=0,l=t.length;if(l===0||s(t[l-1],e)<=0)return l;for(;i<l;){const n=i+l>>>1;s(e,t[n])>=0?i=n+1:l=n}return i}function As(t){return t=t.filter(Ts),()=>Promise.all(t.map(e=>le(`/flows/${e.id}/resume`,{method:"POST"})))}function Zi(){return()=>le("/flows/resume",{method:"POST"})}function er(t){return t=t.filter(Ts),()=>Promise.all(t.map(e=>le(`/flows/${e.id}/kill`,{method:"POST"})))}function Ec(){return()=>le("/flows/kill",{method:"POST"})}function tr(t){return()=>Promise.all(t.map(e=>le(`/flows/${e.id}`,{method:"DELETE"})))}function sr(t){return()=>Promise.all(t.map(e=>le(`/flows/${e.id}/duplicate`,{method:"POST"})))}function Is(t){return t=t.filter(Es),()=>Promise.all(t.map(e=>le(`/flows/${e.id}/replay`,{method:"POST"})))}function nr(t){return t=t.filter(Ui),()=>Promise.all(t.map(e=>le(`/flows/${e.id}/revert`,{method:"POST"})))}function oi(t,e){return()=>Promise.all(t.map(s=>Ve(s,{marked:e})()))}function Ve(t,e){return()=>le.put(`/flows/${t.id}`,e)}function Tc(t,e,s){const i=new FormData;return e=new window.Blob([e],{type:"plain/text"}),i.append("file",e),()=>le(`/flows/${t.id}/${s}/content.data`,{method:"POST",body:i})}function ir(){return()=>le("/clear",{method:"POST"})}function Rc(t){const e=new FormData;return e.append("file",t),()=>le("/flows/dump",{method:"POST",body:e})}const rr=Te("flows/add"),lr=Te("flows/update"),or=Te("flows/remove"),Ds=Te("flows/receive"),cr=Te("flows/filterUpdate"),ar=Te("flows/sort"),Ke=Te("flows/select"),Ac={list:[],_listIndex:new Map,byId:new Map,view:[],_viewIndex:new Map,sort:{column:void 0,desc:!1},selected:[],selectedIds:new Set,highlightedIds:new Set};function Ic(t=Ac,e){if(Ds.match(e)){const{sort:s}=t,i=e.payload,l=St(i),n=new Map(i.map(p=>[p.id,p])),o=ds(i,mt(s)),a=St(o),d=t.selected.map(p=>n.get(p.id)).filter(p=>p!==void 0),u=us(d);return{list:i,_listIndex:l,byId:n,view:o,_viewIndex:a,sort:s,selected:d,selectedIds:u,highlightedIds:new Set}}else if(rr.match(e)){const{flow:s,matching_filters:i}=e.payload;if(t._listIndex.has(s.id))return t;const{sort:l,selected:n,selectedIds:o}=t;let{view:a,_viewIndex:d,highlightedIds:u}=t;const h=new Map(t._listIndex);h.set(s.id,t.list.length);const p=[...t.list,s],g=new Map(t.byId);return g.set(s.id,s),(i[Ee.Search]===!0||i[Ee.Search]===void 0)&&({view:a,_viewIndex:d}=li(a,d,s,mt(l))),i[Ee.Highlight]===!0&&(u=new Set(u),u.add(s.id)),{list:p,_listIndex:h,byId:g,view:a,_viewIndex:d,sort:l,selected:n,selectedIds:o,highlightedIds:u}}else if(lr.match(e)){const{flow:s,matching_filters:i}=e.payload,{_listIndex:l,sort:n,selectedIds:o}=t;let{view:a,_viewIndex:d,selected:u,highlightedIds:h}=t;const p=t._listIndex.get(s.id),g=[...t.list];p!==void 0?g[p]=s:g.push(s);const x=new Map(t.byId);x.set(s.id,s);const j=d.get(s.id),y=j!==void 0,b=i[Ee.Search]===!0||i[Ee.Search]===void 0;return b&&!y?{view:a,_viewIndex:d}=li(a,d,s,mt(n)):!b&&y?{view:a,_viewIndex:d}=ri(a,d,j):b&&y&&({view:a,_viewIndex:d}=Nc(a,d,s,mt(n))),o.has(s.id)&&(u=u.map(w=>w.id===s.id?s:w)),i[Ee.Highlight]===!0?h.has(s.id)||(h=new Set(h),h.add(s.id)):h=ii(h,s.id),{list:g,_listIndex:l,byId:x,view:a,_viewIndex:d,sort:n,selected:u,selectedIds:o,highlightedIds:h}}else if(or.match(e)){const s=e.payload,{sort:i}=t;let{view:l,_viewIndex:n,selected:o,selectedIds:a}=t;const d=t._listIndex.get(s);if(d===void 0)return t;const u=Rs(t.list,d,1),h=St(u),p=new Map(t.byId);p.delete(s);const g=n.get(s);if(g!==void 0&&({view:l,_viewIndex:n}=ri(l,n,g)),a.has(s)){if(o.length===1&&g!==void 0){const j=l[g]??l[g-1];o=j?[j]:[]}else o=o.filter(j=>j.id!==s);a=us(o)}const x=ii(t.highlightedIds,s);return{list:u,_listIndex:h,byId:p,view:l,_viewIndex:n,sort:i,selected:o,selectedIds:a,highlightedIds:x}}else if(cr.match(e)){const{name:s,matching_flow_ids:i}=e.payload;switch(s){case Ee.Search:{const l=ds(i===null?t.list:i.map(o=>t.byId.get(o)).filter(o=>o!==void 0),mt(t.sort)),n=St(l);return{...t,view:l,_viewIndex:n}}case Ee.Highlight:return{...t,highlightedIds:new Set(i)};default:Tt(s)}}else if(ar.match(e)){const s=e.payload;let i;s.column?i=ds(t.view,mt(s)):i=t.list.filter(n=>t._viewIndex.has(n.id));const l=St(i);return{...t,sort:s,view:i,_viewIndex:l}}else return Ke.match(e)?{...t,selected:e.payload,selectedIds:us(e.payload)}:t}function mt({column:t,desc:e}){if(!t)return(i,l)=>0;const s=Gi[t];return(i,l)=>{const n=s(i),o=s(l);return n>o?e?-1:1:n<o?e?1:-1:0}}function gt(t,e){const s=t.selected[t.selected.length-1],i=t._viewIndex.get(s?.id),l=0,n=t.view.length-1;let o;i===void 0?o=e<0?l:n:(o=i+e,o=window.Math.max(o,l),o=window.Math.min(o,n));const a=t.view[o];return Ke(a?[a]:[])}function Dc(t){return(e,s)=>{const{flows:i}=s();i.selectedIds.has(t.id)?e(Ke(i.selected.filter(l=>l!==t))):e(Ke([...i.selected,t]))}}function Fc(t){return(e,s)=>{const{flows:i}=s(),l=i.selected[i.selected.length-1],n=i._viewIndex.get(t.id),o=i._viewIndex.get(l?.id);if(n===void 0||o===void 0)return e(Ke([t]));let a;return n<=o?a=i.view.slice(n,o+1):(a=i.view.slice(o+1,n+1),a.push(l)),e(Ke(a))}}const Lc={activeModal:void 0},dr=xe({name:"ui/modal",initialState:Lc,reducers:{setActiveModal(t,e){t.activeModal=e.payload},hideModal(t){t.activeModal=void 0}}}),{actions:Pc,reducer:Mc}=dr,Oc=dr.actions.hideModal.type,{setActiveModal:qc,hideModal:ur}=Pc,ci=(()=>{const t=document.createElement("div");return t.setAttribute("contenteditable","PLAINTEXT-ONLY"),t.contentEditable==="plaintext-only"?"plaintext-only":"true"})();class fe extends P.Component{input=ke.createRef();render(){const e=Re("inline-input",this.props.className);return r.jsx("span",{ref:this.input,tabIndex:0,className:e,placeholder:this.props.placeholder,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onInput:this.onInput,onPaste:this.onPaste,onMouseDown:this.onMouseDown,onClick:this.onClick,children:this.props.content})}componentDidUpdate(e){e.content!==this.props.content&&this.props.onInput?.(this.props.content)}isEditing=()=>this.input.current?.contentEditable===ci;startEditing=()=>{if(!this.input.current)return console.error("unreachable");this.isEditing()||(this.suppress_events=!0,this.input.current.blur(),this.input.current.contentEditable=ci,window.requestAnimationFrame(()=>{if(this.input.current){if(this.input.current.focus(),this.suppress_events=!1,this.props.selectAllOnClick){const e=document.createRange();e.selectNodeContents(this.input.current);const s=window.getSelection();s?.removeAllRanges(),s?.addRange(e)}this.props.onEditStart?.()}}))};resetValue=()=>{if(!this.input.current)return console.error("unreachable");this.input.current.textContent=this.props.content,this.props.onInput?.(this.props.content)};finishEditing=()=>{if(!this.input.current)return console.error("unreachable");this.props.onEditDone(this.input.current.textContent||""),this.input.current.blur(),this.input.current.contentEditable="inherit"};onPaste=e=>{e.preventDefault();const s=e.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,s)};suppress_events=!1;onMouseDown=e=>{this.suppress_events=!0,window.addEventListener("mouseup",this.onMouseUp,{once:!0})};onMouseUp=e=>{const s=e.target===this.input.current,i=!window.getSelection()?.toString();this.props.selectAllOnClick?s&&i&&this.startEditing():s&&this.startEditing(),this.suppress_events=!1};onClick=e=>{};onFocus=e=>{if(!this.input.current)throw"unreachable";this.suppress_events||this.startEditing()};onInput=e=>{this.props.onInput?.(this.input.current?.textContent||"")};onBlur=e=>{this.suppress_events||this.finishEditing()};onKeyDown=e=>{switch(e.stopPropagation(),e.key){case"Escape":e.preventDefault(),this.resetValue(),this.finishEditing();break;case"Enter":e.shiftKey||(e.preventDefault(),this.finishEditing());break}this.props.onKeyDown?.(e)}}function Nt(t){const e=E.c(15);let s;e[0]!==t.content||e[1]!==t.isValid?(s=t.isValid(t.content),e[0]=t.content,e[1]=t.isValid,e[2]=s):s=e[2];const[i,l]=P.useState(s),n=P.useRef(null);let o;e[3]!==t?(o=x=>{t.isValid(x)?t.onEditDone(x):n.current?.resetValue()},e[3]=t,e[4]=o):o=e[4];const a=o,d=i?"has-success":"has-warning";let u;e[5]!==t.className||e[6]!==d?(u=Re(t.className,d),e[5]=t.className,e[6]=d,e[7]=u):u=e[7];const h=u;let p;e[8]!==t?(p=x=>l(t.isValid(x)),e[8]=t,e[9]=p):p=e[9];let g;return e[10]!==h||e[11]!==a||e[12]!==t||e[13]!==p?(g=r.jsx(fe,{...t,className:h,onInput:p,onEditDone:a,ref:n}),e[10]=h,e[11]=a,e[12]=t,e[13]=p,e[14]=g):g=e[14],g}const ee=()=>Jo(),F=Xo,Hc=Ei.withTypes(),Fs=Te("EVENTS_ADD"),fr=Te("EVENTS_RECEIVE"),Xt=Te("events/toggleVisibility"),pr=Te("events/toggleFilter");var hr=(t=>(t.debug="debug",t.info="info",t.web="web",t.warn="warn",t.error="error",t))(hr||{});const Vc={visible:!1,filters:{debug:!1,info:!0,web:!0,warn:!0,error:!0},list:[],view:[]};function Uc(t=Vc,e){if(Fs.match(e)){const s=e.payload;return{...t,list:[...t.list,s],view:t.filters[s.level]?[...t.view,s]:t.view}}else{if(fr.match(e))return{...t,list:e.payload,view:e.payload.filter(s=>t.filters[s.level])};if(Xt.match(e))return{...t,visible:!t.visible};if(pr.match(e)){const s={...t.filters,[e.payload]:!t.filters[e.payload]};return{...t,filters:s,view:t.list.filter(i=>s[i.level])}}else return t}}function Bc(t,e="web"){return Fs({id:Math.random().toString(),message:t,level:e})}const ai={},Kc=xe({name:"ui/optionsEditor",initialState:ai,reducers:{startUpdate(t,e){t[e.payload.option]={isUpdating:!0,value:e.payload.value,error:!1}},updateSuccess(t,e){t[e.payload.option]=void 0},updateError(t,e){let s=t[e.payload.option].value;typeof s=="boolean"&&(s=!s),t[e.payload.option]={value:s,isUpdating:!1,error:e.payload.error}}},extraReducers:t=>{t.addCase(Oc,()=>ai)}}),{actions:Wc,reducer:zc}=Kc,{startUpdate:Qc,updateSuccess:Gc,updateError:Yc}=Wc;var pe=(t=>(t[t.Capture=0]="Capture",t[t.FlowList=1]="FlowList",t[t.Options=2]="Options",t[t.Flow=3]="Flow",t[t.Metrics=4]="Metrics",t[t.AdTracking=5]="AdTracking",t))(pe||{});const Jc=xe({name:"ui/tabs",initialState:{current:1},reducers:{setCurrent(t,e){t.current=e.payload}}}),{actions:Xc,reducer:Zc}=Jc,{setCurrent:Wt}=Xc,ea=Ti({flow:vc,modal:Mc,optionsEditor:zc,tabs:Zc,filter:Cc});var Ct=(t=>(t.INIT="CONNECTION_INIT",t.FETCHING="CONNECTION_FETCHING",t.ESTABLISHED="CONNECTION_ESTABLISHED",t.ERROR="CONNECTION_ERROR",t))(Ct||{});const ta={state:"CONNECTION_INIT",message:void 0},mr=xe({name:"connection",initialState:ta,reducers:{startFetching:t=>{t.state==="CONNECTION_INIT"&&(t.state="CONNECTION_FETCHING")},finishFetching:t=>{t.state==="CONNECTION_FETCHING"&&(t.state="CONNECTION_ESTABLISHED")},connectionError:(t,e)=>{t.state="CONNECTION_ERROR",t.message=e.payload}}}),{startFetching:sa,finishFetching:na,connectionError:ia}=mr.actions,ra=mr.reducer,la={add_upstream_certs_to_client_chain:!1,allow_hosts:[],anticache:!1,anticomp:!1,block_global:!0,block_list:[],block_private:!1,body_size_limit:void 0,cert_passphrase:void 0,certs:[],ciphers_client:void 0,ciphers_server:void 0,client_certs:void 0,client_replay:[],client_replay_concurrency:1,command_history:!0,confdir:"~/.mitmproxy",connect_addr:void 0,connection_strategy:"eager",console_focus_follow:!1,content_view_lines_cutoff:512,dns_name_servers:[],dns_use_hosts_file:!0,export_preserve_original_ip:!1,hardump:"",http2:!0,http2_ping_keepalive:58,http3:!0,http_connect_send_host_header:!0,ignore_hosts:[],intercept:void 0,intercept_active:!1,keep_alt_svc_header:!1,keep_host_header:!1,key_size:2048,listen_host:"",listen_port:void 0,map_local:[],map_remote:[],mode:["regular"],modify_body:[],modify_headers:[],normalize_outbound_headers:!0,onboarding:!0,onboarding_host:"mitm.it",protobuf_definitions:void 0,proxy_debug:!1,proxyauth:void 0,rawtcp:!0,readfile_filter:void 0,request_client_cert:!1,rfile:void 0,save_stream_file:void 0,save_stream_filter:void 0,scripts:[],server:!0,server_replay:[],server_replay_extra:"forward",server_replay_ignore_content:!1,server_replay_ignore_host:!1,server_replay_ignore_params:[],server_replay_ignore_payload_params:[],server_replay_ignore_port:!1,server_replay_kill_extra:!1,server_replay_nopop:!1,server_replay_refresh:!0,server_replay_reuse:!1,server_replay_use_headers:[],show_ignored_hosts:!1,showhost:!1,ssl_insecure:!1,ssl_verify_upstream_trusted_ca:void 0,ssl_verify_upstream_trusted_confdir:void 0,stickyauth:void 0,stickycookie:void 0,store_streamed_bodies:!1,stream_large_bodies:void 0,strip_ech:!0,tcp_hosts:[],tcp_timeout:600,termlog_verbosity:"info",tls_ecdh_curve_client:void 0,tls_ecdh_curve_server:void 0,tls_version_client_max:"UNBOUNDED",tls_version_client_min:"TLS1_2",tls_version_server_max:"UNBOUNDED",tls_version_server_min:"TLS1_2",udp_hosts:[],upstream_auth:void 0,upstream_cert:!0,validate_inbound_headers:!0,view_filter:void 0,view_order:"time",view_order_reversed:!1,web_columns:["tls","icon","path","method","status","size","time"],web_debug:!1,web_host:"127.0.0.1",web_open_browser:!0,web_password:"",web_port:8081,web_static_viewer:"",websocket:!0},Zt=Te("OPTIONS_RECEIVE"),Ls=Te("OPTIONS_UPDATE"),oa=xe({name:"options",initialState:la,reducers:{},extraReducers:t=>{t.addCase(Zt,(e,s)=>{const i={};for(const[l,{value:n}]of Object.entries(s.payload))i[l]=n;return i}).addCase(Ls,(e,s)=>{for(const[i,{value:l}]of Object.entries(s.payload))e[i]=l})}}),ca=oa.reducer;async function aa(t,e,s){try{const i=await le.put("/options",{[t]:e});if(i.status===200)s(Gc({option:t}));else throw await i.text()}catch(i){s(Yc({option:t,error:i.toString()}))}}const da=aa;function Ps(t,e){return s=>{s(Qc({option:t,value:e})),da(t,e,s)}}const ua={visible:!1},fa=xe({name:"commandBar",initialState:ua,reducers:{toggleVisibility(t){t.visible=!t.visible}}}),{actions:pa,reducer:ha}=fa,{toggleVisibility:gr}=pa,We=Te("STATE_RECEIVE"),ze=Te("STATE_UPDATE"),ma={available:!1,version:"",contentViews:[],servers:{},platform:"",localModeUnavailable:null},ga=xe({name:"backendState",initialState:ma,reducers:{},extraReducers:t=>{t.addCase(We,(e,s)=>({...e,available:!0,...s.payload})).addCase(ze,(e,s)=>({...e,...s.payload}))}}),xa=ga.reducer,va={},_a=xe({name:"optionsMeta",initialState:va,reducers:{},extraReducers:t=>{t.addCase(Zt,(e,s)=>s.payload).addCase(Ls,(e,s)=>({...e,...s.payload}))}}),ja=_a.reducer,ft=(t,e)=>e.listen_host&&e.listen_port?`${t}@${e.listen_host}:${e.listen_port}`:e.listen_port?`${t}@${e.listen_port}`:t,xr=t=>{let[e,s]=js(t,"@");e||(e=s,s="");const[i,l]=Pi(e,":");let n,o;if(s){let a;if(s.includes(":")?[n,a]=js(s,":"):(n="",a=s),a&&(o=parseInt(a,10),isNaN(o)||o<0||o>65535))throw new Error(`invalid port: ${a}`)}return{full_spec:t,name:i,data:l,listen_host:n,listen_port:o}},vr=t=>ft("regular",t),di=({listen_host:t,listen_port:e})=>({ui_id:Math.random(),active:!0,listen_host:t,listen_port:e}),_r=t=>t.selectedProcesses?`local:${t.selectedProcesses}`:"local",ui=({data:t})=>({ui_id:Math.random(),active:!0,selectedProcesses:t}),jr=t=>{const e=t.file_path?`wireguard:${t.file_path}`:"wireguard";return ft(e,t)},fi=({data:t,listen_host:e,listen_port:s})=>({ui_id:Math.random(),active:!0,listen_host:e,listen_port:s,file_path:t});var es=(t=>(t.HTTP="http",t.HTTPS="https",t.HTTP3="http3",t.TLS="tls",t.DTLS="dtls",t.TCP="tcp",t.UDP="udp",t.DNS="dns",t.QUIC="quic",t))(es||{}),ct=(t=>(t.CSS="css",t.JAVASCRIPT="javascript",t.XML="xml",t.YAML="yaml",t.NONE="none",t.ERROR="error",t))(ct||{});const ys=()=>({active:!1,protocol:es.HTTPS,destination:"",ui_id:Math.random()}),Ms=t=>ft(`reverse:${t.protocol}://${t.destination}`,t),ya=({data:t,listen_host:e,listen_port:s})=>{let[i,l]=Pi(t,"://");return l||(l=i,i=es.HTTPS),{ui_id:Math.random(),active:!0,protocol:i,destination:l,listen_host:e,listen_port:s}},yr=t=>ft("transparent",t),pi=({listen_host:t,listen_port:e})=>({ui_id:Math.random(),active:!0,listen_host:t,listen_port:e}),br=t=>ft("socks5",t),hi=({listen_host:t,listen_port:e})=>({ui_id:Math.random(),active:!0,listen_host:t,listen_port:e}),Sr=t=>ft(`upstream:${t.destination}`,t),mi=({data:t,listen_host:e,listen_port:s})=>({ui_id:Math.random(),active:!0,destination:t||"",listen_host:e,listen_port:s}),wr=t=>ft("dns",t),gi=({listen_host:t,listen_port:e})=>({ui_id:Math.random(),active:!0,listen_host:t,listen_port:e}),et=t=>t.active&&!t.error;async function ba(t,e){const s=e.getState().modes,i=[...s.regular.filter(et).map(vr),...s.local.filter(et).map(_r),...s.wireguard.filter(et).map(jr),...s.reverse.filter(et).map(Ms),...s.transparent.filter(et).map(yr),...s.socks.filter(et).map(br),...s.upstream.filter(et).map(Sr),...s.dns.filter(et).map(wr)],l=await le.put("/options",{mode:i});if(l.status!==200)throw new Error(await l.text())}function oe(t){return Hc(t,ba)}function re(t,e,s){t.addCase(s.pending,(i,l)=>{const{server:n,value:o}=l.meta.arg,a=i.findIndex(d=>d.ui_id===n.ui_id);a>=0&&(i[a][e]=o,i[a].error=void 0)}),t.addCase(s.rejected,(i,l)=>{const{server:n}=l.meta.arg,o=i.findIndex(a=>a.ui_id===n.ui_id);o>=0&&(i[o].error=l.error.message)})}function Ie(t,e){return function(i,l){if(l.payload.servers){const n=Object.values(l.payload.servers).filter(o=>o.type===t).map(o=>xr(o.full_spec));if(n.length>0)return n.map(e);for(const o of i)o.active=!1}}}const $r=oe("modes/regular/setActive"),Cr=oe("modes/regular/setListenHost"),Nr=oe("modes/regular/setListenPort"),Sa=[{active:!0,ui_id:Math.random()}],wa=xe({name:"modes/regular",initialState:Sa,reducers:{},extraReducers:t=>{re(t,"active",$r),re(t,"listen_host",Cr),re(t,"listen_port",Nr),t.addCase(We,Ie("regular",di)),t.addCase(ze,Ie("regular",di))}}),$a=wa.reducer,kr=oe("modes/local/setActive"),kt=oe("modes/local/setSelectedProcesses"),Ca=[{active:!1,selectedProcesses:"",ui_id:Math.random()}],Na=xe({name:"modes/local",initialState:Ca,reducers:{},extraReducers:t=>{re(t,"active",kr),re(t,"selectedProcesses",kt),t.addCase(We,Ie("local",ui)),t.addCase(ze,Ie("local",ui))}}),ka=Na.reducer,Er=oe("modes/wireguard/setActive"),Tr=oe("modes/wireguard/setListenHost"),Rr=oe("modes/wireguard/setListenPort"),Ar=oe("modes/wireguard/setFilePath"),Ea=[{active:!1,ui_id:Math.random()}],Ta=xe({name:"modes/wireguard",initialState:Ea,reducers:{},extraReducers:t=>{re(t,"active",Er),re(t,"listen_host",Tr),re(t,"listen_port",Rr),re(t,"file_path",Ar),t.addCase(We,Ie("wireguard",fi)),t.addCase(ze,Ie("wireguard",fi))}}),Ra=Ta.reducer,bs=oe("modes/reverse/setActive"),Ir=oe("modes/reverse/setListenHost"),Dr=oe("modes/reverse/setListenPort"),Fr=oe("modes/reverse/setProtocol"),Lr=oe("modes/reverse/setDestination"),Aa=[ys()],Pr=xe({name:"modes/reverse",initialState:Aa,reducers:{addServer:t=>{t.push(ys())},removeServer:(t,e)=>{const s=t.findIndex(i=>i.ui_id===e.payload.ui_id);s!==-1&&(t[s].active&&console.error("servers should be deactivated before removal"),t.splice(s,1))}},extraReducers:t=>{re(t,"active",bs),re(t,"listen_host",Ir),re(t,"listen_port",Dr),re(t,"protocol",Fr),re(t,"destination",Lr),t.addCase(We,e),t.addCase(ze,e);function e(s,i){if(i.payload.servers){const l=Object.fromEntries(Object.entries(i.payload.servers).filter(([o,a])=>a.type==="reverse").map(([o,a])=>[o,xr(o)])),n=[];for(const o of s){const a=Ms(o),d=a in l;delete l[a],n.push({...o,active:d})}for(const o of Object.values(l))n.push(ya(o));return n.length>1&&Jt({...n[0],ui_id:void 0},{...ys(),ui_id:void 0})&&n.shift(),n}}}}),{addServer:Ia,removeServer:Da}=Pr.actions,Fa=Pr.reducer,Mr=oe("modes/transparent/setActive"),Or=oe("modes/transparent/setListenHost"),qr=oe("modes/transparent/setListenPort"),La=[{active:!1,ui_id:Math.random()}],Pa=xe({name:"modes/transparent",initialState:La,reducers:{},extraReducers:t=>{re(t,"active",Mr),re(t,"listen_host",Or),re(t,"listen_port",qr),t.addCase(We,Ie("transparent",pi)),t.addCase(ze,Ie("transparent",pi))}}),Ma=Pa.reducer,Hr=oe("modes/socks5/setActive"),Vr=oe("modes/socks5/setListenHost"),Ur=oe("modes/socks5/setListenPort"),Oa=[{active:!1,ui_id:Math.random()}],qa=xe({name:"modes/socks5",initialState:Oa,reducers:{},extraReducers:t=>{re(t,"active",Hr),re(t,"listen_host",Vr),re(t,"listen_port",Ur),t.addCase(We,Ie("socks5",hi)),t.addCase(ze,Ie("socks5",hi))}}),Ha=qa.reducer,Br=oe("modes/upstream/setActive"),Kr=oe("modes/upstream/setListenHost"),Wr=oe("modes/upstream/setListenPort"),zr=oe("modes/upstream/setDestination"),Va=[{active:!1,destination:"",ui_id:Math.random()}],Ua=xe({name:"modes/upstream",initialState:Va,reducers:{},extraReducers:t=>{re(t,"active",Br),re(t,"listen_host",Kr),re(t,"listen_port",Wr),re(t,"destination",zr),t.addCase(We,Ie("upstream",mi)),t.addCase(ze,Ie("upstream",mi))}}),Ba=Ua.reducer,Qr=oe("modes/dns/setActive"),Gr=oe("modes/dns/setListenHost"),Yr=oe("modes/dns/setListenPort"),Ka=[{active:!0,ui_id:Math.random()}],Wa=xe({name:"modes/dns",initialState:Ka,reducers:{},extraReducers:t=>{re(t,"active",Qr),re(t,"listen_host",Gr),re(t,"listen_port",Yr),t.addCase(We,Ie("dns",gi)),t.addCase(ze,Ie("dns",gi))}}),za=Wa.reducer,Qa=Ti({regular:$a,local:ka,wireguard:Ra,reverse:Fa,transparent:Ma,socks:Ha,upstream:Ba,dns:za}),Et=Ei("fetchProcesses",async(t,{rejectWithValue:e})=>{try{return(await le("/processes")).json()}catch(s){return e(s.message)}}),Ga={currentProcesses:[],isLoading:!1},Ya=xe({name:"processes",initialState:Ga,reducers:{},extraReducers:t=>{t.addCase(Et.pending,e=>{e.isLoading=!0,e.error=void 0}),t.addCase(Et.fulfilled,(e,s)=>{e.isLoading=!1,e.currentProcesses=s.payload}),t.addCase(Et.rejected,(e,s)=>{e.isLoading=!1,e.error=s.payload})}}),Ja=Ya.reducer,Xa={commandBar:ha,eventLog:Uc,flows:Ic,connection:ra,modes:Qa,ui:ea,options:ca,options_meta:ja,backendState:xa,processes:Ja},Za={immutableCheck:{warnAfter:5e5},serializableCheck:{warnAfter:5e5,ignoredPaths:["flows"]}},Rt=Zo({reducer:Xa,middleware:t=>t(Za),devTools:!1});class ed extends P.Component{container=ke.createRef();nameInput=ke.createRef();valueInput=ke.createRef();render=()=>{const[e,s]=this.props.item;return r.jsxs("div",{ref:this.container,className:"kv-row",onClick:this.onClick,onKeyDownCapture:this.onKeyDown,children:[r.jsx(fe,{ref:this.nameInput,className:"kv-key",content:e,onEditStart:this.props.onEditStart,onEditDone:i=>this.props.onEditDone([i,s]),selectAllOnClick:!0}),": ",r.jsx(fe,{ref:this.valueInput,className:"kv-value",content:s,onEditStart:this.props.onEditStart,onEditDone:i=>this.props.onEditDone([e,i]),placeholder:"empty",selectAllOnClick:!0})]})};onClick=e=>{e.target===this.container.current&&this.props.onClickEmptyArea()};onKeyDown=e=>{e.target===this.valueInput.current?.input.current&&e.key==="Tab"&&this.props.onTabNext()}}class Jr extends P.Component{rowRefs={};currentlyEditing;justFinishedEditing;state={currentList:this.props.data||[],initialList:this.props.data};static getDerivedStateFromProps(e,s){return e.data!==s.initialList?{currentList:e.data||[],initialList:e.data}:null}render=()=>{this.rowRefs={};const e=this.state.currentList.map((s,i)=>r.jsx(ed,{item:s,onEditStart:()=>this.currentlyEditing=i,onEditDone:l=>this.onEditDone(i,l),onClickEmptyArea:()=>this.onClickEmptyArea(i),onTabNext:()=>this.onTabNext(i),ref:l=>{this.rowRefs[i]=l}},i));return r.jsxs("div",{className:Re("kv-editor",this.props.className),onMouseDown:this.onMouseDown,children:[e,r.jsx("div",{onClick:s=>{s.preventDefault(),this.onClickEmptyArea(this.state.currentList.length-1)},className:"kv-add-row fa fa-plus-square-o",role:"button","aria-label":"Add"})]})};onEditDone=(e,s)=>{const i=[...this.state.currentList];s[0]?i[e]=s:i.splice(e,1),this.currentlyEditing=void 0,Kt.isEqual(this.state.currentList,i)||this.props.onChange(i),this.setState({currentList:i})};onClickEmptyArea=e=>{if(this.justFinishedEditing)return;const s=[...this.state.currentList];s.splice(e+1,0,["",""]),this.setState({currentList:s},()=>this.rowRefs[e+1]?.nameInput.current?.startEditing())};onTabNext=e=>{e==this.state.currentList.length-1&&this.onClickEmptyArea(e)};onMouseDown=e=>{this.justFinishedEditing=this.currentlyEditing}}function Xr(t,e){const s=E.c(6),[i,l]=P.useState(),[n,o]=P.useState();let a;s[0]!==n||s[1]!==t?(a=()=>{n&&n.abort();const u=new AbortController;return le(t,{signal:u.signal}).then(td).then(h=>{l(h)}).catch(h=>{u.signal.aborted||l(`Error getting content: ${h}.`)}),o(u),()=>{u.signal.aborted||u.abort()}},s[0]=n,s[1]=t,s[2]=a):a=s[2];let d;return s[3]!==e||s[4]!==t?(d=[t,e],s[3]=e,s[4]=t,s[5]=d):d=s[5],P.useEffect(a,d),i}function td(t){if(!t.ok)throw`${t.status} ${t.statusText}`.trim();return t.text()}function Zr(t,e,s,i,l){const n=E.c(11);let o;n[0]!==t||n[1]!==i||n[2]!==e||n[3]!==s?(o=Ae.getContentURL(t,e,s,i),n[0]=t,n[1]=i,n[2]=e,n[3]=s,n[4]=o):o=n[4];const d=Xr(o,l);let u;if(d)try{let h;n[5]!==d?(h=JSON.parse(d),n[5]=d,n[6]=h):h=n[6],u=h}catch{let h;n[7]!==d?(h={text:d,description:"Network Error",syntax_highlight:"error",view_name:"raw"},n[7]=d,n[8]=h):h=n[8];const p=h;if(e==="messages"){let g;n[9]!==p?(g=[p],n[9]=p,n[10]=g):g=n[10],u=g}else u=p}else u=void 0;return u}const el=ke.memo(function({icon:e,text:s,className:i,title:l,onOpenFile:n,onClick:o}){let a;return r.jsxs("a",{href:"#",onClick:d=>{a.click(),o&&o(d)},className:i,title:l,children:[r.jsx("i",{className:"fa fa-fw "+e}),s,r.jsx("input",{ref:d=>{a=d},className:"hidden",type:"file",onChange:d=>{d.preventDefault(),d.target.files&&d.target.files.length>0&&n(d.target.files[0]),a.value=""}})]})});function _e(t){const e=E.c(11),{onClick:s,children:i,icon:l,disabled:n,className:o,title:a}=t;let d;e[0]!==o?(d=Re(o,"btn btn-default"),e[0]=o,e[1]=d):d=e[1];const u=n?void 0:s;let h;e[2]!==l?(h=l&&r.jsxs(r.Fragment,{children:[r.jsx("i",{className:"fa "+l})," "]}),e[2]=l,e[3]=h):h=e[3];let p;return e[4]!==i||e[5]!==n||e[6]!==d||e[7]!==u||e[8]!==h||e[9]!==a?(p=r.jsxs("button",{className:d,onClick:u,disabled:n,title:a,children:[h,i]}),e[4]=i,e[5]=n,e[6]=d,e[7]=u,e[8]=h,e[9]=a,e[10]=p):p=e[10],p}function sd(t){const e=E.c(11),{initialContent:s,onChange:i,language:l,readonly:n}=t,o=n===void 0?!1:n,a=nd;let d;e:switch(l){case ct.YAML:{let p;e[0]===Symbol.for("react.memo_cache_sentinel")?(p=[nc()],e[0]=p):p=e[0],d=p;break e}case ct.XML:{let p;e[1]===Symbol.for("react.memo_cache_sentinel")?(p=[sc()],e[1]=p):p=e[1],d=p;break e}case ct.JAVASCRIPT:{let p;e[2]===Symbol.for("react.memo_cache_sentinel")?(p=[tc()],e[2]=p):p=e[2],d=p;break e}case ct.CSS:{let p;e[3]===Symbol.for("react.memo_cache_sentinel")?(p=[ec()],e[3]=p):p=e[3],d=p;break e}case void 0:case null:case ct.NONE:case ct.ERROR:{let p;e[4]===Symbol.for("react.memo_cache_sentinel")?(p=[],e[4]=p):p=e[4],d=p;break e}default:{console.error("Unexpected syntax highlighting language: ",l);let g;e[5]===Symbol.for("react.memo_cache_sentinel")?(g=[],e[5]=g):g=e[5],d=g}}const u=d;let h;return e[6]!==u||e[7]!==s||e[8]!==i||e[9]!==o?(h=r.jsx("div",{className:"codeeditor",onKeyDown:a,children:r.jsx(ic,{value:s,onChange:i,readOnly:o,extensions:u})}),e[6]=u,e[7]=s,e[8]=i,e[9]=o,e[10]=h):h=e[10],h}function nd(t){return t.stopPropagation()}const tl=ke.memo(function(e){const s=E.c(9),{content:i,maxLines:l,showMore:n}=e;if(i.length===0)return null;let o;if(s[0]!==i||s[1]!==l||s[2]!==n){let d;s[4]!==l||s[5]!==n?(d=(u,h)=>h===l?r.jsxs("button",{onClick:n,className:"btn btn-xs btn-info",children:[r.jsx("i",{className:"fa fa-angle-double-down","aria-hidden":"true"})," ","Show more"]},"showmore"):r.jsx("div",{children:u},h),s[4]=l,s[5]=n,s[6]=d):d=s[6],o=i.split(`
`).map(d),s[0]=i,s[1]=l,s[2]=n,s[3]=o}else o=s[3];let a;return s[7]!==o?(a=r.jsx("pre",{children:o}),s[7]=o,s[8]=a):a=s[8],a}),id=()=>{const t=E.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=r.jsx("li",{role:"separator",className:"divider"}),t[0]=e):e=t[0],e};function Le(t){const e=E.c(8);let s,i,l;if(e[0]!==t){const{onClick:a,children:d,...u}=t;i=d,s=u,l=h=>{h.preventDefault(),a()},e[0]=t,e[1]=s,e[2]=i,e[3]=l}else s=e[1],i=e[2],l=e[3];const n=l;let o;return e[4]!==s||e[5]!==i||e[6]!==n?(o=r.jsx("li",{children:r.jsx("a",{href:"#",onClick:n,...s,children:i})}),e[4]=s,e[5]=i,e[6]=n,e[7]=o):o=e[7],o}const It=ke.memo(function({text:e,children:s,options:i,className:l,onOpen:n,...o}){const[a,d]=P.useState(!1),{refs:u,floatingStyles:h}=rc(i),p=x=>{d(x),n&&n(x)};P.useEffect(()=>{u.floating.current&&document.addEventListener("click",x=>{u.floating.current?.contains(x.target)?document.addEventListener("click",()=>p(!1),{once:!0}):(x.preventDefault(),x.stopPropagation(),p(!1))},{once:!0,capture:!0})},[u.floating.current]);let g;return a?g=r.jsx("ul",{className:"dropdown-menu show",ref:u.setFloating,style:h,children:s}):g=null,r.jsxs(r.Fragment,{children:[r.jsx("a",{href:"#",ref:u.setReference,className:Re(l,{open:a}),onClick:x=>{x.preventDefault(),p(!0)},...o,children:e}),g]})});function sl(t){const e=E.c(16),{value:s,onChange:i}=t,l=F(rd);let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("i",{className:"fa fa-fw fa-files-o"}),e[0]=n):n=e[0];let o;e[1]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsx("b",{children:"View:"}),e[1]=o):o=e[1];let a;e[2]!==s?(a=s.toLowerCase(),e[2]=s,e[3]=a):a=e[3];let d;e[4]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx("span",{className:"caret"}),e[4]=d):d=e[4];let u;e[5]!==a?(u=r.jsxs("span",{children:[n," ",o," ",a," ",d]}),e[5]=a,e[6]=u):u=e[6];const h=u;let p;e[7]===Symbol.for("react.memo_cache_sentinel")?(p={placement:"top-end"},e[7]=p):p=e[7];let g;if(e[8]!==l||e[9]!==i){let j;e[11]!==i?(j=y=>r.jsx(Le,{onClick:()=>i(y),children:y.toLowerCase().replace("_"," ")},y),e[11]=i,e[12]=j):j=e[12],g=l.map(j),e[8]=l,e[9]=i,e[10]=g}else g=e[10];let x;return e[13]!==h||e[14]!==g?(x=r.jsx(It,{text:h,className:"btn btn-default btn-xs",options:p,children:g}),e[13]=h,e[14]=g,e[15]=x):x=e[15],x}function rd(t){return t.backendState.contentViews||[]}function ld(t){const e=E.c(8),{flow:s,message:i}=t,[l,n]=P.useState(!1);if(l){let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=()=>n(!1),e[0]=o):o=e[0];let a;return e[1]!==s||e[2]!==i?(a=r.jsx(od,{flow:s,message:i,stopEdit:o}),e[1]=s,e[2]=i,e[3]=a):a=e[3],a}else{let o;e[4]===Symbol.for("react.memo_cache_sentinel")?(o=()=>n(!0),e[4]=o):o=e[4];let a;return e[5]!==s||e[6]!==i?(a=r.jsx(cd,{flow:s,message:i,startEdit:o}),e[5]=s,e[6]=i,e[7]=a):a=e[7],a}}function od(t){const e=E.c(23),{flow:s,message:i,stopEdit:l}=t,n=ee(),o=s.request===i?"request":"response";let a;e[0]!==s||e[1]!==i?(a=Ae.getContentURL(s,i),e[0]=s,e[1]=i,e[2]=a):a=e[2];const u=Xr(a,i.contentHash),[h,p]=P.useState();let g;e[3]!==u||e[4]!==n||e[5]!==h||e[6]!==s||e[7]!==o||e[8]!==l?(g=async()=>{await n(Ve(s,{[o]:{content:h||u||""}})),l()},e[3]=u,e[4]=n,e[5]=h,e[6]=s,e[7]=o,e[8]=l,e[9]=g):g=e[9];const x=g;let j;e[10]===Symbol.for("react.memo_cache_sentinel")?(j=r.jsx("h5",{children:"[Editing]"}),e[10]=j):j=e[10];let y;e[11]!==x?(y=r.jsx(_e,{onClick:x,icon:"fa-check text-success",className:"btn-xs",children:"Done"}),e[11]=x,e[12]=y):y=e[12];let b;e[13]!==l?(b=r.jsx(_e,{onClick:()=>l(),icon:"fa-times text-danger",className:"btn-xs",children:"Cancel"}),e[13]=l,e[14]=b):b=e[14];let w;e[15]!==y||e[16]!==b?(w=r.jsxs("div",{className:"controls",children:[j,y," ",b]}),e[15]=y,e[16]=b,e[17]=w):w=e[17];const C=u||"";let k;e[18]!==C?(k=r.jsx(sd,{initialContent:C,onChange:p}),e[18]=C,e[19]=k):k=e[19];let T;return e[20]!==w||e[21]!==k?(T=r.jsxs("div",{className:"contentview",children:[w,k]},"edit"),e[20]=w,e[21]=k,e[22]=T):T=e[22],T}function cd(t){const e=E.c(43),{flow:s,message:i,startEdit:l}=t,n=ee(),o=s.request===i?"request":"response";let a;e[0]!==s.id||e[1]!==o?(a=q=>q.ui.flow.contentViewFor[s.id+o]||"Auto",e[0]=s.id,e[1]=o,e[2]=a):a=e[2];const d=F(a),[u,h]=P.useState(F(ad));let p;e[3]!==u?(p=()=>h(Math.max(1024,u*2)),e[3]=u,e[4]=p):p=e[4];const g=p,x=Zr(s,i,d,u+1,i.contentHash);let j;if(i.contentLength===0)j="No content";else if(x===void 0)j="Loading...";else{const q=`${x.view_name} ${x.description}`;let U;e[5]!==q?(U=q.trimEnd(),e[5]=q,e[6]=U):U=e[6],j=U}let y;e[7]!==j?(y=r.jsx("h5",{children:j}),e[7]=j,e[8]=y):y=e[8];let b;e[9]!==x||e[10]!==s||e[11]!==i?(b=x&&x?.text.length>0&&r.jsx(dd,{flow:s,message:i}),e[9]=x,e[10]=s,e[11]=i,e[12]=b):b=e[12];let w;e[13]!==l?(w=r.jsx(_e,{onClick:l,icon:"fa-edit",className:"btn-xs",children:"Edit"}),e[13]=l,e[14]=w):w=e[14];let C;e[15]!==n||e[16]!==s||e[17]!==o?(C=r.jsx(el,{icon:"fa-upload",text:"Replace",title:"Upload a file to replace the content.",onOpenFile:q=>n(Tc(s,q,o)),className:"btn btn-default btn-xs"}),e[15]=n,e[16]=s,e[17]=o,e[18]=C):C=e[18];let k;e[19]!==n||e[20]!==s.id||e[21]!==o?(k=q=>n(Ii({messageId:s.id+o,contentView:q})),e[19]=n,e[20]=s.id,e[21]=o,e[22]=k):k=e[22];let T;e[23]!==d||e[24]!==k?(T=r.jsx(sl,{value:d,onChange:k}),e[23]=d,e[24]=k,e[25]=T):T=e[25];let D;e[26]!==y||e[27]!==b||e[28]!==w||e[29]!==C||e[30]!==T?(D=r.jsxs("div",{className:"controls",children:[y,b," ",w," ",C," ",T]}),e[26]=y,e[27]=b,e[28]=w,e[29]=C,e[30]=T,e[31]=D):D=e[31];let I;e[32]!==s||e[33]!==i?(I=Ss.matches(i)&&r.jsx(Ss,{flow:s,message:i}),e[32]=s,e[33]=i,e[34]=I):I=e[34];const M=x?.text??"";let O;e[35]!==u||e[36]!==g||e[37]!==M?(O=r.jsx(tl,{content:M,maxLines:u,showMore:g}),e[35]=u,e[36]=g,e[37]=M,e[38]=O):O=e[38];let V;return e[39]!==I||e[40]!==O||e[41]!==D?(V=r.jsxs("div",{className:"contentview",children:[D,I,O]},"view"),e[39]=I,e[40]=O,e[41]=D,e[42]=V):V=e[42],V}function ad(t){return t.options.content_view_lines_cutoff}function dd({flow:t,message:e}){const s=t.request===e?"request":"response",i=F(u=>u.ui.flow.contentViewFor[t.id+s]||"Auto"),[l,n]=P.useState(!1),[o,a]=P.useState(!1),d=async()=>{try{const u=Ae.getContentURL(t,e,i);a(!0);const h=await le(u);if(!h.ok)throw new Error(`${h.status} ${h.statusText}`.trim());const p=await h.json();await jc(p),n(!0),setTimeout(()=>n(!1),2e3)}catch(u){console.error(u)}finally{a(!1)}};return r.jsx(_e,{onClick:d,icon:"fa-clipboard",className:"btn-xs",disabled:o,children:l?"Copied!":"Copy"})}const ud=/^image\/(png|jpe?g|gif|webp|vnc.microsoft.icon|x-icon|svg\+xml)$/i;Ss.matches=t=>ud.test(Ae.getContentType(t)||"");function Ss(t){const e=E.c(5),{flow:s,message:i}=t;let l;e[0]!==s||e[1]!==i?(l=Ae.getContentURL(s,i),e[0]=s,e[1]=i,e[2]=l):l=e[2];let n;return e[3]!==l?(n=r.jsx("div",{className:"flowview-image",children:r.jsx("img",{src:l,alt:"preview",className:"img-thumbnail"})}),e[3]=l,e[4]=n):n=e[4],n}function fd(t){const e=E.c(24),{flow:s}=t,i=ee();let l;e[0]!==i||e[1]!==s?(l=g=>i(Ve(s,{request:{method:g}})),e[0]=i,e[1]=s,e[2]=l):l=e[2];let n;e[3]!==s.request.method||e[4]!==l?(n=r.jsx(Nt,{content:s.request.method,onEditDone:l,isValid:hd,selectAllOnClick:!0}),e[3]=s.request.method,e[4]=l,e[5]=n):n=e[5];let o;e[6]!==s.request?(o=dt.pretty_url(s.request),e[6]=s.request,e[7]=o):o=e[7];let a;e[8]!==i||e[9]!==s?(a=g=>i(Ve(s,{request:{path:"",...Oi(g)}})),e[8]=i,e[9]=s,e[10]=a):a=e[10];let d;e[11]!==o||e[12]!==a?(d=r.jsx(Nt,{content:o,onEditDone:a,isValid:pd}),e[11]=o,e[12]=a,e[13]=d):d=e[13];let u;e[14]!==i||e[15]!==s?(u=g=>i(Ve(s,{request:{http_version:g}})),e[14]=i,e[15]=s,e[16]=u):u=e[16];let h;e[17]!==s.request.http_version||e[18]!==u?(h=r.jsx(Nt,{content:s.request.http_version,onEditDone:u,isValid:qi,selectAllOnClick:!0}),e[17]=s.request.http_version,e[18]=u,e[19]=h):h=e[19];let p;return e[20]!==n||e[21]!==d||e[22]!==h?(p=r.jsx("div",{className:"first-line request-line",children:r.jsxs("div",{children:[n," ",d," ",h]})}),e[20]=n,e[21]=d,e[22]=h,e[23]=p):p=e[23],p}function pd(t){return!!Oi(t)?.host}function hd(t){return t.length>0}function md(t){const e=E.c(19),{flow:s}=t,i=ee();let l;e[0]!==i||e[1]!==s?(l=p=>i(Ve(s,{response:{http_version:p}})),e[0]=i,e[1]=s,e[2]=l):l=e[2];let n;e[3]!==s.response.http_version||e[4]!==l?(n=r.jsx(Nt,{content:s.response.http_version,onEditDone:l,isValid:qi,selectAllOnClick:!0}),e[3]=s.response.http_version,e[4]=l,e[5]=n):n=e[5];const o=s.response.status_code+"";let a;e[6]!==i||e[7]!==s?(a=p=>i(Ve(s,{response:{code:parseInt(p)}})),e[6]=i,e[7]=s,e[8]=a):a=e[8];let d;e[9]!==o||e[10]!==a?(d=r.jsx(Nt,{content:o,onEditDone:a,isValid:gd,selectAllOnClick:!0}),e[9]=o,e[10]=a,e[11]=d):d=e[11];let u;e[12]!==i||e[13]!==s?(u=s.response.http_version!=="HTTP/2.0"&&r.jsxs(r.Fragment,{children:[" ",r.jsx(fe,{content:s.response.reason,onEditDone:p=>i(Ve(s,{response:{msg:p}})),selectAllOnClick:!0})]}),e[12]=i,e[13]=s,e[14]=u):u=e[14];let h;return e[15]!==n||e[16]!==d||e[17]!==u?(h=r.jsxs("div",{className:"first-line response-line",children:[n," ",d,u]}),e[15]=n,e[16]=d,e[17]=u,e[18]=h):h=e[18],h}function gd(t){return/^\d+$/.test(t)}function xd(t){const e=E.c(7),{flow:s,message:i}=t,l=ee(),n=s.request===i?"request":"response";let o;e[0]!==l||e[1]!==s||e[2]!==n?(o=d=>l(Ve(s,{[n]:{headers:d}})),e[0]=l,e[1]=s,e[2]=n,e[3]=o):o=e[3];let a;return e[4]!==i.headers||e[5]!==o?(a=r.jsx(Jr,{className:"headers",data:i.headers,onChange:o}),e[4]=i.headers,e[5]=o,e[6]=a):a=e[6],a}function vd(t){const e=E.c(9),{flow:s,message:i}=t,l=ee(),n=s.request===i?"request":"response";if(!!!Ae.get_first_header(i,/^trailer$/i))return null;let a,d;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("hr",{}),d=r.jsx("h5",{children:"HTTP Trailers"}),e[0]=a,e[1]=d):(a=e[0],d=e[1]);let u;e[2]!==l||e[3]!==s||e[4]!==n?(u=p=>l(Ve(s,{[n]:{trailers:p}})),e[2]=l,e[3]=s,e[4]=n,e[5]=u):u=e[5];let h;return e[6]!==i.trailers||e[7]!==u?(h=r.jsxs(r.Fragment,{children:[a,d,r.jsx(Jr,{className:"trailers",data:i.trailers,onChange:u})]}),e[6]=i.trailers,e[7]=u,e[8]=h):h=e[8],h}const nl=P.memo(function(e){const s=E.c(20),{flow:i,message:l}=e,n=i.request===l?"request":"response",o=i.request===l?fd:md;let a;s[0]!==o||s[1]!==i?(a=r.jsx(o,{flow:i}),s[0]=o,s[1]=i,s[2]=a):a=s[2];let d;s[3]!==i||s[4]!==l?(d=r.jsx(xd,{flow:i,message:l}),s[3]=i,s[4]=l,s[5]=d):d=s[5];let u;s[6]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("hr",{}),s[6]=u):u=s[6];const h=i.id+n;let p;s[7]!==i||s[8]!==l||s[9]!==h?(p=r.jsx(ld,{flow:i,message:l},h),s[7]=i,s[8]=l,s[9]=h,s[10]=p):p=s[10];let g;s[11]!==i||s[12]!==l?(g=r.jsx(vd,{flow:i,message:l}),s[11]=i,s[12]=l,s[13]=g):g=s[13];let x;return s[14]!==n||s[15]!==a||s[16]!==d||s[17]!==p||s[18]!==g?(x=r.jsxs("section",{className:n,children:[a,d,u,p,g]}),s[14]=n,s[15]=a,s[16]=d,s[17]=p,s[18]=g,s[19]=x):x=s[19],x});function il(){const t=E.c(2),e=F(_d);let s;return t[0]!==e?(s=r.jsx(nl,{flow:e,message:e.request}),t[0]=e,t[1]=s):s=t[1],s}function _d(t){return t.flows.selected[0]}il.displayName="Request";function rl(){const t=E.c(2),e=F(jd);let s;return t[0]!==e?(s=r.jsx(nl,{flow:e,message:e.response}),t[0]=e,t[1]=s):s=t[1],s}function jd(t){return t.flows.selected[0]}rl.displayName="Response";const yd=t=>{const e=E.c(3),{message:s}=t,i=s.query?s.op_code:s.response_code,l=s.truncation?"(Truncated)":"";let n;return e[0]!==i||e[1]!==l?(n=r.jsxs("div",{children:[i," ",l]}),e[0]=i,e[1]=l,e[2]=n):n=e[2],n},bd=t=>{const e=E.c(10),{message:s}=t,i=s.recursion_desired?"Recursive ":"";let l;e[0]!==i?(l=r.jsxs("h5",{children:[i,"Question"]}),e[0]=i,e[1]=l):l=e[1];let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{children:"Type"}),r.jsx("th",{children:"Class"})]})}),e[2]=n):n=e[2];let o;e[3]!==s.questions?(o=s.questions.map($d),e[3]=s.questions,e[4]=o):o=e[4];let a;e[5]!==o?(a=r.jsxs("table",{children:[n,r.jsx("tbody",{children:o})]}),e[5]=o,e[6]=a):a=e[6];let d;return e[7]!==l||e[8]!==a?(d=r.jsxs(r.Fragment,{children:[l,a]}),e[7]=l,e[8]=a,e[9]=d):d=e[9],d},fs=t=>{const e=E.c(7),{name:s,values:i}=t;let l;e[0]!==s?(l=r.jsx("h5",{children:s}),e[0]=s,e[1]=l):l=e[1];let n;e[2]!==i?(n=i.length>0?r.jsxs("table",{children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{children:"Type"}),r.jsx("th",{children:"Class"}),r.jsx("th",{children:"TTL"}),r.jsx("th",{children:"Data"})]})}),r.jsx("tbody",{children:i.map(Cd)})]}):"—",e[2]=i,e[3]=n):n=e[3];let o;return e[4]!==l||e[5]!==n?(o=r.jsxs(r.Fragment,{children:[l,n]}),e[4]=l,e[5]=n,e[6]=o):o=e[6],o},ll=t=>{const e=E.c(24),{type:s,message:i}=t,l="dns-"+s,n=`first-line ${s}-line`;let o;e[0]!==i?(o=r.jsx(yd,{message:i}),e[0]=i,e[1]=o):o=e[1];let a;e[2]!==n||e[3]!==o?(a=r.jsx("div",{className:n,children:o}),e[2]=n,e[3]=o,e[4]=a):a=e[4];let d;e[5]!==i?(d=r.jsx(bd,{message:i}),e[5]=i,e[6]=d):d=e[6];let u;e[7]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("hr",{}),e[7]=u):u=e[7];const h=`${i.authoritative_answer?"Authoritative ":""}${i.recursion_available?"Recursive ":""}Answer`;let p;e[8]!==i.answers||e[9]!==h?(p=r.jsx(fs,{name:h,values:i.answers}),e[8]=i.answers,e[9]=h,e[10]=p):p=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("hr",{}),e[11]=g):g=e[11];let x;e[12]!==i.authorities?(x=r.jsx(fs,{name:"Authority",values:i.authorities}),e[12]=i.authorities,e[13]=x):x=e[13];let j;e[14]===Symbol.for("react.memo_cache_sentinel")?(j=r.jsx("hr",{}),e[14]=j):j=e[14];let y;e[15]!==i.additionals?(y=r.jsx(fs,{name:"Additional",values:i.additionals}),e[15]=i.additionals,e[16]=y):y=e[16];let b;return e[17]!==l||e[18]!==x||e[19]!==y||e[20]!==a||e[21]!==d||e[22]!==p?(b=r.jsxs("section",{className:l,children:[a,d,u,p,g,x,j,y]}),e[17]=l,e[18]=x,e[19]=y,e[20]=a,e[21]=d,e[22]=p,e[23]=b):b=e[23],b};function ol(){const t=E.c(2),e=F(Sd);let s;return t[0]!==e.request?(s=r.jsx(ll,{type:"request",message:e.request}),t[0]=e.request,t[1]=s):s=t[1],s}function Sd(t){return t.flows.selected[0]}ol.displayName="Request";function cl(){const t=E.c(2),e=F(wd);let s;return t[0]!==e.response?(s=r.jsx(ll,{type:"response",message:e.response}),t[0]=e.response,t[1]=s):s=t[1],s}function wd(t){return t.flows.selected[0]}cl.displayName="Response";function $d(t,e){return r.jsxs("tr",{children:[r.jsx("td",{children:t.name}),r.jsx("td",{children:t.type}),r.jsx("td",{children:t.class})]},e)}function Cd(t,e){return r.jsxs("tr",{children:[r.jsx("td",{children:t.name}),r.jsx("td",{children:t.type}),r.jsx("td",{children:t.class}),r.jsx("td",{children:t.ttl}),r.jsx("td",{children:JSON.stringify(t.data).replace(/^"|"$/g,"")})]},e)}function Ut(t,e){return e?(e=[e[0],e[1]],e[0].includes(":")&&(e[0]=`[${e[0]}]`),r.jsxs("tr",{children:[r.jsxs("td",{children:[t,":"]}),r.jsx("td",{children:e.join(":")})]})):r.jsx(r.Fragment,{})}function xi(t){const e=E.c(26),{conn:s}=t;let i;if("address"in s){let u;e[0]!==s.address?(u=Ut("Address",s.address),e[0]=s.address,e[1]=u):u=e[1];let h;e[2]!==s.peername?(h=Ut("Resolved address",s.peername),e[2]=s.peername,e[3]=h):h=e[3];let p;e[4]!==s.sockname?(p=Ut("Source address",s.sockname),e[4]=s.sockname,e[5]=p):p=e[5];let g;e[6]!==u||e[7]!==h||e[8]!==p?(g=r.jsxs(r.Fragment,{children:[u,h,p]}),e[6]=u,e[7]=h,e[8]=p,e[9]=g):g=e[9],i=g}else{let u;e[10]!==s.peername?(u=Ut("Address",s.peername),e[10]=s.peername,e[11]=u):u=e[11],i=u}let l;e[12]!==s.sni?(l=s.sni?r.jsxs("tr",{children:[r.jsxs("td",{children:[r.jsx("abbr",{title:"TLS Server Name Indication",children:"SNI"}),":"]}),r.jsx("td",{children:s.sni})]}):null,e[12]=s.sni,e[13]=l):l=e[13];let n;e[14]!==s.alpn?(n=s.alpn?r.jsxs("tr",{children:[r.jsxs("td",{children:[r.jsx("abbr",{title:"ALPN protocol negotiated",children:"ALPN"}),":"]}),r.jsx("td",{children:s.alpn})]}):null,e[14]=s.alpn,e[15]=n):n=e[15];let o;e[16]!==s.tls_version?(o=s.tls_version?r.jsxs("tr",{children:[r.jsx("td",{children:"TLS Version:"}),r.jsx("td",{children:s.tls_version})]}):null,e[16]=s.tls_version,e[17]=o):o=e[17];let a;e[18]!==s.cipher?(a=s.cipher?r.jsxs("tr",{children:[r.jsx("td",{children:"TLS Cipher:"}),r.jsx("td",{children:s.cipher})]}):null,e[18]=s.cipher,e[19]=a):a=e[19];let d;return e[20]!==i||e[21]!==l||e[22]!==n||e[23]!==o||e[24]!==a?(d=r.jsx("table",{className:"connection-table",children:r.jsxs("tbody",{children:[i,l,n,o,a]})}),e[20]=i,e[21]=l,e[22]=n,e[23]=o,e[24]=a,e[25]=d):d=e[25],d}function vi(t){return r.jsx("dl",{className:"cert-attributes",children:t.map(([e,s])=>r.jsxs(P.Fragment,{children:[r.jsx("dt",{children:e}),r.jsx("dd",{children:s})]},e))})}function Nd(t){const e=E.c(46),{flow:s}=t,i=s.server_conn?.cert;if(!i){let U;return e[0]===Symbol.for("react.memo_cache_sentinel")?(U=r.jsx(r.Fragment,{}),e[0]=U):U=e[0],U}let l;e[1]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("h4",{children:"Server Certificate"},"name"),e[1]=l):l=e[1];let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("td",{children:"Type"}),e[2]=n):n=e[2];let o;e[3]!==i.keyinfo[0]||e[4]!==i.keyinfo[1]?(o=r.jsxs("tr",{children:[n,r.jsxs("td",{children:[i.keyinfo[0],", ",i.keyinfo[1]," bits"]})]}),e[3]=i.keyinfo[0],e[4]=i.keyinfo[1],e[5]=o):o=e[5];let a;e[6]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("td",{children:"SHA256 digest"}),e[6]=a):a=e[6];let d;e[7]!==i.sha256?(d=r.jsxs("tr",{children:[a,r.jsx("td",{children:i.sha256})]}),e[7]=i.sha256,e[8]=d):d=e[8];let u;e[9]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("td",{children:"Valid from"}),e[9]=u):u=e[9];let h;e[10]!==i.notbefore?(h=ut(i.notbefore,{includeMilliseconds:!1}),e[10]=i.notbefore,e[11]=h):h=e[11];let p;e[12]!==h?(p=r.jsxs("tr",{children:[u,r.jsx("td",{children:h})]}),e[12]=h,e[13]=p):p=e[13];let g;e[14]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("td",{children:"Valid to"}),e[14]=g):g=e[14];let x;e[15]!==i.notafter?(x=ut(i.notafter,{includeMilliseconds:!1}),e[15]=i.notafter,e[16]=x):x=e[16];let j;e[17]!==x?(j=r.jsxs("tr",{children:[g,r.jsx("td",{children:x})]}),e[17]=x,e[18]=j):j=e[18];let y;e[19]===Symbol.for("react.memo_cache_sentinel")?(y=r.jsx("td",{children:"Subject Alternative Names"}),e[19]=y):y=e[19];let b;e[20]!==i.altnames?(b=i.altnames.join(", "),e[20]=i.altnames,e[21]=b):b=e[21];let w;e[22]!==b?(w=r.jsxs("tr",{children:[y,r.jsx("td",{children:b})]}),e[22]=b,e[23]=w):w=e[23];let C;e[24]===Symbol.for("react.memo_cache_sentinel")?(C=r.jsx("td",{children:"Subject"}),e[24]=C):C=e[24];let k;e[25]!==i.subject?(k=vi(i.subject),e[25]=i.subject,e[26]=k):k=e[26];let T;e[27]!==k?(T=r.jsxs("tr",{children:[C,r.jsx("td",{children:k})]}),e[27]=k,e[28]=T):T=e[28];let D;e[29]===Symbol.for("react.memo_cache_sentinel")?(D=r.jsx("td",{children:"Issuer"}),e[29]=D):D=e[29];let I;e[30]!==i.issuer?(I=vi(i.issuer),e[30]=i.issuer,e[31]=I):I=e[31];let M;e[32]!==I?(M=r.jsxs("tr",{children:[D,r.jsx("td",{children:I})]}),e[32]=I,e[33]=M):M=e[33];let O;e[34]===Symbol.for("react.memo_cache_sentinel")?(O=r.jsx("td",{children:"Serial"}),e[34]=O):O=e[34];let V;e[35]!==i.serial?(V=r.jsxs("tr",{children:[O,r.jsx("td",{children:i.serial})]}),e[35]=i.serial,e[36]=V):V=e[36];let q;return e[37]!==j||e[38]!==w||e[39]!==T||e[40]!==M||e[41]!==V||e[42]!==o||e[43]!==d||e[44]!==p?(q=r.jsxs(r.Fragment,{children:[l,r.jsx("table",{className:"certificate-table",children:r.jsxs("tbody",{children:[o,d,p,j,w,T,M,V]})})]}),e[37]=j,e[38]=w,e[39]=T,e[40]=M,e[41]=V,e[42]=o,e[43]=d,e[44]=p,e[45]=q):q=e[45],q}function al(t){const e=E.c(11),{flow:s}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=r.jsx("h4",{children:"Client Connection"}),e[0]=i):i=e[0];let l;e[1]!==s.client_conn?(l=r.jsx(xi,{conn:s.client_conn}),e[1]=s.client_conn,e[2]=l):l=e[2];let n;e[3]!==s.server_conn?(n=s.server_conn?.address&&r.jsxs(r.Fragment,{children:[r.jsx("h4",{children:"Server Connection"}),r.jsx(xi,{conn:s.server_conn})]}),e[3]=s.server_conn,e[4]=n):n=e[4];let o;e[5]!==s?(o=r.jsx(Nd,{flow:s}),e[5]=s,e[6]=o):o=e[6];let a;return e[7]!==l||e[8]!==n||e[9]!==o?(a=r.jsxs("section",{className:"detail",children:[i,l,n,o]}),e[7]=l,e[8]=n,e[9]=o,e[10]=a):a=e[10],a}al.displayName="Connection";function dl(t){const e=E.c(7),{flow:s}=t,i=s.error.msg;let l;e[0]!==s.error.timestamp?(l=ut(s.error.timestamp),e[0]=s.error.timestamp,e[1]=l):l=e[1];let n;e[2]!==l?(n=r.jsx("div",{children:r.jsx("small",{children:l})}),e[2]=l,e[3]=n):n=e[3];let o;return e[4]!==s.error.msg||e[5]!==n?(o=r.jsx("section",{className:"error",children:r.jsxs("div",{className:"alert alert-warning",children:[i,n]})}),e[4]=s.error.msg,e[5]=n,e[6]=o):o=e[6],o}dl.displayName="Error";function kd(t){const e=E.c(4),{t:s,deltaTo:i,title:l}=t;let n;return e[0]!==i||e[1]!==s||e[2]!==l?(n=s?r.jsxs("tr",{children:[r.jsxs("td",{children:[l,":"]}),r.jsxs("td",{children:[ut(s),i&&r.jsxs("span",{className:"text-muted",children:["(",Fi(1e3*(s-i)),")"]})]})]}):r.jsx("tr",{}),e[0]=i,e[1]=s,e[2]=l,e[3]=n):n=e[3],n}function ul(t){const e=E.c(26),{flow:s}=t;let i;s.type==="http"?i=s.request.timestamp_start:i=s.client_conn.timestamp_start;const l=s.server_conn?.timestamp_start;let n,o,a,d;if(e[0]!==s.client_conn.timestamp_end||e[1]!==s.client_conn.timestamp_start||e[2]!==s.client_conn.timestamp_tls_setup||e[3]!==s.request||e[4]!==s.response?.timestamp_end||e[5]!==s.response?.timestamp_start||e[6]!==s.server_conn?.timestamp_end||e[7]!==s.server_conn?.timestamp_tcp_setup||e[8]!==s.server_conn?.timestamp_tls_setup||e[9]!==s.type||e[10]!==i||e[11]!==l){const g=[{title:"Server conn. initiated",t:l,deltaTo:i},{title:"Server conn. TCP handshake",t:s.server_conn?.timestamp_tcp_setup,deltaTo:i},{title:"Server conn. TLS handshake",t:s.server_conn?.timestamp_tls_setup,deltaTo:i},{title:"Server conn. closed",t:s.server_conn?.timestamp_end,deltaTo:i},{title:"Client conn. established",t:s.client_conn.timestamp_start,deltaTo:s.type==="http"?i:void 0},{title:"Client conn. TLS handshake",t:s.client_conn.timestamp_tls_setup,deltaTo:i},{title:"Client conn. closed",t:s.client_conn.timestamp_end,deltaTo:i}];s.type==="http"&&g.push({title:"First request byte",t:s.request.timestamp_start},{title:"Request complete",t:s.request.timestamp_end,deltaTo:i},{title:"First response byte",t:s.response?.timestamp_start,deltaTo:i},{title:"Response complete",t:s.response?.timestamp_end,deltaTo:i}),a="timing",e[16]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx("h4",{children:"Timing"}),e[16]=d):d=e[16],o="timing-table",n=g.filter(Rd).sort(Td).map(Ed),e[0]=s.client_conn.timestamp_end,e[1]=s.client_conn.timestamp_start,e[2]=s.client_conn.timestamp_tls_setup,e[3]=s.request,e[4]=s.response?.timestamp_end,e[5]=s.response?.timestamp_start,e[6]=s.server_conn?.timestamp_end,e[7]=s.server_conn?.timestamp_tcp_setup,e[8]=s.server_conn?.timestamp_tls_setup,e[9]=s.type,e[10]=i,e[11]=l,e[12]=n,e[13]=o,e[14]=a,e[15]=d}else n=e[12],o=e[13],a=e[14],d=e[15];let u;e[17]!==n?(u=r.jsx("tbody",{children:n}),e[17]=n,e[18]=u):u=e[18];let h;e[19]!==o||e[20]!==u?(h=r.jsx("table",{className:o,children:u}),e[19]=o,e[20]=u,e[21]=h):h=e[21];let p;return e[22]!==a||e[23]!==d||e[24]!==h?(p=r.jsxs("section",{className:a,children:[d,h]}),e[22]=a,e[23]=d,e[24]=h,e[25]=p):p=e[25],p}function Ed(t){const{title:e,t:s,deltaTo:i}=t;return r.jsx(kd,{title:e,t:s,deltaTo:i},e)}function Td(t,e){return t.t-e.t}function Rd(t){return!!t.t}ul.displayName="Timing";function Os({flow:t,messages_meta:e}){const s=ee(),i=F(u=>u.ui.flow.contentViewFor[t.id+"messages"]||"Auto"),[l,n]=P.useState(F(u=>u.options.content_view_lines_cutoff)),o=P.useCallback(()=>n(Math.max(1024,l*2)),[l]),a=Zr(t,"messages",i,l+1,t.id+e.count)??[];let d=l;return r.jsxs("div",{className:"contentview",children:[r.jsxs("div",{className:"controls",children:[r.jsxs("h5",{children:[e.count," Messages"]}),r.jsx(sl,{value:i,onChange:u=>s(Ii({messageId:t.id+"messages",contentView:u}))})]}),a.map((u,h)=>{const p=`fa fa-fw fa-arrow-${u.from_client?"right text-primary":"left text-danger"}`,g=r.jsxs("div",{children:[r.jsxs("small",{children:[r.jsx("i",{className:p}),r.jsx("span",{className:"pull-right",children:u.timestamp&&ut(u.timestamp)})]}),r.jsx(tl,{content:u.text,maxLines:d,showMore:o})]},h);return d-=u.text.split(`
`).length,g})]})}function fl(t){const e=E.c(8),{flow:s}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=r.jsx("h4",{children:"WebSocket"}),e[0]=i):i=e[0];let l;e[1]!==s?(l=r.jsx(Os,{flow:s,messages_meta:s.websocket.messages_meta}),e[1]=s,e[2]=l):l=e[2];let n;e[3]!==s.websocket?(n=r.jsx(Ad,{websocket:s.websocket}),e[3]=s.websocket,e[4]=n):n=e[4];let o;return e[5]!==l||e[6]!==n?(o=r.jsxs("section",{className:"websocket",children:[i,l,n]}),e[5]=l,e[6]=n,e[7]=o):o=e[7],o}fl.displayName="WebSocket";function Ad(t){const e=E.c(10),{websocket:s}=t;if(!s.timestamp_end)return null;const i=s.close_reason?`(${s.close_reason})`:"";let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("i",{className:"fa fa-fw fa-window-close text-muted"}),e[0]=l):l=e[0];const n=s.closed_by_client?"client":"server",o=s.close_code;let a;e[1]!==s.timestamp_end?(a=ut(s.timestamp_end),e[1]=s.timestamp_end,e[2]=a):a=e[2];let d;e[3]!==a?(d=r.jsx("small",{className:"pull-right",children:a}),e[3]=a,e[4]=d):d=e[4];let u;return e[5]!==i||e[6]!==n||e[7]!==d||e[8]!==s.close_code?(u=r.jsxs("div",{children:[l,"  Closed by ",n," ","with code ",o," ",i,".",d]}),e[5]=i,e[6]=n,e[7]=d,e[8]=s.close_code,e[9]=u):u=e[9],u}function pl(t){const e=E.c(7),{flow:s}=t,i=ee();let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("h4",{children:"Comment"}),e[0]=l):l=e[0];let n;e[1]!==i||e[2]!==s?(n=a=>{i(Ve(s,{comment:a}))},e[1]=i,e[2]=s,e[3]=n):n=e[3];let o;return e[4]!==s.comment||e[5]!==n?(o=r.jsxs("section",{className:"timing",children:[l,r.jsx(fe,{className:"kv-value",content:s.comment,onEditDone:n,placeholder:"empty",selectAllOnClick:!0})]}),e[4]=s.comment,e[5]=n,e[6]=o):o=e[6],o}pl.displayName="Comment";function hl(t){const e=E.c(2),{flow:s}=t;let i;return e[0]!==s?(i=r.jsx("section",{className:"tcp",children:r.jsx(Os,{flow:s,messages_meta:s.messages_meta})}),e[0]=s,e[1]=i):i=e[1],i}hl.displayName="Stream Data";function ml(t){const e=E.c(2),{flow:s}=t;let i;return e[0]!==s?(i=r.jsx("section",{className:"udp",children:r.jsx(Os,{flow:s,messages_meta:s.messages_meta})}),e[0]=s,e[1]=i):i=e[1],i}ml.displayName="Datagrams";const _i={request:il,response:rl,error:dl,connection:al,timing:ul,websocket:fl,tcpmessages:hl,udpmessages:ml,dnsrequest:ol,dnsresponse:cl,comment:pl};function ws(t){let e;switch(t.type){case"http":e=["request","response","websocket"].filter(s=>t[s]);break;case"tcp":e=["tcpmessages"];break;case"udp":e=["udpmessages"];break;case"dns":e=["request","response"].filter(s=>t[s]).map(s=>"dns"+s);break}return t.error&&e.push("error"),e.push("connection"),e.push("timing"),e.push("comment"),e}function Id(){const t=E.c(15),e=ee(),s=F(Fd);let i=F(Dd);if(s==null){let y;return t[0]===Symbol.for("react.memo_cache_sentinel")?(y=r.jsx(r.Fragment,{}),t[0]=y):y=t[0],y}const l=ws(s);l.indexOf(i)<0&&(i==="response"&&s.error?i="error":i==="error"&&"response"in s?i="response":i=l[0]);const n=_i[i],o="flow-detail",a="nav-tabs nav-tabs-sm";let d;t[1]!==e?(d=()=>e(Ke([])),t[1]=e,t[2]=d):d=t[2];let u;t[3]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("i",{className:"fa fa-times-circle"}),t[3]=u):u=t[3];let h;t[4]!==d?(h=r.jsx("button",{"data-testid":"close-button-id",className:"close-button",onClick:d,children:u}),t[4]=d,t[5]=h):h=t[5];const p=l.map(y=>r.jsx("a",{href:"#",className:Re({active:i===y}),onClick:b=>{b.preventDefault(),e(zt(y))},children:_i[y].displayName},y));let g;t[6]!==h||t[7]!==p?(g=r.jsxs("nav",{className:a,children:[h,p]}),t[6]=h,t[7]=p,t[8]=g):g=t[8];let x;t[9]!==n||t[10]!==s?(x=r.jsx(n,{flow:s}),t[9]=n,t[10]=s,t[11]=x):x=t[11];let j;return t[12]!==g||t[13]!==x?(j=r.jsxs("div",{className:o,children:[g,x]}),t[12]=g,t[13]=x,t[14]=j):j=t[14],j}function Dd(t){return t.ui.flow.tab}function Fd(t){return t.flows.selected[0]}function Ld(t){if(t.ctrlKey||t.metaKey)return()=>{};const e=t.key;return t.preventDefault(),(s,i)=>{const{flows:l}=i(),n=l.selected,o=n[0];switch(e){case"k":case"ArrowUp":s(gt(l,-1));break;case"j":case"ArrowDown":s(gt(l,1));break;case" ":case"PageDown":s(gt(l,10));break;case"PageUp":s(gt(l,-10));break;case"End":s(gt(l,1e10));break;case"Home":s(gt(l,-1e10));break;case"Escape":i().ui.modal.activeModal?s(ur()):s(Ke([]));break;case"ArrowLeft":{if(!o)break;const a=ws(o),d=i().ui.flow.tab,u=a[(Math.max(0,a.indexOf(d))-1+a.length)%a.length];s(zt(u));break}case"Tab":case"ArrowRight":{if(!o)break;const a=ws(o),d=i().ui.flow.tab,u=a[(Math.max(0,a.indexOf(d))+1)%a.length];s(zt(u));break}case"Delete":case"d":{s(tr(n));break}case"n":{Qt("view.flows.create","get","https://example.com/");break}case"D":{s(sr(n));break}case"a":{s(As(n));break}case"A":{s(Zi());break}case"r":{s(Is(n));break}case"v":{s(nr(n));break}case"x":{s(er(n));break}case"X":{s(Ec());break}case"z":{s(ir());break}default:return}}}class Pd extends P.Component{static defaultProps={axis:"x"};node=ke.createRef();constructor(e,s){super(e,s),this.state={applied:!1,startPos:0,dragPointer:.1},this.onLostPointerCapture=this.onLostPointerCapture.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this)}onPointerDown(e){this.state.dragPointer===.1&&(e.target.setPointerCapture(e.pointerId),this.setState({startPos:this.props.axis==="x"?e.pageX:e.pageY,dragPointer:e.pointerId}))}onLostPointerCapture(e){if(this.state.dragPointer!==e.pointerId)return;const s=this.node.current,i=s.previousElementSibling,l=s.nextElementSibling;s.style.transform="",i.style.flex=`0 0 ${Math.max(0,(this.props.axis==="x"?i.offsetWidth+e.pageX:i.offsetHeight+e.pageY)-this.state.startPos)}px`,l.style.flex="1 1 auto",this.setState({applied:!0,dragPointer:.1}),this.onResize()}onPointerMove(e){this.state.dragPointer===e.pointerId&&(this.node.current.style.transform=this.props.axis==="x"?`translateX(${e.pageX-this.state.startPos}px)`:`translateY(${e.pageY-this.state.startPos}px)`)}onResize(){window.setTimeout(()=>window.dispatchEvent(new CustomEvent("resize")),1)}reset(e){this.state.applied&&(this.node.current?.previousElementSibling instanceof HTMLElement&&(this.node.current.previousElementSibling.style.flex=""),this.node.current?.nextElementSibling instanceof HTMLElement&&(this.node.current.nextElementSibling.style.flex=""),e||this.setState({applied:!1}),this.onResize())}componentWillUnmount(){this.reset(!0)}render(){return r.jsx("div",{ref:this.node,className:Re("splitter",this.props.axis==="x"?"splitter-x":"splitter-y"),children:r.jsx("div",{onLostPointerCapture:this.onLostPointerCapture,onPointerDown:this.onPointerDown,onPointerMove:this.onPointerMove})})}}const qs=t=>{const e=t.current;return e===null||e.scrollTop===0?!1:Math.ceil(e.scrollTop)+e.clientHeight>=e.scrollHeight},gl=t=>{t.current&&!qs(t)&&(t.current.scrollTop=t.current.scrollHeight)};function At(t=void 0){if(!t)return{start:0,end:0,paddingTop:0,paddingBottom:0};const{itemCount:e,rowHeight:s,viewportTop:i,viewportHeight:l,itemHeights:n}=t,o=i+l;let a=0,d=0,u=0,h=0;if(n){let p=0;for(let g=0;g<e;g++){const x=n[g]||s;p<=i&&g%2===0&&(u=p,a=g),p<=o?d=g+1:h+=x,p+=x}if(i>0&&p<i+l)return At({itemCount:e,rowHeight:s,viewportTop:p-l,viewportHeight:l,itemHeights:n})}else{const p=Math.min(i,Math.max(0,e*s-l));a=Math.max(0,Math.floor(p/s)-1)&-2,d=Math.min(e,a+Math.ceil(l/s)+2),u=a*s,h=(e-d)*s}return{start:a,end:d,paddingTop:u,paddingBottom:h}}const Hs=({flow:t})=>r.jsx("td",{className:Re("col-tls",t.client_conn.tls_established?"col-tls-https":"col-tls-http")});Hs.headerName="";const Vs=({flow:t})=>{const e=F(s=>s.flows._listIndex.get(t.id));return r.jsx("td",{className:"col-index",children:e+1})};Vs.headerName="#";const Us=({flow:t})=>r.jsx("td",{className:"col-icon",children:r.jsx("div",{className:Re("resource-icon",Bi(t))})});Us.headerName="";const Bs=({flow:t})=>{let e;return t.error&&(t.error.msg==="Connection killed."?e=r.jsx("i",{className:"fa fa-fw fa-times pull-right"}):e=r.jsx("i",{className:"fa fa-fw fa-exclamation pull-right"})),r.jsxs("td",{className:"col-path",children:[t.is_replay==="request"&&r.jsx("i",{className:"fa fa-fw fa-repeat pull-right"}),t.intercepted&&r.jsx("i",{className:"fa fa-fw fa-pause pull-right"}),e,r.jsx("span",{className:"marker pull-right",children:t.marked}),Ki(t)]})};Bs.headerName="Path";const Ks=({flow:t})=>r.jsx("td",{className:"col-method",children:zi(t)});Ks.headerName="Method";const Ws=({flow:t})=>r.jsx("td",{className:"col-http-version",children:Qi(t)});Ws.headerName="Version";const zs=({flow:t})=>{let e="darkred";return t.type!=="http"&&t.type!="dns"||!t.response?r.jsx("td",{className:"col-status"}):(100<=t.response.status_code&&t.response.status_code<200?e="green":200<=t.response.status_code&&t.response.status_code<300?e="darkgreen":300<=t.response.status_code&&t.response.status_code<400?e="lightblue":(400<=t.response.status_code&&t.response.status_code<500||500<=t.response.status_code&&t.response.status_code<600)&&(e="red"),r.jsx("td",{className:"col-status",style:{color:e},children:Wi(t)}))};zs.headerName="Status";const Qs=({flow:t})=>r.jsx("td",{className:"col-size",children:Di(Vi(t))});Qs.headerName="Size";const Gs=({flow:t})=>{const e=Gt(t),s=Hi(t);return r.jsx("td",{className:"col-time",children:e&&s?Fi(1e3*(s-e)):"..."})};Gs.headerName="Time";const Ys=({flow:t})=>{const e=Gt(t);return r.jsx("td",{className:"col-timestamp",children:e?ut(e):"..."})};Ys.headerName="Start time";const ts=({flow:t})=>{const e=ee();let s=null;return t.intercepted?s=r.jsx("a",{href:"#",className:"quickaction",onClick:()=>e(As([t])),children:r.jsx("i",{className:"fa fa-fw fa-play text-success"})}):Es(t)&&(s=r.jsx("a",{href:"#",className:"quickaction",onClick:()=>e(Is([t])),children:r.jsx("i",{className:"fa fa-fw fa-repeat text-primary"})})),r.jsx("td",{className:"col-quickactions",children:s?r.jsx("div",{children:s}):r.jsx(r.Fragment,{})})};ts.headerName="";const Js=({flow:t})=>{const e=t.comment;return r.jsx("td",{className:"col-comment",children:e})};Js.headerName="Comment";const xl={icon:Us,index:Vs,method:Ks,version:Ws,path:Bs,quickactions:ts,size:Qs,status:zs,time:Gs,timestamp:Ys,tls:Hs,comment:Js},Md=Object.freeze(Object.defineProperty({__proto__:null,comment:Js,default:xl,icon:Us,index:Vs,method:Ks,path:Bs,quickactions:ts,size:Qs,status:zs,time:Gs,timestamp:Ys,tls:Hs,version:Ws},Symbol.toStringTag,{value:"Module"})),Od=P.memo(function(){const e=E.c(13),s=ee(),i=F(qd),l=F(Hd),n=F(Vd),o=i?"sort-desc":"sort-asc";let a;if(e[0]!==s||e[1]!==n||e[2]!==l||e[3]!==i||e[4]!==o){const u=n.filter(Sc).concat("quickactions");let h;e[6]!==s||e[7]!==l||e[8]!==i||e[9]!==o?(h=p=>r.jsx("th",{className:Re(`col-${p}`,l===p&&o),onClick:()=>s(ar({column:p===l&&i?void 0:p,desc:p!==l?!1:!i})),children:xl[p].headerName},p),e[6]=s,e[7]=l,e[8]=i,e[9]=o,e[10]=h):h=e[10],a=u.map(h),e[0]=s,e[1]=n,e[2]=l,e[3]=i,e[4]=o,e[5]=a}else a=e[5];let d;return e[11]!==a?(d=r.jsx("tr",{children:a}),e[11]=a,e[12]=d):d=e[12],d});function qd(t){return t.flows.sort.desc}function Hd(t){return t.flows.sort.column}function Vd(t){return t.options.web_columns}const Ud=ke.memo(function({flow:e,selected:s,highlighted:i}){const l=ee(),n=F(u=>u.options.web_columns),o=Re({selected:s,highlighted:i,intercepted:e.intercepted,"has-request":e.type==="http"&&e.request,"has-response":e.type==="http"&&e.response}),a=P.useCallback(u=>{let h=u.target;for(;h.parentNode;){if(h.classList.contains("col-quickactions"))return;h=h.parentNode}u.metaKey||u.ctrlKey?l(Dc(e)):u.shiftKey?(window.getSelection()?.empty(),l(Fc(e))):l(Ke([e]))},[e]),d=n.map(u=>Md[u]).filter(u=>u).concat(ts);return r.jsx("tr",{className:o,onClick:a,children:d.map(u=>r.jsx(u,{flow:e},u.name))})});class Bd extends P.Component{static defaultProps={rowHeight:32};viewport=P.createRef();head=P.createRef();constructor(e,s){super(e,s),this.state={vScroll:At(),viewportTop:0},this.onViewportUpdate=this.onViewportUpdate.bind(this)}componentDidMount(){window.addEventListener("resize",this.onViewportUpdate),this.onViewportUpdate()}componentWillUnmount(){window.removeEventListener("resize",this.onViewportUpdate)}getSnapshotBeforeUpdate(){return qs(this.viewport)}componentDidUpdate(e,s,i){i&&gl(this.viewport),this.onViewportUpdate();const{onlySelectedId:l}=this.props;if(l&&l!==e.onlySelectedId){const{rowHeight:o,firstSelectedIndex:a}=this.props,d=this.viewport.current,u=this.head.current,h=u?u.offsetHeight:0,p=a*o+h,g=p+o,x=d.scrollTop,j=d.offsetHeight;p-h<x?d.scrollTop=p-h:g>x+j&&(d.scrollTop=g-j),this.onViewportUpdate()}}onViewportUpdate(){const e=this.viewport.current,s=e.scrollTop||0,i=At({viewportTop:s,viewportHeight:e.offsetHeight||0,itemCount:this.props.flowView.length,rowHeight:this.props.rowHeight});if(this.state.viewportTop!==s||!Jt(this.state.vScroll,i)){const l=Math.min(s,i.end*this.props.rowHeight);this.setState({vScroll:i,viewportTop:l})}}render(){const{vScroll:e,viewportTop:s}=this.state,{flowView:i,selectedIds:l,highlightedIds:n}=this.props;return r.jsx("div",{className:"flow-table",onScroll:this.onViewportUpdate,ref:this.viewport,children:r.jsxs("table",{children:[r.jsx("thead",{ref:this.head,style:{transform:`translateY(${s}px)`},children:r.jsx(Od,{})}),r.jsxs("tbody",{children:[r.jsx("tr",{style:{height:e.paddingTop}}),i.slice(e.start,e.end).map(o=>r.jsx(Ud,{flow:o,selected:l.has(o.id),highlighted:n.has(o.id)},o.id)),r.jsx("tr",{style:{height:e.paddingBottom}})]})]})})}}const Kd=_t(t=>({flowView:t.flows.view,highlightedIds:t.flows.highlightedIds,selectedIds:t.flows.selectedIds,onlySelectedId:t.flows.selected.length===1&&t.flows.selected[0].id,firstSelectedIndex:t.flows._viewIndex.get(t.flows.selected[0]?.id)}))(Bd);function Wd(){const t=E.c(3);let e,s;t[0]===Symbol.for("react.memo_cache_sentinel")?(e={padding:"1em 2em"},s=r.jsx("h3",{children:"mitmproxy is running."}),t[0]=e,t[1]=s):(e=t[0],s=t[1]);let i;return t[2]===Symbol.for("react.memo_cache_sentinel")?(i=r.jsxs("div",{style:e,children:[s,r.jsxs("p",{children:["No flows have been recorded yet.",r.jsx("br",{}),"To start capturing traffic, please configure your settings in the Capture tab."]})]}),t[2]=i):i=t[2],i}function zd(t){const e=E.c(20);let{description:s,listen_addrs:i,is_running:l,wireguard_conf:n,type:o}=t;const a=P.useRef(null);let d,u;e[0]!==n?(d=()=>{n&&a.current&&lc.toCanvas(a.current,n,{margin:0,scale:3})},u=[n],e[0]=n,e[1]=d,e[2]=u):(d=e[1],u=e[2]),P.useEffect(d,u);let h;const p=i.length===1||i.length===2&&i[0][1]===i[1][1],g=i.every(Qd);if(p&&g){let y;e[3]!==i[0][1]?(y=si(["*",i[0][1]]),e[3]=i[0][1],e[4]=y):y=e[4],h=y}else{let y;e[5]!==i?(y=i.map(si).join(" and "),e[5]=i,e[6]=y):y=e[6],h=y}s=s[0].toUpperCase()+s.substr(1);let x;if(l){let y;e[9]!==s||e[10]!==h||e[11]!==o?(y=o==="local"?r.jsxs("div",{className:"text-success",children:[s," is active."]}):r.jsxs("div",{className:"text-success",children:[s," listening at ",h,"."]}),e[9]=s,e[10]=h,e[11]=o,e[12]=y):y=e[12];let b;e[13]!==n?(b=n&&r.jsxs("div",{className:"wireguard-config",children:[r.jsx("pre",{children:n}),r.jsx("canvas",{ref:a})]}),e[13]=n,e[14]=b):b=e[14];let w;e[15]!==y||e[16]!==b?(w=r.jsxs(r.Fragment,{children:[y,b]}),e[15]=y,e[16]=b,e[17]=w):w=e[17],x=w}else{let y;e[7]!==s?(y=r.jsx(r.Fragment,{children:r.jsxs("div",{className:"text-warning",children:[s," starting..."]})}),e[7]=s,e[8]=y):y=e[8],x=y}let j;return e[18]!==x?(j=r.jsx("div",{children:x}),e[18]=x,e[19]=j):j=e[19],j}function Qd(t){return["::","0.0.0.0"].includes(t[0])}function st(t){const e=E.c(5),{error:s,backendState:i}=t;let l;e[0]!==i||e[1]!==s?(l=s?r.jsx("div",{className:"text-danger",children:s}):i&&r.jsx(zd,{...i}),e[0]=i,e[1]=s,e[2]=l):l=e[2];let n;return e[3]!==l?(n=r.jsx("div",{className:"mode-status",children:l}),e[3]=l,e[4]=n):n=e[4],n}function nt(t){const e=E.c(13),{value:s,onChange:i,children:l,label:n}=t,o=P.useId(),a=`mode-checkbox-${o}`,d=`mode-checkbox-${o}`;let u;e[0]!==i||e[1]!==a||e[2]!==d||e[3]!==s?(u=r.jsx("input",{type:"checkbox",name:a,id:d,checked:s,onChange:i}),e[0]=i,e[1]=a,e[2]=d,e[3]=s,e[4]=u):u=e[4];const h=`mode-checkbox-${o}`;let p;e[5]===Symbol.for("react.memo_cache_sentinel")?(p={marginBottom:0,fontWeight:"normal"},e[5]=p):p=e[5];let g;e[6]!==n||e[7]!==h?(g=r.jsx("label",{htmlFor:h,style:p,children:n}),e[6]=n,e[7]=h,e[8]=g):g=e[8];let x;return e[9]!==l||e[10]!==u||e[11]!==g?(x=r.jsxs("div",{className:"mode-entry",children:[u,g,l]}),e[9]=l,e[10]=u,e[11]=g,e[12]=x):x=e[12],x}function it(t){const e=E.c(22),{children:s,iconClass:i,classname:l,isVisible:n}=t,o=P.useId();let a;e[0]!==o?(a=[...o].map(Gd),e[0]=o,e[1]=a):a=e[1];const d="--"+a.join(""),u=P.useRef(null),h=P.useRef(null);let p;e[2]!==d?(p=()=>{u.current.style.anchorName=d,h.current.style.positionAnchor=d},e[2]=d,e[3]=p):p=e[3];let g;e[4]===Symbol.for("react.memo_cache_sentinel")?(g=[],e[4]=g):g=e[4],P.useEffect(p,g);let x;e[5]!==o||e[6]!==n?(x=()=>{n===!0&&document.getElementById(o)?.showPopover()},e[5]=o,e[6]=n,e[7]=x):x=e[7];let j;e[8]!==n?(j=[n],e[8]=n,e[9]=j):j=e[9],P.useEffect(x,j);const y=l?`mode-popover ${l}`:"mode-popover";let b;e[10]!==i?(b=r.jsx("i",{className:i,"aria-hidden":"true"}),e[10]=i,e[11]=b):b=e[11];let w;e[12]!==o||e[13]!==b?(w=r.jsx("button",{popoverTarget:o,ref:u,children:b}),e[12]=o,e[13]=b,e[14]=w):w=e[14];let C;e[15]!==s||e[16]!==o?(C=r.jsx("div",{id:o,popover:"auto",ref:h,children:s}),e[15]=s,e[16]=o,e[17]=C):C=e[17];let k;return e[18]!==y||e[19]!==w||e[20]!==C?(k=r.jsxs("div",{className:y,children:[w,C]}),e[18]=y,e[19]=w,e[20]=C,e[21]=k):k=e[21],k}function Gd(t){return t.charCodeAt(0).toString(16)}function Yd(t){const e=E.c(44),{server:s}=t,{currentProcesses:i,isLoading:l}=F(Zd),{selectedProcesses:n}=F(Xd);let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=[],e[0]=o):o=e[0];const[a,d]=P.useState(o),[u,h]=P.useState(""),p=ee(),{platform:g}=F(Jd);let x;e[1]===Symbol.for("react.memo_cache_sentinel")?(x=z=>{h(z.target.value)},e[1]=x):x=e[1];const j=x;let y;e[2]!==g?(y=z=>{const ie=g.startsWith("win32")?"\\":"/";return js(z.executable,ie)[1]},e[2]=g,e[3]=y):y=e[3];const b=y;let w;e[4]!==p||e[5]!==b||e[6]!==n||e[7]!==s?(w=z=>{const ie=typeof z=="string"?z:b(z),H=n?`${n}, ${ie}`:ie;p(kt({server:s,value:H}))},e[4]=p,e[5]=b,e[6]=n,e[7]=s,e[8]=w):w=e[8];const C=w;let k;e[9]!==p||e[10]!==b||e[11]!==n||e[12]!==s?(k=z=>{const ie=n?.split(/,\s*/).filter(H=>H!==b(z)).join(", ");p(kt({server:s,value:ie}))},e[9]=p,e[10]=b,e[11]=n,e[12]=s,e[13]=k):k=e[13];const T=k,D=z=>{I(z)&&n?T(z):C(z)},I=z=>{const ie=b(z);return n?.includes(ie)};let M;e[14]!==i||e[15]!==p?(M=()=>{i.length===0&&p(Et())},e[14]=i,e[15]=p,e[16]=M):M=e[16];let O;e[17]===Symbol.for("react.memo_cache_sentinel")?(O=[],e[17]=O):O=e[17],P.useEffect(M,O);let V;e[18]!==i||e[19]!==u||e[20]!==b||e[21]!==a?(V=()=>{if(u){const z=i.filter(ie=>b(ie).toLowerCase().includes(u.toLowerCase()));d(z)}else a!==i&&d(i)},e[18]=i,e[19]=u,e[20]=b,e[21]=a,e[22]=V):V=e[22];let q;e[23]!==i||e[24]!==u?(q=[u,i],e[23]=i,e[24]=u,e[25]=q):q=e[25],P.useEffect(V,q);let U;e[26]!==C||e[27]!==u?(U=z=>{z.stopPropagation(),z.key==="Enter"&&(C(u),h(""))},e[26]=C,e[27]=u,e[28]=U):U=e[28];const W=U,[B,Q]=P.useState(!1),G="local-dropdown",J="dropdown-header",Z=n&&n?.length>0?"Add more":"all applications";let te,ce;e[29]===Symbol.for("react.memo_cache_sentinel")?(te=()=>Q(!0),ce=()=>Q(!1),e[29]=te,e[30]=ce):(te=e[29],ce=e[30]);let ue;e[31]!==u||e[32]!==W||e[33]!==Z?(ue=r.jsx("input",{type:"text",className:"autocomplete-input",placeholder:Z,value:u,onChange:j,onKeyDown:W,onClick:te,onBlur:ce}),e[31]=u,e[32]=W,e[33]=Z,e[34]=ue):ue=e[34];const ve=it,we="fa fa-chevron-down",ye="local-popover";let he;e[35]===Symbol.for("react.memo_cache_sentinel")?(he=r.jsx("h4",{children:"Current Applications running on machine"}),e[35]=he):he=e[35];const $e=l?r.jsx("i",{className:"fa fa-spinner","aria-hidden":"true"}):a.length>0?r.jsxs("ul",{className:"dropdown-list",children:[r.jsxs("li",{className:`dropdown-item ${n===""?"selected":""}`,onClick:()=>{p(kt({server:s,value:""}))},role:"menuitem",children:[r.jsxs("div",{className:"process-details",children:[r.jsx("div",{className:"process-icon"}),r.jsx("span",{className:"process-name",children:"All applications"})]}),n===""&&r.jsx("i",{className:"fa fa-check","aria-hidden":"true"})]}),r.jsx("hr",{className:"process-separator"}),a.map((z,ie)=>r.jsxs("li",{className:`dropdown-item ${I(z)?"selected":""}`,onClick:()=>D(z),role:"menuitem",children:[r.jsxs("div",{className:"process-details",children:[r.jsx("img",{className:"process-icon",src:`./executable-icon?path=${z.executable}`,loading:"lazy"}),r.jsx("span",{className:"process-name",children:b(z)})]}),I(z)&&r.jsx("i",{className:"fa fa-check","aria-hidden":"true"})]},ie))]}):r.jsxs("span",{children:["Press ",r.jsx("strong",{children:"Enter"})," to capture traffic for programs matching: ",r.jsx("strong",{children:u})]});let N;e[36]!==ve||e[37]!==B||e[38]!==he||e[39]!==$e?(N=r.jsxs(ve,{iconClass:we,classname:ye,isVisible:B,children:[he,$e]}),e[36]=ve,e[37]=B,e[38]=he,e[39]=$e,e[40]=N):N=e[40];let ae;return e[41]!==ue||e[42]!==N?(ae=r.jsx("div",{className:G,children:r.jsxs("div",{className:J,children:[ue,N]})}),e[41]=ue,e[42]=N,e[43]=ae):ae=e[43],ae}function Jd(t){return t.backendState}function Xd(t){return t.modes.local[0]}function Zd(t){return t.processes}function eu(){const t=E.c(9),e=F(su),s=F(tu);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(nu,{server:u,backendState:s[_r(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n,o;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"Local Applications"}),o=r.jsx("p",{className:"mode-description",children:"Transparently Intercept local application(s)."}),t[5]=n,t[6]=o):(n=t[5],o=t[6]);let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function tu(t){return t.backendState.servers}function su(t){return t.modes.local}function nu(t){const e=E.c(31),{server:s,backendState:i}=t,l=ee(),n=F(ru),o=s.error||i?.last_exception||n||void 0;let a;e[0]!==l||e[1]!==s?(a=k=>{const T=s.selectedProcesses?.split(/,\s*/).filter(D=>D!==k).join(", ");l(kt({server:s,value:T}))},e[0]=l,e[1]=s,e[2]=a):a=e[2];const d=a;let u;e[3]!==l||e[4]!==s?(u=()=>l(kr({server:s,value:!s.active})),e[3]=l,e[4]=s,e[5]=u):u=e[5];let h;e[6]!==d||e[7]!==s.selectedProcesses?(h=s.selectedProcesses?.split(/,\s*/).filter(iu).map(k=>r.jsxs("div",{className:"selected-process",children:[k,r.jsx("i",{className:"fa fa-times","aria-hidden":"true",onClick:()=>d(k)})]},k)),e[6]=d,e[7]=s.selectedProcesses,e[8]=h):h=e[8];let p;e[9]!==h?(p=r.jsx("div",{className:"selected-processes",children:h}),e[9]=h,e[10]=p):p=e[10];let g;e[11]!==s?(g=r.jsx(Yd,{server:s}),e[11]=s,e[12]=g):g=e[12];let x;e[13]!==l?(x=r.jsx("i",{className:"fa fa-refresh","aria-hidden":"true",onClick:()=>l(Et())}),e[13]=l,e[14]=x):x=e[14];let j;e[15]!==g||e[16]!==x?(j=r.jsxs("div",{className:"dropdown-container",children:[g,x]}),e[15]=g,e[16]=x,e[17]=j):j=e[17];let y;e[18]!==p||e[19]!==j?(y=r.jsxs("div",{className:"processes-container",children:[p,j]}),e[18]=p,e[19]=j,e[20]=y):y=e[20];let b;e[21]!==s.active||e[22]!==u||e[23]!==y?(b=r.jsx(nt,{value:s.active,label:"Intercept traffic for",onChange:u,children:y}),e[21]=s.active,e[22]=u,e[23]=y,e[24]=b):b=e[24];let w;e[25]!==i||e[26]!==o?(w=r.jsx(st,{error:o,backendState:i}),e[25]=i,e[26]=o,e[27]=w):w=e[27];let C;return e[28]!==w||e[29]!==b?(C=r.jsxs("div",{className:"mode-local",children:[b,w]}),e[28]=w,e[29]=b,e[30]=C):C=e[30],C}function iu(t){return t.trim()!==""}function ru(t){return t.processes.error}function lu(){const t=E.c(9),e=F(cu),s=F(ou);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(au,{server:u,backendState:s[vr(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n,o;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"Explicit HTTP(S) Proxy"}),o=r.jsx("p",{className:"mode-description",children:"You manually configure your client application or device to use an HTTP(S) proxy."}),t[5]=n,t[6]=o):(n=t[5],o=t[6]);let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function ou(t){return t.backendState.servers}function cu(t){return t.modes.regular}function au(t){const e=E.c(33),{server:s,backendState:i}=t,l=ee(),n=s.error||i?.last_exception||void 0;let o;e[0]!==l||e[1]!==s?(o=()=>l($r({server:s,value:!s.active})),e[0]=l,e[1]=s,e[2]=o):o=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("h4",{children:"Advanced Configuration"}),d=r.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const u=s.listen_host||"";let h;e[5]!==l||e[6]!==s?(h=T=>l(Cr({server:s,value:T})),e[5]=l,e[6]=s,e[7]=h):h=e[7];let p;e[8]!==u||e[9]!==h?(p=r.jsx(fe,{className:"mode-input",content:u,onEditDone:h}),e[8]=u,e[9]=h,e[10]=p):p=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==l||e[15]!==s?(j=T=>l(Nr({server:s,value:parseInt(T)})),e[14]=l,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=r.jsx(fe,{className:"mode-input",content:x,placeholder:"8080",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]!==y||e[21]!==p?(b=r.jsxs(it,{iconClass:"fa fa-cog",children:[a,d,p,g,y]}),e[20]=y,e[21]=p,e[22]=b):b=e[22];let w;e[23]!==s.active||e[24]!==o||e[25]!==b?(w=r.jsx(nt,{value:s.active,label:"Run HTTP/S Proxy",onChange:o,children:b}),e[23]=s.active,e[24]=o,e[25]=b,e[26]=w):w=e[26];let C;e[27]!==i||e[28]!==n?(C=r.jsx(st,{error:n,backendState:i}),e[27]=i,e[28]=n,e[29]=C):C=e[29];let k;return e[30]!==w||e[31]!==C?(k=r.jsxs("div",{children:[w,C]}),e[30]=w,e[31]=C,e[32]=k):k=e[32],k}function du(){const t=E.c(9),e=F(fu),s=F(uu);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(pu,{server:u,backendState:s[jr(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n,o;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"WireGuard Server"}),o=r.jsx("p",{className:"mode-description",children:"Start a WireGuard™ server and connect an external device for transparent proxying."}),t[5]=n,t[6]=o):(n=t[5],o=t[6]);let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function uu(t){return t.backendState.servers}function fu(t){return t.modes.wireguard}function pu(t){const e=E.c(41),{server:s,backendState:i}=t,l=ee(),n=s.error||i?.last_exception||void 0;let o;e[0]!==l||e[1]!==s?(o=()=>l(Er({server:s,value:!s.active})),e[0]=l,e[1]=s,e[2]=o):o=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("h4",{children:"Advanced Configuration"}),d=r.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const u=s.listen_host||"";let h;e[5]!==l||e[6]!==s?(h=O=>l(Tr({server:s,value:O})),e[5]=l,e[6]=s,e[7]=h):h=e[7];let p;e[8]!==u||e[9]!==h?(p=r.jsx(fe,{className:"mode-input",content:u,placeholder:"(all interfaces)",onEditDone:h}),e[8]=u,e[9]=h,e[10]=p):p=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==l||e[15]!==s?(j=O=>l(Rr({server:s,value:parseInt(O)})),e[14]=l,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=r.jsx(fe,{className:"mode-input",content:x,placeholder:"51820",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]===Symbol.for("react.memo_cache_sentinel")?(b=r.jsx("p",{children:"Configuration File"}),e[20]=b):b=e[20];const w=s.file_path||"";let C;e[21]!==l||e[22]!==s?(C=O=>l(Ar({server:s,value:O})),e[21]=l,e[22]=s,e[23]=C):C=e[23];let k;e[24]!==w||e[25]!==C?(k=r.jsx(fe,{className:"mode-input",content:w,placeholder:"~/.mitmproxy/wireguard.conf",onEditDone:C}),e[24]=w,e[25]=C,e[26]=k):k=e[26];let T;e[27]!==y||e[28]!==k||e[29]!==p?(T=r.jsxs(it,{iconClass:"fa fa-cog",children:[a,d,p,g,y,b,k]}),e[27]=y,e[28]=k,e[29]=p,e[30]=T):T=e[30];let D;e[31]!==s.active||e[32]!==o||e[33]!==T?(D=r.jsx(nt,{value:s.active,label:"Run WireGuard Server",onChange:o,children:T}),e[31]=s.active,e[32]=o,e[33]=T,e[34]=D):D=e[34];let I;e[35]!==i||e[36]!==n?(I=r.jsx(st,{error:n,backendState:i}),e[35]=i,e[36]=n,e[37]=I):I=e[37];let M;return e[38]!==D||e[39]!==I?(M=r.jsxs("div",{children:[D,I]}),e[38]=D,e[39]=I,e[40]=M):M=e[40],M}function hu(){const t=E.c(15),e=ee(),s=F(gu),i=F(mu);let l,n;t[0]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("h4",{className:"mode-title",children:"Reverse Proxy"}),n=r.jsx("p",{className:"mode-description",children:"Requests are forwarded to a preconfigured destination."}),t[0]=l,t[1]=n):(l=t[0],n=t[1]);let o;if(t[2]!==i||t[3]!==s){let p;t[5]!==i?(p=(g,x)=>r.jsx(xu,{removable:x>0,server:g,backendState:i[Ms(g)]},g.ui_id),t[5]=i,t[6]=p):p=t[6],o=s.map(p),t[2]=i,t[3]=s,t[4]=o}else o=t[4];let a;t[7]!==e?(a=()=>e(Ia()),t[7]=e,t[8]=a):a=t[8];let d;t[9]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx("i",{className:"fa fa-plus-square-o","aria-hidden":"true"}),t[9]=d):d=t[9];let u;t[10]!==a?(u=r.jsxs("div",{className:"mode-reverse-add-server",onClick:a,children:[d,"Add additional server"]}),t[10]=a,t[11]=u):u=t[11];let h;return t[12]!==o||t[13]!==u?(h=r.jsxs("div",{children:[l,n,r.jsxs("div",{className:"mode-reverse-servers",children:[o,u]})]}),t[12]=o,t[13]=u,t[14]=h):h=t[14],h}function mu(t){return t.backendState.servers}function gu(t){return t.modes.reverse}function xu(t){const e=E.c(56),{removable:s,server:i,backendState:l}=t,n=ee();let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=Object.values(es),e[0]=o):o=e[0];const a=o;let d;e[1]!==n||e[2]!==i?(d=async()=>{i.active&&await n(bs({server:i,value:!1})).unwrap(),await n(Da(i))},e[1]=n,e[2]=i,e[3]=d):d=e[3];const u=d,h=i.error||l?.last_exception||void 0,p=i.active;let g;e[4]!==n||e[5]!==i?(g=()=>{n(bs({server:i,value:!i.active}))},e[4]=n,e[5]=i,e[6]=g):g=e[6];const x=i.protocol;let j;e[7]!==n||e[8]!==i?(j=te=>{n(Fr({server:i,value:te.target.value}))},e[7]=n,e[8]=i,e[9]=j):j=e[9];let y;e[10]===Symbol.for("react.memo_cache_sentinel")?(y=a.map(vu),e[10]=y):y=e[10];let b;e[11]!==i.protocol||e[12]!==j?(b=r.jsx("select",{name:"protocols",className:"mode-reverse-dropdown",value:x,onChange:j,children:y}),e[11]=i.protocol,e[12]=j,e[13]=b):b=e[13];let w;e[14]!==i.destination?(w=i.destination?.toString()||"",e[14]=i.destination,e[15]=w):w=e[15];let C;e[16]!==n||e[17]!==i?(C=te=>n(Lr({server:i,value:te})),e[16]=n,e[17]=i,e[18]=C):C=e[18];let k;e[19]!==C||e[20]!==w?(k=r.jsx(fe,{className:"mode-reverse-input",content:w,onEditDone:C,placeholder:"example.com"}),e[19]=C,e[20]=w,e[21]=k):k=e[21];let T,D;e[22]===Symbol.for("react.memo_cache_sentinel")?(T=r.jsx("h4",{children:"Advanced Configuration"}),D=r.jsx("p",{children:"Listen Host"}),e[22]=T,e[23]=D):(T=e[22],D=e[23]);const I=i.listen_host||"";let M;e[24]!==n||e[25]!==i?(M=te=>n(Ir({server:i,value:te})),e[24]=n,e[25]=i,e[26]=M):M=e[26];let O;e[27]!==I||e[28]!==M?(O=r.jsx(fe,{className:"mode-input",content:I,onEditDone:M,placeholder:"*"}),e[27]=I,e[28]=M,e[29]=O):O=e[29];let V;e[30]===Symbol.for("react.memo_cache_sentinel")?(V=r.jsx("p",{children:"Listen Port"}),e[30]=V):V=e[30];const q=String(i.listen_port||"");let U;e[31]!==n||e[32]!==i?(U=te=>n(Dr({server:i,value:te})),e[31]=n,e[32]=i,e[33]=U):U=e[33];let W;e[34]!==q||e[35]!==U?(W=r.jsx(fe,{className:"mode-input",content:q,onEditDone:U,placeholder:"8080"}),e[34]=q,e[35]=U,e[36]=W):W=e[36];let B;e[37]!==O||e[38]!==W?(B=r.jsxs(it,{iconClass:"fa fa-cog",children:[T,D,O,V,W]}),e[37]=O,e[38]=W,e[39]=B):B=e[39];let Q;e[40]!==u||e[41]!==s?(Q=s&&r.jsx("i",{className:"fa fa-fw fa-trash fa-lg","aria-hidden":"true",onClick:u}),e[40]=u,e[41]=s,e[42]=Q):Q=e[42];let G;e[43]!==i.active||e[44]!==k||e[45]!==B||e[46]!==Q||e[47]!==g||e[48]!==b?(G=r.jsxs(nt,{value:p,label:"Forward",onChange:g,children:[b,"traffic to",k,B,Q]}),e[43]=i.active,e[44]=k,e[45]=B,e[46]=Q,e[47]=g,e[48]=b,e[49]=G):G=e[49];let J;e[50]!==l||e[51]!==h?(J=r.jsx(st,{error:h,backendState:l}),e[50]=l,e[51]=h,e[52]=J):J=e[52];let Z;return e[53]!==G||e[54]!==J?(Z=r.jsxs("div",{children:[G,J]}),e[53]=G,e[54]=J,e[55]=Z):Z=e[55],Z}function vu(t){return r.jsx("option",{value:t,children:t},t)}function _u(){const t=E.c(9),e=F(yu),s=F(ju);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(bu,{server:u,backendState:s[yr(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"Transparent Proxy"}),t[5]=n):n=t[5];let o;t[6]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsxs("p",{className:"mode-description",children:["You"," ",r.jsx("a",{href:"https://docs.mitmproxy.org/stable/howto-transparent/",style:{textDecoration:"underline",color:"inherit"},children:"configure your routing table"})," ","to send traffic through mitmproxy."]}),t[6]=o):o=t[6];let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function ju(t){return t.backendState.servers}function yu(t){return t.modes.transparent}function bu(t){const e=E.c(33),{server:s,backendState:i}=t,l=ee(),n=s.error||i?.last_exception||void 0;let o;e[0]!==l||e[1]!==s?(o=()=>l(Mr({server:s,value:!s.active})),e[0]=l,e[1]=s,e[2]=o):o=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("h4",{children:"Advanced Configuration"}),d=r.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const u=s.listen_host||"";let h;e[5]!==l||e[6]!==s?(h=T=>l(Or({server:s,value:T})),e[5]=l,e[6]=s,e[7]=h):h=e[7];let p;e[8]!==u||e[9]!==h?(p=r.jsx(fe,{className:"mode-input",content:u,onEditDone:h}),e[8]=u,e[9]=h,e[10]=p):p=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==l||e[15]!==s?(j=T=>l(qr({server:s,value:parseInt(T)})),e[14]=l,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=r.jsx(fe,{className:"mode-input",content:x,placeholder:"8080",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]!==y||e[21]!==p?(b=r.jsxs(it,{iconClass:"fa fa-cog",children:[a,d,p,g,y]}),e[20]=y,e[21]=p,e[22]=b):b=e[22];let w;e[23]!==s.active||e[24]!==o||e[25]!==b?(w=r.jsx(nt,{value:s.active,label:"Run Transparent Proxy",onChange:o,children:b}),e[23]=s.active,e[24]=o,e[25]=b,e[26]=w):w=e[26];let C;e[27]!==i||e[28]!==n?(C=r.jsx(st,{error:n,backendState:i}),e[27]=i,e[28]=n,e[29]=C):C=e[29];let k;return e[30]!==w||e[31]!==C?(k=r.jsxs("div",{children:[w,C]}),e[30]=w,e[31]=C,e[32]=k):k=e[32],k}function Su(){const t=E.c(9),e=F($u),s=F(wu);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(Cu,{server:u,backendState:s[br(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n,o;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"SOCKS Proxy"}),o=r.jsx("p",{className:"mode-description",children:"You manually configure your client application or device to use a SOCKS5 proxy."}),t[5]=n,t[6]=o):(n=t[5],o=t[6]);let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function wu(t){return t.backendState.servers}function $u(t){return t.modes.socks}function Cu(t){const e=E.c(33),{server:s,backendState:i}=t,l=ee(),n=s.error||i?.last_exception||void 0;let o;e[0]!==l||e[1]!==s?(o=()=>l(Hr({server:s,value:!s.active})),e[0]=l,e[1]=s,e[2]=o):o=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("h4",{children:"Advanced Configuration"}),d=r.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const u=s.listen_host||"";let h;e[5]!==l||e[6]!==s?(h=T=>l(Vr({server:s,value:T})),e[5]=l,e[6]=s,e[7]=h):h=e[7];let p;e[8]!==u||e[9]!==h?(p=r.jsx(fe,{className:"mode-input",content:u,onEditDone:h}),e[8]=u,e[9]=h,e[10]=p):p=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==l||e[15]!==s?(j=T=>l(Ur({server:s,value:parseInt(T)})),e[14]=l,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=r.jsx(fe,{className:"mode-input",content:x,placeholder:"8080",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]!==y||e[21]!==p?(b=r.jsxs(it,{iconClass:"fa fa-cog",children:[a,d,p,g,y]}),e[20]=y,e[21]=p,e[22]=b):b=e[22];let w;e[23]!==s.active||e[24]!==o||e[25]!==b?(w=r.jsx(nt,{value:s.active,label:"Run SOCKS Proxy",onChange:o,children:b}),e[23]=s.active,e[24]=o,e[25]=b,e[26]=w):w=e[26];let C;e[27]!==i||e[28]!==n?(C=r.jsx(st,{error:n,backendState:i}),e[27]=i,e[28]=n,e[29]=C):C=e[29];let k;return e[30]!==w||e[31]!==C?(k=r.jsxs("div",{children:[w,C]}),e[30]=w,e[31]=C,e[32]=k):k=e[32],k}function Nu(){const t=E.c(9),e=F(Eu),s=F(ku);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(Tu,{server:u,backendState:s[Sr(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n,o;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"Explicit HTTP(S) Proxy (With Upstream Proxy)"}),o=r.jsx("p",{className:"mode-description",children:"All requests are forwarded to a second HTTP(S) proxy server."}),t[5]=n,t[6]=o):(n=t[5],o=t[6]);let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function ku(t){return t.backendState.servers}function Eu(t){return t.modes.upstream}function Tu(t){const e=E.c(42),{server:s,backendState:i}=t,l=ee(),n=s.error||i?.last_exception||void 0;let o;e[0]!==l||e[1]!==s?(o=()=>{l(Br({server:s,value:!s.active}))},e[0]=l,e[1]=s,e[2]=o):o=e[2];let a;e[3]!==s.destination?(a=s.destination?.toString()||"",e[3]=s.destination,e[4]=a):a=e[4];let d;e[5]!==l||e[6]!==s?(d=M=>l(zr({server:s,value:M})),e[5]=l,e[6]=s,e[7]=d):d=e[7];let u;e[8]!==a||e[9]!==d?(u=r.jsx(fe,{className:"mode-upstream-input",content:a,onEditDone:d,placeholder:"http://example.com:8080"}),e[8]=a,e[9]=d,e[10]=u):u=e[10];let h,p;e[11]===Symbol.for("react.memo_cache_sentinel")?(h=r.jsx("h4",{children:"Advanced Configuration"}),p=r.jsx("p",{children:"Listen Host"}),e[11]=h,e[12]=p):(h=e[11],p=e[12]);const g=s.listen_host||"";let x;e[13]!==l||e[14]!==s?(x=M=>l(Kr({server:s,value:M})),e[13]=l,e[14]=s,e[15]=x):x=e[15];let j;e[16]!==g||e[17]!==x?(j=r.jsx(fe,{className:"mode-input",content:g,onEditDone:x}),e[16]=g,e[17]=x,e[18]=j):j=e[18];let y;e[19]===Symbol.for("react.memo_cache_sentinel")?(y=r.jsx("p",{children:"Listen Port"}),e[19]=y):y=e[19];let b;e[20]!==s.listen_port?(b=s.listen_port?s.listen_port.toString():"",e[20]=s.listen_port,e[21]=b):b=e[21];let w;e[22]!==l||e[23]!==s?(w=M=>l(Wr({server:s,value:parseInt(M)})),e[22]=l,e[23]=s,e[24]=w):w=e[24];let C;e[25]!==b||e[26]!==w?(C=r.jsx(fe,{className:"mode-input",content:b,placeholder:"8080",onEditDone:w}),e[25]=b,e[26]=w,e[27]=C):C=e[27];let k;e[28]!==C||e[29]!==j?(k=r.jsxs(it,{iconClass:"fa fa-cog",children:[h,p,j,y,C]}),e[28]=C,e[29]=j,e[30]=k):k=e[30];let T;e[31]!==s.active||e[32]!==o||e[33]!==k||e[34]!==u?(T=r.jsxs(nt,{value:s.active,label:"Run HTTP/S Proxy and forward requests to",onChange:o,children:[u,k]}),e[31]=s.active,e[32]=o,e[33]=k,e[34]=u,e[35]=T):T=e[35];let D;e[36]!==i||e[37]!==n?(D=r.jsx(st,{error:n,backendState:i}),e[36]=i,e[37]=n,e[38]=D):D=e[38];let I;return e[39]!==T||e[40]!==D?(I=r.jsxs("div",{children:[T,D]}),e[39]=T,e[40]=D,e[41]=I):I=e[41],I}function Ru(){const t=E.c(9),e=F(Iu),s=F(Au);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(Du,{server:u,backendState:s[wr(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n,o;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"DNS Server"}),o=r.jsx("p",{className:"mode-description",children:"A recursive DNS resolver using the host's DNS configuration."}),t[5]=n,t[6]=o):(n=t[5],o=t[6]);let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function Au(t){return t.backendState.servers}function Iu(t){return t.modes.dns}function Du(t){const e=E.c(33),{server:s,backendState:i}=t,l=ee(),n=s.error||i?.last_exception||void 0;let o;e[0]!==l||e[1]!==s?(o=()=>l(Qr({server:s,value:!s.active})),e[0]=l,e[1]=s,e[2]=o):o=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("h4",{children:"Advanced Configuration"}),d=r.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const u=s.listen_host||"";let h;e[5]!==l||e[6]!==s?(h=T=>l(Gr({server:s,value:T})),e[5]=l,e[6]=s,e[7]=h):h=e[7];let p;e[8]!==u||e[9]!==h?(p=r.jsx(fe,{className:"mode-input",content:u,onEditDone:h}),e[8]=u,e[9]=h,e[10]=p):p=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==l||e[15]!==s?(j=T=>l(Yr({server:s,value:parseInt(T)})),e[14]=l,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=r.jsx(fe,{className:"mode-input",content:x,placeholder:"8080",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]!==y||e[21]!==p?(b=r.jsxs(it,{iconClass:"fa fa-cog",children:[a,d,p,g,y]}),e[20]=y,e[21]=p,e[22]=b):b=e[22];let w;e[23]!==s.active||e[24]!==o||e[25]!==b?(w=r.jsx(nt,{value:s.active,label:"Run DNS Server",onChange:o,children:b}),e[23]=s.active,e[24]=o,e[25]=b,e[26]=w):w=e[26];let C;e[27]!==i||e[28]!==n?(C=r.jsx(st,{error:n,backendState:i}),e[27]=i,e[28]=n,e[29]=C):C=e[29];let k;return e[30]!==w||e[31]!==C?(k=r.jsxs("div",{children:[w,C]}),e[30]=w,e[31]=C,e[32]=k):k=e[32],k}function ji(t){const e=E.c(10),{title:s,description:i}=t;let l;e[0]!==s?(l=r.jsx("h4",{className:"mode-title",children:s}),e[0]=s,e[1]=l):l=e[1];let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("i",{className:"fa fa-exclamation-triangle","aria-hidden":"true"}),e[2]=n):n=e[2];let o;e[3]!==l?(o=r.jsxs("div",{className:"title-icon-container",children:[l,n]}),e[3]=l,e[4]=o):o=e[4];let a;e[5]!==i?(a=r.jsx("p",{className:"mode-description",children:i}),e[5]=i,e[6]=a):a=e[6];let d;return e[7]!==o||e[8]!==a?(d=r.jsxs("div",{className:"missing-mode-container",children:[o,a]}),e[7]=o,e[8]=a,e[9]=d):d=e[9],d}function Fu(){const t=E.c(19),{platform:e,localModeUnavailable:s}=F(Lu);let i,l;t[0]===Symbol.for("react.memo_cache_sentinel")?(i=r.jsx("h2",{children:"Intercept Traffic"}),l=r.jsx("p",{children:"Configure how you want to intercept traffic with mitmproxy."}),t[0]=i,t[1]=l):(i=t[0],l=t[1]);let n;t[2]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h3",{children:"Recommended"}),t[2]=n):n=t[2];let o;t[3]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsx(lu,{}),t[3]=o):o=t[3];let a;t[4]!==s?(a=s!==null?r.jsx(ji,{title:"Local Redirect Mode",description:s}):r.jsx(eu,{}),t[4]=s,t[5]=a):a=t[5];let d,u;t[6]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx(du,{}),u=r.jsx(hu,{}),t[6]=d,t[7]=u):(d=t[6],u=t[7]);let h;t[8]!==a?(h=r.jsxs("div",{className:"modes-category green-left-border",children:[n,r.jsxs("div",{className:"modes-container",children:[o,a,d,u]})]}),t[8]=a,t[9]=h):h=t[9];let p;t[10]===Symbol.for("react.memo_cache_sentinel")?(p=r.jsx("h3",{children:"Advanced"}),t[10]=p):p=t[10];let g,x,j;t[11]===Symbol.for("react.memo_cache_sentinel")?(j=r.jsx(Su,{}),g=r.jsx(Nu,{}),x=r.jsx(Ru,{}),t[11]=g,t[12]=x,t[13]=j):(g=t[11],x=t[12],j=t[13]);let y;t[14]!==e?(y=r.jsxs("div",{className:"modes-category gray-left-border",children:[p,r.jsxs("div",{className:"modes-container",children:[j,g,x,e.startsWith("win32")?r.jsx(ji,{title:"Transparent Proxy",description:"This mode is only supported on Linux and MacOS."}):r.jsx(_u,{})]})]}),t[14]=e,t[15]=y):y=t[15];let b;return t[16]!==y||t[17]!==h?(b=r.jsxs("div",{className:"modes",children:[i,l,h,y]}),t[16]=y,t[17]=h,t[18]=b):b=t[18],b}function Lu(t){return t.backendState}function Pu(t){const e=t.filter(d=>d.type==="http"),s=e.length,i=e.filter(d=>d.response&&d.response.status_code>=400).length,l=s>0?i/s*100:0,n=e.filter(d=>d.response?.timestamp_end&&d.request?.timestamp_start).map(d=>{const u=d.request.timestamp_start;return(d.response.timestamp_end-u)*1e3}),o=n.length>0?n.reduce((d,u)=>d+u,0)/n.length:0,a=n.filter(d=>d>1e3).length;return{totalRequests:s,errorRate:l,avgResponseTime:o,slowQueries:a}}function Mu(t){const e=t.filter(i=>i.type==="http"),s=new Map;return e.forEach(i=>{if(i.response){const l=i.response.status_code;s.set(l,(s.get(l)||0)+1)}}),Array.from(s.entries()).map(([i,l])=>({code:i,count:l})).sort((i,l)=>l.count-i.count).slice(0,10)}function Ou(t){const e=t.filter(i=>i.type==="http"),s=new Map;return e.forEach(i=>{const l=i.request.pretty_host,n=s.get(l)||{count:0,totalTime:0};if(n.count+=1,i.response?.timestamp_end&&i.request?.timestamp_start){const o=(i.response.timestamp_end-i.request.timestamp_start)*1e3;n.totalTime+=o}s.set(l,n)}),Array.from(s.entries()).map(([i,l])=>({domain:i,count:l.count,avgTime:l.count>0?l.totalTime/l.count:0})).sort((i,l)=>l.count-i.count).slice(0,10)}function qu(t,e=5e3){const s=t.filter(l=>l.type==="http"),i=new Map;return s.forEach(l=>{if(l.response?.timestamp_end&&l.request?.timestamp_start){const n=Math.floor(l.request.timestamp_start*1e3),o=Math.floor(n/e)*e,a=(l.response.timestamp_end-l.request.timestamp_start)*1e3;i.has(o)||i.set(o,[]),i.get(o).push(a)}}),Array.from(i.entries()).map(([l,n])=>({timestamp:l,time:n.reduce((o,a)=>o+a,0)/n.length})).sort((l,n)=>l.timestamp-n.timestamp).slice(-50)}function ps(t){return t.toLocaleString()}function Hu(t){return t<1e3?`${Math.round(t)}ms`:`${(t/1e3).toFixed(2)}s`}function Vu(t){return`${t.toFixed(1)}%`}function Uu(t){const e=E.c(13),{flows:s}=t;let i;e[0]!==s?(i=qu(s),e[0]=s,e[1]=i):i=e[1];const l=i;if(l.length===0){let j;return e[2]===Symbol.for("react.memo_cache_sentinel")?(j=r.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"No response time data available"}),e[2]=j):j=e[2],j}let n;e[3]===Symbol.for("react.memo_cache_sentinel")?(n={width:"100%",height:300},e[3]=n):n=e[3];let o,a;e[4]===Symbol.for("react.memo_cache_sentinel")?(o={top:5,right:30,left:20,bottom:5},a=r.jsx(Ri,{strokeDasharray:"3 3"}),e[4]=o,e[5]=a):(o=e[4],a=e[5]);let d;e[6]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx(Ai,{dataKey:"timestamp",tickFormatter:Wu,label:{value:"Time",position:"insideBottom",offset:-5}}),e[6]=d):d=e[6];let u,h,p,g;e[7]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx(vs,{label:{value:"Response Time (ms)",angle:-90,position:"insideLeft"}}),h=r.jsx(Cs,{labelFormatter:Ku,formatter:Bu}),p=r.jsx(Ns,{}),g=r.jsx(oc,{type:"monotone",dataKey:"time",stroke:"#8884d8",strokeWidth:2,dot:!1,name:"Response Time"}),e[7]=u,e[8]=h,e[9]=p,e[10]=g):(u=e[7],h=e[8],p=e[9],g=e[10]);let x;return e[11]!==l?(x=r.jsx("div",{style:n,children:r.jsx(ks,{children:r.jsxs(cc,{data:l,margin:o,children:[a,d,u,h,p,g]})})}),e[11]=l,e[12]=x):x=e[12],x}function Bu(t){return[`${t.toFixed(2)}ms`,"Avg Response Time"]}function Ku(t){return new Date(t).toLocaleTimeString()}function Wu(t){const e=new Date(t);return`${e.getHours()}:${String(e.getMinutes()).padStart(2,"0")}`}const wt={"2xx":"#10b981","3xx":"#3b82f6","4xx":"#f59e0b","5xx":"#ef4444",default:"#6b7280"};function zu(t){return t>=200&&t<300?wt["2xx"]:t>=300&&t<400?wt["3xx"]:t>=400&&t<500?wt["4xx"]:t>=500&&t<600?wt["5xx"]:wt.default}function Qu(t){const e=E.c(13),{flows:s}=t;let i;e[0]!==s?(i=Mu(s).map(Zu),e[0]=s,e[1]=i):i=e[1];const l=i;if(l.length===0){let p;return e[2]===Symbol.for("react.memo_cache_sentinel")?(p=r.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"No status code data available"}),e[2]=p):p=e[2],p}let n;e[3]===Symbol.for("react.memo_cache_sentinel")?(n={width:"100%",height:300},e[3]=n):n=e[3];let o;e[4]!==l?(o=l.map(Ju),e[4]=l,e[5]=o):o=e[5];let a;e[6]!==l||e[7]!==o?(a=r.jsx(ac,{data:l,cx:"50%",cy:"50%",labelLine:!1,label:Xu,outerRadius:80,fill:"#8884d8",dataKey:"value",children:o}),e[6]=l,e[7]=o,e[8]=a):a=e[8];let d,u;e[9]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx(Cs,{formatter:Yu}),u=r.jsx(Ns,{formatter:Gu}),e[9]=d,e[10]=u):(d=e[9],u=e[10]);let h;return e[11]!==a?(h=r.jsx("div",{style:n,children:r.jsx(ks,{children:r.jsxs(dc,{children:[a,d,u]})})}),e[11]=a,e[12]=h):h=e[12],h}function Gu(t,e){return`${t} (${e.payload.value})`}function Yu(t,e){return[`${t} requests`,`Status ${e}`]}function Ju(t,e){return r.jsx(uc,{fill:t.fill},`cell-${e}`)}function Xu(t){const{name:e,percent:s}=t;return`${e} (${(s*100).toFixed(0)}%)`}function Zu(t){return{name:`${t.code}`,value:t.count,fill:zu(t.code)}}function ef(t){const e=E.c(15),{flows:s}=t;let i;e[0]!==s?(i=Ou(s),e[0]=s,e[1]=i):i=e[1];const l=i;if(l.length===0){let b;return e[2]===Symbol.for("react.memo_cache_sentinel")?(b=r.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"No domain data available"}),e[2]=b):b=e[2],b}let n;e[3]===Symbol.for("react.memo_cache_sentinel")?(n={width:"100%",height:300},e[3]=n):n=e[3];let o,a;e[4]===Symbol.for("react.memo_cache_sentinel")?(o={top:5,right:30,left:20,bottom:60},a=r.jsx(Ri,{strokeDasharray:"3 3"}),e[4]=o,e[5]=a):(o=e[4],a=e[5]);let d;e[6]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx(Ai,{dataKey:"domain",angle:-45,textAnchor:"end",height:100,interval:0,tick:{fontSize:10}}),e[6]=d):d=e[6];let u;e[7]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx(vs,{yAxisId:"left",label:{value:"Request Count",angle:-90,position:"insideLeft"}}),e[7]=u):u=e[7];let h,p,g,x,j;e[8]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx(vs,{yAxisId:"right",orientation:"right",label:{value:"Avg Time (ms)",angle:90,position:"insideRight"}}),x=r.jsx(Cs,{formatter:tf}),j=r.jsx(Ns,{}),h=r.jsx(ti,{yAxisId:"left",dataKey:"count",fill:"#8884d8",name:"Request Count"}),p=r.jsx(ti,{yAxisId:"right",dataKey:"avgTime",fill:"#82ca9d",name:"Avg Response Time"}),e[8]=h,e[9]=p,e[10]=g,e[11]=x,e[12]=j):(h=e[8],p=e[9],g=e[10],x=e[11],j=e[12]);let y;return e[13]!==l?(y=r.jsx("div",{style:n,children:r.jsx(ks,{children:r.jsxs(fc,{data:l,margin:o,children:[a,d,u,g,x,j,h,p]})})}),e[13]=l,e[14]=y):y=e[14],y}function tf(t,e){return e==="count"?[`${t} requests`,"Count"]:[`${t.toFixed(2)}ms`,"Avg Time"]}function sf(t){const e=E.c(52),{flows:s}=t;let i;e[0]!==s?(i=Pu(s),e[0]=s,e[1]=i):i=e[1];const l=i;let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h2",{children:"📊 Network Metrics"}),e[2]=n):n=e[2];let o;e[3]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsx("div",{className:"metric-label",children:"Total Requests"}),e[3]=o):o=e[3];let a;e[4]!==l.totalRequests?(a=ps(l.totalRequests),e[4]=l.totalRequests,e[5]=a):a=e[5];let d;e[6]!==a?(d=r.jsxs("div",{className:"metric-card",children:[o,r.jsx("div",{className:"metric-value",children:a})]}),e[6]=a,e[7]=d):d=e[7];let u;e[8]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("div",{className:"metric-label",children:"Error Rate"}),e[8]=u):u=e[8];let h;e[9]!==l.errorRate?(h=Vu(l.errorRate),e[9]=l.errorRate,e[10]=h):h=e[10];let p;e[11]!==h?(p=r.jsxs("div",{className:"metric-card",children:[u,r.jsx("div",{className:"metric-value",children:h})]}),e[11]=h,e[12]=p):p=e[12];let g;e[13]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("div",{className:"metric-label",children:"Avg Response Time"}),e[13]=g):g=e[13];let x;e[14]!==l.avgResponseTime?(x=Hu(l.avgResponseTime),e[14]=l.avgResponseTime,e[15]=x):x=e[15];let j;e[16]!==x?(j=r.jsxs("div",{className:"metric-card",children:[g,r.jsx("div",{className:"metric-value",children:x})]}),e[16]=x,e[17]=j):j=e[17];let y;e[18]===Symbol.for("react.memo_cache_sentinel")?(y=r.jsx("div",{className:"metric-label",children:"Slow Queries (>1s)"}),e[18]=y):y=e[18];let b;e[19]!==l.slowQueries?(b=ps(l.slowQueries),e[19]=l.slowQueries,e[20]=b):b=e[20];let w;e[21]!==b?(w=r.jsxs("div",{className:"metric-card",children:[y,r.jsx("div",{className:"metric-value",children:b})]}),e[21]=b,e[22]=w):w=e[22];let C;e[23]!==j||e[24]!==w||e[25]!==d||e[26]!==p?(C=r.jsxs("div",{className:"metrics-grid",children:[d,p,j,w]}),e[23]=j,e[24]=w,e[25]=d,e[26]=p,e[27]=C):C=e[27];let k;e[28]===Symbol.for("react.memo_cache_sentinel")?(k=r.jsx("h3",{children:"Response Time Over Time"}),e[28]=k):k=e[28];let T;e[29]!==s?(T=r.jsxs("div",{className:"chart-container",children:[k,r.jsx(Uu,{flows:s})]}),e[29]=s,e[30]=T):T=e[30];let D;e[31]===Symbol.for("react.memo_cache_sentinel")?(D=r.jsx("h3",{children:"Status Code Distribution"}),e[31]=D):D=e[31];let I;e[32]!==s?(I=r.jsxs("div",{className:"chart-container",children:[D,r.jsx(Qu,{flows:s})]}),e[32]=s,e[33]=I):I=e[33];let M;e[34]===Symbol.for("react.memo_cache_sentinel")?(M=r.jsx("h3",{children:"Top Domains by Request Count"}),e[34]=M):M=e[34];let O;e[35]!==s?(O=r.jsxs("div",{className:"chart-container",children:[M,r.jsx(ef,{flows:s})]}),e[35]=s,e[36]=O):O=e[36];let V;e[37]!==I||e[38]!==O?(V=r.jsxs("div",{className:"charts-row",children:[I,O]}),e[37]=I,e[38]=O,e[39]=V):V=e[39];let q;e[40]!==T||e[41]!==V?(q=r.jsxs("div",{className:"charts-section",children:[T,V]}),e[40]=T,e[41]=V,e[42]=q):q=e[42];let U;e[43]===Symbol.for("react.memo_cache_sentinel")?(U=r.jsx("p",{children:"✨ Kidsnote mitmweb - Network Debugging Tool"}),e[43]=U):U=e[43];let W;e[44]!==s.length?(W=ps(s.length),e[44]=s.length,e[45]=W):W=e[45];let B;e[46]!==W?(B=r.jsxs("div",{className:"metrics-info",children:[U,r.jsxs("p",{children:["🚀 Phase 1: MVP - Real-time metrics from ",W," ","flows"]})]}),e[46]=W,e[47]=B):B=e[47];let Q;return e[48]!==C||e[49]!==q||e[50]!==B?(Q=r.jsxs("div",{className:"kidsnote-metrics-panel",children:[n,C,q,B]}),e[48]=C,e[49]=q,e[50]=B,e[51]=Q):Q=e[51],Q}const nf=_t(t=>({flows:t.flows.list}))(sf);var Pe=(t=>(t.REQUEST="request",t.IMPRESSION="impression",t.CLICK="click",t))(Pe||{}),je=(t=>(t.REQUESTED="requested",t.IMPRESSED="impressed",t.CLICKED="clicked",t))(je||{});const rf="ads-api-kcsandbox-01.kidsnote.com",Xs={REQUEST:/\/req(\?|$)/,IMPRESSION:/\/imp(\?|$)/,CLICK:/\/click(\?|$)/};function ss(t){return t.type!=="http"?!1:t.request.pretty_host===rf}function vl(t){if(!ss(t))return!1;const e=t.request.path;return Xs.REQUEST.test(e)}function Zs(t){if(!ss(t))return!1;const e=t.request.path;return Xs.IMPRESSION.test(e)}function en(t){if(!ss(t))return!1;const e=t.request.path;return Xs.CLICK.test(e)}function _l(t){const e=new Map;try{new URL(t,"http://dummy.com").searchParams.forEach((i,l)=>{e.set(l,i)})}catch{}return e}function $s(t){if(!Zs(t)&&!en(t))return null;try{const e=`${t.request.scheme}://${t.request.pretty_host}${t.request.path}`;return _l(e).get("adsid")||null}catch(e){return console.error("Failed to extract adsid:",e),null}}function yi(t,e){return{type:e,timestamp:t.request.timestamp_start*1e3,flowId:t.id}}function Yt(t){return t?new Date(t).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3}):"-"}function lf(t){switch(t){case je.REQUESTED:return"요청됨";case je.IMPRESSED:return"노출됨";case je.CLICKED:return"클릭됨";default:return t}}function of(t){switch(t){case je.REQUESTED:return"#6b7280";case je.IMPRESSED:return"#3b82f6";case je.CLICKED:return"#10b981";default:return"#6b7280"}}function cf(t){return vl(t)?Pe.REQUEST:Zs(t)?Pe.IMPRESSION:en(t)?Pe.CLICK:null}function af(t){const e=cf(t);if(!e)return null;const s=`${t.request.scheme}://${t.request.pretty_host}${t.request.path}`,i=_l(s),l=$s(t);return{id:t.id,timestamp:t.request.timestamp_start*1e3,type:e,adsid:l||void 0,method:t.request.method,url:s,path:t.request.path,queryParams:i,statusCode:t.response?.status_code,responseSize:t.response?.content?.length}}function bi(t){switch(t){case Pe.REQUEST:return"광고 요청";case Pe.IMPRESSION:return"노출";case Pe.CLICK:return"클릭";default:return t}}function Si(t){switch(t){case Pe.REQUEST:return"#8b5cf6";case Pe.IMPRESSION:return"#3b82f6";case Pe.CLICK:return"#10b981";default:return"#6b7280"}}function df(t){const e=new Map;return t.forEach(s=>{if(s.type!=="http")return;const i=s;if(vl(i)&&i.response,Zs(i)){const l=$s(i);if(l){const n=e.get(l)||{adsid:l,title:`Ad ${l.substring(0,8)}...`,status:je.REQUESTED},o=yi(i,Pe.IMPRESSION);e.set(l,{...n,impressionEvent:o,impressionTime:o.timestamp,status:je.IMPRESSED})}}if(en(i)){const l=$s(i);if(l){const n=e.get(l)||{adsid:l,title:`Ad ${l.substring(0,8)}...`,status:je.REQUESTED},o=yi(i,Pe.CLICK);e.set(l,{...n,clickEvent:o,clickTime:o.timestamp,status:je.CLICKED})}}}),e}function uf(t){const e=E.c(67),{flows:s}=t,[i,l]=ke.useState(""),[n,o]=ke.useState("all"),[a,d]=ke.useState("ads"),[u,h]=ke.useState(null);let p;e[0]!==s?(p=df(s),e[0]=s,e[1]=p):p=e[1];const g=p;let x;if(e[2]!==g||e[3]!==i||e[4]!==n){let X=Array.from(g.values());if(i){const ge=i.toLowerCase();X=X.filter(ne=>ne.adsid.toLowerCase().includes(ge)||ne.title.toLowerCase().includes(ge))}n!=="all"&&(X=X.filter(ge=>ge.status===n)),x=X.sort(jf),e[2]=g,e[3]=i,e[4]=n,e[5]=x}else x=e[5];const j=x;let y;if(e[6]!==s){const X=[];s.forEach(ge=>{if(ge.type!=="http")return;const ne=ge;if(ss(ne)){const de=af(ne);de&&X.push(de)}}),y=X.sort(_f),e[6]=s,e[7]=y}else y=e[7];const b=y,w=vf;let C;e[8]===Symbol.for("react.memo_cache_sentinel")?(C=r.jsxs("div",{className:"ad-tracking-header",children:[r.jsx("h2",{children:"📱 Kidsnote Ad Tracking Analysis"}),r.jsx("p",{className:"description",children:"키즈노트 광고 트래킹 분석 대시보드 - 광고 요청(req), 노출(imp), 클릭(click)을 자동으로 추적합니다"})]}),e[8]=C):C=e[8];let k;e[9]===Symbol.for("react.memo_cache_sentinel")?(k=X=>l(X.target.value),e[9]=k):k=e[9];let T;e[10]!==i?(T=r.jsx("div",{className:"search-box",children:r.jsx("input",{type:"text",placeholder:"🔍 Ad ID 또는 제목 검색...",value:i,onChange:k,className:"search-input"})}),e[10]=i,e[11]=T):T=e[11];let D;e[12]===Symbol.for("react.memo_cache_sentinel")?(D=X=>o(X.target.value),e[12]=D):D=e[12];let I,M,O,V;e[13]===Symbol.for("react.memo_cache_sentinel")?(O=r.jsx("option",{value:"all",children:"모든 상태"}),V=r.jsx("option",{value:je.REQUESTED,children:"요청됨"}),I=r.jsx("option",{value:je.IMPRESSED,children:"노출됨"}),M=r.jsx("option",{value:je.CLICKED,children:"클릭됨"}),e[13]=I,e[14]=M,e[15]=O,e[16]=V):(I=e[13],M=e[14],O=e[15],V=e[16]);let q;e[17]!==n?(q=r.jsx("div",{className:"filter-box",children:r.jsxs("select",{value:n,onChange:D,className:"status-filter",children:[O,V,I,M]})}),e[17]=n,e[18]=q):q=e[18];let U;e[19]===Symbol.for("react.memo_cache_sentinel")?(U=r.jsx("button",{onClick:w,className:"clear-button",children:"🗑️ 초기화"}),e[19]=U):U=e[19];let W;e[20]!==q||e[21]!==T?(W=r.jsxs("div",{className:"ad-tracking-controls",children:[T,q,U]}),e[20]=q,e[21]=T,e[22]=W):W=e[22];let B;e[23]===Symbol.for("react.memo_cache_sentinel")?(B=r.jsx("div",{className:"stat-label",children:"총 광고"}),e[23]=B):B=e[23];let Q;e[24]!==g.size?(Q=r.jsxs("div",{className:"stat-card",children:[B,r.jsx("div",{className:"stat-value",children:g.size})]}),e[24]=g.size,e[25]=Q):Q=e[25];let G;e[26]===Symbol.for("react.memo_cache_sentinel")?(G=r.jsx("div",{className:"stat-label",children:"노출됨"}),e[26]=G):G=e[26];let J;e[27]!==g?(J=Array.from(g.values()).filter(xf),e[27]=g,e[28]=J):J=e[28];let Z;e[29]!==J.length?(Z=r.jsxs("div",{className:"stat-card",children:[G,r.jsx("div",{className:"stat-value",children:J.length})]}),e[29]=J.length,e[30]=Z):Z=e[30];let te;e[31]===Symbol.for("react.memo_cache_sentinel")?(te=r.jsx("div",{className:"stat-label",children:"클릭됨"}),e[31]=te):te=e[31];let ce;e[32]!==g?(ce=Array.from(g.values()).filter(gf),e[32]=g,e[33]=ce):ce=e[33];let ue;e[34]!==ce.length?(ue=r.jsxs("div",{className:"stat-card",children:[te,r.jsx("div",{className:"stat-value",children:ce.length})]}),e[34]=ce.length,e[35]=ue):ue=e[35];let ve;e[36]===Symbol.for("react.memo_cache_sentinel")?(ve=r.jsx("div",{className:"stat-label",children:"CTR"}),e[36]=ve):ve=e[36];let we;e[37]!==g?(we=g.size>0?(Array.from(g.values()).filter(mf).length/g.size*100).toFixed(1)+"%":"-",e[37]=g,e[38]=we):we=e[38];let ye;e[39]!==we?(ye=r.jsxs("div",{className:"stat-card",children:[ve,r.jsx("div",{className:"stat-value",children:we})]}),e[39]=we,e[40]=ye):ye=e[40];let he;e[41]!==Q||e[42]!==Z||e[43]!==ue||e[44]!==ye?(he=r.jsxs("div",{className:"ad-tracking-stats",children:[Q,Z,ue,ye]}),e[41]=Q,e[42]=Z,e[43]=ue,e[44]=ye,e[45]=he):he=e[45];const $e=`view-tab ${a==="ads"?"active":""}`;let N;e[46]===Symbol.for("react.memo_cache_sentinel")?(N=()=>d("ads"),e[46]=N):N=e[46];let ae;e[47]!==$e?(ae=r.jsx("button",{className:$e,onClick:N,children:"📊 광고 요약"}),e[47]=$e,e[48]=ae):ae=e[48];const z=`view-tab ${a==="packets"?"active":""}`;let ie;e[49]===Symbol.for("react.memo_cache_sentinel")?(ie=()=>d("packets"),e[49]=ie):ie=e[49];let H;e[50]!==z?(H=r.jsx("button",{className:z,onClick:ie,children:"📦 패킷 상세"}),e[50]=z,e[51]=H):H=e[51];let me;e[52]!==ae||e[53]!==H?(me=r.jsxs("div",{className:"view-tabs",children:[ae,H]}),e[52]=ae,e[53]=H,e[54]=me):me=e[54];let Ce;e[55]!==j||e[56]!==a||e[57]!==b?(Ce=r.jsx("div",{className:"ad-tracking-table-container",children:a==="ads"?j.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("p",{children:"📭 광고 트래킹 데이터가 없습니다"}),r.jsx("p",{className:"hint",children:"키즈노트 앱에서 광고를 요청하면 자동으로 추적됩니다"})]}):r.jsxs("table",{className:"ad-tracking-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Ad ID"}),r.jsx("th",{children:"광고 제목"}),r.jsx("th",{children:"상태"}),r.jsx("th",{children:"노출 시간"}),r.jsx("th",{children:"클릭 시간"})]})}),r.jsx("tbody",{children:j.map(hf)})]}):b.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("p",{children:"📭 패킷 데이터가 없습니다"}),r.jsx("p",{className:"hint",children:"키즈노트 앱에서 광고 API를 호출하면 자동으로 추적됩니다"})]}):r.jsxs("table",{className:"ad-tracking-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"시간"}),r.jsx("th",{children:"타입"}),r.jsx("th",{children:"Method"}),r.jsx("th",{children:"URL"}),r.jsx("th",{children:"Ad ID"}),r.jsx("th",{children:"Status"})]})}),r.jsx("tbody",{children:b.map(X=>r.jsxs("tr",{onClick:()=>h(X),children:[r.jsx("td",{className:"ad-time",children:Yt(X.timestamp)}),r.jsx("td",{children:r.jsx("span",{className:"packet-type-badge",style:{backgroundColor:Si(X.type)},children:bi(X.type)})}),r.jsx("td",{children:r.jsx("span",{className:"packet-method",children:X.method})}),r.jsx("td",{className:"packet-url",children:X.path}),r.jsx("td",{className:"ad-id",children:X.adsid?r.jsx("code",{children:X.adsid}):"-"}),r.jsx("td",{children:X.statusCode?r.jsx("span",{className:`packet-status-code ${X.statusCode>=200&&X.statusCode<300?"success":"error"}`,children:X.statusCode}):"-"})]},X.id))})]})}),e[55]=j,e[56]=a,e[57]=b,e[58]=Ce):Ce=e[58];let be;e[59]!==u?(be=u&&r.jsx("div",{className:"packet-detail-modal",onClick:()=>h(null),children:r.jsxs("div",{className:"packet-detail-content",onClick:pf,children:[r.jsxs("div",{className:"packet-detail-header",children:[r.jsx("h3",{children:"📦 패킷 상세 정보"}),r.jsx("button",{className:"close-button",onClick:()=>h(null),children:"✕"})]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("strong",{children:"타입:"})," ",r.jsx("span",{className:"packet-type-badge",style:{backgroundColor:Si(u.type),marginLeft:"8px"},children:bi(u.type)})]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("strong",{children:"시간:"})," ",Yt(u.timestamp)]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("strong",{children:"Method:"})," ",r.jsx("span",{className:"packet-method",children:u.method})]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("strong",{children:"Full URL:"}),r.jsx("div",{className:"packet-url",style:{marginTop:"8px",padding:"8px",background:"#f3f4f6",borderRadius:"4px"},children:u.url})]}),u.adsid&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("strong",{children:"Ad ID:"})," ",r.jsx("code",{style:{background:"#f3f4f6",padding:"4px 8px",borderRadius:"4px"},children:u.adsid})]}),u.statusCode&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("strong",{children:"Status Code:"})," ",r.jsx("span",{className:`packet-status-code ${u.statusCode>=200&&u.statusCode<300?"success":"error"}`,children:u.statusCode})]}),u.queryParams.size>0&&r.jsxs("div",{children:[r.jsx("strong",{children:"Query Parameters:"}),r.jsx("ul",{className:"query-params-list",children:Array.from(u.queryParams.entries()).map(ff)})]})]})}),e[59]=u,e[60]=be):be=e[60];let se;return e[61]!==W||e[62]!==he||e[63]!==me||e[64]!==Ce||e[65]!==be?(se=r.jsxs("div",{className:"kidsnote-ad-tracking-panel",children:[C,W,he,me,Ce,be]}),e[61]=W,e[62]=he,e[63]=me,e[64]=Ce,e[65]=be,e[66]=se):se=e[66],se}function ff(t){const[e,s]=t;return r.jsxs("li",{children:[r.jsxs("span",{className:"query-param-key",children:[e,":"]}),r.jsx("span",{className:"query-param-value",children:s})]},e)}function pf(t){return t.stopPropagation()}function hf(t){return r.jsxs("tr",{children:[r.jsx("td",{className:"ad-id",children:r.jsx("code",{children:t.adsid})}),r.jsx("td",{className:"ad-title",children:t.title}),r.jsx("td",{className:"ad-status",children:r.jsx("span",{className:"status-badge",style:{backgroundColor:of(t.status)},children:lf(t.status)})}),r.jsx("td",{className:"ad-time",children:Yt(t.impressionTime)}),r.jsx("td",{className:"ad-time",children:Yt(t.clickTime)})]},t.adsid)}function mf(t){return t.status===je.CLICKED}function gf(t){return t.status===je.CLICKED}function xf(t){return t.status===je.IMPRESSED||t.status===je.CLICKED}function vf(){confirm("모든 광고 트래킹 데이터를 삭제하시겠습니까?")&&window.location.reload()}function _f(t,e){return e.timestamp-t.timestamp}function jf(t,e){const s=t.requestTime||t.impressionTime||t.clickTime||0;return(e.requestTime||e.impressionTime||e.clickTime||0)-s}const yf=_t(t=>({flows:t.flows.list}))(uf);function bf(){const t=E.c(4),e=F($f),s=F(wf),i=F(Sf);let l;return t[0]!==i||t[1]!==s||t[2]!==e?(l=r.jsx("div",{className:"main-view",children:i===pe.Capture?r.jsx(Fu,{}):i===pe.Metrics?r.jsx(nf,{}):i===pe.AdTracking?r.jsx(yf,{}):r.jsxs(r.Fragment,{children:[s?r.jsx(Kd,{}):r.jsx(Wd,{}),e&&r.jsxs(r.Fragment,{children:[r.jsx(Pd,{},"splitter"),r.jsx(Id,{},"flowDetails")]})]})}),t[0]=i,t[1]=s,t[2]=e,t[3]=l):l=t[3],l}function Sf(t){return t.ui.tabs.current}function wf(t){return t.flows.list.length>0}function $f(t){return t.flows.selected.length===1}function vt(t){const e=E.c(2),{children:s}=t;let i;return e[0]!==s?(i=window.MITMWEB_STATIC?null:r.jsx(r.Fragment,{children:s}),e[0]=s,e[1]=i):i=e[1],i}const Cf=P.memo(function(){const e=E.c(20),s=ee(),i=F(Nf);let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l={placement:"bottom-start"},e[0]=l):l=e[0];let n;e[1]!==s?(n=r.jsx("li",{children:r.jsx(el,{icon:"fa-folder-open",text:" Open...",onClick:kf,onOpenFile:b=>{s(Rc(b)),document.body.click()}})}),e[1]=s,e[2]=n):n=e[2];let o;e[3]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsxs(Le,{onClick:Ef,children:[r.jsx("i",{className:"fa fa-fw fa-floppy-o"})," Save"]}),e[3]=o):o=e[3];let a;e[4]!==i?(a=()=>location.replace("/flows/dump?filter="+i),e[4]=i,e[5]=a):a=e[5];let d;e[6]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx("i",{className:"fa fa-fw fa-floppy-o"}),e[6]=d):d=e[6];let u;e[7]!==a?(u=r.jsxs(Le,{onClick:a,children:[d," Save filtered"]}),e[7]=a,e[8]=u):u=e[8];let h;e[9]!==s?(h=()=>confirm("Delete all flows?")&&s(ir()),e[9]=s,e[10]=h):h=e[10];let p;e[11]===Symbol.for("react.memo_cache_sentinel")?(p=r.jsx("i",{className:"fa fa-fw fa-trash"}),e[11]=p):p=e[11];let g;e[12]!==h?(g=r.jsxs(Le,{onClick:h,children:[p," Clear All"]}),e[12]=h,e[13]=g):g=e[13];let x;e[14]===Symbol.for("react.memo_cache_sentinel")?(x=r.jsx(id,{}),e[14]=x):x=e[14];let j;e[15]===Symbol.for("react.memo_cache_sentinel")?(j=r.jsxs(vt,{children:[x,r.jsx("li",{children:r.jsxs("a",{href:"http://mitm.it/",target:"_blank",rel:"noreferrer",children:[r.jsx("i",{className:"fa fa-fw fa-external-link"})," Install Certificates..."]})})]}),e[15]=j):j=e[15];let y;return e[16]!==n||e[17]!==u||e[18]!==g?(y=r.jsxs(It,{className:"pull-left special",text:"File",options:l,children:[n,o,u,g,j]}),e[16]=n,e[17]=u,e[18]=g,e[19]=y):y=e[19],y});function Nf(t){return t.ui.filter[Ee.Search]}function kf(t){return t.stopPropagation()}function Ef(){return location.replace("/flows/dump")}const Tf=P.memo(function(){const e=E.c(5),s=F(Rf),i=F(Af);switch(s){case Ct.INIT:{let l;return e[0]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("span",{className:"connection-indicator init",children:"connecting…"}),e[0]=l):l=e[0],l}case Ct.FETCHING:{let l;return e[1]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("span",{className:"connection-indicator fetching",children:"fetching data…"}),e[1]=l):l=e[1],l}case Ct.ESTABLISHED:{let l;return e[2]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("span",{className:"connection-indicator established",children:"connected"}),e[2]=l):l=e[2],l}case Ct.ERROR:{let l;return e[3]!==i?(l=r.jsx("span",{className:"connection-indicator error",title:i,children:"connection lost"}),e[3]=i,e[4]=l):l=e[4],l}default:Tt(s)}});function Rf(t){return t.connection.state}function Af(t){return t.connection.message}jl.title="Capture";function jl(){const t=E.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=r.jsx(r.Fragment,{}),t[0]=e):e=t[0],e}const wi=function(){function t(i,l){function n(){this.constructor=i}n.prototype=l.prototype,i.prototype=new n}function e(i,l,n,o){this.message=i,this.expected=l,this.found=n,this.location=o,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,e)}t(e,Error);function s(i){var l=arguments.length>1?arguments[1]:{},n={},o={start:In},a=In,d={type:"other",description:"filter expression"},u=function(c){return c},h={type:"other",description:"whitespace"},p=/^[ \t\n\r]/,g={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},x={type:"other",description:"control character"},j=/^[|&!()~"]/,y={type:"class",value:'[|&!()~"]',description:'[|&!()~"]'},b={type:"other",description:"optional whitespace"},w="|",C={type:"literal",value:"|",description:'"|"'},k=function(c,f){return ko(c,f)},T="&",D={type:"literal",value:"&",description:'"&"'},I=function(c,f){return Eo(c,f)},M="!",O={type:"literal",value:"!",description:'"!"'},V=function(c){return To(c)},q="(",U={type:"literal",value:"(",description:'"("'},W=")",B={type:"literal",value:")",description:'")"'},Q=function(c){return Ro(c)},G="~all",J={type:"literal",value:"~all",description:'"~all"'},Z=function(){return Mn},te="~a",ce={type:"literal",value:"~a",description:'"~a"'},ue=function(){return qn},ve="~b",we={type:"literal",value:"~b",description:'"~b"'},ye=function(c){return Ao(c)},he="~bq",$e={type:"literal",value:"~bq",description:'"~bq"'},N=function(c){return Io(c)},ae="~bs",z={type:"literal",value:"~bs",description:'"~bs"'},ie=function(c){return Do(c)},H="~c",me={type:"literal",value:"~c",description:'"~c"'},Ce=function(c){return Fo(c)},be="~comment",se={type:"literal",value:"~comment",description:'"~comment"'},X=function(c){return Lo(c)},ge="~d",ne={type:"literal",value:"~d",description:'"~d"'},de=function(c){return Po(c)},Ne="~dns",Me={type:"literal",value:"~dns",description:'"~dns"'},rt=function(){return Hn},Xe="~dst",is={type:"literal",value:"~dst",description:'"~dst"'},S=function(c){return Mo(c)},$="~e",A={type:"literal",value:"~e",description:'"~e"'},K=function(){return Vn},Dt="~h",rs={type:"literal",value:"~h",description:'"~h"'},De=function(c){return Oo(c)},Oe="~hq",pt={type:"literal",value:"~hq",description:'"~hq"'},Qe=function(c){return qo(c)},jt="~hs",Ft={type:"literal",value:"~hs",description:'"~hs"'},lt=function(c){return Ho(c)},Lt="~http",ht={type:"literal",value:"~http",description:'"~http"'},qe=function(){return Un},nn="~marked",Nl={type:"literal",value:"~marked",description:'"~marked"'},kl=function(){return Bn},rn="~marker",El={type:"literal",value:"~marker",description:'"~marker"'},Tl=function(c){return Vo(c)},ln="~m",Rl={type:"literal",value:"~m",description:'"~m"'},Al=function(c){return Uo(c)},on="~q",Il={type:"literal",value:"~q",description:'"~q"'},Dl=function(){return Kn},cn="~replayq",Fl={type:"literal",value:"~replayq",description:'"~replayq"'},Ll=function(){return Wn},an="~replays",Pl={type:"literal",value:"~replays",description:'"~replays"'},Ml=function(){return zn},dn="~replay",Ol={type:"literal",value:"~replay",description:'"~replay"'},ql=function(){return Qn},un="~src",Hl={type:"literal",value:"~src",description:'"~src"'},Vl=function(c){return Bo(c)},fn="~s",Ul={type:"literal",value:"~s",description:'"~s"'},Bl=function(){return Gn},pn="~tcp",Kl={type:"literal",value:"~tcp",description:'"~tcp"'},Wl=function(){return Yn},hn="~udp",zl={type:"literal",value:"~udp",description:'"~udp"'},Ql=function(){return Jn},mn="~tq",Gl={type:"literal",value:"~tq",description:'"~tq"'},Yl=function(c){return Ko(c)},gn="~ts",Jl={type:"literal",value:"~ts",description:'"~ts"'},Xl=function(c){return Wo(c)},xn="~t",Zl={type:"literal",value:"~t",description:'"~t"'},eo=function(c){return zo(c)},vn="~u",to={type:"literal",value:"~u",description:'"~u"'},_n=function(c){return Qo(c)},jn="~websocket",so={type:"literal",value:"~websocket",description:'"~websocket"'},no=function(){return Xn},io={type:"other",description:"integer"},yn=/^['"]/,bn={type:"class",value:`['"]`,description:`['"]`},Sn=/^[0-9]/,wn={type:"class",value:"[0-9]",description:"[0-9]"},ro=function(c){return parseInt(c.join(""),10)},lo={type:"other",description:"string"},$n='"',Cn={type:"literal",value:'"',description:'"\\""'},ls=function(c){return c.join("")},Nn="'",kn={type:"literal",value:"'",description:`"'"`},oo=/^["\\]/,co={type:"class",value:'["\\\\]',description:'["\\\\]'},os={type:"any",description:"any character"},yt=function(c){return c},En="\\",Tn={type:"literal",value:"\\",description:'"\\\\"'},ao=/^['\\]/,uo={type:"class",value:"['\\\\]",description:"['\\\\]"},fo=/^['"\\]/,po={type:"class",value:`['"\\\\]`,description:`['"\\\\]`},ho="n",mo={type:"literal",value:"n",description:'"n"'},go=function(){return`
`},xo="r",vo={type:"literal",value:"r",description:'"r"'},_o=function(){return"\r"},jo="t",yo={type:"literal",value:"t",description:'"t"'},bo=function(){return"	"},m=0,Pt=[{line:1,column:1,seenCR:!1}],Ue=0,cs=[],R=0,Mt;if("startRule"in l){if(!(l.startRule in o))throw new Error(`Can't start parsing from rule "`+l.startRule+'".');a=o[l.startRule]}function Rn(c){var f=Pt[c],v,_;if(f)return f;for(v=c-1;!Pt[v];)v--;for(f=Pt[v],f={line:f.line,column:f.column,seenCR:f.seenCR};v<c;)_=i.charAt(v),_===`
`?(f.seenCR||f.line++,f.column=1,f.seenCR=!1):_==="\r"||_==="\u2028"||_==="\u2029"?(f.line++,f.column=1,f.seenCR=!0):(f.column++,f.seenCR=!1),v++;return Pt[c]=f,f}function An(c,f){var v=Rn(c),_=Rn(f);return{start:{offset:c,line:v.line,column:v.column},end:{offset:f,line:_.line,column:_.column}}}function L(c){m<Ue||(m>Ue&&(Ue=m,cs=[]),cs.push(c))}function So(c,f,v,_){function Be(He){var Ze=1;for(He.sort(function(Ht,ot){return Ht.description<ot.description?-1:Ht.description>ot.description?1:0});Ze<He.length;)He[Ze-1]===He[Ze]?He.splice(Ze,1):Ze++}function Fe(He,Ze){function Ht(Go){function Vt(Ye){return Ye.charCodeAt(0).toString(16).toUpperCase()}return Go.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(Ye){return"\\x0"+Vt(Ye)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(Ye){return"\\x"+Vt(Ye)}).replace(/[\u0100-\u0FFF]/g,function(Ye){return"\\u0"+Vt(Ye)}).replace(/[\u1000-\uFFFF]/g,function(Ye){return"\\u"+Vt(Ye)})}var ot=new Array(He.length),Zn,ei,bt;for(bt=0;bt<He.length;bt++)ot[bt]=He[bt].description;return Zn=He.length>1?ot.slice(0,-1).join(", ")+" or "+ot[He.length-1]:ot[0],ei=Ze?'"'+Ht(Ze)+'"':"end of input","Expected "+Zn+" but "+ei+" found."}return f!==null&&Be(f),new e(Fe(f,v),f,v,_)}function In(){var c,f,v,_;return R++,c=m,f=Ge(),f!==n?(v=as(),v!==n?(_=Ge(),_!==n?(f=u(v),c=f):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),R--,c===n&&(f=n,R===0&&L(d)),c}function Y(){var c;return R++,p.test(i.charAt(m))?(c=i.charAt(m),m++):(c=n,R===0&&L(g)),R--,c===n&&R===0&&L(h),c}function wo(){var c;return R++,j.test(i.charAt(m))?(c=i.charAt(m),m++):(c=n,R===0&&L(y)),R--,c===n&&R===0&&L(x),c}function Ge(){var c,f;for(R++,c=[],f=Y();f!==n;)c.push(f),f=Y();return R--,c===n&&(f=n,R===0&&L(b)),c}function as(){var c,f,v,_,Be,Fe;return c=m,f=Ot(),f!==n?(v=Ge(),v!==n?(i.charCodeAt(m)===124?(_=w,m++):(_=n,R===0&&L(C)),_!==n?(Be=Ge(),Be!==n?(Fe=as(),Fe!==n?(f=k(f,Fe),c=f):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),c===n&&(c=Ot()),c}function Ot(){var c,f,v,_,Be,Fe;if(c=m,f=qt(),f!==n?(v=Ge(),v!==n?(i.charCodeAt(m)===38?(_=T,m++):(_=n,R===0&&L(D)),_!==n?(Be=Ge(),Be!==n?(Fe=Ot(),Fe!==n?(f=I(f,Fe),c=f):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),c===n){if(c=m,f=qt(),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=Ot(),_!==n?(f=I(f,_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;c===n&&(c=qt())}return c}function qt(){var c,f,v,_;return c=m,i.charCodeAt(m)===33?(f=M,m++):(f=n,R===0&&L(O)),f!==n?(v=Ge(),v!==n?(_=qt(),_!==n?(f=V(_),c=f):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),c===n&&(c=$o()),c}function $o(){var c,f,v,_,Be,Fe;return c=m,i.charCodeAt(m)===40?(f=q,m++):(f=n,R===0&&L(U)),f!==n?(v=Ge(),v!==n?(_=as(),_!==n?(Be=Ge(),Be!==n?(i.charCodeAt(m)===41?(Fe=W,m++):(Fe=n,R===0&&L(B)),Fe!==n?(f=Q(_),c=f):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),c===n&&(c=Co()),c}function Co(){var c,f,v,_;if(c=m,i.substr(m,4)===G?(f=G,m+=4):(f=n,R===0&&L(J)),f!==n&&(f=Z()),c=f,c===n&&(c=m,i.substr(m,2)===te?(f=te,m+=2):(f=n,R===0&&L(ce)),f!==n&&(f=ue()),c=f,c===n)){if(c=m,i.substr(m,2)===ve?(f=ve,m+=2):(f=n,R===0&&L(we)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=Se(),_!==n?(f=ye(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===he?(f=he,m+=3):(f=n,R===0&&L($e)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=Se(),_!==n?(f=N(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===ae?(f=ae,m+=3):(f=n,R===0&&L(z)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=Se(),_!==n?(f=ie(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===H?(f=H,m+=2):(f=n,R===0&&L(me)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=No(),_!==n?(f=Ce(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,8)===be?(f=be,m+=8):(f=n,R===0&&L(se)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=Se(),_!==n?(f=X(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===ge?(f=ge,m+=2):(f=n,R===0&&L(ne)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=Se(),_!==n?(f=de(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,4)===Ne?(f=Ne,m+=4):(f=n,R===0&&L(Me)),f!==n&&(f=rt()),c=f,c===n)){if(c=m,i.substr(m,4)===Xe?(f=Xe,m+=4):(f=n,R===0&&L(is)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=Se(),_!==n?(f=S(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,2)===$?(f=$,m+=2):(f=n,R===0&&L(A)),f!==n&&(f=K()),c=f,c===n)){if(c=m,i.substr(m,2)===Dt?(f=Dt,m+=2):(f=n,R===0&&L(rs)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=Se(),_!==n?(f=De(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===Oe?(f=Oe,m+=3):(f=n,R===0&&L(pt)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=Se(),_!==n?(f=Qe(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===jt?(f=jt,m+=3):(f=n,R===0&&L(Ft)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=Se(),_!==n?(f=lt(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,5)===Lt?(f=Lt,m+=5):(f=n,R===0&&L(ht)),f!==n&&(f=qe()),c=f,c===n&&(c=m,i.substr(m,7)===nn?(f=nn,m+=7):(f=n,R===0&&L(Nl)),f!==n&&(f=kl()),c=f,c===n))){if(c=m,i.substr(m,7)===rn?(f=rn,m+=7):(f=n,R===0&&L(El)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=Se(),_!==n?(f=Tl(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===ln?(f=ln,m+=2):(f=n,R===0&&L(Rl)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=Se(),_!==n?(f=Al(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,2)===on?(f=on,m+=2):(f=n,R===0&&L(Il)),f!==n&&(f=Dl()),c=f,c===n&&(c=m,i.substr(m,8)===cn?(f=cn,m+=8):(f=n,R===0&&L(Fl)),f!==n&&(f=Ll()),c=f,c===n&&(c=m,i.substr(m,8)===an?(f=an,m+=8):(f=n,R===0&&L(Pl)),f!==n&&(f=Ml()),c=f,c===n&&(c=m,i.substr(m,7)===dn?(f=dn,m+=7):(f=n,R===0&&L(Ol)),f!==n&&(f=ql()),c=f,c===n))))){if(c=m,i.substr(m,4)===un?(f=un,m+=4):(f=n,R===0&&L(Hl)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=Se(),_!==n?(f=Vl(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,2)===fn?(f=fn,m+=2):(f=n,R===0&&L(Ul)),f!==n&&(f=Bl()),c=f,c===n&&(c=m,i.substr(m,4)===pn?(f=pn,m+=4):(f=n,R===0&&L(Kl)),f!==n&&(f=Wl()),c=f,c===n&&(c=m,i.substr(m,4)===hn?(f=hn,m+=4):(f=n,R===0&&L(zl)),f!==n&&(f=Ql()),c=f,c===n)))){if(c=m,i.substr(m,3)===mn?(f=mn,m+=3):(f=n,R===0&&L(Gl)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=Se(),_!==n?(f=Yl(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===gn?(f=gn,m+=3):(f=n,R===0&&L(Jl)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=Se(),_!==n?(f=Xl(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===xn?(f=xn,m+=2):(f=n,R===0&&L(Zl)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=Se(),_!==n?(f=eo(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===vn?(f=vn,m+=2):(f=n,R===0&&L(to)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=Se(),_!==n?(f=_n(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;c===n&&(c=m,i.substr(m,10)===jn?(f=jn,m+=10):(f=n,R===0&&L(so)),f!==n&&(f=no()),c=f,c===n&&(c=m,f=Se(),f!==n&&(f=_n(f)),c=f))}}}}}}}}}}}}}}}}}return c}function No(){var c,f,v,_;if(R++,c=m,yn.test(i.charAt(m))?(f=i.charAt(m),m++):(f=n,R===0&&L(bn)),f===n&&(f=null),f!==n){if(v=[],Sn.test(i.charAt(m))?(_=i.charAt(m),m++):(_=n,R===0&&L(wn)),_!==n)for(;_!==n;)v.push(_),Sn.test(i.charAt(m))?(_=i.charAt(m),m++):(_=n,R===0&&L(wn));else v=n;v!==n?(yn.test(i.charAt(m))?(_=i.charAt(m),m++):(_=n,R===0&&L(bn)),_===n&&(_=null),_!==n?(f=ro(v),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;return R--,c===n&&(f=n,R===0&&L(io)),c}function Se(){var c,f,v,_;if(R++,c=m,i.charCodeAt(m)===34?(f=$n,m++):(f=n,R===0&&L(Cn)),f!==n){for(v=[],_=Dn();_!==n;)v.push(_),_=Dn();v!==n?(i.charCodeAt(m)===34?(_=$n,m++):(_=n,R===0&&L(Cn)),_!==n?(f=ls(v),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.charCodeAt(m)===39?(f=Nn,m++):(f=n,R===0&&L(kn)),f!==n){for(v=[],_=Fn();_!==n;)v.push(_),_=Fn();v!==n?(i.charCodeAt(m)===39?(_=Nn,m++):(_=n,R===0&&L(kn)),_!==n?(f=ls(v),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n)if(c=m,f=m,R++,v=wo(),R--,v===n?f=void 0:(m=f,f=n),f!==n){if(v=[],_=Ln(),_!==n)for(;_!==n;)v.push(_),_=Ln();else v=n;v!==n?(f=ls(v),c=f):(m=c,c=n)}else m=c,c=n}return R--,c===n&&(f=n,R===0&&L(lo)),c}function Dn(){var c,f,v;return c=m,f=m,R++,oo.test(i.charAt(m))?(v=i.charAt(m),m++):(v=n,R===0&&L(co)),R--,v===n?f=void 0:(m=f,f=n),f!==n?(i.length>m?(v=i.charAt(m),m++):(v=n,R===0&&L(os)),v!==n?(f=yt(v),c=f):(m=c,c=n)):(m=c,c=n),c===n&&(c=m,i.charCodeAt(m)===92?(f=En,m++):(f=n,R===0&&L(Tn)),f!==n?(v=Pn(),v!==n?(f=yt(v),c=f):(m=c,c=n)):(m=c,c=n)),c}function Fn(){var c,f,v;return c=m,f=m,R++,ao.test(i.charAt(m))?(v=i.charAt(m),m++):(v=n,R===0&&L(uo)),R--,v===n?f=void 0:(m=f,f=n),f!==n?(i.length>m?(v=i.charAt(m),m++):(v=n,R===0&&L(os)),v!==n?(f=yt(v),c=f):(m=c,c=n)):(m=c,c=n),c===n&&(c=m,i.charCodeAt(m)===92?(f=En,m++):(f=n,R===0&&L(Tn)),f!==n?(v=Pn(),v!==n?(f=yt(v),c=f):(m=c,c=n)):(m=c,c=n)),c}function Ln(){var c,f,v;return c=m,f=m,R++,v=Y(),R--,v===n?f=void 0:(m=f,f=n),f!==n?(i.length>m?(v=i.charAt(m),m++):(v=n,R===0&&L(os)),v!==n?(f=yt(v),c=f):(m=c,c=n)):(m=c,c=n),c}function Pn(){var c,f;return fo.test(i.charAt(m))?(c=i.charAt(m),m++):(c=n,R===0&&L(po)),c===n&&(c=m,i.charCodeAt(m)===110?(f=ho,m++):(f=n,R===0&&L(mo)),f!==n&&(f=go()),c=f,c===n&&(c=m,i.charCodeAt(m)===114?(f=xo,m++):(f=n,R===0&&L(vo)),f!==n&&(f=_o()),c=f,c===n&&(c=m,i.charCodeAt(m)===116?(f=jo,m++):(f=n,R===0&&L(yo)),f!==n&&(f=bo()),c=f))),c}function ko(c,f){function v(){return c.apply(this,arguments)||f.apply(this,arguments)}return v.desc=c.desc+" or "+f.desc,v}function Eo(c,f){function v(){return c.apply(this,arguments)&&f.apply(this,arguments)}return v.desc=c.desc+" and "+f.desc,v}function To(c){function f(){return!c.apply(this,arguments)}return f.desc="not "+c.desc,f}function Ro(c){function f(){return c.apply(this,arguments)}return f.desc="("+c.desc+")",f}function Mn(c){return!0}Mn.desc="all flows";var On=[new RegExp("text/javascript"),new RegExp("application/x-javascript"),new RegExp("application/javascript"),new RegExp("text/css"),new RegExp("image/.*"),new RegExp("font/.*"),new RegExp("application/font.*")];function qn(c){if(c.response){for(var f=xt.getContentType(c.response),v=On.length;v--;)if(On[v].test(f))return!0}return!1}qn.desc="is asset";function Ao(c){c=new RegExp(c,"i");function f(v){return!0}return f.desc="body matches "+c,f}function Io(c){c=new RegExp(c,"i");function f(v){return!0}return f.desc="body request matches "+c,f}function Do(c){c=new RegExp(c,"i");function f(v){return!0}return f.desc="body response matches "+c,f}function Fo(c){function f(v){return v.response&&v.response.status_code===c}return f.desc="resp. code is "+c,f}function Lo(c){c=new RegExp(c,"i");function f(v){return c.test(v.comment)}return f.desc="comment matches "+c,f}function Po(c){c=new RegExp(c,"i");function f(v){return v.request&&(c.test(v.request.host)||c.test(v.request.pretty_host))}return f.desc="domain matches "+c,f}function Hn(c){return c.type==="dns"}Hn.desc="is a DNS Flow";function Mo(c){c=new RegExp(c,"i");function f(v){return!!v.server_conn.address&&c.test(v.server_conn.address[0]+":"+v.server_conn.address[1])}return f.desc="destination address matches "+c,f}function Vn(c){return!!c.error}Vn.desc="has error";function Oo(c){c=new RegExp(c,"i");function f(v){return v.request&&dt.match_header(v.request,c)||v.response&&xt.match_header(v.response,c)}return f.desc="header matches "+c,f}function qo(c){c=new RegExp(c,"i");function f(v){return v.request&&dt.match_header(v.request,c)}return f.desc="req. header matches "+c,f}function Ho(c){c=new RegExp(c,"i");function f(v){return v.response&&xt.match_header(v.response,c)}return f.desc="resp. header matches "+c,f}function Un(c){return c.type==="http"}Un.desc="is an HTTP Flow";function Bn(c){return c.marked}Bn.desc="is marked";function Vo(c){c=new RegExp(c,"i");function f(v){return c.test(v.marked)}return f.desc="marker matches "+c,f}function Uo(c){c=new RegExp(c,"i");function f(v){return v.request&&c.test(v.request.method)}return f.desc="method matches "+c,f}function Kn(c){return c.request&&!c.response}Kn.desc="has no response";function Wn(c){return c.is_replay==="request"}Wn.desc="request has been replayed";function zn(c){return c.is_replay==="response"}zn.desc="response has been replayed";function Qn(c){return!!c.is_replay}Qn.desc="flow has been replayed";function Bo(c){c=new RegExp(c,"i");function f(v){return!!v.client_conn.peername&&c.test(v.client_conn.peername[0]+":"+v.client_conn.peername[1])}return f.desc="source address matches "+c,f}function Gn(c){return!!c.response}Gn.desc="has response";function Yn(c){return c.type==="tcp"}Yn.desc="is a TCP Flow";function Jn(c){return c.type==="udp"}Jn.desc="is a UDP Flow";function Ko(c){c=new RegExp(c,"i");function f(v){return v.request&&c.test(dt.getContentType(v.request))}return f.desc="req. content type matches "+c,f}function Wo(c){c=new RegExp(c,"i");function f(v){return v.response&&c.test(xt.getContentType(v.response))}return f.desc="resp. content type matches "+c,f}function zo(c){c=new RegExp(c,"i");function f(v){return v.request&&c.test(dt.getContentType(v.request))||v.response&&c.test(xt.getContentType(v.response))}return f.desc="content type matches "+c,f}function Qo(c){c=new RegExp(c,"i");function f(v){if(v.type==="dns"){const _=v.request?.questions[0];return _&&c.test(_.name)}return v.request&&c.test(dt.pretty_url(v.request))}return f.desc="url matches "+c,f}function Xn(c){return!!c.websocket}if(Xn.desc="is a Websocket Flow",Mt=a(),Mt!==n&&m===i.length)return Mt;throw Mt!==n&&m<i.length&&L({type:"end",description:"end of input"}),So(null,cs,Ue<i.length?i.charAt(Ue):null,Ue<i.length?An(Ue,Ue+1):An(Ue,Ue))}return{SyntaxError:e,parse:s}}();class Je extends P.Component{static xhr;static doc;constructor(e,s){super(e,s),this.state={doc:Je.doc}}componentDidMount(){Je.xhr||(Je.xhr=le("/filter-help").then(e=>e.json()),Je.xhr.catch(()=>{Je.xhr=null})),this.state.doc||Je.xhr.then(e=>{Je.doc=e,this.setState({doc:e})})}render(){const{doc:e}=this.state;return e?r.jsx("table",{className:"table table-condensed",children:r.jsxs("tbody",{children:[e.commands.map(s=>r.jsxs("tr",{onClick:()=>this.props.selectHandler(s[0].split(" ")[0]+" "),children:[r.jsx("td",{children:s[0].replace(" "," ")}),r.jsx("td",{children:s[1]})]},s[1])),r.jsx("tr",{children:r.jsx("td",{colSpan:2,children:r.jsxs("a",{href:"https://mitmproxy.org/docs/latest/concepts-filters/",target:"_blank",rel:"noreferrer",children:[r.jsx("i",{className:"fa fa-external-link"}),"  mitmproxy docs"]})})},"docs-link")]})}):r.jsx("i",{className:"fa fa-spinner fa-spin"})}}var ns=(t=>(t.SEARCH="search",t.HIGHLIGHT="tag",t.INTERCEPT="pause",t))(ns||{});class tn extends P.Component{inputRef=ke.createRef();constructor(e,s){super(e,s),this.state={value:this.props.value,focus:!1,mousefocus:!1},this.onChange=this.onChange.bind(this),this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.selectFilter=this.selectFilter.bind(this)}UNSAFE_componentWillReceiveProps(e){this.setState({value:e.value})}isValid(e){try{return e&&wi.parse(e),!0}catch{return!1}}getDesc(){if(!this.state.value)return r.jsx(Je,{selectHandler:this.selectFilter});try{return wi.parse(this.state.value).desc}catch(e){return""+e}}onChange(e){const s=e.target.value;this.setState({value:s}),this.isValid(s)&&this.props.onChange(s)}onFocus(){this.setState({focus:!0})}onBlur(){this.setState({focus:!1})}onMouseEnter(){this.setState({mousefocus:!0})}onMouseLeave(){this.setState({mousefocus:!1})}onKeyDown(e){(e.key==="Escape"||e.key==="Enter")&&(this.blur(),this.setState({mousefocus:!1})),e.stopPropagation()}selectFilter(e){this.setState({value:e}),this.inputRef.current?.focus()}blur(){this.inputRef.current?.blur()}select(){this.inputRef.current?.select()}render(){const{icon:e,color:s,placeholder:i}=this.props,{value:l,focus:n,mousefocus:o}=this.state;return r.jsxs("div",{className:Re("filter-input input-group",{"has-error":!this.isValid(l)}),children:[r.jsx("span",{className:"input-group-addon",children:r.jsx("i",{className:"fa fa-fw fa-"+e,style:{color:s}})}),r.jsx("input",{type:"text",ref:this.inputRef,placeholder:i,className:"form-control",value:l,onChange:this.onChange,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown}),(n||o)&&r.jsxs("div",{className:"popover bottom",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[r.jsx("div",{className:"arrow"}),r.jsx("div",{className:"popover-content",children:this.getDesc()})]})]})}}yl.title="Flow List";function yl(){const t=E.c(2);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=r.jsxs("div",{className:"menu-group",children:[r.jsxs("div",{className:"menu-content",children:[r.jsx(Ff,{}),r.jsx(Pf,{})]}),r.jsx("div",{className:"menu-legend",children:"Find"})]}),t[0]=e):e=t[0];let s;return t[1]===Symbol.for("react.memo_cache_sentinel")?(s=r.jsxs("div",{className:"main-menu",children:[e,r.jsxs("div",{className:"menu-group",children:[r.jsxs("div",{className:"menu-content",children:[r.jsx(If,{}),r.jsx(Of,{})]}),r.jsx("div",{className:"menu-legend",children:"Intercept"})]})]}),t[1]=s):s=t[1],s}function If(){const t=E.c(5),e=ee(),i=F(Df)||"";let l;t[0]!==e?(l=o=>e(Ps("intercept",o)),t[0]=e,t[1]=l):l=t[1];let n;return t[2]!==i||t[3]!==l?(n=r.jsx(tn,{value:i,placeholder:"Intercept",icon:ns.INTERCEPT,color:"hsl(208, 56%, 53%)",onChange:l}),t[2]=i,t[3]=l,t[4]=n):n=t[4],n}function Df(t){return t.options.intercept}function Ff(){const t=E.c(5),e=ee(),s=F(Lf);let i;t[0]!==e?(i=n=>e(Ji(n)),t[0]=e,t[1]=i):i=t[1];let l;return t[2]!==i||t[3]!==s?(l=r.jsx(tn,{value:s,placeholder:"Search",icon:ns.SEARCH,color:"black",onChange:i}),t[2]=i,t[3]=s,t[4]=l):l=t[4],l}function Lf(t){return t.ui.filter[Ee.Search]}function Pf(){const t=E.c(5),e=ee(),s=F(Mf);let i;t[0]!==e?(i=n=>e(Xi(n)),t[0]=e,t[1]=i):i=t[1];let l;return t[2]!==i||t[3]!==s?(l=r.jsx(tn,{value:s,placeholder:"Highlight",icon:ns.HIGHLIGHT,color:"hsl(48, 100%, 50%)",onChange:i}),t[2]=i,t[3]=s,t[4]=l):l=t[4],l}function Mf(t){return t.ui.filter[Ee.Highlight]}function Of(){const t=E.c(2),e=ee();let s;return t[0]!==e?(s=r.jsx(_e,{className:"btn-sm",title:"[a]ccept all",icon:"fa-forward text-success",onClick:()=>e(Zi()),children:"Resume All"}),t[0]=e,t[1]=s):s=t[1],s}function sn(t){const e=E.c(6),{value:s,onChange:i,children:l}=t;let n;e[0]!==i||e[1]!==s?(n=r.jsx("input",{type:"checkbox",checked:s,onChange:i}),e[0]=i,e[1]=s,e[2]=n):n=e[2];let o;return e[3]!==l||e[4]!==n?(o=r.jsx("div",{className:"menu-entry",children:r.jsxs("label",{children:[n,l]})}),e[3]=l,e[4]=n,e[5]=o):o=e[5],o}function hs(t){const e=E.c(10),{name:s,children:i}=t,l=ee();let n;e[0]!==s?(n=h=>h.options[s],e[0]=s,e[1]=n):n=e[1];const o=F(n),a=!!o;let d;e[2]!==l||e[3]!==s||e[4]!==o?(d=()=>l(Ps(s,!o)),e[2]=l,e[3]=s,e[4]=o,e[5]=d):d=e[5];let u;return e[6]!==i||e[7]!==a||e[8]!==d?(u=r.jsx(sn,{value:a,onChange:d,children:i}),e[6]=i,e[7]=a,e[8]=d,e[9]=u):u=e[9],u}function qf(){const t=E.c(5),e=ee(),s=F(Hf);let i;t[0]!==e?(i=()=>e(Xt()),t[0]=e,t[1]=i):i=t[1];let l;return t[2]!==i||t[3]!==s?(l=r.jsx(sn,{value:s,onChange:i,children:"Display Event Log"}),t[2]=i,t[3]=s,t[4]=l):l=t[4],l}function Hf(t){return t.eventLog.visible}function Vf(){const t=E.c(5),e=ee(),s=F(Uf);let i;t[0]!==e?(i=()=>e(gr()),t[0]=e,t[1]=i):i=t[1];let l;return t[2]!==i||t[3]!==s?(l=r.jsx(sn,{value:s,onChange:i,children:"Display Command Bar"}),t[2]=i,t[3]=s,t[4]=l):l=t[4],l}function Uf(t){return t.commandBar.visible}function ms(t){const e=E.c(5),{children:s,resource:i}=t,l=`https://docs.mitmproxy.org/stable/${i}`;let n;e[0]!==s?(n=s||r.jsx("i",{className:"fa fa-question-circle"}),e[0]=s,e[1]=n):n=e[1];let o;return e[2]!==n||e[3]!==l?(o=r.jsx("a",{target:"_blank",href:l,rel:"noreferrer",children:n}),e[2]=n,e[3]=l,e[4]=o):o=e[4],o}bl.title="Options";function bl(){const t=E.c(16),e=ee(),s=Bf;let i;t[0]!==e?(i=()=>e(s()),t[0]=e,t[1]=i):i=t[1];let l;t[2]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("sup",{children:"alpha"}),t[2]=l):l=t[2];let n;t[3]!==i?(n=r.jsx("div",{className:"menu-content",children:r.jsxs(_e,{title:"Open Options",icon:"fa-cogs text-primary",onClick:i,children:["Edit Options ",l]})}),t[3]=i,t[4]=n):n=t[4];let o;t[5]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsx("div",{className:"menu-legend",children:"Options Editor"}),t[5]=o):o=t[5];let a;t[6]!==n?(a=r.jsxs("div",{className:"menu-group",children:[n,o]}),t[6]=n,t[7]=a):a=t[7];let d;t[8]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsxs(hs,{name:"anticache",children:["Strip cache headers"," ",r.jsx(ms,{resource:"overview/features/#anticache"})]}),t[8]=d):d=t[8];let u;t[9]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsxs(hs,{name:"showhost",children:["Use host header for display"," ",r.jsx(ms,{resource:"concepts/options/#showhost"})]}),t[9]=u):u=t[9];let h;t[10]===Symbol.for("react.memo_cache_sentinel")?(h=r.jsxs("div",{className:"menu-group",children:[r.jsxs("div",{className:"menu-content",children:[d,u,r.jsxs(hs,{name:"ssl_insecure",children:["Don't verify server certificates"," ",r.jsx(ms,{resource:"concepts/options/#ssl_insecure"})]})]}),r.jsx("div",{className:"menu-legend",children:"Quick Options"})]}),t[10]=h):h=t[10];let p;t[11]!==a?(p=r.jsxs(vt,{children:[a,h]}),t[11]=a,t[12]=p):p=t[12];let g;t[13]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsxs("div",{className:"menu-group",children:[r.jsxs("div",{className:"menu-content",children:[r.jsx(qf,{}),r.jsx(Vf,{})]}),r.jsx("div",{className:"menu-legend",children:"View Options"})]}),t[13]=g):g=t[13];let x;return t[14]!==p?(x=r.jsxs("div",{children:[p,g]}),t[14]=p,t[15]=x):x=t[15],x}function Bf(){return qc("OptionModal")}const $t=async(t,e)=>{const s=(async()=>{const i=await Qt("export",e,`@${t.id}`);if(i.value)return i.value;throw i.error?i.error:i})();try{await Li(s)}catch(i){alert(i)}};Sl.title="Flow";function Sl(){const t=E.c(63),e=ee(),s=F(Kf),i=s[0];let l;t[0]!==s?(l=s.some(Ts),t[0]=s,t[1]=l):l=t[1];const n=l;if(s.length===0){let Z;return t[2]===Symbol.for("react.memo_cache_sentinel")?(Z=r.jsx("div",{}),t[2]=Z):Z=t[2],Z}let o;t[3]!==e||t[4]!==s?(o=()=>e(Is(s)),t[3]=e,t[4]=s,t[5]=o):o=t[5];let a;t[6]!==s?(a=s.some(Es),t[6]=s,t[7]=a):a=t[7];const d=!a;let u;t[8]!==o||t[9]!==d?(u=r.jsx(_e,{title:"[r]eplay flow",icon:"fa-repeat text-primary",onClick:o,disabled:d,children:"Replay"}),t[8]=o,t[9]=d,t[10]=u):u=t[10];let h;t[11]!==e||t[12]!==s?(h=r.jsx(_e,{title:"[D]uplicate flow",icon:"fa-copy text-info",onClick:()=>e(sr(s)),children:"Duplicate"}),t[11]=e,t[12]=s,t[13]=h):h=t[13];let p;t[14]!==s?(p=s.some(Ui),t[14]=s,t[15]=p):p=t[15];const g=!p;let x;t[16]!==e||t[17]!==s?(x=()=>e(nr(s)),t[16]=e,t[17]=s,t[18]=x):x=t[18];let j;t[19]!==g||t[20]!==x?(j=r.jsx(_e,{disabled:g,title:"revert changes to flow [V]",icon:"fa-history text-warning",onClick:x,children:"Revert"}),t[19]=g,t[20]=x,t[21]=j):j=t[21];let y;t[22]!==e||t[23]!==s?(y=r.jsx(_e,{title:"[d]elete flow",icon:"fa-trash text-danger",onClick:()=>{e(tr(s))},children:"Delete"}),t[22]=e,t[23]=s,t[24]=y):y=t[24];let b;t[25]!==s?(b=r.jsx(ep,{flows:s}),t[25]=s,t[26]=b):b=t[26];let w;t[27]!==y||t[28]!==b||t[29]!==u||t[30]!==h||t[31]!==j?(w=r.jsxs("div",{className:"menu-content",children:[u,h,j,y,b]}),t[27]=y,t[28]=b,t[29]=u,t[30]=h,t[31]=j,t[32]=w):w=t[32];let C;t[33]===Symbol.for("react.memo_cache_sentinel")?(C=r.jsx("div",{className:"menu-legend",children:"Flow Modification"}),t[33]=C):C=t[33];let k;t[34]!==w?(k=r.jsx(vt,{children:r.jsxs("div",{className:"menu-group",children:[w,C]})}),t[34]=w,t[35]=k):k=t[35];let T;t[36]!==i?(T=r.jsxs("div",{className:"menu-content",children:[r.jsx(Wf,{flow:i}),r.jsx(Yf,{flow:i})]}),t[36]=i,t[37]=T):T=t[37];let D;t[38]===Symbol.for("react.memo_cache_sentinel")?(D=r.jsx("div",{className:"menu-legend",children:"Export"}),t[38]=D):D=t[38];let I;t[39]!==T?(I=r.jsxs("div",{className:"menu-group",children:[T,D]}),t[39]=T,t[40]=I):I=t[40];const M=!n;let O;t[41]!==e||t[42]!==s?(O=()=>e(As(s)),t[41]=e,t[42]=s,t[43]=O):O=t[43];let V;t[44]!==M||t[45]!==O?(V=r.jsx(_e,{disabled:M,title:"[a]ccept intercepted flow",icon:"fa-play text-success",onClick:O,children:"Resume"}),t[44]=M,t[45]=O,t[46]=V):V=t[46];const q=!n;let U;t[47]!==e||t[48]!==s?(U=()=>e(er(s)),t[47]=e,t[48]=s,t[49]=U):U=t[49];let W;t[50]!==q||t[51]!==U?(W=r.jsx(_e,{disabled:q,title:"kill intercepted flow [x]",icon:"fa-times text-danger",onClick:U,children:"Abort"}),t[50]=q,t[51]=U,t[52]=W):W=t[52];let B;t[53]!==V||t[54]!==W?(B=r.jsxs("div",{className:"menu-content",children:[V,W]}),t[53]=V,t[54]=W,t[55]=B):B=t[55];let Q;t[56]===Symbol.for("react.memo_cache_sentinel")?(Q=r.jsx("div",{className:"menu-legend",children:"Interception"}),t[56]=Q):Q=t[56];let G;t[57]!==B?(G=r.jsx(vt,{children:r.jsxs("div",{className:"menu-group",children:[B,Q]})}),t[57]=B,t[58]=G):G=t[58];let J;return t[59]!==k||t[60]!==I||t[61]!==G?(J=r.jsxs("div",{className:"flow-menu",children:[k,I,G]}),t[59]=k,t[60]=I,t[61]=G,t[62]=J):J=t[62],J}function Kf(t){return t.flows.selected}const Bt=t=>{const e=window.open(t,"_blank","noopener,noreferrer");e&&(e.opener=null)};function Wf(t){const e=E.c(24),{flow:s}=t,i=F(Gf);if(s.type!=="http"){let l;return e[0]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx(_e,{icon:"fa-download",onClick:Qf,disabled:!0,children:"Download"}),e[0]=l):l=e[0],l}if(s.request.contentLength&&!s.response?.contentLength){let l;e[1]!==s?(l=()=>Bt(Ae.getContentURL(s,s.request)),e[1]=s,e[2]=l):l=e[2];const n=!i;let o;return e[3]!==l||e[4]!==n?(o=r.jsx(_e,{icon:"fa-download",onClick:l,disabled:n,children:"Download"}),e[3]=l,e[4]=n,e[5]=o):o=e[5],o}if(s.response){const l=s.response;if(!s.request.contentLength&&s.response.contentLength){let n;e[6]!==s||e[7]!==l?(n=()=>Bt(Ae.getContentURL(s,l)),e[6]=s,e[7]=l,e[8]=n):n=e[8];const o=!i;let a;return e[9]!==n||e[10]!==o?(a=r.jsx(_e,{icon:"fa-download",onClick:n,disabled:o,children:"Download"}),e[9]=n,e[10]=o,e[11]=a):a=e[11],a}if(s.request.contentLength&&s.response.contentLength){const n=!i;let o;e[12]!==n?(o=r.jsx(_e,{icon:"fa-download",onClick:zf,disabled:n,children:"Download▾"}),e[12]=n,e[13]=o):o=e[13];let a;e[14]===Symbol.for("react.memo_cache_sentinel")?(a={placement:"bottom-start"},e[14]=a):a=e[14];let d;e[15]!==s?(d=r.jsx(Le,{onClick:()=>Bt(Ae.getContentURL(s,s.request)),children:"Download request"}),e[15]=s,e[16]=d):d=e[16];let u;e[17]!==s||e[18]!==l?(u=r.jsx(Le,{onClick:()=>Bt(Ae.getContentURL(s,l)),children:"Download response"}),e[17]=s,e[18]=l,e[19]=u):u=e[19];let h;return e[20]!==o||e[21]!==d||e[22]!==u?(h=r.jsxs(It,{text:o,options:a,children:[d,u]}),e[20]=o,e[21]=d,e[22]=u,e[23]=h):h=e[23],h}}return null}function zf(){return 1}function Qf(){return 0}function Gf(t){return t.flows.selected.length===1}function Yf(t){const e=E.c(20),{flow:s}=t,i=F(Xf),l=s.type!=="http"||!i;let n;e[0]!==l?(n=r.jsx(_e,{title:"Export flow.",icon:"fa-clone",onClick:Jf,disabled:l,children:"Export▾"}),e[0]=l,e[1]=n):n=e[1];let o;e[2]===Symbol.for("react.memo_cache_sentinel")?(o={placement:"bottom-start"},e[2]=o):o=e[2];let a;e[3]!==s?(a=r.jsx(Le,{onClick:()=>$t(s,"raw_request"),children:"Copy raw request"}),e[3]=s,e[4]=a):a=e[4];let d;e[5]!==s?(d=r.jsx(Le,{onClick:()=>$t(s,"raw_response"),children:"Copy raw response"}),e[5]=s,e[6]=d):d=e[6];let u;e[7]!==s?(u=r.jsx(Le,{onClick:()=>$t(s,"raw"),children:"Copy raw request and response"}),e[7]=s,e[8]=u):u=e[8];let h;e[9]!==s?(h=r.jsx(Le,{onClick:()=>$t(s,"curl"),children:"Copy as cURL"}),e[9]=s,e[10]=h):h=e[10];let p;e[11]!==s?(p=r.jsx(Le,{onClick:()=>$t(s,"httpie"),children:"Copy as HTTPie"}),e[11]=s,e[12]=p):p=e[12];let g;return e[13]!==n||e[14]!==a||e[15]!==d||e[16]!==u||e[17]!==h||e[18]!==p?(g=r.jsxs(It,{className:"",text:n,options:o,children:[a,d,u,h,p]}),e[13]=n,e[14]=a,e[15]=d,e[16]=u,e[17]=h,e[18]=p,e[19]=g):g=e[19],g}function Jf(){return 1}function Xf(t){return t.flows.selected.length===1}const Zf={":red_circle:":"🔴",":orange_circle:":"🟠",":yellow_circle:":"🟡",":green_circle:":"🟢",":large_blue_circle:":"🔵",":purple_circle:":"🟣",":brown_circle:":"🟤"};function ep(t){const e=E.c(5),{flows:s}=t,i=ee();let l,n;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx(_e,{title:"mark flow",icon:"fa-paint-brush text-success",onClick:tp,children:"Mark▾"}),n={placement:"bottom-start"},e[0]=l,e[1]=n):(l=e[0],n=e[1]);let o;return e[2]!==i||e[3]!==s?(o=r.jsxs(It,{className:"",text:l,options:n,children:[r.jsx(Le,{onClick:()=>i(oi(s,"")),children:"⚪ (no marker)"}),Object.entries(Zf).map(a=>{const[d,u]=a;return r.jsxs(Le,{onClick:()=>i(oi(s,d)),children:[u," ",d.replace(/[:_]/g," ")]},d)})]}),e[2]=i,e[3]=s,e[4]=o):o=e[4],o}function tp(){return 1}function wl(){const t=E.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=r.jsx("div",{className:"menu-row",children:r.jsx("div",{className:"menu-group",children:r.jsx("div",{className:"menu-content",children:r.jsx("span",{className:"menu-legend",children:"📊 Network Metrics Dashboard"})})})}),t[0]=e):e=t[0],e}wl.title="Metrics";function $l(){const t=E.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=r.jsx("div",{className:"menu-row",children:r.jsx("div",{className:"menu-group",children:r.jsx("div",{className:"menu-content",children:r.jsx("span",{className:"menu-legend",children:"📱 Kidsnote Ad Tracking Analysis"})})})}),t[0]=e):e=t[0],e}$l.title="Ad Tracking";const $i={[pe.Capture]:jl,[pe.FlowList]:yl,[pe.Options]:bl,[pe.Flow]:Sl,[pe.Metrics]:wl,[pe.AdTracking]:$l};function sp(){const t=E.c(26),e=ee(),s=F(ip),i=F(np),[l,n]=P.useState(!1);let o;t[0]!==i.length?(o=[pe.Capture,pe.FlowList,pe.Options,pe.Metrics,pe.AdTracking],i.length>0&&o.push(pe.Flow),t[0]=i.length,t[1]=o):o=t[1];let a;t[2]!==s||t[3]!==e||t[4]!==i.length||t[5]!==l?(a=()=>{i.length>0&&!l?(e(Wt(pe.Flow)),n(!0)):i.length===0&&(l&&n(!1),s===pe.Flow&&e(Wt(pe.FlowList)))},t[2]=s,t[3]=e,t[4]=i.length,t[5]=l,t[6]=a):a=t[6];let d;t[7]!==s||t[8]!==i||t[9]!==l?(d=[i,l,s],t[7]=s,t[8]=i,t[9]=l,t[10]=d):d=t[10],P.useEffect(a,d);let u;t[11]!==e?(u=function(k,T){T.preventDefault(),e(Wt(k))},t[11]=e,t[12]=u):u=t[12];const h=u,p=$i[s];let g;t[13]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx(Cf,{}),t[13]=g):g=t[13];let x;t[14]!==s||t[15]!==o||t[16]!==h?(x=o.map(C=>r.jsx("a",{href:"#",className:Re({active:C===s}),onClick:k=>h(C,k),children:$i[C].title},C)),t[14]=s,t[15]=o,t[16]=h,t[17]=x):x=t[17];let j;t[18]===Symbol.for("react.memo_cache_sentinel")?(j=r.jsx(vt,{children:r.jsx(Tf,{})}),t[18]=j):j=t[18];let y;t[19]!==x?(y=r.jsxs("nav",{className:"nav-tabs nav-tabs-lg",children:[g,x,j]}),t[19]=x,t[20]=y):y=t[20];let b;t[21]!==p?(b=r.jsx("div",{children:r.jsx(p,{})}),t[21]=p,t[22]=b):b=t[22];let w;return t[23]!==y||t[24]!==b?(w=r.jsxs("header",{children:[y,b]}),t[23]=y,t[24]=b,t[25]=w):w=t[25],w}function np(t){return t.flows.selected}function ip(t){return t.ui.tabs.current}const gs=function(){function t(i,l){function n(){this.constructor=i}n.prototype=l.prototype,i.prototype=new n}function e(i,l,n,o){this.message=i,this.expected=l,this.found=n,this.location=o,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,e)}t(e,Error);function s(i){var l=arguments.length>1?arguments[1]:{},n={},o={Expr:ge},a=ge,d=function(S,$){return[S,...$]},u=function(S){return[S]},h=function(){return""},p={type:"other",description:"string"},g='"',x={type:"literal",value:'"',description:'"\\""'},j=function(S){return S.join("")},y="'",b={type:"literal",value:"'",description:`"'"`},w=/^["\\]/,C={type:"class",value:'["\\\\]',description:'["\\\\]'},k={type:"any",description:"any character"},T=function(S){return S},D="\\",I={type:"literal",value:"\\",description:'"\\\\"'},M=/^['\\]/,O={type:"class",value:"['\\\\]",description:"['\\\\]"},V=/^['"\\]/,q={type:"class",value:`['"\\\\]`,description:`['"\\\\]`},U="n",W={type:"literal",value:"n",description:'"n"'},B=function(){return`
`},Q="r",G={type:"literal",value:"r",description:'"r"'},J=function(){return"\r"},Z="t",te={type:"literal",value:"t",description:'"t"'},ce=function(){return"	"},ue={type:"other",description:"whitespace"},ve=/^[ \t\n\r]/,we={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},ye={type:"other",description:"control character"},he=/^[|&!()~"]/,$e={type:"class",value:'[|&!()~"]',description:'[|&!()~"]'},N=0,ae=[{line:1,column:1,seenCR:!1}],z=0,ie=[],H=0,me;if("startRule"in l){if(!(l.startRule in o))throw new Error(`Can't start parsing from rule "`+l.startRule+'".');a=o[l.startRule]}function Ce(S){var $=ae[S],A,K;if($)return $;for(A=S-1;!ae[A];)A--;for($=ae[A],$={line:$.line,column:$.column,seenCR:$.seenCR};A<S;)K=i.charAt(A),K===`
`?($.seenCR||$.line++,$.column=1,$.seenCR=!1):K==="\r"||K==="\u2028"||K==="\u2029"?($.line++,$.column=1,$.seenCR=!0):($.column++,$.seenCR=!1),A++;return ae[S]=$,$}function be(S,$){var A=Ce(S),K=Ce($);return{start:{offset:S,line:A.line,column:A.column},end:{offset:$,line:K.line,column:K.column}}}function se(S){N<z||(N>z&&(z=N,ie=[]),ie.push(S))}function X(S,$,A,K){function Dt(De){var Oe=1;for(De.sort(function(pt,Qe){return pt.description<Qe.description?-1:pt.description>Qe.description?1:0});Oe<De.length;)De[Oe-1]===De[Oe]?De.splice(Oe,1):Oe++}function rs(De,Oe){function pt(Lt){function ht(qe){return qe.charCodeAt(0).toString(16).toUpperCase()}return Lt.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(qe){return"\\x0"+ht(qe)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(qe){return"\\x"+ht(qe)}).replace(/[\u0100-\u0FFF]/g,function(qe){return"\\u0"+ht(qe)}).replace(/[\u1000-\uFFFF]/g,function(qe){return"\\u"+ht(qe)})}var Qe=new Array(De.length),jt,Ft,lt;for(lt=0;lt<De.length;lt++)Qe[lt]=De[lt].description;return jt=De.length>1?Qe.slice(0,-1).join(", ")+" or "+Qe[De.length-1]:Qe[0],Ft=Oe?'"'+pt(Oe)+'"':"end of input","Expected "+jt+" but "+Ft+" found."}return $!==null&&Dt($),new e(rs($,A),$,A,K)}function ge(){var S,$,A,K;if(S=N,$=ne(),$!==n){if(A=[],K=Xe(),K!==n)for(;K!==n;)A.push(K),K=Xe();else A=n;A!==n?(K=ge(),K!==n?($=d($,K),S=$):(N=S,S=n)):(N=S,S=n)}else N=S,S=n;if(S===n&&(S=N,$=ne(),$!==n&&($=u($)),S=$,S===n)){for(S=N,$=[],A=Xe();A!==n;)$.push(A),A=Xe();$!==n&&($=h()),S=$}return S}function ne(){var S,$,A,K;if(H++,S=N,i.charCodeAt(N)===34?($=g,N++):($=n,H===0&&se(x)),$!==n){for(A=[],K=de();K!==n;)A.push(K),K=de();A!==n?(i.charCodeAt(N)===34?(K=g,N++):(K=n,H===0&&se(x)),K!==n?($=j(A),S=$):(N=S,S=n)):(N=S,S=n)}else N=S,S=n;if(S===n){if(S=N,i.charCodeAt(N)===39?($=y,N++):($=n,H===0&&se(b)),$!==n){for(A=[],K=Ne();K!==n;)A.push(K),K=Ne();A!==n?(i.charCodeAt(N)===39?(K=y,N++):(K=n,H===0&&se(b)),K!==n?($=j(A),S=$):(N=S,S=n)):(N=S,S=n)}else N=S,S=n;if(S===n){if(S=N,$=N,H++,A=is(),H--,A===n?$=void 0:(N=$,$=n),$!==n){if(A=[],K=Me(),K!==n)for(;K!==n;)A.push(K),K=Me();else A=n;A!==n?($=j(A),S=$):(N=S,S=n)}else N=S,S=n;if(S===n){if(S=N,i.charCodeAt(N)===34?($=g,N++):($=n,H===0&&se(x)),$!==n){for(A=[],K=de();K!==n;)A.push(K),K=de();A!==n?($=j(A),S=$):(N=S,S=n)}else N=S,S=n;if(S===n)if(S=N,i.charCodeAt(N)===39?($=y,N++):($=n,H===0&&se(b)),$!==n){for(A=[],K=Ne();K!==n;)A.push(K),K=Ne();A!==n?($=j(A),S=$):(N=S,S=n)}else N=S,S=n}}}return H--,S===n&&($=n,H===0&&se(p)),S}function de(){var S,$,A;return S=N,$=N,H++,w.test(i.charAt(N))?(A=i.charAt(N),N++):(A=n,H===0&&se(C)),H--,A===n?$=void 0:(N=$,$=n),$!==n?(i.length>N?(A=i.charAt(N),N++):(A=n,H===0&&se(k)),A!==n?($=T(A),S=$):(N=S,S=n)):(N=S,S=n),S===n&&(S=N,i.charCodeAt(N)===92?($=D,N++):($=n,H===0&&se(I)),$!==n?(A=rt(),A!==n?($=T(A),S=$):(N=S,S=n)):(N=S,S=n)),S}function Ne(){var S,$,A;return S=N,$=N,H++,M.test(i.charAt(N))?(A=i.charAt(N),N++):(A=n,H===0&&se(O)),H--,A===n?$=void 0:(N=$,$=n),$!==n?(i.length>N?(A=i.charAt(N),N++):(A=n,H===0&&se(k)),A!==n?($=T(A),S=$):(N=S,S=n)):(N=S,S=n),S===n&&(S=N,i.charCodeAt(N)===92?($=D,N++):($=n,H===0&&se(I)),$!==n?(A=rt(),A!==n?($=T(A),S=$):(N=S,S=n)):(N=S,S=n)),S}function Me(){var S,$,A;return S=N,$=N,H++,A=Xe(),H--,A===n?$=void 0:(N=$,$=n),$!==n?(i.length>N?(A=i.charAt(N),N++):(A=n,H===0&&se(k)),A!==n?($=T(A),S=$):(N=S,S=n)):(N=S,S=n),S}function rt(){var S,$;return V.test(i.charAt(N))?(S=i.charAt(N),N++):(S=n,H===0&&se(q)),S===n&&(S=N,i.charCodeAt(N)===110?($=U,N++):($=n,H===0&&se(W)),$!==n&&($=B()),S=$,S===n&&(S=N,i.charCodeAt(N)===114?($=Q,N++):($=n,H===0&&se(G)),$!==n&&($=J()),S=$,S===n&&(S=N,i.charCodeAt(N)===116?($=Z,N++):($=n,H===0&&se(te)),$!==n&&($=ce()),S=$))),S}function Xe(){var S;return H++,ve.test(i.charAt(N))?(S=i.charAt(N),N++):(S=n,H===0&&se(we)),H--,S===n&&H===0&&se(ue),S}function is(){var S;return H++,he.test(i.charAt(N))?(S=i.charAt(N),N++):(S=n,H===0&&se($e)),H--,S===n&&H===0&&se(ye),S}if(me=a(),me!==n&&N===i.length)return me;throw me!==n&&N<i.length&&se({type:"end",description:"end of input"}),X(null,ie,z<i.length?i.charAt(z):null,z<i.length?be(z,z+1):be(z,z))}return{SyntaxError:e,parse:s}}();function xs(t,e=""){if(!t)return[];const s=[];for(const i of Object.keys(t))i.startsWith(e)&&s.push(i);return s}function rp(t){const e=E.c(6),{results:s}=t,i=P.useRef(null);let l,n;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=()=>{i&&i.current.addEventListener("DOMNodeInserted",op)},n=[],e[0]=l,e[1]=n):(l=e[0],n=e[1]),P.useEffect(l,n);let o;e[2]!==s?(o=s.map(lp),e[2]=s,e[3]=o):o=e[3];let a;return e[4]!==o?(a=r.jsx("div",{className:"command-result",ref:i,children:o}),e[4]=o,e[5]=a):a=e[5],a}function lp(t,e){return r.jsxs("div",{children:[r.jsx("div",{children:r.jsxs("strong",{children:["$ ",t.command]})}),t.result]},e)}function op(t){const e=t.currentTarget;e.scroll({top:e.scrollHeight,behavior:"auto"})}function cp(t){const e=E.c(20),{nextArgs:s,currentArg:i,help:l,description:n,availableCommands:o}=t;let a;if(e[0]!==i||e[1]!==s){a=[];for(let b=0;b<s.length;b++){if(b==i){a.push(r.jsx("mark",{children:s[b]},b));continue}a.push(r.jsxs("span",{children:[s[b]," "]},b))}e[0]=i,e[1]=s,e[2]=a}else a=e[2];let d;e[3]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx("div",{className:"arrow"}),e[3]=d):d=e[3];let u;e[4]!==a?(u=a.length>0&&r.jsxs("div",{children:[r.jsx("strong",{children:"Argument suggestion:"})," ",a]}),e[4]=a,e[5]=u):u=e[5];let h;e[6]!==l?(h=l?.includes("->")&&r.jsxs("div",{children:[r.jsx("strong",{children:"Signature help: "}),l]}),e[6]=l,e[7]=h):h=e[7];let p;e[8]!==n?(p=n&&r.jsxs("div",{children:["# ",n]}),e[8]=n,e[9]=p):p=e[9];let g;e[10]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("strong",{children:"Available Commands: "}),e[10]=g):g=e[10];let x;e[11]!==o?(x=JSON.stringify(o),e[11]=o,e[12]=x):x=e[12];let j;e[13]!==x?(j=r.jsxs("div",{children:[g,r.jsx("p",{className:"available-commands",children:x})]}),e[13]=x,e[14]=j):j=e[14];let y;return e[15]!==u||e[16]!==h||e[17]!==p||e[18]!==j?(y=r.jsxs("div",{className:"argument-suggestion popover top",children:[d,r.jsxs("div",{className:"popover-content",children:[u,h,p,j]})]}),e[15]=u,e[16]=h,e[17]=p,e[18]=j,e[19]=y):y=e[19],y}function ap(){const t=E.c(45),[e,s]=P.useState(""),[i,l]=P.useState(""),[n,o]=P.useState(0);let a;t[0]===Symbol.for("react.memo_cache_sentinel")?(a=[],t[0]=a):a=t[0];const[d,u]=P.useState(a);let h;t[1]===Symbol.for("react.memo_cache_sentinel")?(h=[],t[1]=h):h=t[1];const[p,g]=P.useState(h);let x;t[2]===Symbol.for("react.memo_cache_sentinel")?(x={},t[2]=x):x=t[2];const[j,y]=P.useState(x);let b;t[3]===Symbol.for("react.memo_cache_sentinel")?(b=[],t[3]=b):b=t[3];const[w,C]=P.useState(b),[k,T]=P.useState(0),[D,I]=P.useState(""),[M,O]=P.useState("");let V;t[4]===Symbol.for("react.memo_cache_sentinel")?(V=[],t[4]=V):V=t[4];const[q,U]=P.useState(V);let W;t[5]===Symbol.for("react.memo_cache_sentinel")?(W=[],t[5]=W):W=t[5];const[B,Q]=P.useState(W),[G,J]=P.useState(void 0);let Z,te;t[6]===Symbol.for("react.memo_cache_sentinel")?(Z=()=>{le("/commands",{method:"GET"}).then(mp).then(ne=>{y(ne),u(xs(ne)),g(Object.keys(ne))}).catch(hp)},te=[],t[6]=Z,t[7]=te):(Z=t[6],te=t[7]),P.useEffect(Z,te);let ce,ue;t[8]===Symbol.for("react.memo_cache_sentinel")?(ce=()=>{Qt("commands.history.get").then(ne=>{Q(ne.value)}).catch(pp)},ue=[],t[8]=ce,t[9]=ue):(ce=t[8],ue=t[9]),P.useEffect(ce,ue);let ve;t[10]!==j?(ve=(ne,de)=>{const Ne=gs.parse(de),Me=gs.parse(ne);I(j[Ne[0]]?.signature_help),O(j[Ne[0]]?.help||""),u(xs(j,Me[0])),g(xs(j,Ne[0]));const rt=j[Ne[0]]?.parameters.map(fp);rt&&(C([Ne[0],...rt]),T(Ne.length-1))},t[10]=j,t[11]=ve):ve=t[11];const we=ve;let ye;t[12]===Symbol.for("react.memo_cache_sentinel")?(ye=ne=>{s(ne.target.value),l(ne.target.value),o(0)},t[12]=ye):ye=t[12];const he=ye;let $e;t[13]!==p||t[14]!==d||t[15]!==n||t[16]!==G||t[17]!==B||t[18]!==e||t[19]!==q?($e=ne=>{if(ne.key==="Enter"){const[de,...Ne]=gs.parse(e);Q([...B,e]),Qt("commands.history.add",e).catch(up),le.post(`/commands/${de}`,{arguments:Ne}).then(dp).then(Me=>{J(void 0),C([]),U([...q,{command:e,result:JSON.stringify(Me.value||Me.error)}])}).catch(Me=>{J(void 0),C([]),U([...q,{command:e,result:Me.toString()}])}),I(""),O(""),s(""),l(""),o(0),u(p)}if(ne.key==="ArrowUp"){let de;G===void 0?de=B.length-1:de=Math.max(0,G-1),s(B[de]),l(B[de]),J(de)}if(ne.key==="ArrowDown"){if(G===void 0)return;if(G==B.length-1)s(""),l(""),J(void 0);else{const de=G+1;s(B[de]),l(B[de]),J(de)}}ne.key==="Tab"&&(s(d[n]),o((n+1)%d.length),ne.preventDefault()),ne.stopPropagation()},t[13]=p,t[14]=d,t[15]=n,t[16]=G,t[17]=B,t[18]=e,t[19]=q,t[20]=$e):$e=t[20];const N=$e;let ae;t[21]!==j||t[22]!==e||t[23]!==i||t[24]!==we?(ae=ne=>{if(!e){g(Object.keys(j));return}we(i,e),ne.stopPropagation()},t[21]=j,t[22]=e,t[23]=i,t[24]=we,t[25]=ae):ae=t[25];const z=ae;let ie;t[26]===Symbol.for("react.memo_cache_sentinel")?(ie=r.jsx("div",{className:"command-title",children:"Command Result"}),t[26]=ie):ie=t[26];let H;t[27]!==q?(H=r.jsx(rp,{results:q}),t[27]=q,t[28]=H):H=t[28];let me;t[29]!==p||t[30]!==k||t[31]!==M||t[32]!==w||t[33]!==D?(me=r.jsx(cp,{nextArgs:w,currentArg:k,help:D,description:M,availableCommands:p}),t[29]=p,t[30]=k,t[31]=M,t[32]=w,t[33]=D,t[34]=me):me=t[34];let Ce;t[35]===Symbol.for("react.memo_cache_sentinel")?(Ce=Re("command-input input-group"),t[35]=Ce):Ce=t[35];let be;t[36]===Symbol.for("react.memo_cache_sentinel")?(be=r.jsx("span",{className:"input-group-addon",children:r.jsx("i",{className:"fa fa-fw fa-terminal"})}),t[36]=be):be=t[36];const se=e||"";let X;t[37]!==N||t[38]!==z||t[39]!==se?(X=r.jsxs("div",{className:Ce,children:[be,r.jsx("input",{type:"text",placeholder:"Enter command",className:"form-control",value:se,onChange:he,onKeyDown:N,onKeyUp:z})]}),t[37]=N,t[38]=z,t[39]=se,t[40]=X):X=t[40];let ge;return t[41]!==H||t[42]!==me||t[43]!==X?(ge=r.jsxs("div",{className:"command",children:[ie,H,me,X]}),t[41]=H,t[42]=me,t[43]=X,t[44]=ge):ge=t[44],ge}function dp(t){return t.json()}function up(){return 0}function fp(t){return t.name}function pp(t){return console.error(t)}function hp(t){return console.error(t)}function mp(t){return t.json()}function gp(t){const e=E.c(7),{checked:s,onToggle:i,text:l}=t,n="btn btn-toggle "+(s?"btn-primary":"btn-default"),o="fa fa-fw "+(s?"fa-check-square-o":"fa-square-o");let a;e[0]!==o?(a=r.jsx("i",{className:o}),e[0]=o,e[1]=a):a=e[1];let d;return e[2]!==i||e[3]!==n||e[4]!==a||e[5]!==l?(d=r.jsxs("div",{className:n,onClick:i,children:[a," ",l]}),e[2]=i,e[3]=n,e[4]=a,e[5]=l,e[6]=d):d=e[6],d}class xp extends P.Component{static defaultProps={rowHeight:18};heights;viewport=ke.createRef();constructor(e){super(e),this.heights={},this.state={vScroll:At()},this.onViewportUpdate=this.onViewportUpdate.bind(this)}componentDidMount(){window.addEventListener("resize",this.onViewportUpdate),this.onViewportUpdate()}componentWillUnmount(){window.removeEventListener("resize",this.onViewportUpdate)}getSnapshotBeforeUpdate(){return qs(this.viewport)}componentDidUpdate(e,s,i){i&&gl(this.viewport),this.onViewportUpdate()}onViewportUpdate(){const e=this.viewport.current,s=At({itemCount:this.props.events.length,rowHeight:this.props.rowHeight,viewportTop:e.scrollTop,viewportHeight:e.offsetHeight,itemHeights:this.props.events.map(i=>this.heights[i.id])});Jt(this.state.vScroll,s)||this.setState({vScroll:s})}setHeight(e,s){if(s&&!this.heights[e]){const i=s.offsetHeight;this.heights[e]!==i&&(this.heights[e]=i,this.onViewportUpdate())}}render(){const{vScroll:e}=this.state,{events:s}=this.props;return r.jsxs("pre",{ref:this.viewport,onScroll:this.onViewportUpdate,children:[r.jsx("div",{style:{height:e.paddingTop}}),s.slice(e.start,e.end).map(i=>r.jsxs("div",{ref:l=>{this.setHeight(i.id,l)},children:[r.jsx(vp,{event:i}),i.message]},i.id)),r.jsx("div",{style:{height:e.paddingBottom}})]})}}function vp(t){const e=E.c(4),{event:s}=t;let i;e[0]!==s.level?(i={web:"html5",debug:"bug",warn:"exclamation-triangle",error:"ban"}[s.level]||"info",e[0]=s.level,e[1]=i):i=e[1];const n=`fa fa-fw fa-${i}`;let o;return e[2]!==n?(o=r.jsx("i",{className:n}),e[2]=n,e[3]=o):o=e[3],o}class _p extends P.Component{static defaultProps={defaultHeight:200};dragStart;constructor(e,s){super(e,s),this.state={height:this.props.defaultHeight},this.onDragStart=this.onDragStart.bind(this),this.onDragMove=this.onDragMove.bind(this),this.onDragStop=this.onDragStop.bind(this)}onDragStart(e){e.preventDefault(),this.dragStart=this.state.height+e.pageY,window.addEventListener("mousemove",this.onDragMove),window.addEventListener("mouseup",this.onDragStop),window.addEventListener("dragend",this.onDragStop)}onDragMove(e){e.preventDefault(),this.setState({height:this.dragStart-e.pageY})}onDragStop(e){e.preventDefault(),window.removeEventListener("mousemove",this.onDragMove)}render(){const{height:e}=this.state,{filters:s,events:i,toggleFilter:l,close:n}=this.props;return r.jsxs("div",{className:"eventlog",style:{height:e},children:[r.jsxs("div",{onMouseDown:this.onDragStart,children:["Eventlog",r.jsxs("div",{className:"pull-right",children:[Object.values(hr).map(o=>r.jsx(gp,{text:o,checked:s[o],onToggle:()=>l(o)},o)),r.jsx("i",{onClick:n,className:"fa fa-close"})]})]}),r.jsx(xp,{events:i})]})}}const jp=_t(t=>({filters:t.eventLog.filters,events:t.eventLog.view}),{close:Xt,toggleFilter:pr})(_p);function yp(){const t=E.c(52),e=F(Sp),{mode:s,intercept:i,showhost:l,upstream_cert:n,rawtcp:o,http2:a,websocket:d,anticache:u,anticomp:h,stickyauth:p,stickycookie:g,stream_large_bodies:x,listen_host:j,listen_port:y,server:b,ssl_insecure:w}=F(bp);let C;t[0]!==s?(C=s&&(s.length!==1||s[0]!=="regular")&&r.jsx("span",{className:"label label-success",children:s.join(",")}),t[0]=s,t[1]=C):C=t[1];let k;t[2]!==i?(k=i&&r.jsxs("span",{className:"label label-success",children:["Intercept: ",i]}),t[2]=i,t[3]=k):k=t[3];let T;t[4]!==w?(T=w&&r.jsx("span",{className:"label label-danger",children:"ssl_insecure"}),t[4]=w,t[5]=T):T=t[5];let D;t[6]!==l?(D=l&&r.jsx("span",{className:"label label-success",children:"showhost"}),t[6]=l,t[7]=D):D=t[7];let I;t[8]!==n?(I=!n&&r.jsx("span",{className:"label label-success",children:"no-upstream-cert"}),t[8]=n,t[9]=I):I=t[9];let M;t[10]!==o?(M=!o&&r.jsx("span",{className:"label label-success",children:"no-raw-tcp"}),t[10]=o,t[11]=M):M=t[11];let O;t[12]!==a?(O=!a&&r.jsx("span",{className:"label label-success",children:"no-http2"}),t[12]=a,t[13]=O):O=t[13];let V;t[14]!==d?(V=!d&&r.jsx("span",{className:"label label-success",children:"no-websocket"}),t[14]=d,t[15]=V):V=t[15];let q;t[16]!==u?(q=u&&r.jsx("span",{className:"label label-success",children:"anticache"}),t[16]=u,t[17]=q):q=t[17];let U;t[18]!==h?(U=h&&r.jsx("span",{className:"label label-success",children:"anticomp"}),t[18]=h,t[19]=U):U=t[19];let W;t[20]!==p?(W=p&&r.jsxs("span",{className:"label label-success",children:["stickyauth: ",p]}),t[20]=p,t[21]=W):W=t[21];let B;t[22]!==g?(B=g&&r.jsxs("span",{className:"label label-success",children:["stickycookie: ",g]}),t[22]=g,t[23]=B):B=t[23];let Q;t[24]!==x?(Q=x&&r.jsxs("span",{className:"label label-success",children:["stream: ",Di(x)]}),t[24]=x,t[25]=Q):Q=t[25];let G;t[26]!==j||t[27]!==y||t[28]!==b?(G=b&&r.jsxs("span",{className:"label label-primary",title:"HTTP Proxy Server Address",children:[j||"*",":",y||8080]}),t[26]=j,t[27]=y,t[28]=b,t[29]=G):G=t[29];let J;t[30]!==G?(J=r.jsx(vt,{children:G}),t[30]=G,t[31]=J):J=t[31];let Z;t[32]!==e?(Z=r.jsxs("span",{className:"label label-default",title:"Mitmproxy Version",children:["mitmproxy ",e]}),t[32]=e,t[33]=Z):Z=t[33];let te;t[34]!==J||t[35]!==Z?(te=r.jsxs("div",{className:"pull-right",children:[J,Z]}),t[34]=J,t[35]=Z,t[36]=te):te=t[36];let ce;return t[37]!==C||t[38]!==k||t[39]!==W||t[40]!==B||t[41]!==Q||t[42]!==te||t[43]!==T||t[44]!==D||t[45]!==I||t[46]!==M||t[47]!==O||t[48]!==V||t[49]!==q||t[50]!==U?(ce=r.jsxs("footer",{children:[C,k,T,D,I,M,O,V,q,U,W,B,Q,te]}),t[37]=C,t[38]=k,t[39]=W,t[40]=B,t[41]=Q,t[42]=te,t[43]=T,t[44]=D,t[45]=I,t[46]=M,t[47]=O,t[48]=V,t[49]=q,t[50]=U,t[51]=ce):ce=t[51],ce}function bp(t){return t.options}function Sp(t){return t.backendState.version}function wp(t){const e=E.c(3),{children:s}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=r.jsx("div",{className:"modal-backdrop fade in"}),e[0]=i):i=e[0];let l;return e[1]!==s?(l=r.jsxs("div",{children:[i,r.jsx("div",{className:"modal modal-visible",id:"optionsModal",tabIndex:-1,role:"dialog","aria-labelledby":"options",children:r.jsx("div",{className:"modal-dialog modal-lg",role:"document",children:r.jsx("div",{className:"modal-content",children:s})})})]}),e[1]=s,e[2]=l):l=e[2],l}const $p=t=>{t.key!=="Escape"&&t.stopPropagation()};function Cl(t){const e=E.c(10);let s,i,l;e[0]!==t?({value:l,onChange:s,...i}=t,e[0]=t,e[1]=s,e[2]=i,e[3]=l):(s=e[1],i=e[2],l=e[3]);let n;e[4]!==s?(n=a=>s(a.target.checked),e[4]=s,e[5]=n):n=e[5];let o;return e[6]!==i||e[7]!==n||e[8]!==l?(o=r.jsx("div",{className:"checkbox",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",checked:l,onChange:n,...i}),"Enable"]})}),e[6]=i,e[7]=n,e[8]=l,e[9]=o):o=e[9],o}function Ci(t){const e=E.c(10);let s,i,l;e[0]!==t?({value:l,onChange:s,...i}=t,e[0]=t,e[1]=s,e[2]=i,e[3]=l):(s=e[1],i=e[2],l=e[3]);const n=l||"";let o;e[4]!==s?(o=d=>s(d.target.value),e[4]=s,e[5]=o):o=e[5];let a;return e[6]!==i||e[7]!==n||e[8]!==o?(a=r.jsx("input",{type:"text",value:n,onChange:o,...i}),e[6]=i,e[7]=n,e[8]=o,e[9]=a):a=e[9],a}function Ni(t){return function({onChange:s,...i}){return r.jsx(t,{onChange:l=>s(l||null),...i})}}function ki(t){const e=E.c(10);let s,i,l;e[0]!==t?({value:l,onChange:s,...i}=t,e[0]=t,e[1]=s,e[2]=i,e[3]=l):(s=e[1],i=e[2],l=e[3]);let n;e[4]!==s?(n=a=>s(parseInt(a.target.value)),e[4]=s,e[5]=n):n=e[5];let o;return e[6]!==i||e[7]!==n||e[8]!==l?(o=r.jsx("input",{type:"number",value:l,onChange:n,...i}),e[6]=i,e[7]=n,e[8]=l,e[9]=o):o=e[9],o}function Cp(t){const e=E.c(12);let s,i,l,n;if(e[0]!==t){const{value:d,onChange:u,choices:h,...p}=t;n=d,s=h,i=p,l=g=>u(g.target.value),e[0]=t,e[1]=s,e[2]=i,e[3]=l,e[4]=n}else s=e[1],i=e[2],l=e[3],n=e[4];let o;e[5]!==s?(o=s.map(Np),e[5]=s,e[6]=o):o=e[6];let a;return e[7]!==i||e[8]!==l||e[9]!==o||e[10]!==n?(a=r.jsx("select",{onChange:l,value:n,...i,children:o}),e[7]=i,e[8]=l,e[9]=o,e[10]=n,e[11]=a):a=e[11],a}function Np(t){return r.jsx("option",{value:t,children:t},t)}function kp(t){const e=E.c(13);let s,i,l;e[0]!==t?({value:l,onChange:s,...i}=t,e[0]=t,e[1]=s,e[2]=i,e[3]=l):(s=e[1],i=e[2],l=e[3]);const n=Math.max(l.length,1);let o;e[4]!==l?(o=l.join(`
`),e[4]=l,e[5]=o):o=e[5];const[a,d]=ke.useState(o);let u;e[6]!==s?(u=g=>{const x=g.target.value;d(x),s(x.split(`
`).map(Tp).filter(Ep))},e[6]=s,e[7]=u):u=e[7];const h=u;let p;return e[8]!==h||e[9]!==n||e[10]!==i||e[11]!==a?(p=r.jsx("textarea",{rows:n,value:a,onChange:h,...i}),e[8]=h,e[9]=n,e[10]=i,e[11]=a,e[12]=p):p=e[12],p}function Ep(t){return t!==""}function Tp(t){return t.trim()}const Rp={bool:Cl,str:Ci,int:ki,"optional str":Ni(Ci),"optional int":Ni(ki),"sequence of str":kp};function Ap(t){const e=E.c(16),{choices:s,type:i,value:l,onChange:n,name:o,error:a}=t;let d,u;if(e[0]!==d||e[1]!==s||e[2]!==n||e[3]!==i||e[4]!==l){if(u={onChange:n,value:l},s)d=Cp,u.choices=s;else if(d=Rp[i],!d)throw`unknown option type ${i}`;d!==Cl&&(u.className="form-control"),e[0]=d,e[1]=s,e[2]=n,e[3]=i,e[4]=l,e[5]=u,e[6]=d}else u=e[5],d=e[6];let h;e[7]!==a?(h=Re({"has-error":a}),e[7]=a,e[8]=h):h=e[8];let p;e[9]!==d||e[10]!==o||e[11]!==u?(p=r.jsx(d,{name:o,onKeyDown:$p,...u}),e[9]=d,e[10]=o,e[11]=u,e[12]=p):p=e[12];let g;return e[13]!==h||e[14]!==p?(g=r.jsx("div",{className:h,children:p}),e[13]=h,e[14]=p,e[15]=g):g=e[15],g}function Ip(t){const e=E.c(18),{name:s}=t,i=ee();let l;e[0]!==s?(l=j=>j.options_meta[s]?.choices,e[0]=s,e[1]=l):l=e[1];const n=F(l);let o;e[2]!==s?(o=j=>j.options_meta[s]?.type,e[2]=s,e[3]=o):o=e[3];const a=F(o);let d;e[4]!==s?(d=j=>{const y=j.ui.optionsEditor[s];return y?y.value:j.options_meta[s]?.value},e[4]=s,e[5]=d):d=e[5];const u=F(d);let h;e[6]!==s?(h=j=>j.ui.optionsEditor[s]?.error,e[6]=s,e[7]=h):h=e[7];const p=F(h);let g;e[8]!==i||e[9]!==s?(g=j=>i(Ps(s,j)),e[8]=i,e[9]=s,e[10]=g):g=e[10];let x;return e[11]!==n||e[12]!==p||e[13]!==s||e[14]!==g||e[15]!==a||e[16]!==u?(x=r.jsx(Ap,{name:s,choices:n,type:a,value:u,error:p,onChange:g}),e[11]=n,e[12]=p,e[13]=s,e[14]=g,e[15]=a,e[16]=u,e[17]=x):x=e[17],x}function Dp(t){const e=E.c(4),{name:s}=t;let i;e[0]!==s?(i=o=>o.options_meta[s]?.help,e[0]=s,e[1]=i):i=e[1];const l=F(i);let n;return e[2]!==l?(n=r.jsx("div",{className:"help-block small",children:l}),e[2]=l,e[3]=n):n=e[3],n}function Fp(t){const e=E.c(4),{name:s}=t;let i;e[0]!==s?(i=o=>o.options_meta[s]?.error,e[0]=s,e[1]=i):i=e[1];const l=F(i);if(!l)return null;let n;return e[2]!==l?(n=r.jsx("div",{className:"small text-danger",children:l}),e[2]=l,e[3]=n):n=e[3],n}function Lp(t){const e=E.c(2);let{value:s,defaultVal:i}=t;if(s===i)return null;{if(typeof i=="boolean")i=i?"true":"false";else if(Array.isArray(i)){if(Kt.isEmpty(Kt.compact(s))&&Kt.isEmpty(i))return null;i="[ ]"}else i===""?i='""':i===null&&(i="null");let l;return e[0]!==i?(l=r.jsxs("div",{className:"small",children:["Default: ",r.jsxs("strong",{children:[" ",i," "]})," "]}),e[0]=i,e[1]=l):l=e[1],l}}const Pp=_t((t,{name:e})=>({value:t.options[e],defaultVal:t.options_meta[e]?.default}))(Lp);function Mp(){const t=E.c(24),e=ee(),s=F(qp,Jt);let i,l,n,o;if(t[0]!==e||t[1]!==s){const p=s.sort();let g;t[6]!==e?(g=()=>e(ur()),t[6]=e,t[7]=g):g=t[7];let x;t[8]===Symbol.for("react.memo_cache_sentinel")?(x=r.jsx("i",{className:"fa fa-fw fa-times"}),t[8]=x):x=t[8];let j;t[9]!==g?(j=r.jsx("button",{type:"button",className:"close","data-dismiss":"modal",onClick:g,children:x}),t[9]=g,t[10]=j):j=t[10];let y;t[11]===Symbol.for("react.memo_cache_sentinel")?(y=r.jsx("div",{className:"modal-title",children:r.jsx("h4",{children:"Options"})}),t[11]=y):y=t[11],t[12]!==j?(o=r.jsxs("div",{className:"modal-header",children:[j,y]}),t[12]=j,t[13]=o):o=t[13],n="modal-body",i="form-horizontal",l=p.map(Op),t[0]=e,t[1]=s,t[2]=i,t[3]=l,t[4]=n,t[5]=o}else i=t[2],l=t[3],n=t[4],o=t[5];let a;t[14]!==i||t[15]!==l?(a=r.jsx("div",{className:i,children:l}),t[14]=i,t[15]=l,t[16]=a):a=t[16];let d;t[17]!==n||t[18]!==a?(d=r.jsx("div",{className:n,children:a}),t[17]=n,t[18]=a,t[19]=d):d=t[19];let u;t[20]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("div",{className:"modal-footer"}),t[20]=u):u=t[20];let h;return t[21]!==o||t[22]!==d?(h=r.jsxs("div",{children:[o,d,u]}),t[21]=o,t[22]=d,t[23]=h):h=t[23],h}function Op(t){return r.jsxs("div",{className:"form-group",children:[r.jsxs("div",{className:"col-xs-6",children:[r.jsx("label",{htmlFor:t,children:t}),r.jsx(Dp,{name:t})]}),r.jsxs("div",{className:"col-xs-6",children:[r.jsx(Ip,{name:t}),r.jsx(Fp,{name:t}),r.jsx(Pp,{name:t})]})]},t)}function qp(t){return Object.keys(t.options_meta)}function Hp(){const t=E.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=r.jsx(wp,{children:r.jsx(Mp,{})}),t[0]=e):e=t[0],e}const Vp={OptionModal:Hp};function Up(){const t=E.c(3),e=F(Bp),s=e?Vp[e]:void 0;if(s){let i;return t[0]!==s?(i=r.jsx(s,{}),t[0]=s,t[1]=i):i=t[1],i}else{let i;return t[2]===Symbol.for("react.memo_cache_sentinel")?(i=r.jsx(r.Fragment,{}),t[2]=i):i=t[2],i}}function Bp(t){return t.ui.modal.activeModal}class Kp extends P.Component{state={};render=()=>{const{showEventLog:e,showCommandBar:s}=this.props;return this.state.error?(console.log("ERR",this.state),r.jsxs("div",{className:"container",children:[r.jsx("h1",{children:"mitmproxy has crashed."}),r.jsxs("pre",{children:[this.state.error.stack,r.jsx("br",{}),r.jsx("br",{}),"Component Stack:",this.state.errorInfo?.componentStack]}),r.jsxs("p",{children:["Please lodge a bug report at"," ",r.jsx("a",{href:"https://github.com/mitmproxy/mitmproxy/issues",children:"https://github.com/mitmproxy/mitmproxy/issues"}),"."]})]})):r.jsxs("div",{id:"container",tabIndex:0,children:[r.jsx(sp,{}),r.jsx(bf,{}),s&&r.jsx(ap,{},"commandbar"),e&&r.jsx(jp,{},"eventlog"),r.jsx(yp,{}),r.jsx(Up,{})]})};componentDidMount(){window.addEventListener("keydown",this.props.onKeyDown)}componentWillUnmount(){window.removeEventListener("keydown",this.props.onKeyDown)}componentDidCatch(e,s){this.setState({error:e,errorInfo:s})}}const Wp=_t(t=>({showEventLog:t.eventLog.visible,showCommandBar:t.commandBar.visible}),{onKeyDown:Ld})(Kp),tt={SEARCH:"s",HIGHLIGHT:"h",SHOW_EVENTLOG:"e",SHOW_COMMANDBAR:"c"};function zp(t){const[e,s]=window.location.hash.substr(1).split("?",2),i=e.substr(1).split("/");if(i[0]==="flows"){if(i.length==3){const[l,n]=i.slice(1);t.dispatch(zt(n));const o=()=>{const d=t.getState().flows.byId.get(l);d!==void 0&&(a(),t.dispatch(Ke([d])))},a=t.subscribe(o);o()}}else i[0]==="capture"&&t.dispatch(Wt(pe.Capture));s&&s.split("&").forEach(l=>{const[n,o]=l.split("=",2),a=decodeURIComponent(o);switch(n){case tt.SEARCH:t.dispatch(Ji(a));break;case tt.HIGHLIGHT:t.dispatch(Xi(a));break;case tt.SHOW_EVENTLOG:t.getState().eventLog.visible||t.dispatch(Xt());break;case tt.SHOW_COMMANDBAR:t.getState().commandBar.visible||t.dispatch(gr());break;default:console.error(`unimplemented query arg: ${l}`)}})}function Qp(t){const e=t.getState(),s={[tt.SEARCH]:e.ui.filter[Ee.Search],[tt.HIGHLIGHT]:e.ui.filter[Ee.Highlight],[tt.SHOW_EVENTLOG]:e.eventLog.visible,[tt.SHOW_COMMANDBAR]:e.commandBar.visible},i=Object.keys(s).filter(o=>s[o]).map(o=>`${o}=${encodeURIComponent(s[o])}`).join("&");let l;e.ui.tabs.current===pe.Capture?l="/capture":e.flows.selected.length>0?l=`/flows/${e.flows.selected[0].id}/${e.ui.flow.tab}`:l="/flows",i&&(l+="?"+i);let n=window.location.pathname;n==="blank"&&(n="/"),window.location.hash.substr(1)!==l&&history.replaceState(void 0,"",`${n}#${l}`)}function Gp(t){zp(t),t.subscribe(()=>Qp(t))}var at=(t=>(t.State="state",t.Flows="flows",t.Events="events",t.Options="options",t))(at||{});class Yp{activeFetches;store;filterState;socket;messageQueue;constructor(e){this.activeFetches={},this.store=e,this.filterState=Yi,this.messageQueue=[],this.connect(),this.store.subscribe(this.onStoreUpdate.bind(this))}connect(){this.socket=new WebSocket(location.origin.replace("http","ws")+location.pathname.replace(/\/$/,"")+"/updates"),this.socket.addEventListener("open",()=>this.onOpen()),this.socket.addEventListener("close",e=>this.onClose(e)),this.socket.addEventListener("message",e=>this.onMessage(JSON.parse(e.data))),this.socket.addEventListener("error",e=>this.onError(e))}async onOpen(){for(const e of this.messageQueue)this.socket.send(JSON.stringify(e));this.messageQueue=[],this.store.dispatch(sa()),await Promise.all([this.fetchData("state"),this.fetchData("flows"),this.fetchData("events"),this.fetchData("options")]),this.store.dispatch(na())}onStoreUpdate(){const e=this.store.getState().ui.filter;if(e!==this.filterState){for(const s of Object.values(Ee))this.filterState[s]!==e[s]&&this.sendMessage({type:"flows/updateFilter",payload:{name:s,expr:e[s]}});this.filterState=e}}fetchData(e){const s=[];return this.activeFetches[e]=s,le(`./${e}`).then(i=>i.json()).then(i=>{this.activeFetches[e]===s&&this.receive(e,i)})}onMessage(e){switch(e.type){case"flows/add":return this.queueOrDispatch("flows",rr(e.payload));case"flows/update":return this.queueOrDispatch("flows",lr(e.payload));case"flows/filterUpdate":return this.queueOrDispatch("flows",cr(e.payload));case"flows/remove":return this.queueOrDispatch("flows",or(e.payload));case"events/add":return this.queueOrDispatch("events",Fs(e.payload));case"options/update":return this.queueOrDispatch("options",Ls(e.payload));case"state/update":return this.queueOrDispatch("state",ze(e.payload));case"flows/reset":return this.fetchData("flows");case"events/reset":return this.fetchData("events");default:Tt(e.type)}}sendMessage(e){this.socket.readyState===WebSocket.OPEN?this.socket.send(JSON.stringify(e)):this.socket.readyState===WebSocket.CONNECTING?this.messageQueue.push(e):console.error("WebSocket is not open. Cannot send:",e)}queueOrDispatch(e,s){const i=this.activeFetches[e];i!==void 0?i.push(s):this.store.dispatch(s)}receive(e,s){switch(e){case"state":this.store.dispatch(We(s));break;case"options":this.store.dispatch(Zt(s));break;case"events":this.store.dispatch(fr(s));break;case"flows":this.store.dispatch(Ds(s));break;default:Tt(e)}const i=this.activeFetches[e];delete this.activeFetches[e],i.forEach(l=>this.store.dispatch(l))}onClose(e){this.store.dispatch(ia(`Connection closed at ${new Date().toUTCString()} with error code ${e.code}.`)),console.error("websocket connection closed",e)}onError(...e){console.error("websocket connection errored",e)}}class Jp{store;constructor(e){this.store=e,this.onOpen()}onOpen(){this.fetchData(at.Flows),this.fetchData(at.Options)}fetchData(e){le(`./${e}`).then(s=>s.json()).then(s=>{this.receive(e,s)})}receive(e,s){switch(e){case at.Flows:this.store.dispatch(Ds(s));break;case at.Options:this.store.dispatch(Zt(s));break;case at.State:throw"unreachable";case at.Events:throw"unreachable";default:Tt(e)}}}window.MITMWEB_STATIC?window.backend=new Jp(Rt):window.backend=new Yp(Rt);Gp(Rt);window.addEventListener("error",t=>{Rt.dispatch(Bc(`${t.message}
${t.error.stack}`))});document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("mitmproxy");pc.createRoot(t).render(r.jsx(hc,{store:Rt,children:r.jsx(Wp,{})}))});
