import{c as ae,R as Ll,a as ve,r as I,b as Ee,d as _e,j as o,e as E,f as vi,u as Pl,g as Ml,h as _i,s as Gt,i as Ol,l as Ut,k as ql,m as Hl,n as Vl,y as Ul,o as Bl,p as Wl,q as Tt,Q as Kl,C as ji,X as yi,Y as hs,T as ys,L as bs,t as zl,v as ws,w as Gl,P as Ql,x as Yl,z as Jl,B as zn,A as Xl,D as Zl,E as ec}from"./vendor-CV_2_uTW.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();const tc={tab:"request",contentViewFor:{}},sc=ae({name:"ui/flow",initialState:tc,reducers:{selectTab(t,e){t.tab=e.payload},setContentViewFor(t,e){t.contentViewFor[e.payload.messageId]=e.payload.contentView}}}),{actions:nc,reducer:ic}=sc,{selectTab:Wt,setContentViewFor:bi}=nc;window.React=Ll;const wi=function(t){if(t===0)return"0";const e=["b","kb","mb","gb","tb"];let s=0;for(;s<e.length&&!(Math.pow(1024,s+1)>t);s++);let i;return t%Math.pow(1024,s)===0?i=0:i=1,(t/Math.pow(1024,s)).toFixed(i)+e[s]},Si=function(t){let e=t;const s=["ms","s","min","h"],i=[1e3,60,60];let r=0;for(;Math.abs(e)>=i[r]&&r<i.length;)e=e/i[r],r++;return Math.round(e)+s[r]},at=function(t,{includeMilliseconds:e=!0}={}){const s=new Date(t*1e3),i=String(s.getFullYear()),r=String(s.getMonth()+1).padStart(2,"0"),n=String(s.getDate()).padStart(2,"0"),l=String(s.getHours()).padStart(2,"0"),a=String(s.getMinutes()).padStart(2,"0"),d=String(s.getSeconds()).padStart(2,"0"),f=String(s.getMilliseconds()).padStart(3,"0");let h=`${i}-${r}-${n} ${l}:${a}:${d}`;return e&&(h+=`.${f}`),h};function Gn(t){return t[0].includes(":")?`[${t[0]}]:${t[1]}`:`${t[0]}:${t[1]}`}function rc(t){const e=document.cookie.match(new RegExp("\\b"+t+"=([^;]*)\\b"));return e?e[1]:void 0}let ms=()=>{const t=rc("_xsrf");return ms=()=>t,ms()};function ne(t,e={}){return e.method&&e.method!=="GET"&&(e.headers=e.headers||{},e.headers["X-XSRFToken"]=ms()),t.startsWith("/")&&(t="."+t),fetch(t,{credentials:"same-origin",...e})}ne.put=(t,e,s={})=>ne(t,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),...s});ne.post=(t,e,s={})=>ne(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),...s});async function Kt(t,...e){return await(await ne(`/commands/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({arguments:e})})).json()}async function $i(t){try{await navigator.clipboard.write([new ClipboardItem({"text/plain":t})]);return}catch(i){console.warn(i)}const e=await t;try{await navigator.clipboard.writeText(e);return}catch(i){console.warn(i)}const s=document.createElement("textarea");s.value=e,s.style.position="absolute",s.style.opacity="0",document.body.appendChild(s);try{if(s.focus(),s.select(),!document.execCommand("copy"))throw"failed to copy"}catch{alert(e)}finally{s.remove()}}async function oc(t){await $i(Promise.resolve(t?.text||""))}function gs(t,e){const s=t.lastIndexOf(e);if(s===-1)return["",t];const i=t.slice(0,s),r=t.slice(s+e.length);return[i,r]}function Ci(t,e){const s=t.indexOf(e);if(s===-1)return[t,""];const i=t.slice(0,s),r=t.slice(s+e.length);return[i,r]}function Nt(t){throw new Error(`Unreachable: ${JSON.stringify(t)}`)}const Ni={http:80,https:443},Qn=new WeakMap;class je{static getContentType(e){const s=je.get_first_header(e,/^Content-Type$/i);if(s)return s.split(";")[0].trim()}static get_first_header(e,s){let i=Qn.get(e);i||(i=new Map,Qn.set(e,i));let r=i.get(s);if(r===void 0){const n=e.headers.find(([l,a])=>s.test(l));r=n?n[1]:!1,i.set(s,r)}return r!==!1?r:void 0}static match_header(e,s){const i=e.headers;if(!i)return!1;let r=i.length;for(;r--;)if(s.test(i[r].join(" ")))return i[r];return!1}static getContentURL(e,s,i,r){e.type==="http"&&s===e.request?s="request":e.type==="http"&&s===e.response&&(s="response");const n=r?`?lines=${r}`:"";return`./flows/${e.id}/${s}/`+(i?`content/${encodeURIComponent(i)}.json${n}`:"content.data")}}class ct extends je{static pretty_url(e){let s="";return Ni[e.scheme]!==e.port&&(s=":"+e.port),e.scheme+"://"+e.pretty_host+s+e.path}}class mt extends je{}const lc=/^(?:(https?):\/\/)?([^/:]+)?(?::(\d+))?(\/.*)?$/i,ki=function(t){const e=lc.exec(t);if(!e)return;const s=e[1],i=e[2],r=parseInt(e[3]),n=e[4],l=s?r||Ni[s]:r,a={};return s&&(a.scheme=s),i&&(a.host=i),l&&(a.port=l),n&&(a.path=n),a},cc=/^HTTP\/\d+(\.\d+)*$/i,Ei=function(t){return cc.test(t)};function zt(t){switch(t.type){case"http":return t.request.timestamp_start;case"tcp":case"udp":return t.client_conn.timestamp_start;case"dns":return t.request.timestamp}}function Ti(t){switch(t.type){case"http":if(t.websocket){if(t.websocket.timestamp_end)return t.websocket.timestamp_end;if(t.websocket.messages_meta.timestamp_last)return t.websocket.messages_meta.timestamp_last}return t.response?t.response.timestamp_end:void 0;case"tcp":return t.server_conn?.timestamp_end;case"udp":return t.messages_meta.timestamp_last;case"dns":return t.response?.timestamp}}const Ri=t=>{switch(t.type){case"http":{let e=t.request.contentLength||0;return t.response&&(e+=t.response.contentLength||0),t.websocket&&(e+=t.websocket.messages_meta.contentLength||0),e}case"tcp":case"udp":return t.messages_meta.contentLength||0;case"dns":return t.response?.size??0}},Ss=t=>t.type==="http"&&!t.websocket,Ai=t=>t.modified,$s=t=>t.intercepted,Di=t=>{if(t.type!=="http")return t.client_conn.tls_version==="QUICv1"?"resource-icon-quic":`resource-icon-${t.type}`;if(t.websocket)return"resource-icon-websocket";if(!t.response)return"resource-icon-plain";const e=mt.getContentType(t.response)||"";return t.response.status_code===304?"resource-icon-not-modified":300<=t.response.status_code&&t.response.status_code<400?"resource-icon-redirect":e.indexOf("image")>=0?"resource-icon-image":e.indexOf("javascript")>=0?"resource-icon-js":e.indexOf("css")>=0?"resource-icon-css":e.indexOf("html")>=0?"resource-icon-document":"resource-icon-plain"},Fi=t=>{switch(t.type){case"http":return ct.pretty_url(t.request);case"tcp":case"udp":return`${t.client_conn.peername.join(":")} ↔ ${t.server_conn?.address?.join(":")}`;case"dns":return`${t.request.questions.map(e=>`${e.name} ${e.type}`).join(", ")} = ${(t.response?.answers.map(e=>e.data).join(", ")??"...")||"?"}`}},Ii=t=>{switch(t.type){case"http":return t.response?.status_code;case"dns":return t.response?.response_code;default:return}},Li=t=>{switch(t.type){case"http":return t.websocket?t.client_conn.tls_established?"WSS":"WS":t.request.method;case"dns":return t.request.op_code;default:return t.type.toUpperCase()}},Pi=t=>{switch(t.type){case"http":return t.request.http_version;default:return""}},Mi={tls:t=>t.type==="http"&&t.request.scheme,icon:Di,index:()=>0,path:Fi,method:Li,version:Pi,status:Ii,size:Ri,time:t=>{const e=zt(t),s=Ti(t);return e&&s&&s-e},timestamp:zt,quickactions:()=>0,comment:t=>t.comment};function ac(t){return t in Mi}var xe=(t=>(t.Search="search",t.Highlight="highlight",t))(xe||{});const Oi={search:"",highlight:""},dc=ae({name:"ui/filters",initialState:Oi,reducers:{setFilter(t,e){t.search=e.payload},setHighlight(t,e){t.highlight=e.payload}}}),{actions:fc,reducer:uc}=dc,{setFilter:qi,setHighlight:Hi}=fc;function os(t,e){return t.toSorted?t.toSorted(e):[...t].sort(e)}function Cs(t,...e){if(t.toSpliced)return t.toSpliced(...e);{const s=[...t];return s.splice(...e),s}}function jt(t){return new Map(t.map((e,s)=>[e.id,s]))}function ls(t){return new Set(t.map(e=>e.id))}function Yn(t,e){return t.has(e)&&(t=new Set(t),t.delete(e)),t}function Jn(t,e,s){const i=Cs(t,s,1),r=new Map(e);r.delete(t[s].id);for(let n=i.length-1;n>=s;n--)r.set(i[n].id,n);return{view:i,_viewIndex:r}}function pc(t,e,s,i){const r=[...t],n=r.length;let l=e,a=l.get(s.id);if(a+1<n&&i(s,r[a+1])>0){l=new Map(l);do{const d=r[a+1];r[a]=d,l.set(d.id,a),a++}while(a+1<n&&i(s,r[a+1])>0);l.set(s.id,a)}else if(a>0&&i(s,r[a-1])<0){l=new Map(l);do{const d=r[a-1];r[a]=d,l.set(d.id,a),a--}while(a>0&&i(s,r[a-1])<0);l.set(s.id,a)}return r[a]=s,{view:r,_viewIndex:l}}function Xn(t,e,s,i){const r=hc(t,s,i),n=Cs(t,r,0,s),l=new Map(e);for(let a=n.length-1;a>=r;a--)l.set(n[a].id,a);return{view:n,_viewIndex:l}}function hc(t,e,s){let i=0,r=t.length;if(r===0||s(t[r-1],e)<=0)return r;for(;i<r;){const n=i+r>>>1;s(e,t[n])>=0?i=n+1:r=n}return i}function Ns(t){return t=t.filter($s),()=>Promise.all(t.map(e=>ne(`/flows/${e.id}/resume`,{method:"POST"})))}function Vi(){return()=>ne("/flows/resume",{method:"POST"})}function Ui(t){return t=t.filter($s),()=>Promise.all(t.map(e=>ne(`/flows/${e.id}/kill`,{method:"POST"})))}function mc(){return()=>ne("/flows/kill",{method:"POST"})}function Bi(t){return()=>Promise.all(t.map(e=>ne(`/flows/${e.id}`,{method:"DELETE"})))}function Wi(t){return()=>Promise.all(t.map(e=>ne(`/flows/${e.id}/duplicate`,{method:"POST"})))}function ks(t){return t=t.filter(Ss),()=>Promise.all(t.map(e=>ne(`/flows/${e.id}/replay`,{method:"POST"})))}function Ki(t){return t=t.filter(Ai),()=>Promise.all(t.map(e=>ne(`/flows/${e.id}/revert`,{method:"POST"})))}function Zn(t,e){return()=>Promise.all(t.map(s=>Ie(s,{marked:e})()))}function Ie(t,e){return()=>ne.put(`/flows/${t.id}`,e)}function gc(t,e,s){const i=new FormData;return e=new window.Blob([e],{type:"plain/text"}),i.append("file",e),()=>ne(`/flows/${t.id}/${s}/content.data`,{method:"POST",body:i})}function zi(){return()=>ne("/clear",{method:"POST"})}function xc(t){const e=new FormData;return e.append("file",t),()=>ne("/flows/dump",{method:"POST",body:e})}const Gi=ve("flows/add"),Qi=ve("flows/update"),Yi=ve("flows/remove"),Es=ve("flows/receive"),Ji=ve("flows/filterUpdate"),Xi=ve("flows/sort"),He=ve("flows/select"),vc={list:[],_listIndex:new Map,byId:new Map,view:[],_viewIndex:new Map,sort:{column:void 0,desc:!1},selected:[],selectedIds:new Set,highlightedIds:new Set};function _c(t=vc,e){if(Es.match(e)){const{sort:s}=t,i=e.payload,r=jt(i),n=new Map(i.map(p=>[p.id,p])),l=os(i,pt(s)),a=jt(l),d=t.selected.map(p=>n.get(p.id)).filter(p=>p!==void 0),f=ls(d);return{list:i,_listIndex:r,byId:n,view:l,_viewIndex:a,sort:s,selected:d,selectedIds:f,highlightedIds:new Set}}else if(Gi.match(e)){const{flow:s,matching_filters:i}=e.payload;if(t._listIndex.has(s.id))return t;const{sort:r,selected:n,selectedIds:l}=t;let{view:a,_viewIndex:d,highlightedIds:f}=t;const h=new Map(t._listIndex);h.set(s.id,t.list.length);const p=[...t.list,s],g=new Map(t.byId);return g.set(s.id,s),(i[xe.Search]===!0||i[xe.Search]===void 0)&&({view:a,_viewIndex:d}=Xn(a,d,s,pt(r))),i[xe.Highlight]===!0&&(f=new Set(f),f.add(s.id)),{list:p,_listIndex:h,byId:g,view:a,_viewIndex:d,sort:r,selected:n,selectedIds:l,highlightedIds:f}}else if(Qi.match(e)){const{flow:s,matching_filters:i}=e.payload,{_listIndex:r,sort:n,selectedIds:l}=t;let{view:a,_viewIndex:d,selected:f,highlightedIds:h}=t;const p=t._listIndex.get(s.id),g=[...t.list];p!==void 0?g[p]=s:g.push(s);const x=new Map(t.byId);x.set(s.id,s);const j=d.get(s.id),y=j!==void 0,b=i[xe.Search]===!0||i[xe.Search]===void 0;return b&&!y?{view:a,_viewIndex:d}=Xn(a,d,s,pt(n)):!b&&y?{view:a,_viewIndex:d}=Jn(a,d,j):b&&y&&({view:a,_viewIndex:d}=pc(a,d,s,pt(n))),l.has(s.id)&&(f=f.map($=>$.id===s.id?s:$)),i[xe.Highlight]===!0?h.has(s.id)||(h=new Set(h),h.add(s.id)):h=Yn(h,s.id),{list:g,_listIndex:r,byId:x,view:a,_viewIndex:d,sort:n,selected:f,selectedIds:l,highlightedIds:h}}else if(Yi.match(e)){const s=e.payload,{sort:i}=t;let{view:r,_viewIndex:n,selected:l,selectedIds:a}=t;const d=t._listIndex.get(s);if(d===void 0)return t;const f=Cs(t.list,d,1),h=jt(f),p=new Map(t.byId);p.delete(s);const g=n.get(s);if(g!==void 0&&({view:r,_viewIndex:n}=Jn(r,n,g)),a.has(s)){if(l.length===1&&g!==void 0){const j=r[g]??r[g-1];l=j?[j]:[]}else l=l.filter(j=>j.id!==s);a=ls(l)}const x=Yn(t.highlightedIds,s);return{list:f,_listIndex:h,byId:p,view:r,_viewIndex:n,sort:i,selected:l,selectedIds:a,highlightedIds:x}}else if(Ji.match(e)){const{name:s,matching_flow_ids:i}=e.payload;switch(s){case xe.Search:{const r=os(i===null?t.list:i.map(l=>t.byId.get(l)).filter(l=>l!==void 0),pt(t.sort)),n=jt(r);return{...t,view:r,_viewIndex:n}}case xe.Highlight:return{...t,highlightedIds:new Set(i)};default:Nt(s)}}else if(Xi.match(e)){const s=e.payload;let i;s.column?i=os(t.view,pt(s)):i=t.list.filter(n=>t._viewIndex.has(n.id));const r=jt(i);return{...t,sort:s,view:i,_viewIndex:r}}else return He.match(e)?{...t,selected:e.payload,selectedIds:ls(e.payload)}:t}function pt({column:t,desc:e}){if(!t)return(i,r)=>0;const s=Mi[t];return(i,r)=>{const n=s(i),l=s(r);return n>l?e?-1:1:n<l?e?1:-1:0}}function ht(t,e){const s=t.selected[t.selected.length-1],i=t._viewIndex.get(s?.id),r=0,n=t.view.length-1;let l;i===void 0?l=e<0?r:n:(l=i+e,l=window.Math.max(l,r),l=window.Math.min(l,n));const a=t.view[l];return He(a?[a]:[])}function jc(t){return(e,s)=>{const{flows:i}=s();i.selectedIds.has(t.id)?e(He(i.selected.filter(r=>r!==t))):e(He([...i.selected,t]))}}function yc(t){return(e,s)=>{const{flows:i}=s(),r=i.selected[i.selected.length-1],n=i._viewIndex.get(t.id),l=i._viewIndex.get(r?.id);if(n===void 0||l===void 0)return e(He([t]));let a;return n<=l?a=i.view.slice(n,l+1):(a=i.view.slice(l+1,n+1),a.push(r)),e(He(a))}}const bc={activeModal:void 0},Zi=ae({name:"ui/modal",initialState:bc,reducers:{setActiveModal(t,e){t.activeModal=e.payload},hideModal(t){t.activeModal=void 0}}}),{actions:wc,reducer:Sc}=Zi,$c=Zi.actions.hideModal.type,{setActiveModal:Cc,hideModal:er}=wc,ei=(()=>{const t=document.createElement("div");return t.setAttribute("contenteditable","PLAINTEXT-ONLY"),t.contentEditable==="plaintext-only"?"plaintext-only":"true"})();class le extends I.Component{input=Ee.createRef();render(){const e=_e("inline-input",this.props.className);return o.jsx("span",{ref:this.input,tabIndex:0,className:e,placeholder:this.props.placeholder,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onInput:this.onInput,onPaste:this.onPaste,onMouseDown:this.onMouseDown,onClick:this.onClick,children:this.props.content})}componentDidUpdate(e){e.content!==this.props.content&&this.props.onInput?.(this.props.content)}isEditing=()=>this.input.current?.contentEditable===ei;startEditing=()=>{if(!this.input.current)return console.error("unreachable");this.isEditing()||(this.suppress_events=!0,this.input.current.blur(),this.input.current.contentEditable=ei,window.requestAnimationFrame(()=>{if(this.input.current){if(this.input.current.focus(),this.suppress_events=!1,this.props.selectAllOnClick){const e=document.createRange();e.selectNodeContents(this.input.current);const s=window.getSelection();s?.removeAllRanges(),s?.addRange(e)}this.props.onEditStart?.()}}))};resetValue=()=>{if(!this.input.current)return console.error("unreachable");this.input.current.textContent=this.props.content,this.props.onInput?.(this.props.content)};finishEditing=()=>{if(!this.input.current)return console.error("unreachable");this.props.onEditDone(this.input.current.textContent||""),this.input.current.blur(),this.input.current.contentEditable="inherit"};onPaste=e=>{e.preventDefault();const s=e.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,s)};suppress_events=!1;onMouseDown=e=>{this.suppress_events=!0,window.addEventListener("mouseup",this.onMouseUp,{once:!0})};onMouseUp=e=>{const s=e.target===this.input.current,i=!window.getSelection()?.toString();this.props.selectAllOnClick?s&&i&&this.startEditing():s&&this.startEditing(),this.suppress_events=!1};onClick=e=>{};onFocus=e=>{if(!this.input.current)throw"unreachable";this.suppress_events||this.startEditing()};onInput=e=>{this.props.onInput?.(this.input.current?.textContent||"")};onBlur=e=>{this.suppress_events||this.finishEditing()};onKeyDown=e=>{switch(e.stopPropagation(),e.key){case"Escape":e.preventDefault(),this.resetValue(),this.finishEditing();break;case"Enter":e.shiftKey||(e.preventDefault(),this.finishEditing());break}this.props.onKeyDown?.(e)}}function St(t){const e=E.c(15);let s;e[0]!==t.content||e[1]!==t.isValid?(s=t.isValid(t.content),e[0]=t.content,e[1]=t.isValid,e[2]=s):s=e[2];const[i,r]=I.useState(s),n=I.useRef(null);let l;e[3]!==t?(l=x=>{t.isValid(x)?t.onEditDone(x):n.current?.resetValue()},e[3]=t,e[4]=l):l=e[4];const a=l,d=i?"has-success":"has-warning";let f;e[5]!==t.className||e[6]!==d?(f=_e(t.className,d),e[5]=t.className,e[6]=d,e[7]=f):f=e[7];const h=f;let p;e[8]!==t?(p=x=>r(t.isValid(x)),e[8]=t,e[9]=p):p=e[9];let g;return e[10]!==h||e[11]!==a||e[12]!==t||e[13]!==p?(g=o.jsx(le,{...t,className:h,onInput:p,onEditDone:a,ref:n}),e[10]=h,e[11]=a,e[12]=t,e[13]=p,e[14]=g):g=e[14],g}const Q=()=>Pl(),D=Ml,Nc=vi.withTypes(),Ts=ve("EVENTS_ADD"),tr=ve("EVENTS_RECEIVE"),Qt=ve("events/toggleVisibility"),sr=ve("events/toggleFilter");var nr=(t=>(t.debug="debug",t.info="info",t.web="web",t.warn="warn",t.error="error",t))(nr||{});const kc={visible:!1,filters:{debug:!1,info:!0,web:!0,warn:!0,error:!0},list:[],view:[]};function Ec(t=kc,e){if(Ts.match(e)){const s=e.payload;return{...t,list:[...t.list,s],view:t.filters[s.level]?[...t.view,s]:t.view}}else{if(tr.match(e))return{...t,list:e.payload,view:e.payload.filter(s=>t.filters[s.level])};if(Qt.match(e))return{...t,visible:!t.visible};if(sr.match(e)){const s={...t.filters,[e.payload]:!t.filters[e.payload]};return{...t,filters:s,view:t.list.filter(i=>s[i.level])}}else return t}}function Tc(t,e="web"){return Ts({id:Math.random().toString(),message:t,level:e})}const ti={},Rc=ae({name:"ui/optionsEditor",initialState:ti,reducers:{startUpdate(t,e){t[e.payload.option]={isUpdating:!0,value:e.payload.value,error:!1}},updateSuccess(t,e){t[e.payload.option]=void 0},updateError(t,e){let s=t[e.payload.option].value;typeof s=="boolean"&&(s=!s),t[e.payload.option]={value:s,isUpdating:!1,error:e.payload.error}}},extraReducers:t=>{t.addCase($c,()=>ti)}}),{actions:Ac,reducer:Dc}=Rc,{startUpdate:Fc,updateSuccess:Ic,updateError:Lc}=Ac;var fe=(t=>(t[t.Capture=0]="Capture",t[t.FlowList=1]="FlowList",t[t.Options=2]="Options",t[t.Flow=3]="Flow",t[t.Metrics=4]="Metrics",t))(fe||{});const Pc=ae({name:"ui/tabs",initialState:{current:1},reducers:{setCurrent(t,e){t.current=e.payload}}}),{actions:Mc,reducer:Oc}=Pc,{setCurrent:Bt}=Mc,qc=_i({flow:ic,modal:Sc,optionsEditor:Dc,tabs:Oc,filter:uc});var wt=(t=>(t.INIT="CONNECTION_INIT",t.FETCHING="CONNECTION_FETCHING",t.ESTABLISHED="CONNECTION_ESTABLISHED",t.ERROR="CONNECTION_ERROR",t))(wt||{});const Hc={state:"CONNECTION_INIT",message:void 0},ir=ae({name:"connection",initialState:Hc,reducers:{startFetching:t=>{t.state==="CONNECTION_INIT"&&(t.state="CONNECTION_FETCHING")},finishFetching:t=>{t.state==="CONNECTION_FETCHING"&&(t.state="CONNECTION_ESTABLISHED")},connectionError:(t,e)=>{t.state="CONNECTION_ERROR",t.message=e.payload}}}),{startFetching:Vc,finishFetching:Uc,connectionError:Bc}=ir.actions,Wc=ir.reducer,Kc={add_upstream_certs_to_client_chain:!1,allow_hosts:[],anticache:!1,anticomp:!1,block_global:!0,block_list:[],block_private:!1,body_size_limit:void 0,cert_passphrase:void 0,certs:[],ciphers_client:void 0,ciphers_server:void 0,client_certs:void 0,client_replay:[],client_replay_concurrency:1,command_history:!0,confdir:"~/.mitmproxy",connect_addr:void 0,connection_strategy:"eager",console_focus_follow:!1,content_view_lines_cutoff:512,dns_name_servers:[],dns_use_hosts_file:!0,export_preserve_original_ip:!1,hardump:"",http2:!0,http2_ping_keepalive:58,http3:!0,http_connect_send_host_header:!0,ignore_hosts:[],intercept:void 0,intercept_active:!1,keep_alt_svc_header:!1,keep_host_header:!1,key_size:2048,listen_host:"",listen_port:void 0,map_local:[],map_remote:[],mode:["regular"],modify_body:[],modify_headers:[],normalize_outbound_headers:!0,onboarding:!0,onboarding_host:"mitm.it",protobuf_definitions:void 0,proxy_debug:!1,proxyauth:void 0,rawtcp:!0,readfile_filter:void 0,request_client_cert:!1,rfile:void 0,save_stream_file:void 0,save_stream_filter:void 0,scripts:[],server:!0,server_replay:[],server_replay_extra:"forward",server_replay_ignore_content:!1,server_replay_ignore_host:!1,server_replay_ignore_params:[],server_replay_ignore_payload_params:[],server_replay_ignore_port:!1,server_replay_kill_extra:!1,server_replay_nopop:!1,server_replay_refresh:!0,server_replay_reuse:!1,server_replay_use_headers:[],show_ignored_hosts:!1,showhost:!1,ssl_insecure:!1,ssl_verify_upstream_trusted_ca:void 0,ssl_verify_upstream_trusted_confdir:void 0,stickyauth:void 0,stickycookie:void 0,store_streamed_bodies:!1,stream_large_bodies:void 0,strip_ech:!0,tcp_hosts:[],tcp_timeout:600,termlog_verbosity:"info",tls_ecdh_curve_client:void 0,tls_ecdh_curve_server:void 0,tls_version_client_max:"UNBOUNDED",tls_version_client_min:"TLS1_2",tls_version_server_max:"UNBOUNDED",tls_version_server_min:"TLS1_2",udp_hosts:[],upstream_auth:void 0,upstream_cert:!0,validate_inbound_headers:!0,view_filter:void 0,view_order:"time",view_order_reversed:!1,web_columns:["tls","icon","path","method","status","size","time"],web_debug:!1,web_host:"127.0.0.1",web_open_browser:!0,web_password:"",web_port:8081,web_static_viewer:"",websocket:!0},Yt=ve("OPTIONS_RECEIVE"),Rs=ve("OPTIONS_UPDATE"),zc=ae({name:"options",initialState:Kc,reducers:{},extraReducers:t=>{t.addCase(Yt,(e,s)=>{const i={};for(const[r,{value:n}]of Object.entries(s.payload))i[r]=n;return i}).addCase(Rs,(e,s)=>{for(const[i,{value:r}]of Object.entries(s.payload))e[i]=r})}}),Gc=zc.reducer;async function Qc(t,e,s){try{const i=await ne.put("/options",{[t]:e});if(i.status===200)s(Ic({option:t}));else throw await i.text()}catch(i){s(Lc({option:t,error:i.toString()}))}}const Yc=Qc;function As(t,e){return s=>{s(Fc({option:t,value:e})),Yc(t,e,s)}}const Jc={visible:!1},Xc=ae({name:"commandBar",initialState:Jc,reducers:{toggleVisibility(t){t.visible=!t.visible}}}),{actions:Zc,reducer:ea}=Xc,{toggleVisibility:rr}=Zc,Ve=ve("STATE_RECEIVE"),Ue=ve("STATE_UPDATE"),ta={available:!1,version:"",contentViews:[],servers:{},platform:"",localModeUnavailable:null},sa=ae({name:"backendState",initialState:ta,reducers:{},extraReducers:t=>{t.addCase(Ve,(e,s)=>({...e,available:!0,...s.payload})).addCase(Ue,(e,s)=>({...e,...s.payload}))}}),na=sa.reducer,ia={},ra=ae({name:"optionsMeta",initialState:ia,reducers:{},extraReducers:t=>{t.addCase(Yt,(e,s)=>s.payload).addCase(Rs,(e,s)=>({...e,...s.payload}))}}),oa=ra.reducer,dt=(t,e)=>e.listen_host&&e.listen_port?`${t}@${e.listen_host}:${e.listen_port}`:e.listen_port?`${t}@${e.listen_port}`:t,or=t=>{let[e,s]=gs(t,"@");e||(e=s,s="");const[i,r]=Ci(e,":");let n,l;if(s){let a;if(s.includes(":")?[n,a]=gs(s,":"):(n="",a=s),a&&(l=parseInt(a,10),isNaN(l)||l<0||l>65535))throw new Error(`invalid port: ${a}`)}return{full_spec:t,name:i,data:r,listen_host:n,listen_port:l}},lr=t=>dt("regular",t),si=({listen_host:t,listen_port:e})=>({ui_id:Math.random(),active:!0,listen_host:t,listen_port:e}),cr=t=>t.selectedProcesses?`local:${t.selectedProcesses}`:"local",ni=({data:t})=>({ui_id:Math.random(),active:!0,selectedProcesses:t}),ar=t=>{const e=t.file_path?`wireguard:${t.file_path}`:"wireguard";return dt(e,t)},ii=({data:t,listen_host:e,listen_port:s})=>({ui_id:Math.random(),active:!0,listen_host:e,listen_port:s,file_path:t});var Jt=(t=>(t.HTTP="http",t.HTTPS="https",t.HTTP3="http3",t.TLS="tls",t.DTLS="dtls",t.TCP="tcp",t.UDP="udp",t.DNS="dns",t.QUIC="quic",t))(Jt||{}),ot=(t=>(t.CSS="css",t.JAVASCRIPT="javascript",t.XML="xml",t.YAML="yaml",t.NONE="none",t.ERROR="error",t))(ot||{});const xs=()=>({active:!1,protocol:Jt.HTTPS,destination:"",ui_id:Math.random()}),Ds=t=>dt(`reverse:${t.protocol}://${t.destination}`,t),la=({data:t,listen_host:e,listen_port:s})=>{let[i,r]=Ci(t,"://");return r||(r=i,i=Jt.HTTPS),{ui_id:Math.random(),active:!0,protocol:i,destination:r,listen_host:e,listen_port:s}},dr=t=>dt("transparent",t),ri=({listen_host:t,listen_port:e})=>({ui_id:Math.random(),active:!0,listen_host:t,listen_port:e}),fr=t=>dt("socks5",t),oi=({listen_host:t,listen_port:e})=>({ui_id:Math.random(),active:!0,listen_host:t,listen_port:e}),ur=t=>dt(`upstream:${t.destination}`,t),li=({data:t,listen_host:e,listen_port:s})=>({ui_id:Math.random(),active:!0,destination:t||"",listen_host:e,listen_port:s}),pr=t=>dt("dns",t),ci=({listen_host:t,listen_port:e})=>({ui_id:Math.random(),active:!0,listen_host:t,listen_port:e}),Xe=t=>t.active&&!t.error;async function ca(t,e){const s=e.getState().modes,i=[...s.regular.filter(Xe).map(lr),...s.local.filter(Xe).map(cr),...s.wireguard.filter(Xe).map(ar),...s.reverse.filter(Xe).map(Ds),...s.transparent.filter(Xe).map(dr),...s.socks.filter(Xe).map(fr),...s.upstream.filter(Xe).map(ur),...s.dns.filter(Xe).map(pr)],r=await ne.put("/options",{mode:i});if(r.status!==200)throw new Error(await r.text())}function ie(t){return Nc(t,ca)}function se(t,e,s){t.addCase(s.pending,(i,r)=>{const{server:n,value:l}=r.meta.arg,a=i.findIndex(d=>d.ui_id===n.ui_id);a>=0&&(i[a][e]=l,i[a].error=void 0)}),t.addCase(s.rejected,(i,r)=>{const{server:n}=r.meta.arg,l=i.findIndex(a=>a.ui_id===n.ui_id);l>=0&&(i[l].error=r.error.message)})}function ye(t,e){return function(i,r){if(r.payload.servers){const n=Object.values(r.payload.servers).filter(l=>l.type===t).map(l=>or(l.full_spec));if(n.length>0)return n.map(e);for(const l of i)l.active=!1}}}const hr=ie("modes/regular/setActive"),mr=ie("modes/regular/setListenHost"),gr=ie("modes/regular/setListenPort"),aa=[{active:!0,ui_id:Math.random()}],da=ae({name:"modes/regular",initialState:aa,reducers:{},extraReducers:t=>{se(t,"active",hr),se(t,"listen_host",mr),se(t,"listen_port",gr),t.addCase(Ve,ye("regular",si)),t.addCase(Ue,ye("regular",si))}}),fa=da.reducer,xr=ie("modes/local/setActive"),$t=ie("modes/local/setSelectedProcesses"),ua=[{active:!1,selectedProcesses:"",ui_id:Math.random()}],pa=ae({name:"modes/local",initialState:ua,reducers:{},extraReducers:t=>{se(t,"active",xr),se(t,"selectedProcesses",$t),t.addCase(Ve,ye("local",ni)),t.addCase(Ue,ye("local",ni))}}),ha=pa.reducer,vr=ie("modes/wireguard/setActive"),_r=ie("modes/wireguard/setListenHost"),jr=ie("modes/wireguard/setListenPort"),yr=ie("modes/wireguard/setFilePath"),ma=[{active:!1,ui_id:Math.random()}],ga=ae({name:"modes/wireguard",initialState:ma,reducers:{},extraReducers:t=>{se(t,"active",vr),se(t,"listen_host",_r),se(t,"listen_port",jr),se(t,"file_path",yr),t.addCase(Ve,ye("wireguard",ii)),t.addCase(Ue,ye("wireguard",ii))}}),xa=ga.reducer,vs=ie("modes/reverse/setActive"),br=ie("modes/reverse/setListenHost"),wr=ie("modes/reverse/setListenPort"),Sr=ie("modes/reverse/setProtocol"),$r=ie("modes/reverse/setDestination"),va=[xs()],Cr=ae({name:"modes/reverse",initialState:va,reducers:{addServer:t=>{t.push(xs())},removeServer:(t,e)=>{const s=t.findIndex(i=>i.ui_id===e.payload.ui_id);s!==-1&&(t[s].active&&console.error("servers should be deactivated before removal"),t.splice(s,1))}},extraReducers:t=>{se(t,"active",vs),se(t,"listen_host",br),se(t,"listen_port",wr),se(t,"protocol",Sr),se(t,"destination",$r),t.addCase(Ve,e),t.addCase(Ue,e);function e(s,i){if(i.payload.servers){const r=Object.fromEntries(Object.entries(i.payload.servers).filter(([l,a])=>a.type==="reverse").map(([l,a])=>[l,or(l)])),n=[];for(const l of s){const a=Ds(l),d=a in r;delete r[a],n.push({...l,active:d})}for(const l of Object.values(r))n.push(la(l));return n.length>1&&Gt({...n[0],ui_id:void 0},{...xs(),ui_id:void 0})&&n.shift(),n}}}}),{addServer:_a,removeServer:ja}=Cr.actions,ya=Cr.reducer,Nr=ie("modes/transparent/setActive"),kr=ie("modes/transparent/setListenHost"),Er=ie("modes/transparent/setListenPort"),ba=[{active:!1,ui_id:Math.random()}],wa=ae({name:"modes/transparent",initialState:ba,reducers:{},extraReducers:t=>{se(t,"active",Nr),se(t,"listen_host",kr),se(t,"listen_port",Er),t.addCase(Ve,ye("transparent",ri)),t.addCase(Ue,ye("transparent",ri))}}),Sa=wa.reducer,Tr=ie("modes/socks5/setActive"),Rr=ie("modes/socks5/setListenHost"),Ar=ie("modes/socks5/setListenPort"),$a=[{active:!1,ui_id:Math.random()}],Ca=ae({name:"modes/socks5",initialState:$a,reducers:{},extraReducers:t=>{se(t,"active",Tr),se(t,"listen_host",Rr),se(t,"listen_port",Ar),t.addCase(Ve,ye("socks5",oi)),t.addCase(Ue,ye("socks5",oi))}}),Na=Ca.reducer,Dr=ie("modes/upstream/setActive"),Fr=ie("modes/upstream/setListenHost"),Ir=ie("modes/upstream/setListenPort"),Lr=ie("modes/upstream/setDestination"),ka=[{active:!1,destination:"",ui_id:Math.random()}],Ea=ae({name:"modes/upstream",initialState:ka,reducers:{},extraReducers:t=>{se(t,"active",Dr),se(t,"listen_host",Fr),se(t,"listen_port",Ir),se(t,"destination",Lr),t.addCase(Ve,ye("upstream",li)),t.addCase(Ue,ye("upstream",li))}}),Ta=Ea.reducer,Pr=ie("modes/dns/setActive"),Mr=ie("modes/dns/setListenHost"),Or=ie("modes/dns/setListenPort"),Ra=[{active:!0,ui_id:Math.random()}],Aa=ae({name:"modes/dns",initialState:Ra,reducers:{},extraReducers:t=>{se(t,"active",Pr),se(t,"listen_host",Mr),se(t,"listen_port",Or),t.addCase(Ve,ye("dns",ci)),t.addCase(Ue,ye("dns",ci))}}),Da=Aa.reducer,Fa=_i({regular:fa,local:ha,wireguard:xa,reverse:ya,transparent:Sa,socks:Na,upstream:Ta,dns:Da}),Ct=vi("fetchProcesses",async(t,{rejectWithValue:e})=>{try{return(await ne("/processes")).json()}catch(s){return e(s.message)}}),Ia={currentProcesses:[],isLoading:!1},La=ae({name:"processes",initialState:Ia,reducers:{},extraReducers:t=>{t.addCase(Ct.pending,e=>{e.isLoading=!0,e.error=void 0}),t.addCase(Ct.fulfilled,(e,s)=>{e.isLoading=!1,e.currentProcesses=s.payload}),t.addCase(Ct.rejected,(e,s)=>{e.isLoading=!1,e.error=s.payload})}}),Pa=La.reducer,Ma={commandBar:ea,eventLog:Ec,flows:_c,connection:Wc,modes:Fa,ui:qc,options:Gc,options_meta:oa,backendState:na,processes:Pa},Oa={immutableCheck:{warnAfter:5e5},serializableCheck:{warnAfter:5e5,ignoredPaths:["flows"]}},kt=Ol({reducer:Ma,middleware:t=>t(Oa),devTools:!1});class qa extends I.Component{container=Ee.createRef();nameInput=Ee.createRef();valueInput=Ee.createRef();render=()=>{const[e,s]=this.props.item;return o.jsxs("div",{ref:this.container,className:"kv-row",onClick:this.onClick,onKeyDownCapture:this.onKeyDown,children:[o.jsx(le,{ref:this.nameInput,className:"kv-key",content:e,onEditStart:this.props.onEditStart,onEditDone:i=>this.props.onEditDone([i,s]),selectAllOnClick:!0}),": ",o.jsx(le,{ref:this.valueInput,className:"kv-value",content:s,onEditStart:this.props.onEditStart,onEditDone:i=>this.props.onEditDone([e,i]),placeholder:"empty",selectAllOnClick:!0})]})};onClick=e=>{e.target===this.container.current&&this.props.onClickEmptyArea()};onKeyDown=e=>{e.target===this.valueInput.current?.input.current&&e.key==="Tab"&&this.props.onTabNext()}}class qr extends I.Component{rowRefs={};currentlyEditing;justFinishedEditing;state={currentList:this.props.data||[],initialList:this.props.data};static getDerivedStateFromProps(e,s){return e.data!==s.initialList?{currentList:e.data||[],initialList:e.data}:null}render=()=>{this.rowRefs={};const e=this.state.currentList.map((s,i)=>o.jsx(qa,{item:s,onEditStart:()=>this.currentlyEditing=i,onEditDone:r=>this.onEditDone(i,r),onClickEmptyArea:()=>this.onClickEmptyArea(i),onTabNext:()=>this.onTabNext(i),ref:r=>{this.rowRefs[i]=r}},i));return o.jsxs("div",{className:_e("kv-editor",this.props.className),onMouseDown:this.onMouseDown,children:[e,o.jsx("div",{onClick:s=>{s.preventDefault(),this.onClickEmptyArea(this.state.currentList.length-1)},className:"kv-add-row fa fa-plus-square-o",role:"button","aria-label":"Add"})]})};onEditDone=(e,s)=>{const i=[...this.state.currentList];s[0]?i[e]=s:i.splice(e,1),this.currentlyEditing=void 0,Ut.isEqual(this.state.currentList,i)||this.props.onChange(i),this.setState({currentList:i})};onClickEmptyArea=e=>{if(this.justFinishedEditing)return;const s=[...this.state.currentList];s.splice(e+1,0,["",""]),this.setState({currentList:s},()=>this.rowRefs[e+1]?.nameInput.current?.startEditing())};onTabNext=e=>{e==this.state.currentList.length-1&&this.onClickEmptyArea(e)};onMouseDown=e=>{this.justFinishedEditing=this.currentlyEditing}}function Hr(t,e){const s=E.c(6),[i,r]=I.useState(),[n,l]=I.useState();let a;s[0]!==n||s[1]!==t?(a=()=>{n&&n.abort();const f=new AbortController;return ne(t,{signal:f.signal}).then(Ha).then(h=>{r(h)}).catch(h=>{f.signal.aborted||r(`Error getting content: ${h}.`)}),l(f),()=>{f.signal.aborted||f.abort()}},s[0]=n,s[1]=t,s[2]=a):a=s[2];let d;return s[3]!==e||s[4]!==t?(d=[t,e],s[3]=e,s[4]=t,s[5]=d):d=s[5],I.useEffect(a,d),i}function Ha(t){if(!t.ok)throw`${t.status} ${t.statusText}`.trim();return t.text()}function Vr(t,e,s,i,r){const n=E.c(11);let l;n[0]!==t||n[1]!==i||n[2]!==e||n[3]!==s?(l=je.getContentURL(t,e,s,i),n[0]=t,n[1]=i,n[2]=e,n[3]=s,n[4]=l):l=n[4];const d=Hr(l,r);let f;if(d)try{let h;n[5]!==d?(h=JSON.parse(d),n[5]=d,n[6]=h):h=n[6],f=h}catch{let h;n[7]!==d?(h={text:d,description:"Network Error",syntax_highlight:"error",view_name:"raw"},n[7]=d,n[8]=h):h=n[8];const p=h;if(e==="messages"){let g;n[9]!==p?(g=[p],n[9]=p,n[10]=g):g=n[10],f=g}else f=p}else f=void 0;return f}const Ur=Ee.memo(function({icon:e,text:s,className:i,title:r,onOpenFile:n,onClick:l}){let a;return o.jsxs("a",{href:"#",onClick:d=>{a.click(),l&&l(d)},className:i,title:r,children:[o.jsx("i",{className:"fa fa-fw "+e}),s,o.jsx("input",{ref:d=>{a=d},className:"hidden",type:"file",onChange:d=>{d.preventDefault(),d.target.files&&d.target.files.length>0&&n(d.target.files[0]),a.value=""}})]})});function ue(t){const e=E.c(11),{onClick:s,children:i,icon:r,disabled:n,className:l,title:a}=t;let d;e[0]!==l?(d=_e(l,"btn btn-default"),e[0]=l,e[1]=d):d=e[1];const f=n?void 0:s;let h;e[2]!==r?(h=r&&o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fa "+r})," "]}),e[2]=r,e[3]=h):h=e[3];let p;return e[4]!==i||e[5]!==n||e[6]!==d||e[7]!==f||e[8]!==h||e[9]!==a?(p=o.jsxs("button",{className:d,onClick:f,disabled:n,title:a,children:[h,i]}),e[4]=i,e[5]=n,e[6]=d,e[7]=f,e[8]=h,e[9]=a,e[10]=p):p=e[10],p}function Va(t){const e=E.c(11),{initialContent:s,onChange:i,language:r,readonly:n}=t,l=n===void 0?!1:n,a=Ua;let d;e:switch(r){case ot.YAML:{let p;e[0]===Symbol.for("react.memo_cache_sentinel")?(p=[Ul()],e[0]=p):p=e[0],d=p;break e}case ot.XML:{let p;e[1]===Symbol.for("react.memo_cache_sentinel")?(p=[Vl()],e[1]=p):p=e[1],d=p;break e}case ot.JAVASCRIPT:{let p;e[2]===Symbol.for("react.memo_cache_sentinel")?(p=[Hl()],e[2]=p):p=e[2],d=p;break e}case ot.CSS:{let p;e[3]===Symbol.for("react.memo_cache_sentinel")?(p=[ql()],e[3]=p):p=e[3],d=p;break e}case void 0:case null:case ot.NONE:case ot.ERROR:{let p;e[4]===Symbol.for("react.memo_cache_sentinel")?(p=[],e[4]=p):p=e[4],d=p;break e}default:{console.error("Unexpected syntax highlighting language: ",r);let g;e[5]===Symbol.for("react.memo_cache_sentinel")?(g=[],e[5]=g):g=e[5],d=g}}const f=d;let h;return e[6]!==f||e[7]!==s||e[8]!==i||e[9]!==l?(h=o.jsx("div",{className:"codeeditor",onKeyDown:a,children:o.jsx(Bl,{value:s,onChange:i,readOnly:l,extensions:f})}),e[6]=f,e[7]=s,e[8]=i,e[9]=l,e[10]=h):h=e[10],h}function Ua(t){return t.stopPropagation()}const Br=Ee.memo(function(e){const s=E.c(9),{content:i,maxLines:r,showMore:n}=e;if(i.length===0)return null;let l;if(s[0]!==i||s[1]!==r||s[2]!==n){let d;s[4]!==r||s[5]!==n?(d=(f,h)=>h===r?o.jsxs("button",{onClick:n,className:"btn btn-xs btn-info",children:[o.jsx("i",{className:"fa fa-angle-double-down","aria-hidden":"true"})," ","Show more"]},"showmore"):o.jsx("div",{children:f},h),s[4]=r,s[5]=n,s[6]=d):d=s[6],l=i.split(`
`).map(d),s[0]=i,s[1]=r,s[2]=n,s[3]=l}else l=s[3];let a;return s[7]!==l?(a=o.jsx("pre",{children:l}),s[7]=l,s[8]=a):a=s[8],a}),Ba=()=>{const t=E.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=o.jsx("li",{role:"separator",className:"divider"}),t[0]=e):e=t[0],e};function Ne(t){const e=E.c(8);let s,i,r;if(e[0]!==t){const{onClick:a,children:d,...f}=t;i=d,s=f,r=h=>{h.preventDefault(),a()},e[0]=t,e[1]=s,e[2]=i,e[3]=r}else s=e[1],i=e[2],r=e[3];const n=r;let l;return e[4]!==s||e[5]!==i||e[6]!==n?(l=o.jsx("li",{children:o.jsx("a",{href:"#",onClick:n,...s,children:i})}),e[4]=s,e[5]=i,e[6]=n,e[7]=l):l=e[7],l}const Rt=Ee.memo(function({text:e,children:s,options:i,className:r,onOpen:n,...l}){const[a,d]=I.useState(!1),{refs:f,floatingStyles:h}=Wl(i),p=x=>{d(x),n&&n(x)};I.useEffect(()=>{f.floating.current&&document.addEventListener("click",x=>{f.floating.current?.contains(x.target)?document.addEventListener("click",()=>p(!1),{once:!0}):(x.preventDefault(),x.stopPropagation(),p(!1))},{once:!0,capture:!0})},[f.floating.current]);let g;return a?g=o.jsx("ul",{className:"dropdown-menu show",ref:f.setFloating,style:h,children:s}):g=null,o.jsxs(o.Fragment,{children:[o.jsx("a",{href:"#",ref:f.setReference,className:_e(r,{open:a}),onClick:x=>{x.preventDefault(),p(!0)},...l,children:e}),g]})});function Wr(t){const e=E.c(16),{value:s,onChange:i}=t,r=D(Wa);let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=o.jsx("i",{className:"fa fa-fw fa-files-o"}),e[0]=n):n=e[0];let l;e[1]===Symbol.for("react.memo_cache_sentinel")?(l=o.jsx("b",{children:"View:"}),e[1]=l):l=e[1];let a;e[2]!==s?(a=s.toLowerCase(),e[2]=s,e[3]=a):a=e[3];let d;e[4]===Symbol.for("react.memo_cache_sentinel")?(d=o.jsx("span",{className:"caret"}),e[4]=d):d=e[4];let f;e[5]!==a?(f=o.jsxs("span",{children:[n," ",l," ",a," ",d]}),e[5]=a,e[6]=f):f=e[6];const h=f;let p;e[7]===Symbol.for("react.memo_cache_sentinel")?(p={placement:"top-end"},e[7]=p):p=e[7];let g;if(e[8]!==r||e[9]!==i){let j;e[11]!==i?(j=y=>o.jsx(Ne,{onClick:()=>i(y),children:y.toLowerCase().replace("_"," ")},y),e[11]=i,e[12]=j):j=e[12],g=r.map(j),e[8]=r,e[9]=i,e[10]=g}else g=e[10];let x;return e[13]!==h||e[14]!==g?(x=o.jsx(Rt,{text:h,className:"btn btn-default btn-xs",options:p,children:g}),e[13]=h,e[14]=g,e[15]=x):x=e[15],x}function Wa(t){return t.backendState.contentViews||[]}function Ka(t){const e=E.c(8),{flow:s,message:i}=t,[r,n]=I.useState(!1);if(r){let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=()=>n(!1),e[0]=l):l=e[0];let a;return e[1]!==s||e[2]!==i?(a=o.jsx(za,{flow:s,message:i,stopEdit:l}),e[1]=s,e[2]=i,e[3]=a):a=e[3],a}else{let l;e[4]===Symbol.for("react.memo_cache_sentinel")?(l=()=>n(!0),e[4]=l):l=e[4];let a;return e[5]!==s||e[6]!==i?(a=o.jsx(Ga,{flow:s,message:i,startEdit:l}),e[5]=s,e[6]=i,e[7]=a):a=e[7],a}}function za(t){const e=E.c(23),{flow:s,message:i,stopEdit:r}=t,n=Q(),l=s.request===i?"request":"response";let a;e[0]!==s||e[1]!==i?(a=je.getContentURL(s,i),e[0]=s,e[1]=i,e[2]=a):a=e[2];const f=Hr(a,i.contentHash),[h,p]=I.useState();let g;e[3]!==f||e[4]!==n||e[5]!==h||e[6]!==s||e[7]!==l||e[8]!==r?(g=async()=>{await n(Ie(s,{[l]:{content:h||f||""}})),r()},e[3]=f,e[4]=n,e[5]=h,e[6]=s,e[7]=l,e[8]=r,e[9]=g):g=e[9];const x=g;let j;e[10]===Symbol.for("react.memo_cache_sentinel")?(j=o.jsx("h5",{children:"[Editing]"}),e[10]=j):j=e[10];let y;e[11]!==x?(y=o.jsx(ue,{onClick:x,icon:"fa-check text-success",className:"btn-xs",children:"Done"}),e[11]=x,e[12]=y):y=e[12];let b;e[13]!==r?(b=o.jsx(ue,{onClick:()=>r(),icon:"fa-times text-danger",className:"btn-xs",children:"Cancel"}),e[13]=r,e[14]=b):b=e[14];let $;e[15]!==y||e[16]!==b?($=o.jsxs("div",{className:"controls",children:[j,y," ",b]}),e[15]=y,e[16]=b,e[17]=$):$=e[17];const C=f||"";let k;e[18]!==C?(k=o.jsx(Va,{initialContent:C,onChange:p}),e[18]=C,e[19]=k):k=e[19];let T;return e[20]!==$||e[21]!==k?(T=o.jsxs("div",{className:"contentview",children:[$,k]},"edit"),e[20]=$,e[21]=k,e[22]=T):T=e[22],T}function Ga(t){const e=E.c(43),{flow:s,message:i,startEdit:r}=t,n=Q(),l=s.request===i?"request":"response";let a;e[0]!==s.id||e[1]!==l?(a=q=>q.ui.flow.contentViewFor[s.id+l]||"Auto",e[0]=s.id,e[1]=l,e[2]=a):a=e[2];const d=D(a),[f,h]=I.useState(D(Qa));let p;e[3]!==f?(p=()=>h(Math.max(1024,f*2)),e[3]=f,e[4]=p):p=e[4];const g=p,x=Vr(s,i,d,f+1,i.contentHash);let j;if(i.contentLength===0)j="No content";else if(x===void 0)j="Loading...";else{const q=`${x.view_name} ${x.description}`;let B;e[5]!==q?(B=q.trimEnd(),e[5]=q,e[6]=B):B=e[6],j=B}let y;e[7]!==j?(y=o.jsx("h5",{children:j}),e[7]=j,e[8]=y):y=e[8];let b;e[9]!==x||e[10]!==s||e[11]!==i?(b=x&&x?.text.length>0&&o.jsx(Ya,{flow:s,message:i}),e[9]=x,e[10]=s,e[11]=i,e[12]=b):b=e[12];let $;e[13]!==r?($=o.jsx(ue,{onClick:r,icon:"fa-edit",className:"btn-xs",children:"Edit"}),e[13]=r,e[14]=$):$=e[14];let C;e[15]!==n||e[16]!==s||e[17]!==l?(C=o.jsx(Ur,{icon:"fa-upload",text:"Replace",title:"Upload a file to replace the content.",onOpenFile:q=>n(gc(s,q,l)),className:"btn btn-default btn-xs"}),e[15]=n,e[16]=s,e[17]=l,e[18]=C):C=e[18];let k;e[19]!==n||e[20]!==s.id||e[21]!==l?(k=q=>n(bi({messageId:s.id+l,contentView:q})),e[19]=n,e[20]=s.id,e[21]=l,e[22]=k):k=e[22];let T;e[23]!==d||e[24]!==k?(T=o.jsx(Wr,{value:d,onChange:k}),e[23]=d,e[24]=k,e[25]=T):T=e[25];let P;e[26]!==y||e[27]!==b||e[28]!==$||e[29]!==C||e[30]!==T?(P=o.jsxs("div",{className:"controls",children:[y,b," ",$," ",C," ",T]}),e[26]=y,e[27]=b,e[28]=$,e[29]=C,e[30]=T,e[31]=P):P=e[31];let L;e[32]!==s||e[33]!==i?(L=_s.matches(i)&&o.jsx(_s,{flow:s,message:i}),e[32]=s,e[33]=i,e[34]=L):L=e[34];const M=x?.text??"";let O;e[35]!==f||e[36]!==g||e[37]!==M?(O=o.jsx(Br,{content:M,maxLines:f,showMore:g}),e[35]=f,e[36]=g,e[37]=M,e[38]=O):O=e[38];let H;return e[39]!==L||e[40]!==O||e[41]!==P?(H=o.jsxs("div",{className:"contentview",children:[P,L,O]},"view"),e[39]=L,e[40]=O,e[41]=P,e[42]=H):H=e[42],H}function Qa(t){return t.options.content_view_lines_cutoff}function Ya({flow:t,message:e}){const s=t.request===e?"request":"response",i=D(f=>f.ui.flow.contentViewFor[t.id+s]||"Auto"),[r,n]=I.useState(!1),[l,a]=I.useState(!1),d=async()=>{try{const f=je.getContentURL(t,e,i);a(!0);const h=await ne(f);if(!h.ok)throw new Error(`${h.status} ${h.statusText}`.trim());const p=await h.json();await oc(p),n(!0),setTimeout(()=>n(!1),2e3)}catch(f){console.error(f)}finally{a(!1)}};return o.jsx(ue,{onClick:d,icon:"fa-clipboard",className:"btn-xs",disabled:l,children:r?"Copied!":"Copy"})}const Ja=/^image\/(png|jpe?g|gif|webp|vnc.microsoft.icon|x-icon|svg\+xml)$/i;_s.matches=t=>Ja.test(je.getContentType(t)||"");function _s(t){const e=E.c(5),{flow:s,message:i}=t;let r;e[0]!==s||e[1]!==i?(r=je.getContentURL(s,i),e[0]=s,e[1]=i,e[2]=r):r=e[2];let n;return e[3]!==r?(n=o.jsx("div",{className:"flowview-image",children:o.jsx("img",{src:r,alt:"preview",className:"img-thumbnail"})}),e[3]=r,e[4]=n):n=e[4],n}function Xa(t){const e=E.c(24),{flow:s}=t,i=Q();let r;e[0]!==i||e[1]!==s?(r=g=>i(Ie(s,{request:{method:g}})),e[0]=i,e[1]=s,e[2]=r):r=e[2];let n;e[3]!==s.request.method||e[4]!==r?(n=o.jsx(St,{content:s.request.method,onEditDone:r,isValid:ed,selectAllOnClick:!0}),e[3]=s.request.method,e[4]=r,e[5]=n):n=e[5];let l;e[6]!==s.request?(l=ct.pretty_url(s.request),e[6]=s.request,e[7]=l):l=e[7];let a;e[8]!==i||e[9]!==s?(a=g=>i(Ie(s,{request:{path:"",...ki(g)}})),e[8]=i,e[9]=s,e[10]=a):a=e[10];let d;e[11]!==l||e[12]!==a?(d=o.jsx(St,{content:l,onEditDone:a,isValid:Za}),e[11]=l,e[12]=a,e[13]=d):d=e[13];let f;e[14]!==i||e[15]!==s?(f=g=>i(Ie(s,{request:{http_version:g}})),e[14]=i,e[15]=s,e[16]=f):f=e[16];let h;e[17]!==s.request.http_version||e[18]!==f?(h=o.jsx(St,{content:s.request.http_version,onEditDone:f,isValid:Ei,selectAllOnClick:!0}),e[17]=s.request.http_version,e[18]=f,e[19]=h):h=e[19];let p;return e[20]!==n||e[21]!==d||e[22]!==h?(p=o.jsx("div",{className:"first-line request-line",children:o.jsxs("div",{children:[n," ",d," ",h]})}),e[20]=n,e[21]=d,e[22]=h,e[23]=p):p=e[23],p}function Za(t){return!!ki(t)?.host}function ed(t){return t.length>0}function td(t){const e=E.c(19),{flow:s}=t,i=Q();let r;e[0]!==i||e[1]!==s?(r=p=>i(Ie(s,{response:{http_version:p}})),e[0]=i,e[1]=s,e[2]=r):r=e[2];let n;e[3]!==s.response.http_version||e[4]!==r?(n=o.jsx(St,{content:s.response.http_version,onEditDone:r,isValid:Ei,selectAllOnClick:!0}),e[3]=s.response.http_version,e[4]=r,e[5]=n):n=e[5];const l=s.response.status_code+"";let a;e[6]!==i||e[7]!==s?(a=p=>i(Ie(s,{response:{code:parseInt(p)}})),e[6]=i,e[7]=s,e[8]=a):a=e[8];let d;e[9]!==l||e[10]!==a?(d=o.jsx(St,{content:l,onEditDone:a,isValid:sd,selectAllOnClick:!0}),e[9]=l,e[10]=a,e[11]=d):d=e[11];let f;e[12]!==i||e[13]!==s?(f=s.response.http_version!=="HTTP/2.0"&&o.jsxs(o.Fragment,{children:[" ",o.jsx(le,{content:s.response.reason,onEditDone:p=>i(Ie(s,{response:{msg:p}})),selectAllOnClick:!0})]}),e[12]=i,e[13]=s,e[14]=f):f=e[14];let h;return e[15]!==n||e[16]!==d||e[17]!==f?(h=o.jsxs("div",{className:"first-line response-line",children:[n," ",d,f]}),e[15]=n,e[16]=d,e[17]=f,e[18]=h):h=e[18],h}function sd(t){return/^\d+$/.test(t)}function nd(t){const e=E.c(7),{flow:s,message:i}=t,r=Q(),n=s.request===i?"request":"response";let l;e[0]!==r||e[1]!==s||e[2]!==n?(l=d=>r(Ie(s,{[n]:{headers:d}})),e[0]=r,e[1]=s,e[2]=n,e[3]=l):l=e[3];let a;return e[4]!==i.headers||e[5]!==l?(a=o.jsx(qr,{className:"headers",data:i.headers,onChange:l}),e[4]=i.headers,e[5]=l,e[6]=a):a=e[6],a}function id(t){const e=E.c(9),{flow:s,message:i}=t,r=Q(),n=s.request===i?"request":"response";if(!!!je.get_first_header(i,/^trailer$/i))return null;let a,d;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=o.jsx("hr",{}),d=o.jsx("h5",{children:"HTTP Trailers"}),e[0]=a,e[1]=d):(a=e[0],d=e[1]);let f;e[2]!==r||e[3]!==s||e[4]!==n?(f=p=>r(Ie(s,{[n]:{trailers:p}})),e[2]=r,e[3]=s,e[4]=n,e[5]=f):f=e[5];let h;return e[6]!==i.trailers||e[7]!==f?(h=o.jsxs(o.Fragment,{children:[a,d,o.jsx(qr,{className:"trailers",data:i.trailers,onChange:f})]}),e[6]=i.trailers,e[7]=f,e[8]=h):h=e[8],h}const Kr=I.memo(function(e){const s=E.c(20),{flow:i,message:r}=e,n=i.request===r?"request":"response",l=i.request===r?Xa:td;let a;s[0]!==l||s[1]!==i?(a=o.jsx(l,{flow:i}),s[0]=l,s[1]=i,s[2]=a):a=s[2];let d;s[3]!==i||s[4]!==r?(d=o.jsx(nd,{flow:i,message:r}),s[3]=i,s[4]=r,s[5]=d):d=s[5];let f;s[6]===Symbol.for("react.memo_cache_sentinel")?(f=o.jsx("hr",{}),s[6]=f):f=s[6];const h=i.id+n;let p;s[7]!==i||s[8]!==r||s[9]!==h?(p=o.jsx(Ka,{flow:i,message:r},h),s[7]=i,s[8]=r,s[9]=h,s[10]=p):p=s[10];let g;s[11]!==i||s[12]!==r?(g=o.jsx(id,{flow:i,message:r}),s[11]=i,s[12]=r,s[13]=g):g=s[13];let x;return s[14]!==n||s[15]!==a||s[16]!==d||s[17]!==p||s[18]!==g?(x=o.jsxs("section",{className:n,children:[a,d,f,p,g]}),s[14]=n,s[15]=a,s[16]=d,s[17]=p,s[18]=g,s[19]=x):x=s[19],x});function zr(){const t=E.c(2),e=D(rd);let s;return t[0]!==e?(s=o.jsx(Kr,{flow:e,message:e.request}),t[0]=e,t[1]=s):s=t[1],s}function rd(t){return t.flows.selected[0]}zr.displayName="Request";function Gr(){const t=E.c(2),e=D(od);let s;return t[0]!==e?(s=o.jsx(Kr,{flow:e,message:e.response}),t[0]=e,t[1]=s):s=t[1],s}function od(t){return t.flows.selected[0]}Gr.displayName="Response";const ld=t=>{const e=E.c(3),{message:s}=t,i=s.query?s.op_code:s.response_code,r=s.truncation?"(Truncated)":"";let n;return e[0]!==i||e[1]!==r?(n=o.jsxs("div",{children:[i," ",r]}),e[0]=i,e[1]=r,e[2]=n):n=e[2],n},cd=t=>{const e=E.c(10),{message:s}=t,i=s.recursion_desired?"Recursive ":"";let r;e[0]!==i?(r=o.jsxs("h5",{children:[i,"Question"]}),e[0]=i,e[1]=r):r=e[1];let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Name"}),o.jsx("th",{children:"Type"}),o.jsx("th",{children:"Class"})]})}),e[2]=n):n=e[2];let l;e[3]!==s.questions?(l=s.questions.map(fd),e[3]=s.questions,e[4]=l):l=e[4];let a;e[5]!==l?(a=o.jsxs("table",{children:[n,o.jsx("tbody",{children:l})]}),e[5]=l,e[6]=a):a=e[6];let d;return e[7]!==r||e[8]!==a?(d=o.jsxs(o.Fragment,{children:[r,a]}),e[7]=r,e[8]=a,e[9]=d):d=e[9],d},cs=t=>{const e=E.c(7),{name:s,values:i}=t;let r;e[0]!==s?(r=o.jsx("h5",{children:s}),e[0]=s,e[1]=r):r=e[1];let n;e[2]!==i?(n=i.length>0?o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Name"}),o.jsx("th",{children:"Type"}),o.jsx("th",{children:"Class"}),o.jsx("th",{children:"TTL"}),o.jsx("th",{children:"Data"})]})}),o.jsx("tbody",{children:i.map(ud)})]}):"—",e[2]=i,e[3]=n):n=e[3];let l;return e[4]!==r||e[5]!==n?(l=o.jsxs(o.Fragment,{children:[r,n]}),e[4]=r,e[5]=n,e[6]=l):l=e[6],l},Qr=t=>{const e=E.c(24),{type:s,message:i}=t,r="dns-"+s,n=`first-line ${s}-line`;let l;e[0]!==i?(l=o.jsx(ld,{message:i}),e[0]=i,e[1]=l):l=e[1];let a;e[2]!==n||e[3]!==l?(a=o.jsx("div",{className:n,children:l}),e[2]=n,e[3]=l,e[4]=a):a=e[4];let d;e[5]!==i?(d=o.jsx(cd,{message:i}),e[5]=i,e[6]=d):d=e[6];let f;e[7]===Symbol.for("react.memo_cache_sentinel")?(f=o.jsx("hr",{}),e[7]=f):f=e[7];const h=`${i.authoritative_answer?"Authoritative ":""}${i.recursion_available?"Recursive ":""}Answer`;let p;e[8]!==i.answers||e[9]!==h?(p=o.jsx(cs,{name:h,values:i.answers}),e[8]=i.answers,e[9]=h,e[10]=p):p=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=o.jsx("hr",{}),e[11]=g):g=e[11];let x;e[12]!==i.authorities?(x=o.jsx(cs,{name:"Authority",values:i.authorities}),e[12]=i.authorities,e[13]=x):x=e[13];let j;e[14]===Symbol.for("react.memo_cache_sentinel")?(j=o.jsx("hr",{}),e[14]=j):j=e[14];let y;e[15]!==i.additionals?(y=o.jsx(cs,{name:"Additional",values:i.additionals}),e[15]=i.additionals,e[16]=y):y=e[16];let b;return e[17]!==r||e[18]!==x||e[19]!==y||e[20]!==a||e[21]!==d||e[22]!==p?(b=o.jsxs("section",{className:r,children:[a,d,f,p,g,x,j,y]}),e[17]=r,e[18]=x,e[19]=y,e[20]=a,e[21]=d,e[22]=p,e[23]=b):b=e[23],b};function Yr(){const t=E.c(2),e=D(ad);let s;return t[0]!==e.request?(s=o.jsx(Qr,{type:"request",message:e.request}),t[0]=e.request,t[1]=s):s=t[1],s}function ad(t){return t.flows.selected[0]}Yr.displayName="Request";function Jr(){const t=E.c(2),e=D(dd);let s;return t[0]!==e.response?(s=o.jsx(Qr,{type:"response",message:e.response}),t[0]=e.response,t[1]=s):s=t[1],s}function dd(t){return t.flows.selected[0]}Jr.displayName="Response";function fd(t,e){return o.jsxs("tr",{children:[o.jsx("td",{children:t.name}),o.jsx("td",{children:t.type}),o.jsx("td",{children:t.class})]},e)}function ud(t,e){return o.jsxs("tr",{children:[o.jsx("td",{children:t.name}),o.jsx("td",{children:t.type}),o.jsx("td",{children:t.class}),o.jsx("td",{children:t.ttl}),o.jsx("td",{children:JSON.stringify(t.data).replace(/^"|"$/g,"")})]},e)}function Ht(t,e){return e?(e=[e[0],e[1]],e[0].includes(":")&&(e[0]=`[${e[0]}]`),o.jsxs("tr",{children:[o.jsxs("td",{children:[t,":"]}),o.jsx("td",{children:e.join(":")})]})):o.jsx(o.Fragment,{})}function ai(t){const e=E.c(26),{conn:s}=t;let i;if("address"in s){let f;e[0]!==s.address?(f=Ht("Address",s.address),e[0]=s.address,e[1]=f):f=e[1];let h;e[2]!==s.peername?(h=Ht("Resolved address",s.peername),e[2]=s.peername,e[3]=h):h=e[3];let p;e[4]!==s.sockname?(p=Ht("Source address",s.sockname),e[4]=s.sockname,e[5]=p):p=e[5];let g;e[6]!==f||e[7]!==h||e[8]!==p?(g=o.jsxs(o.Fragment,{children:[f,h,p]}),e[6]=f,e[7]=h,e[8]=p,e[9]=g):g=e[9],i=g}else{let f;e[10]!==s.peername?(f=Ht("Address",s.peername),e[10]=s.peername,e[11]=f):f=e[11],i=f}let r;e[12]!==s.sni?(r=s.sni?o.jsxs("tr",{children:[o.jsxs("td",{children:[o.jsx("abbr",{title:"TLS Server Name Indication",children:"SNI"}),":"]}),o.jsx("td",{children:s.sni})]}):null,e[12]=s.sni,e[13]=r):r=e[13];let n;e[14]!==s.alpn?(n=s.alpn?o.jsxs("tr",{children:[o.jsxs("td",{children:[o.jsx("abbr",{title:"ALPN protocol negotiated",children:"ALPN"}),":"]}),o.jsx("td",{children:s.alpn})]}):null,e[14]=s.alpn,e[15]=n):n=e[15];let l;e[16]!==s.tls_version?(l=s.tls_version?o.jsxs("tr",{children:[o.jsx("td",{children:"TLS Version:"}),o.jsx("td",{children:s.tls_version})]}):null,e[16]=s.tls_version,e[17]=l):l=e[17];let a;e[18]!==s.cipher?(a=s.cipher?o.jsxs("tr",{children:[o.jsx("td",{children:"TLS Cipher:"}),o.jsx("td",{children:s.cipher})]}):null,e[18]=s.cipher,e[19]=a):a=e[19];let d;return e[20]!==i||e[21]!==r||e[22]!==n||e[23]!==l||e[24]!==a?(d=o.jsx("table",{className:"connection-table",children:o.jsxs("tbody",{children:[i,r,n,l,a]})}),e[20]=i,e[21]=r,e[22]=n,e[23]=l,e[24]=a,e[25]=d):d=e[25],d}function di(t){return o.jsx("dl",{className:"cert-attributes",children:t.map(([e,s])=>o.jsxs(I.Fragment,{children:[o.jsx("dt",{children:e}),o.jsx("dd",{children:s})]},e))})}function pd(t){const e=E.c(46),{flow:s}=t,i=s.server_conn?.cert;if(!i){let B;return e[0]===Symbol.for("react.memo_cache_sentinel")?(B=o.jsx(o.Fragment,{}),e[0]=B):B=e[0],B}let r;e[1]===Symbol.for("react.memo_cache_sentinel")?(r=o.jsx("h4",{children:"Server Certificate"},"name"),e[1]=r):r=e[1];let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=o.jsx("td",{children:"Type"}),e[2]=n):n=e[2];let l;e[3]!==i.keyinfo[0]||e[4]!==i.keyinfo[1]?(l=o.jsxs("tr",{children:[n,o.jsxs("td",{children:[i.keyinfo[0],", ",i.keyinfo[1]," bits"]})]}),e[3]=i.keyinfo[0],e[4]=i.keyinfo[1],e[5]=l):l=e[5];let a;e[6]===Symbol.for("react.memo_cache_sentinel")?(a=o.jsx("td",{children:"SHA256 digest"}),e[6]=a):a=e[6];let d;e[7]!==i.sha256?(d=o.jsxs("tr",{children:[a,o.jsx("td",{children:i.sha256})]}),e[7]=i.sha256,e[8]=d):d=e[8];let f;e[9]===Symbol.for("react.memo_cache_sentinel")?(f=o.jsx("td",{children:"Valid from"}),e[9]=f):f=e[9];let h;e[10]!==i.notbefore?(h=at(i.notbefore,{includeMilliseconds:!1}),e[10]=i.notbefore,e[11]=h):h=e[11];let p;e[12]!==h?(p=o.jsxs("tr",{children:[f,o.jsx("td",{children:h})]}),e[12]=h,e[13]=p):p=e[13];let g;e[14]===Symbol.for("react.memo_cache_sentinel")?(g=o.jsx("td",{children:"Valid to"}),e[14]=g):g=e[14];let x;e[15]!==i.notafter?(x=at(i.notafter,{includeMilliseconds:!1}),e[15]=i.notafter,e[16]=x):x=e[16];let j;e[17]!==x?(j=o.jsxs("tr",{children:[g,o.jsx("td",{children:x})]}),e[17]=x,e[18]=j):j=e[18];let y;e[19]===Symbol.for("react.memo_cache_sentinel")?(y=o.jsx("td",{children:"Subject Alternative Names"}),e[19]=y):y=e[19];let b;e[20]!==i.altnames?(b=i.altnames.join(", "),e[20]=i.altnames,e[21]=b):b=e[21];let $;e[22]!==b?($=o.jsxs("tr",{children:[y,o.jsx("td",{children:b})]}),e[22]=b,e[23]=$):$=e[23];let C;e[24]===Symbol.for("react.memo_cache_sentinel")?(C=o.jsx("td",{children:"Subject"}),e[24]=C):C=e[24];let k;e[25]!==i.subject?(k=di(i.subject),e[25]=i.subject,e[26]=k):k=e[26];let T;e[27]!==k?(T=o.jsxs("tr",{children:[C,o.jsx("td",{children:k})]}),e[27]=k,e[28]=T):T=e[28];let P;e[29]===Symbol.for("react.memo_cache_sentinel")?(P=o.jsx("td",{children:"Issuer"}),e[29]=P):P=e[29];let L;e[30]!==i.issuer?(L=di(i.issuer),e[30]=i.issuer,e[31]=L):L=e[31];let M;e[32]!==L?(M=o.jsxs("tr",{children:[P,o.jsx("td",{children:L})]}),e[32]=L,e[33]=M):M=e[33];let O;e[34]===Symbol.for("react.memo_cache_sentinel")?(O=o.jsx("td",{children:"Serial"}),e[34]=O):O=e[34];let H;e[35]!==i.serial?(H=o.jsxs("tr",{children:[O,o.jsx("td",{children:i.serial})]}),e[35]=i.serial,e[36]=H):H=e[36];let q;return e[37]!==j||e[38]!==$||e[39]!==T||e[40]!==M||e[41]!==H||e[42]!==l||e[43]!==d||e[44]!==p?(q=o.jsxs(o.Fragment,{children:[r,o.jsx("table",{className:"certificate-table",children:o.jsxs("tbody",{children:[l,d,p,j,$,T,M,H]})})]}),e[37]=j,e[38]=$,e[39]=T,e[40]=M,e[41]=H,e[42]=l,e[43]=d,e[44]=p,e[45]=q):q=e[45],q}function Xr(t){const e=E.c(11),{flow:s}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=o.jsx("h4",{children:"Client Connection"}),e[0]=i):i=e[0];let r;e[1]!==s.client_conn?(r=o.jsx(ai,{conn:s.client_conn}),e[1]=s.client_conn,e[2]=r):r=e[2];let n;e[3]!==s.server_conn?(n=s.server_conn?.address&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{children:"Server Connection"}),o.jsx(ai,{conn:s.server_conn})]}),e[3]=s.server_conn,e[4]=n):n=e[4];let l;e[5]!==s?(l=o.jsx(pd,{flow:s}),e[5]=s,e[6]=l):l=e[6];let a;return e[7]!==r||e[8]!==n||e[9]!==l?(a=o.jsxs("section",{className:"detail",children:[i,r,n,l]}),e[7]=r,e[8]=n,e[9]=l,e[10]=a):a=e[10],a}Xr.displayName="Connection";function Zr(t){const e=E.c(7),{flow:s}=t,i=s.error.msg;let r;e[0]!==s.error.timestamp?(r=at(s.error.timestamp),e[0]=s.error.timestamp,e[1]=r):r=e[1];let n;e[2]!==r?(n=o.jsx("div",{children:o.jsx("small",{children:r})}),e[2]=r,e[3]=n):n=e[3];let l;return e[4]!==s.error.msg||e[5]!==n?(l=o.jsx("section",{className:"error",children:o.jsxs("div",{className:"alert alert-warning",children:[i,n]})}),e[4]=s.error.msg,e[5]=n,e[6]=l):l=e[6],l}Zr.displayName="Error";function hd(t){const e=E.c(4),{t:s,deltaTo:i,title:r}=t;let n;return e[0]!==i||e[1]!==s||e[2]!==r?(n=s?o.jsxs("tr",{children:[o.jsxs("td",{children:[r,":"]}),o.jsxs("td",{children:[at(s),i&&o.jsxs("span",{className:"text-muted",children:["(",Si(1e3*(s-i)),")"]})]})]}):o.jsx("tr",{}),e[0]=i,e[1]=s,e[2]=r,e[3]=n):n=e[3],n}function eo(t){const e=E.c(26),{flow:s}=t;let i;s.type==="http"?i=s.request.timestamp_start:i=s.client_conn.timestamp_start;const r=s.server_conn?.timestamp_start;let n,l,a,d;if(e[0]!==s.client_conn.timestamp_end||e[1]!==s.client_conn.timestamp_start||e[2]!==s.client_conn.timestamp_tls_setup||e[3]!==s.request||e[4]!==s.response?.timestamp_end||e[5]!==s.response?.timestamp_start||e[6]!==s.server_conn?.timestamp_end||e[7]!==s.server_conn?.timestamp_tcp_setup||e[8]!==s.server_conn?.timestamp_tls_setup||e[9]!==s.type||e[10]!==i||e[11]!==r){const g=[{title:"Server conn. initiated",t:r,deltaTo:i},{title:"Server conn. TCP handshake",t:s.server_conn?.timestamp_tcp_setup,deltaTo:i},{title:"Server conn. TLS handshake",t:s.server_conn?.timestamp_tls_setup,deltaTo:i},{title:"Server conn. closed",t:s.server_conn?.timestamp_end,deltaTo:i},{title:"Client conn. established",t:s.client_conn.timestamp_start,deltaTo:s.type==="http"?i:void 0},{title:"Client conn. TLS handshake",t:s.client_conn.timestamp_tls_setup,deltaTo:i},{title:"Client conn. closed",t:s.client_conn.timestamp_end,deltaTo:i}];s.type==="http"&&g.push({title:"First request byte",t:s.request.timestamp_start},{title:"Request complete",t:s.request.timestamp_end,deltaTo:i},{title:"First response byte",t:s.response?.timestamp_start,deltaTo:i},{title:"Response complete",t:s.response?.timestamp_end,deltaTo:i}),a="timing",e[16]===Symbol.for("react.memo_cache_sentinel")?(d=o.jsx("h4",{children:"Timing"}),e[16]=d):d=e[16],l="timing-table",n=g.filter(xd).sort(gd).map(md),e[0]=s.client_conn.timestamp_end,e[1]=s.client_conn.timestamp_start,e[2]=s.client_conn.timestamp_tls_setup,e[3]=s.request,e[4]=s.response?.timestamp_end,e[5]=s.response?.timestamp_start,e[6]=s.server_conn?.timestamp_end,e[7]=s.server_conn?.timestamp_tcp_setup,e[8]=s.server_conn?.timestamp_tls_setup,e[9]=s.type,e[10]=i,e[11]=r,e[12]=n,e[13]=l,e[14]=a,e[15]=d}else n=e[12],l=e[13],a=e[14],d=e[15];let f;e[17]!==n?(f=o.jsx("tbody",{children:n}),e[17]=n,e[18]=f):f=e[18];let h;e[19]!==l||e[20]!==f?(h=o.jsx("table",{className:l,children:f}),e[19]=l,e[20]=f,e[21]=h):h=e[21];let p;return e[22]!==a||e[23]!==d||e[24]!==h?(p=o.jsxs("section",{className:a,children:[d,h]}),e[22]=a,e[23]=d,e[24]=h,e[25]=p):p=e[25],p}function md(t){const{title:e,t:s,deltaTo:i}=t;return o.jsx(hd,{title:e,t:s,deltaTo:i},e)}function gd(t,e){return t.t-e.t}function xd(t){return!!t.t}eo.displayName="Timing";function Fs({flow:t,messages_meta:e}){const s=Q(),i=D(f=>f.ui.flow.contentViewFor[t.id+"messages"]||"Auto"),[r,n]=I.useState(D(f=>f.options.content_view_lines_cutoff)),l=I.useCallback(()=>n(Math.max(1024,r*2)),[r]),a=Vr(t,"messages",i,r+1,t.id+e.count)??[];let d=r;return o.jsxs("div",{className:"contentview",children:[o.jsxs("div",{className:"controls",children:[o.jsxs("h5",{children:[e.count," Messages"]}),o.jsx(Wr,{value:i,onChange:f=>s(bi({messageId:t.id+"messages",contentView:f}))})]}),a.map((f,h)=>{const p=`fa fa-fw fa-arrow-${f.from_client?"right text-primary":"left text-danger"}`,g=o.jsxs("div",{children:[o.jsxs("small",{children:[o.jsx("i",{className:p}),o.jsx("span",{className:"pull-right",children:f.timestamp&&at(f.timestamp)})]}),o.jsx(Br,{content:f.text,maxLines:d,showMore:l})]},h);return d-=f.text.split(`
`).length,g})]})}function to(t){const e=E.c(8),{flow:s}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=o.jsx("h4",{children:"WebSocket"}),e[0]=i):i=e[0];let r;e[1]!==s?(r=o.jsx(Fs,{flow:s,messages_meta:s.websocket.messages_meta}),e[1]=s,e[2]=r):r=e[2];let n;e[3]!==s.websocket?(n=o.jsx(vd,{websocket:s.websocket}),e[3]=s.websocket,e[4]=n):n=e[4];let l;return e[5]!==r||e[6]!==n?(l=o.jsxs("section",{className:"websocket",children:[i,r,n]}),e[5]=r,e[6]=n,e[7]=l):l=e[7],l}to.displayName="WebSocket";function vd(t){const e=E.c(10),{websocket:s}=t;if(!s.timestamp_end)return null;const i=s.close_reason?`(${s.close_reason})`:"";let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=o.jsx("i",{className:"fa fa-fw fa-window-close text-muted"}),e[0]=r):r=e[0];const n=s.closed_by_client?"client":"server",l=s.close_code;let a;e[1]!==s.timestamp_end?(a=at(s.timestamp_end),e[1]=s.timestamp_end,e[2]=a):a=e[2];let d;e[3]!==a?(d=o.jsx("small",{className:"pull-right",children:a}),e[3]=a,e[4]=d):d=e[4];let f;return e[5]!==i||e[6]!==n||e[7]!==d||e[8]!==s.close_code?(f=o.jsxs("div",{children:[r,"  Closed by ",n," ","with code ",l," ",i,".",d]}),e[5]=i,e[6]=n,e[7]=d,e[8]=s.close_code,e[9]=f):f=e[9],f}function so(t){const e=E.c(7),{flow:s}=t,i=Q();let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=o.jsx("h4",{children:"Comment"}),e[0]=r):r=e[0];let n;e[1]!==i||e[2]!==s?(n=a=>{i(Ie(s,{comment:a}))},e[1]=i,e[2]=s,e[3]=n):n=e[3];let l;return e[4]!==s.comment||e[5]!==n?(l=o.jsxs("section",{className:"timing",children:[r,o.jsx(le,{className:"kv-value",content:s.comment,onEditDone:n,placeholder:"empty",selectAllOnClick:!0})]}),e[4]=s.comment,e[5]=n,e[6]=l):l=e[6],l}so.displayName="Comment";function no(t){const e=E.c(2),{flow:s}=t;let i;return e[0]!==s?(i=o.jsx("section",{className:"tcp",children:o.jsx(Fs,{flow:s,messages_meta:s.messages_meta})}),e[0]=s,e[1]=i):i=e[1],i}no.displayName="Stream Data";function io(t){const e=E.c(2),{flow:s}=t;let i;return e[0]!==s?(i=o.jsx("section",{className:"udp",children:o.jsx(Fs,{flow:s,messages_meta:s.messages_meta})}),e[0]=s,e[1]=i):i=e[1],i}io.displayName="Datagrams";const fi={request:zr,response:Gr,error:Zr,connection:Xr,timing:eo,websocket:to,tcpmessages:no,udpmessages:io,dnsrequest:Yr,dnsresponse:Jr,comment:so};function js(t){let e;switch(t.type){case"http":e=["request","response","websocket"].filter(s=>t[s]);break;case"tcp":e=["tcpmessages"];break;case"udp":e=["udpmessages"];break;case"dns":e=["request","response"].filter(s=>t[s]).map(s=>"dns"+s);break}return t.error&&e.push("error"),e.push("connection"),e.push("timing"),e.push("comment"),e}function _d(){const t=E.c(15),e=Q(),s=D(yd);let i=D(jd);if(s==null){let y;return t[0]===Symbol.for("react.memo_cache_sentinel")?(y=o.jsx(o.Fragment,{}),t[0]=y):y=t[0],y}const r=js(s);r.indexOf(i)<0&&(i==="response"&&s.error?i="error":i==="error"&&"response"in s?i="response":i=r[0]);const n=fi[i],l="flow-detail",a="nav-tabs nav-tabs-sm";let d;t[1]!==e?(d=()=>e(He([])),t[1]=e,t[2]=d):d=t[2];let f;t[3]===Symbol.for("react.memo_cache_sentinel")?(f=o.jsx("i",{className:"fa fa-times-circle"}),t[3]=f):f=t[3];let h;t[4]!==d?(h=o.jsx("button",{"data-testid":"close-button-id",className:"close-button",onClick:d,children:f}),t[4]=d,t[5]=h):h=t[5];const p=r.map(y=>o.jsx("a",{href:"#",className:_e({active:i===y}),onClick:b=>{b.preventDefault(),e(Wt(y))},children:fi[y].displayName},y));let g;t[6]!==h||t[7]!==p?(g=o.jsxs("nav",{className:a,children:[h,p]}),t[6]=h,t[7]=p,t[8]=g):g=t[8];let x;t[9]!==n||t[10]!==s?(x=o.jsx(n,{flow:s}),t[9]=n,t[10]=s,t[11]=x):x=t[11];let j;return t[12]!==g||t[13]!==x?(j=o.jsxs("div",{className:l,children:[g,x]}),t[12]=g,t[13]=x,t[14]=j):j=t[14],j}function jd(t){return t.ui.flow.tab}function yd(t){return t.flows.selected[0]}function bd(t){if(t.ctrlKey||t.metaKey)return()=>{};const e=t.key;return t.preventDefault(),(s,i)=>{const{flows:r}=i(),n=r.selected,l=n[0];switch(e){case"k":case"ArrowUp":s(ht(r,-1));break;case"j":case"ArrowDown":s(ht(r,1));break;case" ":case"PageDown":s(ht(r,10));break;case"PageUp":s(ht(r,-10));break;case"End":s(ht(r,1e10));break;case"Home":s(ht(r,-1e10));break;case"Escape":i().ui.modal.activeModal?s(er()):s(He([]));break;case"ArrowLeft":{if(!l)break;const a=js(l),d=i().ui.flow.tab,f=a[(Math.max(0,a.indexOf(d))-1+a.length)%a.length];s(Wt(f));break}case"Tab":case"ArrowRight":{if(!l)break;const a=js(l),d=i().ui.flow.tab,f=a[(Math.max(0,a.indexOf(d))+1)%a.length];s(Wt(f));break}case"Delete":case"d":{s(Bi(n));break}case"n":{Kt("view.flows.create","get","https://example.com/");break}case"D":{s(Wi(n));break}case"a":{s(Ns(n));break}case"A":{s(Vi());break}case"r":{s(ks(n));break}case"v":{s(Ki(n));break}case"x":{s(Ui(n));break}case"X":{s(mc());break}case"z":{s(zi());break}default:return}}}class wd extends I.Component{static defaultProps={axis:"x"};node=Ee.createRef();constructor(e,s){super(e,s),this.state={applied:!1,startPos:0,dragPointer:.1},this.onLostPointerCapture=this.onLostPointerCapture.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this)}onPointerDown(e){this.state.dragPointer===.1&&(e.target.setPointerCapture(e.pointerId),this.setState({startPos:this.props.axis==="x"?e.pageX:e.pageY,dragPointer:e.pointerId}))}onLostPointerCapture(e){if(this.state.dragPointer!==e.pointerId)return;const s=this.node.current,i=s.previousElementSibling,r=s.nextElementSibling;s.style.transform="",i.style.flex=`0 0 ${Math.max(0,(this.props.axis==="x"?i.offsetWidth+e.pageX:i.offsetHeight+e.pageY)-this.state.startPos)}px`,r.style.flex="1 1 auto",this.setState({applied:!0,dragPointer:.1}),this.onResize()}onPointerMove(e){this.state.dragPointer===e.pointerId&&(this.node.current.style.transform=this.props.axis==="x"?`translateX(${e.pageX-this.state.startPos}px)`:`translateY(${e.pageY-this.state.startPos}px)`)}onResize(){window.setTimeout(()=>window.dispatchEvent(new CustomEvent("resize")),1)}reset(e){this.state.applied&&(this.node.current?.previousElementSibling instanceof HTMLElement&&(this.node.current.previousElementSibling.style.flex=""),this.node.current?.nextElementSibling instanceof HTMLElement&&(this.node.current.nextElementSibling.style.flex=""),e||this.setState({applied:!1}),this.onResize())}componentWillUnmount(){this.reset(!0)}render(){return o.jsx("div",{ref:this.node,className:_e("splitter",this.props.axis==="x"?"splitter-x":"splitter-y"),children:o.jsx("div",{onLostPointerCapture:this.onLostPointerCapture,onPointerDown:this.onPointerDown,onPointerMove:this.onPointerMove})})}}const Is=t=>{const e=t.current;return e===null||e.scrollTop===0?!1:Math.ceil(e.scrollTop)+e.clientHeight>=e.scrollHeight},ro=t=>{t.current&&!Is(t)&&(t.current.scrollTop=t.current.scrollHeight)};function Et(t=void 0){if(!t)return{start:0,end:0,paddingTop:0,paddingBottom:0};const{itemCount:e,rowHeight:s,viewportTop:i,viewportHeight:r,itemHeights:n}=t,l=i+r;let a=0,d=0,f=0,h=0;if(n){let p=0;for(let g=0;g<e;g++){const x=n[g]||s;p<=i&&g%2===0&&(f=p,a=g),p<=l?d=g+1:h+=x,p+=x}if(i>0&&p<i+r)return Et({itemCount:e,rowHeight:s,viewportTop:p-r,viewportHeight:r,itemHeights:n})}else{const p=Math.min(i,Math.max(0,e*s-r));a=Math.max(0,Math.floor(p/s)-1)&-2,d=Math.min(e,a+Math.ceil(r/s)+2),f=a*s,h=(e-d)*s}return{start:a,end:d,paddingTop:f,paddingBottom:h}}const Ls=({flow:t})=>o.jsx("td",{className:_e("col-tls",t.client_conn.tls_established?"col-tls-https":"col-tls-http")});Ls.headerName="";const Ps=({flow:t})=>{const e=D(s=>s.flows._listIndex.get(t.id));return o.jsx("td",{className:"col-index",children:e+1})};Ps.headerName="#";const Ms=({flow:t})=>o.jsx("td",{className:"col-icon",children:o.jsx("div",{className:_e("resource-icon",Di(t))})});Ms.headerName="";const Os=({flow:t})=>{let e;return t.error&&(t.error.msg==="Connection killed."?e=o.jsx("i",{className:"fa fa-fw fa-times pull-right"}):e=o.jsx("i",{className:"fa fa-fw fa-exclamation pull-right"})),o.jsxs("td",{className:"col-path",children:[t.is_replay==="request"&&o.jsx("i",{className:"fa fa-fw fa-repeat pull-right"}),t.intercepted&&o.jsx("i",{className:"fa fa-fw fa-pause pull-right"}),e,o.jsx("span",{className:"marker pull-right",children:t.marked}),Fi(t)]})};Os.headerName="Path";const qs=({flow:t})=>o.jsx("td",{className:"col-method",children:Li(t)});qs.headerName="Method";const Hs=({flow:t})=>o.jsx("td",{className:"col-http-version",children:Pi(t)});Hs.headerName="Version";const Vs=({flow:t})=>{let e="darkred";return t.type!=="http"&&t.type!="dns"||!t.response?o.jsx("td",{className:"col-status"}):(100<=t.response.status_code&&t.response.status_code<200?e="green":200<=t.response.status_code&&t.response.status_code<300?e="darkgreen":300<=t.response.status_code&&t.response.status_code<400?e="lightblue":(400<=t.response.status_code&&t.response.status_code<500||500<=t.response.status_code&&t.response.status_code<600)&&(e="red"),o.jsx("td",{className:"col-status",style:{color:e},children:Ii(t)}))};Vs.headerName="Status";const Us=({flow:t})=>o.jsx("td",{className:"col-size",children:wi(Ri(t))});Us.headerName="Size";const Bs=({flow:t})=>{const e=zt(t),s=Ti(t);return o.jsx("td",{className:"col-time",children:e&&s?Si(1e3*(s-e)):"..."})};Bs.headerName="Time";const Ws=({flow:t})=>{const e=zt(t);return o.jsx("td",{className:"col-timestamp",children:e?at(e):"..."})};Ws.headerName="Start time";const Xt=({flow:t})=>{const e=Q();let s=null;return t.intercepted?s=o.jsx("a",{href:"#",className:"quickaction",onClick:()=>e(Ns([t])),children:o.jsx("i",{className:"fa fa-fw fa-play text-success"})}):Ss(t)&&(s=o.jsx("a",{href:"#",className:"quickaction",onClick:()=>e(ks([t])),children:o.jsx("i",{className:"fa fa-fw fa-repeat text-primary"})})),o.jsx("td",{className:"col-quickactions",children:s?o.jsx("div",{children:s}):o.jsx(o.Fragment,{})})};Xt.headerName="";const Ks=({flow:t})=>{const e=t.comment;return o.jsx("td",{className:"col-comment",children:e})};Ks.headerName="Comment";const oo={icon:Ms,index:Ps,method:qs,version:Hs,path:Os,quickactions:Xt,size:Us,status:Vs,time:Bs,timestamp:Ws,tls:Ls,comment:Ks},Sd=Object.freeze(Object.defineProperty({__proto__:null,comment:Ks,default:oo,icon:Ms,index:Ps,method:qs,path:Os,quickactions:Xt,size:Us,status:Vs,time:Bs,timestamp:Ws,tls:Ls,version:Hs},Symbol.toStringTag,{value:"Module"})),$d=I.memo(function(){const e=E.c(13),s=Q(),i=D(Cd),r=D(Nd),n=D(kd),l=i?"sort-desc":"sort-asc";let a;if(e[0]!==s||e[1]!==n||e[2]!==r||e[3]!==i||e[4]!==l){const f=n.filter(ac).concat("quickactions");let h;e[6]!==s||e[7]!==r||e[8]!==i||e[9]!==l?(h=p=>o.jsx("th",{className:_e(`col-${p}`,r===p&&l),onClick:()=>s(Xi({column:p===r&&i?void 0:p,desc:p!==r?!1:!i})),children:oo[p].headerName},p),e[6]=s,e[7]=r,e[8]=i,e[9]=l,e[10]=h):h=e[10],a=f.map(h),e[0]=s,e[1]=n,e[2]=r,e[3]=i,e[4]=l,e[5]=a}else a=e[5];let d;return e[11]!==a?(d=o.jsx("tr",{children:a}),e[11]=a,e[12]=d):d=e[12],d});function Cd(t){return t.flows.sort.desc}function Nd(t){return t.flows.sort.column}function kd(t){return t.options.web_columns}const Ed=Ee.memo(function({flow:e,selected:s,highlighted:i}){const r=Q(),n=D(f=>f.options.web_columns),l=_e({selected:s,highlighted:i,intercepted:e.intercepted,"has-request":e.type==="http"&&e.request,"has-response":e.type==="http"&&e.response}),a=I.useCallback(f=>{let h=f.target;for(;h.parentNode;){if(h.classList.contains("col-quickactions"))return;h=h.parentNode}f.metaKey||f.ctrlKey?r(jc(e)):f.shiftKey?(window.getSelection()?.empty(),r(yc(e))):r(He([e]))},[e]),d=n.map(f=>Sd[f]).filter(f=>f).concat(Xt);return o.jsx("tr",{className:l,onClick:a,children:d.map(f=>o.jsx(f,{flow:e},f.name))})});class Td extends I.Component{static defaultProps={rowHeight:32};viewport=I.createRef();head=I.createRef();constructor(e,s){super(e,s),this.state={vScroll:Et(),viewportTop:0},this.onViewportUpdate=this.onViewportUpdate.bind(this)}componentDidMount(){window.addEventListener("resize",this.onViewportUpdate),this.onViewportUpdate()}componentWillUnmount(){window.removeEventListener("resize",this.onViewportUpdate)}getSnapshotBeforeUpdate(){return Is(this.viewport)}componentDidUpdate(e,s,i){i&&ro(this.viewport),this.onViewportUpdate();const{onlySelectedId:r}=this.props;if(r&&r!==e.onlySelectedId){const{rowHeight:l,firstSelectedIndex:a}=this.props,d=this.viewport.current,f=this.head.current,h=f?f.offsetHeight:0,p=a*l+h,g=p+l,x=d.scrollTop,j=d.offsetHeight;p-h<x?d.scrollTop=p-h:g>x+j&&(d.scrollTop=g-j),this.onViewportUpdate()}}onViewportUpdate(){const e=this.viewport.current,s=e.scrollTop||0,i=Et({viewportTop:s,viewportHeight:e.offsetHeight||0,itemCount:this.props.flowView.length,rowHeight:this.props.rowHeight});if(this.state.viewportTop!==s||!Gt(this.state.vScroll,i)){const r=Math.min(s,i.end*this.props.rowHeight);this.setState({vScroll:i,viewportTop:r})}}render(){const{vScroll:e,viewportTop:s}=this.state,{flowView:i,selectedIds:r,highlightedIds:n}=this.props;return o.jsx("div",{className:"flow-table",onScroll:this.onViewportUpdate,ref:this.viewport,children:o.jsxs("table",{children:[o.jsx("thead",{ref:this.head,style:{transform:`translateY(${s}px)`},children:o.jsx($d,{})}),o.jsxs("tbody",{children:[o.jsx("tr",{style:{height:e.paddingTop}}),i.slice(e.start,e.end).map(l=>o.jsx(Ed,{flow:l,selected:r.has(l.id),highlighted:n.has(l.id)},l.id)),o.jsx("tr",{style:{height:e.paddingBottom}})]})]})})}}const Rd=Tt(t=>({flowView:t.flows.view,highlightedIds:t.flows.highlightedIds,selectedIds:t.flows.selectedIds,onlySelectedId:t.flows.selected.length===1&&t.flows.selected[0].id,firstSelectedIndex:t.flows._viewIndex.get(t.flows.selected[0]?.id)}))(Td);function Ad(){const t=E.c(3);let e,s;t[0]===Symbol.for("react.memo_cache_sentinel")?(e={padding:"1em 2em"},s=o.jsx("h3",{children:"mitmproxy is running."}),t[0]=e,t[1]=s):(e=t[0],s=t[1]);let i;return t[2]===Symbol.for("react.memo_cache_sentinel")?(i=o.jsxs("div",{style:e,children:[s,o.jsxs("p",{children:["No flows have been recorded yet.",o.jsx("br",{}),"To start capturing traffic, please configure your settings in the Capture tab."]})]}),t[2]=i):i=t[2],i}function Dd(t){const e=E.c(20);let{description:s,listen_addrs:i,is_running:r,wireguard_conf:n,type:l}=t;const a=I.useRef(null);let d,f;e[0]!==n?(d=()=>{n&&a.current&&Kl.toCanvas(a.current,n,{margin:0,scale:3})},f=[n],e[0]=n,e[1]=d,e[2]=f):(d=e[1],f=e[2]),I.useEffect(d,f);let h;const p=i.length===1||i.length===2&&i[0][1]===i[1][1],g=i.every(Fd);if(p&&g){let y;e[3]!==i[0][1]?(y=Gn(["*",i[0][1]]),e[3]=i[0][1],e[4]=y):y=e[4],h=y}else{let y;e[5]!==i?(y=i.map(Gn).join(" and "),e[5]=i,e[6]=y):y=e[6],h=y}s=s[0].toUpperCase()+s.substr(1);let x;if(r){let y;e[9]!==s||e[10]!==h||e[11]!==l?(y=l==="local"?o.jsxs("div",{className:"text-success",children:[s," is active."]}):o.jsxs("div",{className:"text-success",children:[s," listening at ",h,"."]}),e[9]=s,e[10]=h,e[11]=l,e[12]=y):y=e[12];let b;e[13]!==n?(b=n&&o.jsxs("div",{className:"wireguard-config",children:[o.jsx("pre",{children:n}),o.jsx("canvas",{ref:a})]}),e[13]=n,e[14]=b):b=e[14];let $;e[15]!==y||e[16]!==b?($=o.jsxs(o.Fragment,{children:[y,b]}),e[15]=y,e[16]=b,e[17]=$):$=e[17],x=$}else{let y;e[7]!==s?(y=o.jsx(o.Fragment,{children:o.jsxs("div",{className:"text-warning",children:[s," starting..."]})}),e[7]=s,e[8]=y):y=e[8],x=y}let j;return e[18]!==x?(j=o.jsx("div",{children:x}),e[18]=x,e[19]=j):j=e[19],j}function Fd(t){return["::","0.0.0.0"].includes(t[0])}function et(t){const e=E.c(5),{error:s,backendState:i}=t;let r;e[0]!==i||e[1]!==s?(r=s?o.jsx("div",{className:"text-danger",children:s}):i&&o.jsx(Dd,{...i}),e[0]=i,e[1]=s,e[2]=r):r=e[2];let n;return e[3]!==r?(n=o.jsx("div",{className:"mode-status",children:r}),e[3]=r,e[4]=n):n=e[4],n}function tt(t){const e=E.c(13),{value:s,onChange:i,children:r,label:n}=t,l=I.useId(),a=`mode-checkbox-${l}`,d=`mode-checkbox-${l}`;let f;e[0]!==i||e[1]!==a||e[2]!==d||e[3]!==s?(f=o.jsx("input",{type:"checkbox",name:a,id:d,checked:s,onChange:i}),e[0]=i,e[1]=a,e[2]=d,e[3]=s,e[4]=f):f=e[4];const h=`mode-checkbox-${l}`;let p;e[5]===Symbol.for("react.memo_cache_sentinel")?(p={marginBottom:0,fontWeight:"normal"},e[5]=p):p=e[5];let g;e[6]!==n||e[7]!==h?(g=o.jsx("label",{htmlFor:h,style:p,children:n}),e[6]=n,e[7]=h,e[8]=g):g=e[8];let x;return e[9]!==r||e[10]!==f||e[11]!==g?(x=o.jsxs("div",{className:"mode-entry",children:[f,g,r]}),e[9]=r,e[10]=f,e[11]=g,e[12]=x):x=e[12],x}function st(t){const e=E.c(22),{children:s,iconClass:i,classname:r,isVisible:n}=t,l=I.useId();let a;e[0]!==l?(a=[...l].map(Id),e[0]=l,e[1]=a):a=e[1];const d="--"+a.join(""),f=I.useRef(null),h=I.useRef(null);let p;e[2]!==d?(p=()=>{f.current.style.anchorName=d,h.current.style.positionAnchor=d},e[2]=d,e[3]=p):p=e[3];let g;e[4]===Symbol.for("react.memo_cache_sentinel")?(g=[],e[4]=g):g=e[4],I.useEffect(p,g);let x;e[5]!==l||e[6]!==n?(x=()=>{n===!0&&document.getElementById(l)?.showPopover()},e[5]=l,e[6]=n,e[7]=x):x=e[7];let j;e[8]!==n?(j=[n],e[8]=n,e[9]=j):j=e[9],I.useEffect(x,j);const y=r?`mode-popover ${r}`:"mode-popover";let b;e[10]!==i?(b=o.jsx("i",{className:i,"aria-hidden":"true"}),e[10]=i,e[11]=b):b=e[11];let $;e[12]!==l||e[13]!==b?($=o.jsx("button",{popoverTarget:l,ref:f,children:b}),e[12]=l,e[13]=b,e[14]=$):$=e[14];let C;e[15]!==s||e[16]!==l?(C=o.jsx("div",{id:l,popover:"auto",ref:h,children:s}),e[15]=s,e[16]=l,e[17]=C):C=e[17];let k;return e[18]!==y||e[19]!==$||e[20]!==C?(k=o.jsxs("div",{className:y,children:[$,C]}),e[18]=y,e[19]=$,e[20]=C,e[21]=k):k=e[21],k}function Id(t){return t.charCodeAt(0).toString(16)}function Ld(t){const e=E.c(44),{server:s}=t,{currentProcesses:i,isLoading:r}=D(Od),{selectedProcesses:n}=D(Md);let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=[],e[0]=l):l=e[0];const[a,d]=I.useState(l),[f,h]=I.useState(""),p=Q(),{platform:g}=D(Pd);let x;e[1]===Symbol.for("react.memo_cache_sentinel")?(x=K=>{h(K.target.value)},e[1]=x):x=e[1];const j=x;let y;e[2]!==g?(y=K=>{const oe=g.startsWith("win32")?"\\":"/";return gs(K.executable,oe)[1]},e[2]=g,e[3]=y):y=e[3];const b=y;let $;e[4]!==p||e[5]!==b||e[6]!==n||e[7]!==s?($=K=>{const oe=typeof K=="string"?K:b(K),V=n?`${n}, ${oe}`:oe;p($t({server:s,value:V}))},e[4]=p,e[5]=b,e[6]=n,e[7]=s,e[8]=$):$=e[8];const C=$;let k;e[9]!==p||e[10]!==b||e[11]!==n||e[12]!==s?(k=K=>{const oe=n?.split(/,\s*/).filter(V=>V!==b(K)).join(", ");p($t({server:s,value:oe}))},e[9]=p,e[10]=b,e[11]=n,e[12]=s,e[13]=k):k=e[13];const T=k,P=K=>{L(K)&&n?T(K):C(K)},L=K=>{const oe=b(K);return n?.includes(oe)};let M;e[14]!==i||e[15]!==p?(M=()=>{i.length===0&&p(Ct())},e[14]=i,e[15]=p,e[16]=M):M=e[16];let O;e[17]===Symbol.for("react.memo_cache_sentinel")?(O=[],e[17]=O):O=e[17],I.useEffect(M,O);let H;e[18]!==i||e[19]!==f||e[20]!==b||e[21]!==a?(H=()=>{if(f){const K=i.filter(oe=>b(oe).toLowerCase().includes(f.toLowerCase()));d(K)}else a!==i&&d(i)},e[18]=i,e[19]=f,e[20]=b,e[21]=a,e[22]=H):H=e[22];let q;e[23]!==i||e[24]!==f?(q=[f,i],e[23]=i,e[24]=f,e[25]=q):q=e[25],I.useEffect(H,q);let B;e[26]!==C||e[27]!==f?(B=K=>{K.stopPropagation(),K.key==="Enter"&&(C(f),h(""))},e[26]=C,e[27]=f,e[28]=B):B=e[28];const z=B,[W,J]=I.useState(!1),Y="local-dropdown",X="dropdown-header",Z=n&&n?.length>0?"Add more":"all applications";let ee,de;e[29]===Symbol.for("react.memo_cache_sentinel")?(ee=()=>J(!0),de=()=>J(!1),e[29]=ee,e[30]=de):(ee=e[29],de=e[30]);let ge;e[31]!==f||e[32]!==z||e[33]!==Z?(ge=o.jsx("input",{type:"text",className:"autocomplete-input",placeholder:Z,value:f,onChange:j,onKeyDown:z,onClick:ee,onBlur:de}),e[31]=f,e[32]=z,e[33]=Z,e[34]=ge):ge=e[34];const be=st,Be="fa fa-chevron-down",Le="local-popover";let we;e[35]===Symbol.for("react.memo_cache_sentinel")?(we=o.jsx("h4",{children:"Current Applications running on machine"}),e[35]=we):we=e[35];const ke=r?o.jsx("i",{className:"fa fa-spinner","aria-hidden":"true"}):a.length>0?o.jsxs("ul",{className:"dropdown-list",children:[o.jsxs("li",{className:`dropdown-item ${n===""?"selected":""}`,onClick:()=>{p($t({server:s,value:""}))},role:"menuitem",children:[o.jsxs("div",{className:"process-details",children:[o.jsx("div",{className:"process-icon"}),o.jsx("span",{className:"process-name",children:"All applications"})]}),n===""&&o.jsx("i",{className:"fa fa-check","aria-hidden":"true"})]}),o.jsx("hr",{className:"process-separator"}),a.map((K,oe)=>o.jsxs("li",{className:`dropdown-item ${L(K)?"selected":""}`,onClick:()=>P(K),role:"menuitem",children:[o.jsxs("div",{className:"process-details",children:[o.jsx("img",{className:"process-icon",src:`./executable-icon?path=${K.executable}`,loading:"lazy"}),o.jsx("span",{className:"process-name",children:b(K)})]}),L(K)&&o.jsx("i",{className:"fa fa-check","aria-hidden":"true"})]},oe))]}):o.jsxs("span",{children:["Press ",o.jsx("strong",{children:"Enter"})," to capture traffic for programs matching: ",o.jsx("strong",{children:f})]});let N;e[36]!==be||e[37]!==W||e[38]!==we||e[39]!==ke?(N=o.jsxs(be,{iconClass:Be,classname:Le,isVisible:W,children:[we,ke]}),e[36]=be,e[37]=W,e[38]=we,e[39]=ke,e[40]=N):N=e[40];let pe;return e[41]!==ge||e[42]!==N?(pe=o.jsx("div",{className:Y,children:o.jsxs("div",{className:X,children:[ge,N]})}),e[41]=ge,e[42]=N,e[43]=pe):pe=e[43],pe}function Pd(t){return t.backendState}function Md(t){return t.modes.local[0]}function Od(t){return t.processes}function qd(){const t=E.c(9),e=D(Vd),s=D(Hd);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=f=>o.jsx(Ud,{server:f,backendState:s[cr(f)]},f.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const r=i;let n,l;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=o.jsx("h4",{className:"mode-title",children:"Local Applications"}),l=o.jsx("p",{className:"mode-description",children:"Transparently Intercept local application(s)."}),t[5]=n,t[6]=l):(n=t[5],l=t[6]);let a;return t[7]!==r?(a=o.jsxs("div",{children:[n,l,r]}),t[7]=r,t[8]=a):a=t[8],a}function Hd(t){return t.backendState.servers}function Vd(t){return t.modes.local}function Ud(t){const e=E.c(31),{server:s,backendState:i}=t,r=Q(),n=D(Wd),l=s.error||i?.last_exception||n||void 0;let a;e[0]!==r||e[1]!==s?(a=k=>{const T=s.selectedProcesses?.split(/,\s*/).filter(P=>P!==k).join(", ");r($t({server:s,value:T}))},e[0]=r,e[1]=s,e[2]=a):a=e[2];const d=a;let f;e[3]!==r||e[4]!==s?(f=()=>r(xr({server:s,value:!s.active})),e[3]=r,e[4]=s,e[5]=f):f=e[5];let h;e[6]!==d||e[7]!==s.selectedProcesses?(h=s.selectedProcesses?.split(/,\s*/).filter(Bd).map(k=>o.jsxs("div",{className:"selected-process",children:[k,o.jsx("i",{className:"fa fa-times","aria-hidden":"true",onClick:()=>d(k)})]},k)),e[6]=d,e[7]=s.selectedProcesses,e[8]=h):h=e[8];let p;e[9]!==h?(p=o.jsx("div",{className:"selected-processes",children:h}),e[9]=h,e[10]=p):p=e[10];let g;e[11]!==s?(g=o.jsx(Ld,{server:s}),e[11]=s,e[12]=g):g=e[12];let x;e[13]!==r?(x=o.jsx("i",{className:"fa fa-refresh","aria-hidden":"true",onClick:()=>r(Ct())}),e[13]=r,e[14]=x):x=e[14];let j;e[15]!==g||e[16]!==x?(j=o.jsxs("div",{className:"dropdown-container",children:[g,x]}),e[15]=g,e[16]=x,e[17]=j):j=e[17];let y;e[18]!==p||e[19]!==j?(y=o.jsxs("div",{className:"processes-container",children:[p,j]}),e[18]=p,e[19]=j,e[20]=y):y=e[20];let b;e[21]!==s.active||e[22]!==f||e[23]!==y?(b=o.jsx(tt,{value:s.active,label:"Intercept traffic for",onChange:f,children:y}),e[21]=s.active,e[22]=f,e[23]=y,e[24]=b):b=e[24];let $;e[25]!==i||e[26]!==l?($=o.jsx(et,{error:l,backendState:i}),e[25]=i,e[26]=l,e[27]=$):$=e[27];let C;return e[28]!==$||e[29]!==b?(C=o.jsxs("div",{className:"mode-local",children:[b,$]}),e[28]=$,e[29]=b,e[30]=C):C=e[30],C}function Bd(t){return t.trim()!==""}function Wd(t){return t.processes.error}function Kd(){const t=E.c(9),e=D(Gd),s=D(zd);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=f=>o.jsx(Qd,{server:f,backendState:s[lr(f)]},f.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const r=i;let n,l;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=o.jsx("h4",{className:"mode-title",children:"Explicit HTTP(S) Proxy"}),l=o.jsx("p",{className:"mode-description",children:"You manually configure your client application or device to use an HTTP(S) proxy."}),t[5]=n,t[6]=l):(n=t[5],l=t[6]);let a;return t[7]!==r?(a=o.jsxs("div",{children:[n,l,r]}),t[7]=r,t[8]=a):a=t[8],a}function zd(t){return t.backendState.servers}function Gd(t){return t.modes.regular}function Qd(t){const e=E.c(33),{server:s,backendState:i}=t,r=Q(),n=s.error||i?.last_exception||void 0;let l;e[0]!==r||e[1]!==s?(l=()=>r(hr({server:s,value:!s.active})),e[0]=r,e[1]=s,e[2]=l):l=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=o.jsx("h4",{children:"Advanced Configuration"}),d=o.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const f=s.listen_host||"";let h;e[5]!==r||e[6]!==s?(h=T=>r(mr({server:s,value:T})),e[5]=r,e[6]=s,e[7]=h):h=e[7];let p;e[8]!==f||e[9]!==h?(p=o.jsx(le,{className:"mode-input",content:f,onEditDone:h}),e[8]=f,e[9]=h,e[10]=p):p=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=o.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==r||e[15]!==s?(j=T=>r(gr({server:s,value:parseInt(T)})),e[14]=r,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=o.jsx(le,{className:"mode-input",content:x,placeholder:"8080",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]!==y||e[21]!==p?(b=o.jsxs(st,{iconClass:"fa fa-cog",children:[a,d,p,g,y]}),e[20]=y,e[21]=p,e[22]=b):b=e[22];let $;e[23]!==s.active||e[24]!==l||e[25]!==b?($=o.jsx(tt,{value:s.active,label:"Run HTTP/S Proxy",onChange:l,children:b}),e[23]=s.active,e[24]=l,e[25]=b,e[26]=$):$=e[26];let C;e[27]!==i||e[28]!==n?(C=o.jsx(et,{error:n,backendState:i}),e[27]=i,e[28]=n,e[29]=C):C=e[29];let k;return e[30]!==$||e[31]!==C?(k=o.jsxs("div",{children:[$,C]}),e[30]=$,e[31]=C,e[32]=k):k=e[32],k}function Yd(){const t=E.c(9),e=D(Xd),s=D(Jd);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=f=>o.jsx(Zd,{server:f,backendState:s[ar(f)]},f.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const r=i;let n,l;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=o.jsx("h4",{className:"mode-title",children:"WireGuard Server"}),l=o.jsx("p",{className:"mode-description",children:"Start a WireGuard™ server and connect an external device for transparent proxying."}),t[5]=n,t[6]=l):(n=t[5],l=t[6]);let a;return t[7]!==r?(a=o.jsxs("div",{children:[n,l,r]}),t[7]=r,t[8]=a):a=t[8],a}function Jd(t){return t.backendState.servers}function Xd(t){return t.modes.wireguard}function Zd(t){const e=E.c(41),{server:s,backendState:i}=t,r=Q(),n=s.error||i?.last_exception||void 0;let l;e[0]!==r||e[1]!==s?(l=()=>r(vr({server:s,value:!s.active})),e[0]=r,e[1]=s,e[2]=l):l=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=o.jsx("h4",{children:"Advanced Configuration"}),d=o.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const f=s.listen_host||"";let h;e[5]!==r||e[6]!==s?(h=O=>r(_r({server:s,value:O})),e[5]=r,e[6]=s,e[7]=h):h=e[7];let p;e[8]!==f||e[9]!==h?(p=o.jsx(le,{className:"mode-input",content:f,placeholder:"(all interfaces)",onEditDone:h}),e[8]=f,e[9]=h,e[10]=p):p=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=o.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==r||e[15]!==s?(j=O=>r(jr({server:s,value:parseInt(O)})),e[14]=r,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=o.jsx(le,{className:"mode-input",content:x,placeholder:"51820",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]===Symbol.for("react.memo_cache_sentinel")?(b=o.jsx("p",{children:"Configuration File"}),e[20]=b):b=e[20];const $=s.file_path||"";let C;e[21]!==r||e[22]!==s?(C=O=>r(yr({server:s,value:O})),e[21]=r,e[22]=s,e[23]=C):C=e[23];let k;e[24]!==$||e[25]!==C?(k=o.jsx(le,{className:"mode-input",content:$,placeholder:"~/.mitmproxy/wireguard.conf",onEditDone:C}),e[24]=$,e[25]=C,e[26]=k):k=e[26];let T;e[27]!==y||e[28]!==k||e[29]!==p?(T=o.jsxs(st,{iconClass:"fa fa-cog",children:[a,d,p,g,y,b,k]}),e[27]=y,e[28]=k,e[29]=p,e[30]=T):T=e[30];let P;e[31]!==s.active||e[32]!==l||e[33]!==T?(P=o.jsx(tt,{value:s.active,label:"Run WireGuard Server",onChange:l,children:T}),e[31]=s.active,e[32]=l,e[33]=T,e[34]=P):P=e[34];let L;e[35]!==i||e[36]!==n?(L=o.jsx(et,{error:n,backendState:i}),e[35]=i,e[36]=n,e[37]=L):L=e[37];let M;return e[38]!==P||e[39]!==L?(M=o.jsxs("div",{children:[P,L]}),e[38]=P,e[39]=L,e[40]=M):M=e[40],M}function ef(){const t=E.c(15),e=Q(),s=D(sf),i=D(tf);let r,n;t[0]===Symbol.for("react.memo_cache_sentinel")?(r=o.jsx("h4",{className:"mode-title",children:"Reverse Proxy"}),n=o.jsx("p",{className:"mode-description",children:"Requests are forwarded to a preconfigured destination."}),t[0]=r,t[1]=n):(r=t[0],n=t[1]);let l;if(t[2]!==i||t[3]!==s){let p;t[5]!==i?(p=(g,x)=>o.jsx(nf,{removable:x>0,server:g,backendState:i[Ds(g)]},g.ui_id),t[5]=i,t[6]=p):p=t[6],l=s.map(p),t[2]=i,t[3]=s,t[4]=l}else l=t[4];let a;t[7]!==e?(a=()=>e(_a()),t[7]=e,t[8]=a):a=t[8];let d;t[9]===Symbol.for("react.memo_cache_sentinel")?(d=o.jsx("i",{className:"fa fa-plus-square-o","aria-hidden":"true"}),t[9]=d):d=t[9];let f;t[10]!==a?(f=o.jsxs("div",{className:"mode-reverse-add-server",onClick:a,children:[d,"Add additional server"]}),t[10]=a,t[11]=f):f=t[11];let h;return t[12]!==l||t[13]!==f?(h=o.jsxs("div",{children:[r,n,o.jsxs("div",{className:"mode-reverse-servers",children:[l,f]})]}),t[12]=l,t[13]=f,t[14]=h):h=t[14],h}function tf(t){return t.backendState.servers}function sf(t){return t.modes.reverse}function nf(t){const e=E.c(56),{removable:s,server:i,backendState:r}=t,n=Q();let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=Object.values(Jt),e[0]=l):l=e[0];const a=l;let d;e[1]!==n||e[2]!==i?(d=async()=>{i.active&&await n(vs({server:i,value:!1})).unwrap(),await n(ja(i))},e[1]=n,e[2]=i,e[3]=d):d=e[3];const f=d,h=i.error||r?.last_exception||void 0,p=i.active;let g;e[4]!==n||e[5]!==i?(g=()=>{n(vs({server:i,value:!i.active}))},e[4]=n,e[5]=i,e[6]=g):g=e[6];const x=i.protocol;let j;e[7]!==n||e[8]!==i?(j=ee=>{n(Sr({server:i,value:ee.target.value}))},e[7]=n,e[8]=i,e[9]=j):j=e[9];let y;e[10]===Symbol.for("react.memo_cache_sentinel")?(y=a.map(rf),e[10]=y):y=e[10];let b;e[11]!==i.protocol||e[12]!==j?(b=o.jsx("select",{name:"protocols",className:"mode-reverse-dropdown",value:x,onChange:j,children:y}),e[11]=i.protocol,e[12]=j,e[13]=b):b=e[13];let $;e[14]!==i.destination?($=i.destination?.toString()||"",e[14]=i.destination,e[15]=$):$=e[15];let C;e[16]!==n||e[17]!==i?(C=ee=>n($r({server:i,value:ee})),e[16]=n,e[17]=i,e[18]=C):C=e[18];let k;e[19]!==C||e[20]!==$?(k=o.jsx(le,{className:"mode-reverse-input",content:$,onEditDone:C,placeholder:"example.com"}),e[19]=C,e[20]=$,e[21]=k):k=e[21];let T,P;e[22]===Symbol.for("react.memo_cache_sentinel")?(T=o.jsx("h4",{children:"Advanced Configuration"}),P=o.jsx("p",{children:"Listen Host"}),e[22]=T,e[23]=P):(T=e[22],P=e[23]);const L=i.listen_host||"";let M;e[24]!==n||e[25]!==i?(M=ee=>n(br({server:i,value:ee})),e[24]=n,e[25]=i,e[26]=M):M=e[26];let O;e[27]!==L||e[28]!==M?(O=o.jsx(le,{className:"mode-input",content:L,onEditDone:M,placeholder:"*"}),e[27]=L,e[28]=M,e[29]=O):O=e[29];let H;e[30]===Symbol.for("react.memo_cache_sentinel")?(H=o.jsx("p",{children:"Listen Port"}),e[30]=H):H=e[30];const q=String(i.listen_port||"");let B;e[31]!==n||e[32]!==i?(B=ee=>n(wr({server:i,value:ee})),e[31]=n,e[32]=i,e[33]=B):B=e[33];let z;e[34]!==q||e[35]!==B?(z=o.jsx(le,{className:"mode-input",content:q,onEditDone:B,placeholder:"8080"}),e[34]=q,e[35]=B,e[36]=z):z=e[36];let W;e[37]!==O||e[38]!==z?(W=o.jsxs(st,{iconClass:"fa fa-cog",children:[T,P,O,H,z]}),e[37]=O,e[38]=z,e[39]=W):W=e[39];let J;e[40]!==f||e[41]!==s?(J=s&&o.jsx("i",{className:"fa fa-fw fa-trash fa-lg","aria-hidden":"true",onClick:f}),e[40]=f,e[41]=s,e[42]=J):J=e[42];let Y;e[43]!==i.active||e[44]!==k||e[45]!==W||e[46]!==J||e[47]!==g||e[48]!==b?(Y=o.jsxs(tt,{value:p,label:"Forward",onChange:g,children:[b,"traffic to",k,W,J]}),e[43]=i.active,e[44]=k,e[45]=W,e[46]=J,e[47]=g,e[48]=b,e[49]=Y):Y=e[49];let X;e[50]!==r||e[51]!==h?(X=o.jsx(et,{error:h,backendState:r}),e[50]=r,e[51]=h,e[52]=X):X=e[52];let Z;return e[53]!==Y||e[54]!==X?(Z=o.jsxs("div",{children:[Y,X]}),e[53]=Y,e[54]=X,e[55]=Z):Z=e[55],Z}function rf(t){return o.jsx("option",{value:t,children:t},t)}function of(){const t=E.c(9),e=D(cf),s=D(lf);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=f=>o.jsx(af,{server:f,backendState:s[dr(f)]},f.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const r=i;let n;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=o.jsx("h4",{className:"mode-title",children:"Transparent Proxy"}),t[5]=n):n=t[5];let l;t[6]===Symbol.for("react.memo_cache_sentinel")?(l=o.jsxs("p",{className:"mode-description",children:["You"," ",o.jsx("a",{href:"https://docs.mitmproxy.org/stable/howto-transparent/",style:{textDecoration:"underline",color:"inherit"},children:"configure your routing table"})," ","to send traffic through mitmproxy."]}),t[6]=l):l=t[6];let a;return t[7]!==r?(a=o.jsxs("div",{children:[n,l,r]}),t[7]=r,t[8]=a):a=t[8],a}function lf(t){return t.backendState.servers}function cf(t){return t.modes.transparent}function af(t){const e=E.c(33),{server:s,backendState:i}=t,r=Q(),n=s.error||i?.last_exception||void 0;let l;e[0]!==r||e[1]!==s?(l=()=>r(Nr({server:s,value:!s.active})),e[0]=r,e[1]=s,e[2]=l):l=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=o.jsx("h4",{children:"Advanced Configuration"}),d=o.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const f=s.listen_host||"";let h;e[5]!==r||e[6]!==s?(h=T=>r(kr({server:s,value:T})),e[5]=r,e[6]=s,e[7]=h):h=e[7];let p;e[8]!==f||e[9]!==h?(p=o.jsx(le,{className:"mode-input",content:f,onEditDone:h}),e[8]=f,e[9]=h,e[10]=p):p=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=o.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==r||e[15]!==s?(j=T=>r(Er({server:s,value:parseInt(T)})),e[14]=r,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=o.jsx(le,{className:"mode-input",content:x,placeholder:"8080",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]!==y||e[21]!==p?(b=o.jsxs(st,{iconClass:"fa fa-cog",children:[a,d,p,g,y]}),e[20]=y,e[21]=p,e[22]=b):b=e[22];let $;e[23]!==s.active||e[24]!==l||e[25]!==b?($=o.jsx(tt,{value:s.active,label:"Run Transparent Proxy",onChange:l,children:b}),e[23]=s.active,e[24]=l,e[25]=b,e[26]=$):$=e[26];let C;e[27]!==i||e[28]!==n?(C=o.jsx(et,{error:n,backendState:i}),e[27]=i,e[28]=n,e[29]=C):C=e[29];let k;return e[30]!==$||e[31]!==C?(k=o.jsxs("div",{children:[$,C]}),e[30]=$,e[31]=C,e[32]=k):k=e[32],k}function df(){const t=E.c(9),e=D(uf),s=D(ff);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=f=>o.jsx(pf,{server:f,backendState:s[fr(f)]},f.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const r=i;let n,l;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=o.jsx("h4",{className:"mode-title",children:"SOCKS Proxy"}),l=o.jsx("p",{className:"mode-description",children:"You manually configure your client application or device to use a SOCKS5 proxy."}),t[5]=n,t[6]=l):(n=t[5],l=t[6]);let a;return t[7]!==r?(a=o.jsxs("div",{children:[n,l,r]}),t[7]=r,t[8]=a):a=t[8],a}function ff(t){return t.backendState.servers}function uf(t){return t.modes.socks}function pf(t){const e=E.c(33),{server:s,backendState:i}=t,r=Q(),n=s.error||i?.last_exception||void 0;let l;e[0]!==r||e[1]!==s?(l=()=>r(Tr({server:s,value:!s.active})),e[0]=r,e[1]=s,e[2]=l):l=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=o.jsx("h4",{children:"Advanced Configuration"}),d=o.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const f=s.listen_host||"";let h;e[5]!==r||e[6]!==s?(h=T=>r(Rr({server:s,value:T})),e[5]=r,e[6]=s,e[7]=h):h=e[7];let p;e[8]!==f||e[9]!==h?(p=o.jsx(le,{className:"mode-input",content:f,onEditDone:h}),e[8]=f,e[9]=h,e[10]=p):p=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=o.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==r||e[15]!==s?(j=T=>r(Ar({server:s,value:parseInt(T)})),e[14]=r,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=o.jsx(le,{className:"mode-input",content:x,placeholder:"8080",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]!==y||e[21]!==p?(b=o.jsxs(st,{iconClass:"fa fa-cog",children:[a,d,p,g,y]}),e[20]=y,e[21]=p,e[22]=b):b=e[22];let $;e[23]!==s.active||e[24]!==l||e[25]!==b?($=o.jsx(tt,{value:s.active,label:"Run SOCKS Proxy",onChange:l,children:b}),e[23]=s.active,e[24]=l,e[25]=b,e[26]=$):$=e[26];let C;e[27]!==i||e[28]!==n?(C=o.jsx(et,{error:n,backendState:i}),e[27]=i,e[28]=n,e[29]=C):C=e[29];let k;return e[30]!==$||e[31]!==C?(k=o.jsxs("div",{children:[$,C]}),e[30]=$,e[31]=C,e[32]=k):k=e[32],k}function hf(){const t=E.c(9),e=D(gf),s=D(mf);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=f=>o.jsx(xf,{server:f,backendState:s[ur(f)]},f.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const r=i;let n,l;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=o.jsx("h4",{className:"mode-title",children:"Explicit HTTP(S) Proxy (With Upstream Proxy)"}),l=o.jsx("p",{className:"mode-description",children:"All requests are forwarded to a second HTTP(S) proxy server."}),t[5]=n,t[6]=l):(n=t[5],l=t[6]);let a;return t[7]!==r?(a=o.jsxs("div",{children:[n,l,r]}),t[7]=r,t[8]=a):a=t[8],a}function mf(t){return t.backendState.servers}function gf(t){return t.modes.upstream}function xf(t){const e=E.c(42),{server:s,backendState:i}=t,r=Q(),n=s.error||i?.last_exception||void 0;let l;e[0]!==r||e[1]!==s?(l=()=>{r(Dr({server:s,value:!s.active}))},e[0]=r,e[1]=s,e[2]=l):l=e[2];let a;e[3]!==s.destination?(a=s.destination?.toString()||"",e[3]=s.destination,e[4]=a):a=e[4];let d;e[5]!==r||e[6]!==s?(d=M=>r(Lr({server:s,value:M})),e[5]=r,e[6]=s,e[7]=d):d=e[7];let f;e[8]!==a||e[9]!==d?(f=o.jsx(le,{className:"mode-upstream-input",content:a,onEditDone:d,placeholder:"http://example.com:8080"}),e[8]=a,e[9]=d,e[10]=f):f=e[10];let h,p;e[11]===Symbol.for("react.memo_cache_sentinel")?(h=o.jsx("h4",{children:"Advanced Configuration"}),p=o.jsx("p",{children:"Listen Host"}),e[11]=h,e[12]=p):(h=e[11],p=e[12]);const g=s.listen_host||"";let x;e[13]!==r||e[14]!==s?(x=M=>r(Fr({server:s,value:M})),e[13]=r,e[14]=s,e[15]=x):x=e[15];let j;e[16]!==g||e[17]!==x?(j=o.jsx(le,{className:"mode-input",content:g,onEditDone:x}),e[16]=g,e[17]=x,e[18]=j):j=e[18];let y;e[19]===Symbol.for("react.memo_cache_sentinel")?(y=o.jsx("p",{children:"Listen Port"}),e[19]=y):y=e[19];let b;e[20]!==s.listen_port?(b=s.listen_port?s.listen_port.toString():"",e[20]=s.listen_port,e[21]=b):b=e[21];let $;e[22]!==r||e[23]!==s?($=M=>r(Ir({server:s,value:parseInt(M)})),e[22]=r,e[23]=s,e[24]=$):$=e[24];let C;e[25]!==b||e[26]!==$?(C=o.jsx(le,{className:"mode-input",content:b,placeholder:"8080",onEditDone:$}),e[25]=b,e[26]=$,e[27]=C):C=e[27];let k;e[28]!==C||e[29]!==j?(k=o.jsxs(st,{iconClass:"fa fa-cog",children:[h,p,j,y,C]}),e[28]=C,e[29]=j,e[30]=k):k=e[30];let T;e[31]!==s.active||e[32]!==l||e[33]!==k||e[34]!==f?(T=o.jsxs(tt,{value:s.active,label:"Run HTTP/S Proxy and forward requests to",onChange:l,children:[f,k]}),e[31]=s.active,e[32]=l,e[33]=k,e[34]=f,e[35]=T):T=e[35];let P;e[36]!==i||e[37]!==n?(P=o.jsx(et,{error:n,backendState:i}),e[36]=i,e[37]=n,e[38]=P):P=e[38];let L;return e[39]!==T||e[40]!==P?(L=o.jsxs("div",{children:[T,P]}),e[39]=T,e[40]=P,e[41]=L):L=e[41],L}function vf(){const t=E.c(9),e=D(jf),s=D(_f);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=f=>o.jsx(yf,{server:f,backendState:s[pr(f)]},f.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const r=i;let n,l;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=o.jsx("h4",{className:"mode-title",children:"DNS Server"}),l=o.jsx("p",{className:"mode-description",children:"A recursive DNS resolver using the host's DNS configuration."}),t[5]=n,t[6]=l):(n=t[5],l=t[6]);let a;return t[7]!==r?(a=o.jsxs("div",{children:[n,l,r]}),t[7]=r,t[8]=a):a=t[8],a}function _f(t){return t.backendState.servers}function jf(t){return t.modes.dns}function yf(t){const e=E.c(33),{server:s,backendState:i}=t,r=Q(),n=s.error||i?.last_exception||void 0;let l;e[0]!==r||e[1]!==s?(l=()=>r(Pr({server:s,value:!s.active})),e[0]=r,e[1]=s,e[2]=l):l=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=o.jsx("h4",{children:"Advanced Configuration"}),d=o.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const f=s.listen_host||"";let h;e[5]!==r||e[6]!==s?(h=T=>r(Mr({server:s,value:T})),e[5]=r,e[6]=s,e[7]=h):h=e[7];let p;e[8]!==f||e[9]!==h?(p=o.jsx(le,{className:"mode-input",content:f,onEditDone:h}),e[8]=f,e[9]=h,e[10]=p):p=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=o.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==r||e[15]!==s?(j=T=>r(Or({server:s,value:parseInt(T)})),e[14]=r,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=o.jsx(le,{className:"mode-input",content:x,placeholder:"8080",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]!==y||e[21]!==p?(b=o.jsxs(st,{iconClass:"fa fa-cog",children:[a,d,p,g,y]}),e[20]=y,e[21]=p,e[22]=b):b=e[22];let $;e[23]!==s.active||e[24]!==l||e[25]!==b?($=o.jsx(tt,{value:s.active,label:"Run DNS Server",onChange:l,children:b}),e[23]=s.active,e[24]=l,e[25]=b,e[26]=$):$=e[26];let C;e[27]!==i||e[28]!==n?(C=o.jsx(et,{error:n,backendState:i}),e[27]=i,e[28]=n,e[29]=C):C=e[29];let k;return e[30]!==$||e[31]!==C?(k=o.jsxs("div",{children:[$,C]}),e[30]=$,e[31]=C,e[32]=k):k=e[32],k}function ui(t){const e=E.c(10),{title:s,description:i}=t;let r;e[0]!==s?(r=o.jsx("h4",{className:"mode-title",children:s}),e[0]=s,e[1]=r):r=e[1];let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=o.jsx("i",{className:"fa fa-exclamation-triangle","aria-hidden":"true"}),e[2]=n):n=e[2];let l;e[3]!==r?(l=o.jsxs("div",{className:"title-icon-container",children:[r,n]}),e[3]=r,e[4]=l):l=e[4];let a;e[5]!==i?(a=o.jsx("p",{className:"mode-description",children:i}),e[5]=i,e[6]=a):a=e[6];let d;return e[7]!==l||e[8]!==a?(d=o.jsxs("div",{className:"missing-mode-container",children:[l,a]}),e[7]=l,e[8]=a,e[9]=d):d=e[9],d}function bf(){const t=E.c(19),{platform:e,localModeUnavailable:s}=D(wf);let i,r;t[0]===Symbol.for("react.memo_cache_sentinel")?(i=o.jsx("h2",{children:"Intercept Traffic"}),r=o.jsx("p",{children:"Configure how you want to intercept traffic with mitmproxy."}),t[0]=i,t[1]=r):(i=t[0],r=t[1]);let n;t[2]===Symbol.for("react.memo_cache_sentinel")?(n=o.jsx("h3",{children:"Recommended"}),t[2]=n):n=t[2];let l;t[3]===Symbol.for("react.memo_cache_sentinel")?(l=o.jsx(Kd,{}),t[3]=l):l=t[3];let a;t[4]!==s?(a=s!==null?o.jsx(ui,{title:"Local Redirect Mode",description:s}):o.jsx(qd,{}),t[4]=s,t[5]=a):a=t[5];let d,f;t[6]===Symbol.for("react.memo_cache_sentinel")?(d=o.jsx(Yd,{}),f=o.jsx(ef,{}),t[6]=d,t[7]=f):(d=t[6],f=t[7]);let h;t[8]!==a?(h=o.jsxs("div",{className:"modes-category green-left-border",children:[n,o.jsxs("div",{className:"modes-container",children:[l,a,d,f]})]}),t[8]=a,t[9]=h):h=t[9];let p;t[10]===Symbol.for("react.memo_cache_sentinel")?(p=o.jsx("h3",{children:"Advanced"}),t[10]=p):p=t[10];let g,x,j;t[11]===Symbol.for("react.memo_cache_sentinel")?(j=o.jsx(df,{}),g=o.jsx(hf,{}),x=o.jsx(vf,{}),t[11]=g,t[12]=x,t[13]=j):(g=t[11],x=t[12],j=t[13]);let y;t[14]!==e?(y=o.jsxs("div",{className:"modes-category gray-left-border",children:[p,o.jsxs("div",{className:"modes-container",children:[j,g,x,e.startsWith("win32")?o.jsx(ui,{title:"Transparent Proxy",description:"This mode is only supported on Linux and MacOS."}):o.jsx(of,{})]})]}),t[14]=e,t[15]=y):y=t[15];let b;return t[16]!==y||t[17]!==h?(b=o.jsxs("div",{className:"modes",children:[i,r,h,y]}),t[16]=y,t[17]=h,t[18]=b):b=t[18],b}function wf(t){return t.backendState}function Sf(t){const e=t.filter(d=>d.type==="http"),s=e.length,i=e.filter(d=>d.response&&d.response.status_code>=400).length,r=s>0?i/s*100:0,n=e.filter(d=>d.response?.timestamp_end&&d.request?.timestamp_start).map(d=>{const f=d.request.timestamp_start;return(d.response.timestamp_end-f)*1e3}),l=n.length>0?n.reduce((d,f)=>d+f,0)/n.length:0,a=n.filter(d=>d>1e3).length;return{totalRequests:s,errorRate:r,avgResponseTime:l,slowQueries:a}}function $f(t){const e=t.filter(i=>i.type==="http"),s=new Map;return e.forEach(i=>{if(i.response){const r=i.response.status_code;s.set(r,(s.get(r)||0)+1)}}),Array.from(s.entries()).map(([i,r])=>({code:i,count:r})).sort((i,r)=>r.count-i.count).slice(0,10)}function Cf(t){const e=t.filter(i=>i.type==="http"),s=new Map;return e.forEach(i=>{const r=i.request.pretty_host,n=s.get(r)||{count:0,totalTime:0};if(n.count+=1,i.response?.timestamp_end&&i.request?.timestamp_start){const l=(i.response.timestamp_end-i.request.timestamp_start)*1e3;n.totalTime+=l}s.set(r,n)}),Array.from(s.entries()).map(([i,r])=>({domain:i,count:r.count,avgTime:r.count>0?r.totalTime/r.count:0})).sort((i,r)=>r.count-i.count).slice(0,10)}function Nf(t,e=5e3){const s=t.filter(r=>r.type==="http"),i=new Map;return s.forEach(r=>{if(r.response?.timestamp_end&&r.request?.timestamp_start){const n=Math.floor(r.request.timestamp_start*1e3),l=Math.floor(n/e)*e,a=(r.response.timestamp_end-r.request.timestamp_start)*1e3;i.has(l)||i.set(l,[]),i.get(l).push(a)}}),Array.from(i.entries()).map(([r,n])=>({timestamp:r,time:n.reduce((l,a)=>l+a,0)/n.length})).sort((r,n)=>r.timestamp-n.timestamp).slice(-50)}function as(t){return t.toLocaleString()}function kf(t){return t<1e3?`${Math.round(t)}ms`:`${(t/1e3).toFixed(2)}s`}function Ef(t){return`${t.toFixed(1)}%`}function Tf(t){const e=E.c(13),{flows:s}=t;let i;e[0]!==s?(i=Nf(s),e[0]=s,e[1]=i):i=e[1];const r=i;if(r.length===0){let j;return e[2]===Symbol.for("react.memo_cache_sentinel")?(j=o.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"No response time data available"}),e[2]=j):j=e[2],j}let n;e[3]===Symbol.for("react.memo_cache_sentinel")?(n={width:"100%",height:300},e[3]=n):n=e[3];let l,a;e[4]===Symbol.for("react.memo_cache_sentinel")?(l={top:5,right:30,left:20,bottom:5},a=o.jsx(ji,{strokeDasharray:"3 3"}),e[4]=l,e[5]=a):(l=e[4],a=e[5]);let d;e[6]===Symbol.for("react.memo_cache_sentinel")?(d=o.jsx(yi,{dataKey:"timestamp",tickFormatter:Df,label:{value:"Time",position:"insideBottom",offset:-5}}),e[6]=d):d=e[6];let f,h,p,g;e[7]===Symbol.for("react.memo_cache_sentinel")?(f=o.jsx(hs,{label:{value:"Response Time (ms)",angle:-90,position:"insideLeft"}}),h=o.jsx(ys,{labelFormatter:Af,formatter:Rf}),p=o.jsx(bs,{}),g=o.jsx(zl,{type:"monotone",dataKey:"time",stroke:"#8884d8",strokeWidth:2,dot:!1,name:"Response Time"}),e[7]=f,e[8]=h,e[9]=p,e[10]=g):(f=e[7],h=e[8],p=e[9],g=e[10]);let x;return e[11]!==r?(x=o.jsx("div",{style:n,children:o.jsx(ws,{children:o.jsxs(Gl,{data:r,margin:l,children:[a,d,f,h,p,g]})})}),e[11]=r,e[12]=x):x=e[12],x}function Rf(t){return[`${t.toFixed(2)}ms`,"Avg Response Time"]}function Af(t){return new Date(t).toLocaleTimeString()}function Df(t){const e=new Date(t);return`${e.getHours()}:${String(e.getMinutes()).padStart(2,"0")}`}const yt={"2xx":"#10b981","3xx":"#3b82f6","4xx":"#f59e0b","5xx":"#ef4444",default:"#6b7280"};function Ff(t){return t>=200&&t<300?yt["2xx"]:t>=300&&t<400?yt["3xx"]:t>=400&&t<500?yt["4xx"]:t>=500&&t<600?yt["5xx"]:yt.default}function If(t){const e=E.c(13),{flows:s}=t;let i;e[0]!==s?(i=$f(s).map(qf),e[0]=s,e[1]=i):i=e[1];const r=i;if(r.length===0){let p;return e[2]===Symbol.for("react.memo_cache_sentinel")?(p=o.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"No status code data available"}),e[2]=p):p=e[2],p}let n;e[3]===Symbol.for("react.memo_cache_sentinel")?(n={width:"100%",height:300},e[3]=n):n=e[3];let l;e[4]!==r?(l=r.map(Mf),e[4]=r,e[5]=l):l=e[5];let a;e[6]!==r||e[7]!==l?(a=o.jsx(Ql,{data:r,cx:"50%",cy:"50%",labelLine:!1,label:Of,outerRadius:80,fill:"#8884d8",dataKey:"value",children:l}),e[6]=r,e[7]=l,e[8]=a):a=e[8];let d,f;e[9]===Symbol.for("react.memo_cache_sentinel")?(d=o.jsx(ys,{formatter:Pf}),f=o.jsx(bs,{formatter:Lf}),e[9]=d,e[10]=f):(d=e[9],f=e[10]);let h;return e[11]!==a?(h=o.jsx("div",{style:n,children:o.jsx(ws,{children:o.jsxs(Yl,{children:[a,d,f]})})}),e[11]=a,e[12]=h):h=e[12],h}function Lf(t,e){return`${t} (${e.payload.value})`}function Pf(t,e){return[`${t} requests`,`Status ${e}`]}function Mf(t,e){return o.jsx(Jl,{fill:t.fill},`cell-${e}`)}function Of(t){const{name:e,percent:s}=t;return`${e} (${(s*100).toFixed(0)}%)`}function qf(t){return{name:`${t.code}`,value:t.count,fill:Ff(t.code)}}function Hf(t){const e=E.c(15),{flows:s}=t;let i;e[0]!==s?(i=Cf(s),e[0]=s,e[1]=i):i=e[1];const r=i;if(r.length===0){let b;return e[2]===Symbol.for("react.memo_cache_sentinel")?(b=o.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"No domain data available"}),e[2]=b):b=e[2],b}let n;e[3]===Symbol.for("react.memo_cache_sentinel")?(n={width:"100%",height:300},e[3]=n):n=e[3];let l,a;e[4]===Symbol.for("react.memo_cache_sentinel")?(l={top:5,right:30,left:20,bottom:60},a=o.jsx(ji,{strokeDasharray:"3 3"}),e[4]=l,e[5]=a):(l=e[4],a=e[5]);let d;e[6]===Symbol.for("react.memo_cache_sentinel")?(d=o.jsx(yi,{dataKey:"domain",angle:-45,textAnchor:"end",height:100,interval:0,tick:{fontSize:10}}),e[6]=d):d=e[6];let f;e[7]===Symbol.for("react.memo_cache_sentinel")?(f=o.jsx(hs,{yAxisId:"left",label:{value:"Request Count",angle:-90,position:"insideLeft"}}),e[7]=f):f=e[7];let h,p,g,x,j;e[8]===Symbol.for("react.memo_cache_sentinel")?(g=o.jsx(hs,{yAxisId:"right",orientation:"right",label:{value:"Avg Time (ms)",angle:90,position:"insideRight"}}),x=o.jsx(ys,{formatter:Vf}),j=o.jsx(bs,{}),h=o.jsx(zn,{yAxisId:"left",dataKey:"count",fill:"#8884d8",name:"Request Count"}),p=o.jsx(zn,{yAxisId:"right",dataKey:"avgTime",fill:"#82ca9d",name:"Avg Response Time"}),e[8]=h,e[9]=p,e[10]=g,e[11]=x,e[12]=j):(h=e[8],p=e[9],g=e[10],x=e[11],j=e[12]);let y;return e[13]!==r?(y=o.jsx("div",{style:n,children:o.jsx(ws,{children:o.jsxs(Xl,{data:r,margin:l,children:[a,d,f,g,x,j,h,p]})})}),e[13]=r,e[14]=y):y=e[14],y}function Vf(t,e){return e==="count"?[`${t} requests`,"Count"]:[`${t.toFixed(2)}ms`,"Avg Time"]}function Uf(t){const e=E.c(52),{flows:s}=t;let i;e[0]!==s?(i=Sf(s),e[0]=s,e[1]=i):i=e[1];const r=i;let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=o.jsx("h2",{children:"📊 Network Metrics"}),e[2]=n):n=e[2];let l;e[3]===Symbol.for("react.memo_cache_sentinel")?(l=o.jsx("div",{className:"metric-label",children:"Total Requests"}),e[3]=l):l=e[3];let a;e[4]!==r.totalRequests?(a=as(r.totalRequests),e[4]=r.totalRequests,e[5]=a):a=e[5];let d;e[6]!==a?(d=o.jsxs("div",{className:"metric-card",children:[l,o.jsx("div",{className:"metric-value",children:a})]}),e[6]=a,e[7]=d):d=e[7];let f;e[8]===Symbol.for("react.memo_cache_sentinel")?(f=o.jsx("div",{className:"metric-label",children:"Error Rate"}),e[8]=f):f=e[8];let h;e[9]!==r.errorRate?(h=Ef(r.errorRate),e[9]=r.errorRate,e[10]=h):h=e[10];let p;e[11]!==h?(p=o.jsxs("div",{className:"metric-card",children:[f,o.jsx("div",{className:"metric-value",children:h})]}),e[11]=h,e[12]=p):p=e[12];let g;e[13]===Symbol.for("react.memo_cache_sentinel")?(g=o.jsx("div",{className:"metric-label",children:"Avg Response Time"}),e[13]=g):g=e[13];let x;e[14]!==r.avgResponseTime?(x=kf(r.avgResponseTime),e[14]=r.avgResponseTime,e[15]=x):x=e[15];let j;e[16]!==x?(j=o.jsxs("div",{className:"metric-card",children:[g,o.jsx("div",{className:"metric-value",children:x})]}),e[16]=x,e[17]=j):j=e[17];let y;e[18]===Symbol.for("react.memo_cache_sentinel")?(y=o.jsx("div",{className:"metric-label",children:"Slow Queries (>1s)"}),e[18]=y):y=e[18];let b;e[19]!==r.slowQueries?(b=as(r.slowQueries),e[19]=r.slowQueries,e[20]=b):b=e[20];let $;e[21]!==b?($=o.jsxs("div",{className:"metric-card",children:[y,o.jsx("div",{className:"metric-value",children:b})]}),e[21]=b,e[22]=$):$=e[22];let C;e[23]!==j||e[24]!==$||e[25]!==d||e[26]!==p?(C=o.jsxs("div",{className:"metrics-grid",children:[d,p,j,$]}),e[23]=j,e[24]=$,e[25]=d,e[26]=p,e[27]=C):C=e[27];let k;e[28]===Symbol.for("react.memo_cache_sentinel")?(k=o.jsx("h3",{children:"Response Time Over Time"}),e[28]=k):k=e[28];let T;e[29]!==s?(T=o.jsxs("div",{className:"chart-container",children:[k,o.jsx(Tf,{flows:s})]}),e[29]=s,e[30]=T):T=e[30];let P;e[31]===Symbol.for("react.memo_cache_sentinel")?(P=o.jsx("h3",{children:"Status Code Distribution"}),e[31]=P):P=e[31];let L;e[32]!==s?(L=o.jsxs("div",{className:"chart-container",children:[P,o.jsx(If,{flows:s})]}),e[32]=s,e[33]=L):L=e[33];let M;e[34]===Symbol.for("react.memo_cache_sentinel")?(M=o.jsx("h3",{children:"Top Domains by Request Count"}),e[34]=M):M=e[34];let O;e[35]!==s?(O=o.jsxs("div",{className:"chart-container",children:[M,o.jsx(Hf,{flows:s})]}),e[35]=s,e[36]=O):O=e[36];let H;e[37]!==L||e[38]!==O?(H=o.jsxs("div",{className:"charts-row",children:[L,O]}),e[37]=L,e[38]=O,e[39]=H):H=e[39];let q;e[40]!==T||e[41]!==H?(q=o.jsxs("div",{className:"charts-section",children:[T,H]}),e[40]=T,e[41]=H,e[42]=q):q=e[42];let B;e[43]===Symbol.for("react.memo_cache_sentinel")?(B=o.jsx("p",{children:"✨ Kidsnote mitmweb - Network Debugging Tool"}),e[43]=B):B=e[43];let z;e[44]!==s.length?(z=as(s.length),e[44]=s.length,e[45]=z):z=e[45];let W;e[46]!==z?(W=o.jsxs("div",{className:"metrics-info",children:[B,o.jsxs("p",{children:["🚀 Phase 1: MVP - Real-time metrics from ",z," ","flows"]})]}),e[46]=z,e[47]=W):W=e[47];let J;return e[48]!==C||e[49]!==q||e[50]!==W?(J=o.jsxs("div",{className:"kidsnote-metrics-panel",children:[n,C,q,W]}),e[48]=C,e[49]=q,e[50]=W,e[51]=J):J=e[51],J}const Bf=Tt(t=>({flows:t.flows.list}))(Uf);function Wf(){const t=E.c(4),e=D(Gf),s=D(zf),i=D(Kf);let r;return t[0]!==i||t[1]!==s||t[2]!==e?(r=o.jsx("div",{className:"main-view",children:i===fe.Capture?o.jsx(bf,{}):i===fe.Metrics?o.jsx(Bf,{}):o.jsxs(o.Fragment,{children:[s?o.jsx(Rd,{}):o.jsx(Ad,{}),e&&o.jsxs(o.Fragment,{children:[o.jsx(wd,{},"splitter"),o.jsx(_d,{},"flowDetails")]})]})}),t[0]=i,t[1]=s,t[2]=e,t[3]=r):r=t[3],r}function Kf(t){return t.ui.tabs.current}function zf(t){return t.flows.list.length>0}function Gf(t){return t.flows.selected.length===1}function gt(t){const e=E.c(2),{children:s}=t;let i;return e[0]!==s?(i=window.MITMWEB_STATIC?null:o.jsx(o.Fragment,{children:s}),e[0]=s,e[1]=i):i=e[1],i}const Qf=I.memo(function(){const e=E.c(20),s=Q(),i=D(Yf);let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r={placement:"bottom-start"},e[0]=r):r=e[0];let n;e[1]!==s?(n=o.jsx("li",{children:o.jsx(Ur,{icon:"fa-folder-open",text:" Open...",onClick:Jf,onOpenFile:b=>{s(xc(b)),document.body.click()}})}),e[1]=s,e[2]=n):n=e[2];let l;e[3]===Symbol.for("react.memo_cache_sentinel")?(l=o.jsxs(Ne,{onClick:Xf,children:[o.jsx("i",{className:"fa fa-fw fa-floppy-o"})," Save"]}),e[3]=l):l=e[3];let a;e[4]!==i?(a=()=>location.replace("/flows/dump?filter="+i),e[4]=i,e[5]=a):a=e[5];let d;e[6]===Symbol.for("react.memo_cache_sentinel")?(d=o.jsx("i",{className:"fa fa-fw fa-floppy-o"}),e[6]=d):d=e[6];let f;e[7]!==a?(f=o.jsxs(Ne,{onClick:a,children:[d," Save filtered"]}),e[7]=a,e[8]=f):f=e[8];let h;e[9]!==s?(h=()=>confirm("Delete all flows?")&&s(zi()),e[9]=s,e[10]=h):h=e[10];let p;e[11]===Symbol.for("react.memo_cache_sentinel")?(p=o.jsx("i",{className:"fa fa-fw fa-trash"}),e[11]=p):p=e[11];let g;e[12]!==h?(g=o.jsxs(Ne,{onClick:h,children:[p," Clear All"]}),e[12]=h,e[13]=g):g=e[13];let x;e[14]===Symbol.for("react.memo_cache_sentinel")?(x=o.jsx(Ba,{}),e[14]=x):x=e[14];let j;e[15]===Symbol.for("react.memo_cache_sentinel")?(j=o.jsxs(gt,{children:[x,o.jsx("li",{children:o.jsxs("a",{href:"http://mitm.it/",target:"_blank",rel:"noreferrer",children:[o.jsx("i",{className:"fa fa-fw fa-external-link"})," Install Certificates..."]})})]}),e[15]=j):j=e[15];let y;return e[16]!==n||e[17]!==f||e[18]!==g?(y=o.jsxs(Rt,{className:"pull-left special",text:"File",options:r,children:[n,l,f,g,j]}),e[16]=n,e[17]=f,e[18]=g,e[19]=y):y=e[19],y});function Yf(t){return t.ui.filter[xe.Search]}function Jf(t){return t.stopPropagation()}function Xf(){return location.replace("/flows/dump")}const Zf=I.memo(function(){const e=E.c(5),s=D(eu),i=D(tu);switch(s){case wt.INIT:{let r;return e[0]===Symbol.for("react.memo_cache_sentinel")?(r=o.jsx("span",{className:"connection-indicator init",children:"connecting…"}),e[0]=r):r=e[0],r}case wt.FETCHING:{let r;return e[1]===Symbol.for("react.memo_cache_sentinel")?(r=o.jsx("span",{className:"connection-indicator fetching",children:"fetching data…"}),e[1]=r):r=e[1],r}case wt.ESTABLISHED:{let r;return e[2]===Symbol.for("react.memo_cache_sentinel")?(r=o.jsx("span",{className:"connection-indicator established",children:"connected"}),e[2]=r):r=e[2],r}case wt.ERROR:{let r;return e[3]!==i?(r=o.jsx("span",{className:"connection-indicator error",title:i,children:"connection lost"}),e[3]=i,e[4]=r):r=e[4],r}default:Nt(s)}});function eu(t){return t.connection.state}function tu(t){return t.connection.message}lo.title="Capture";function lo(){const t=E.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=o.jsx(o.Fragment,{}),t[0]=e):e=t[0],e}const pi=function(){function t(i,r){function n(){this.constructor=i}n.prototype=r.prototype,i.prototype=new n}function e(i,r,n,l){this.message=i,this.expected=r,this.found=n,this.location=l,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,e)}t(e,Error);function s(i){var r=arguments.length>1?arguments[1]:{},n={},l={start:$n},a=$n,d={type:"other",description:"filter expression"},f=function(c){return c},h={type:"other",description:"whitespace"},p=/^[ \t\n\r]/,g={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},x={type:"other",description:"control character"},j=/^[|&!()~"]/,y={type:"class",value:'[|&!()~"]',description:'[|&!()~"]'},b={type:"other",description:"optional whitespace"},$="|",C={type:"literal",value:"|",description:'"|"'},k=function(c,u){return hl(c,u)},T="&",P={type:"literal",value:"&",description:'"&"'},L=function(c,u){return ml(c,u)},M="!",O={type:"literal",value:"!",description:'"!"'},H=function(c){return gl(c)},q="(",B={type:"literal",value:"(",description:'"("'},z=")",W={type:"literal",value:")",description:'")"'},J=function(c){return xl(c)},Y="~all",X={type:"literal",value:"~all",description:'"~all"'},Z=function(){return Tn},ee="~a",de={type:"literal",value:"~a",description:'"~a"'},ge=function(){return An},be="~b",Be={type:"literal",value:"~b",description:'"~b"'},Le=function(c){return vl(c)},we="~bq",ke={type:"literal",value:"~bq",description:'"~bq"'},N=function(c){return _l(c)},pe="~bs",K={type:"literal",value:"~bs",description:'"~bs"'},oe=function(c){return jl(c)},V="~c",Se={type:"literal",value:"~c",description:'"~c"'},We=function(c){return yl(c)},Pe="~comment",te={type:"literal",value:"~comment",description:'"~comment"'},Me=function(c){return bl(c)},Te="~d",re={type:"literal",value:"~d",description:'"~d"'},ce=function(c){return wl(c)},me="~dns",Re={type:"literal",value:"~dns",description:'"~dns"'},nt=function(){return Dn},Ye="~dst",es={type:"literal",value:"~dst",description:'"~dst"'},w=function(c){return Sl(c)},S="~e",A={type:"literal",value:"~e",description:'"~e"'},U=function(){return Fn},At="~h",ts={type:"literal",value:"~h",description:'"~h"'},$e=function(c){return $l(c)},Ae="~hq",ft={type:"literal",value:"~hq",description:'"~hq"'},Ke=function(c){return Cl(c)},xt="~hs",Dt={type:"literal",value:"~hs",description:'"~hs"'},it=function(c){return Nl(c)},Ft="~http",ut={type:"literal",value:"~http",description:'"~http"'},De=function(){return In},Qs="~marked",ho={type:"literal",value:"~marked",description:'"~marked"'},mo=function(){return Ln},Ys="~marker",go={type:"literal",value:"~marker",description:'"~marker"'},xo=function(c){return kl(c)},Js="~m",vo={type:"literal",value:"~m",description:'"~m"'},_o=function(c){return El(c)},Xs="~q",jo={type:"literal",value:"~q",description:'"~q"'},yo=function(){return Pn},Zs="~replayq",bo={type:"literal",value:"~replayq",description:'"~replayq"'},wo=function(){return Mn},en="~replays",So={type:"literal",value:"~replays",description:'"~replays"'},$o=function(){return On},tn="~replay",Co={type:"literal",value:"~replay",description:'"~replay"'},No=function(){return qn},sn="~src",ko={type:"literal",value:"~src",description:'"~src"'},Eo=function(c){return Tl(c)},nn="~s",To={type:"literal",value:"~s",description:'"~s"'},Ro=function(){return Hn},rn="~tcp",Ao={type:"literal",value:"~tcp",description:'"~tcp"'},Do=function(){return Vn},on="~udp",Fo={type:"literal",value:"~udp",description:'"~udp"'},Io=function(){return Un},ln="~tq",Lo={type:"literal",value:"~tq",description:'"~tq"'},Po=function(c){return Rl(c)},cn="~ts",Mo={type:"literal",value:"~ts",description:'"~ts"'},Oo=function(c){return Al(c)},an="~t",qo={type:"literal",value:"~t",description:'"~t"'},Ho=function(c){return Dl(c)},dn="~u",Vo={type:"literal",value:"~u",description:'"~u"'},fn=function(c){return Fl(c)},un="~websocket",Uo={type:"literal",value:"~websocket",description:'"~websocket"'},Bo=function(){return Bn},Wo={type:"other",description:"integer"},pn=/^['"]/,hn={type:"class",value:`['"]`,description:`['"]`},mn=/^[0-9]/,gn={type:"class",value:"[0-9]",description:"[0-9]"},Ko=function(c){return parseInt(c.join(""),10)},zo={type:"other",description:"string"},xn='"',vn={type:"literal",value:'"',description:'"\\""'},ss=function(c){return c.join("")},_n="'",jn={type:"literal",value:"'",description:`"'"`},Go=/^["\\]/,Qo={type:"class",value:'["\\\\]',description:'["\\\\]'},ns={type:"any",description:"any character"},vt=function(c){return c},yn="\\",bn={type:"literal",value:"\\",description:'"\\\\"'},Yo=/^['\\]/,Jo={type:"class",value:"['\\\\]",description:"['\\\\]"},Xo=/^['"\\]/,Zo={type:"class",value:`['"\\\\]`,description:`['"\\\\]`},el="n",tl={type:"literal",value:"n",description:'"n"'},sl=function(){return`
`},nl="r",il={type:"literal",value:"r",description:'"r"'},rl=function(){return"\r"},ol="t",ll={type:"literal",value:"t",description:'"t"'},cl=function(){return"	"},m=0,It=[{line:1,column:1,seenCR:!1}],Oe=0,is=[],R=0,Lt;if("startRule"in r){if(!(r.startRule in l))throw new Error(`Can't start parsing from rule "`+r.startRule+'".');a=l[r.startRule]}function wn(c){var u=It[c],v,_;if(u)return u;for(v=c-1;!It[v];)v--;for(u=It[v],u={line:u.line,column:u.column,seenCR:u.seenCR};v<c;)_=i.charAt(v),_===`
`?(u.seenCR||u.line++,u.column=1,u.seenCR=!1):_==="\r"||_==="\u2028"||_==="\u2029"?(u.line++,u.column=1,u.seenCR=!0):(u.column++,u.seenCR=!1),v++;return It[c]=u,u}function Sn(c,u){var v=wn(c),_=wn(u);return{start:{offset:c,line:v.line,column:v.column},end:{offset:u,line:_.line,column:_.column}}}function F(c){m<Oe||(m>Oe&&(Oe=m,is=[]),is.push(c))}function al(c,u,v,_){function qe(Fe){var Je=1;for(Fe.sort(function(Ot,rt){return Ot.description<rt.description?-1:Ot.description>rt.description?1:0});Je<Fe.length;)Fe[Je-1]===Fe[Je]?Fe.splice(Je,1):Je++}function Ce(Fe,Je){function Ot(Il){function qt(Ge){return Ge.charCodeAt(0).toString(16).toUpperCase()}return Il.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(Ge){return"\\x0"+qt(Ge)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(Ge){return"\\x"+qt(Ge)}).replace(/[\u0100-\u0FFF]/g,function(Ge){return"\\u0"+qt(Ge)}).replace(/[\u1000-\uFFFF]/g,function(Ge){return"\\u"+qt(Ge)})}var rt=new Array(Fe.length),Wn,Kn,_t;for(_t=0;_t<Fe.length;_t++)rt[_t]=Fe[_t].description;return Wn=Fe.length>1?rt.slice(0,-1).join(", ")+" or "+rt[Fe.length-1]:rt[0],Kn=Je?'"'+Ot(Je)+'"':"end of input","Expected "+Wn+" but "+Kn+" found."}return u!==null&&qe(u),new e(Ce(u,v),u,v,_)}function $n(){var c,u,v,_;return R++,c=m,u=ze(),u!==n?(v=rs(),v!==n?(_=ze(),_!==n?(u=f(v),c=u):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),R--,c===n&&(u=n,R===0&&F(d)),c}function G(){var c;return R++,p.test(i.charAt(m))?(c=i.charAt(m),m++):(c=n,R===0&&F(g)),R--,c===n&&R===0&&F(h),c}function dl(){var c;return R++,j.test(i.charAt(m))?(c=i.charAt(m),m++):(c=n,R===0&&F(y)),R--,c===n&&R===0&&F(x),c}function ze(){var c,u;for(R++,c=[],u=G();u!==n;)c.push(u),u=G();return R--,c===n&&(u=n,R===0&&F(b)),c}function rs(){var c,u,v,_,qe,Ce;return c=m,u=Pt(),u!==n?(v=ze(),v!==n?(i.charCodeAt(m)===124?(_=$,m++):(_=n,R===0&&F(C)),_!==n?(qe=ze(),qe!==n?(Ce=rs(),Ce!==n?(u=k(u,Ce),c=u):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),c===n&&(c=Pt()),c}function Pt(){var c,u,v,_,qe,Ce;if(c=m,u=Mt(),u!==n?(v=ze(),v!==n?(i.charCodeAt(m)===38?(_=T,m++):(_=n,R===0&&F(P)),_!==n?(qe=ze(),qe!==n?(Ce=Pt(),Ce!==n?(u=L(u,Ce),c=u):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),c===n){if(c=m,u=Mt(),u!==n){if(v=[],_=G(),_!==n)for(;_!==n;)v.push(_),_=G();else v=n;v!==n?(_=Pt(),_!==n?(u=L(u,_),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;c===n&&(c=Mt())}return c}function Mt(){var c,u,v,_;return c=m,i.charCodeAt(m)===33?(u=M,m++):(u=n,R===0&&F(O)),u!==n?(v=ze(),v!==n?(_=Mt(),_!==n?(u=H(_),c=u):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),c===n&&(c=fl()),c}function fl(){var c,u,v,_,qe,Ce;return c=m,i.charCodeAt(m)===40?(u=q,m++):(u=n,R===0&&F(B)),u!==n?(v=ze(),v!==n?(_=rs(),_!==n?(qe=ze(),qe!==n?(i.charCodeAt(m)===41?(Ce=z,m++):(Ce=n,R===0&&F(W)),Ce!==n?(u=J(_),c=u):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),c===n&&(c=ul()),c}function ul(){var c,u,v,_;if(c=m,i.substr(m,4)===Y?(u=Y,m+=4):(u=n,R===0&&F(X)),u!==n&&(u=Z()),c=u,c===n&&(c=m,i.substr(m,2)===ee?(u=ee,m+=2):(u=n,R===0&&F(de)),u!==n&&(u=ge()),c=u,c===n)){if(c=m,i.substr(m,2)===be?(u=be,m+=2):(u=n,R===0&&F(Be)),u!==n){if(v=[],_=G(),_!==n)for(;_!==n;)v.push(_),_=G();else v=n;v!==n?(_=he(),_!==n?(u=Le(_),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===we?(u=we,m+=3):(u=n,R===0&&F(ke)),u!==n){if(v=[],_=G(),_!==n)for(;_!==n;)v.push(_),_=G();else v=n;v!==n?(_=he(),_!==n?(u=N(_),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===pe?(u=pe,m+=3):(u=n,R===0&&F(K)),u!==n){if(v=[],_=G(),_!==n)for(;_!==n;)v.push(_),_=G();else v=n;v!==n?(_=he(),_!==n?(u=oe(_),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===V?(u=V,m+=2):(u=n,R===0&&F(Se)),u!==n){if(v=[],_=G(),_!==n)for(;_!==n;)v.push(_),_=G();else v=n;v!==n?(_=pl(),_!==n?(u=We(_),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,8)===Pe?(u=Pe,m+=8):(u=n,R===0&&F(te)),u!==n){if(v=[],_=G(),_!==n)for(;_!==n;)v.push(_),_=G();else v=n;v!==n?(_=he(),_!==n?(u=Me(_),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===Te?(u=Te,m+=2):(u=n,R===0&&F(re)),u!==n){if(v=[],_=G(),_!==n)for(;_!==n;)v.push(_),_=G();else v=n;v!==n?(_=he(),_!==n?(u=ce(_),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,4)===me?(u=me,m+=4):(u=n,R===0&&F(Re)),u!==n&&(u=nt()),c=u,c===n)){if(c=m,i.substr(m,4)===Ye?(u=Ye,m+=4):(u=n,R===0&&F(es)),u!==n){if(v=[],_=G(),_!==n)for(;_!==n;)v.push(_),_=G();else v=n;v!==n?(_=he(),_!==n?(u=w(_),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,2)===S?(u=S,m+=2):(u=n,R===0&&F(A)),u!==n&&(u=U()),c=u,c===n)){if(c=m,i.substr(m,2)===At?(u=At,m+=2):(u=n,R===0&&F(ts)),u!==n){if(v=[],_=G(),_!==n)for(;_!==n;)v.push(_),_=G();else v=n;v!==n?(_=he(),_!==n?(u=$e(_),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===Ae?(u=Ae,m+=3):(u=n,R===0&&F(ft)),u!==n){if(v=[],_=G(),_!==n)for(;_!==n;)v.push(_),_=G();else v=n;v!==n?(_=he(),_!==n?(u=Ke(_),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===xt?(u=xt,m+=3):(u=n,R===0&&F(Dt)),u!==n){if(v=[],_=G(),_!==n)for(;_!==n;)v.push(_),_=G();else v=n;v!==n?(_=he(),_!==n?(u=it(_),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,5)===Ft?(u=Ft,m+=5):(u=n,R===0&&F(ut)),u!==n&&(u=De()),c=u,c===n&&(c=m,i.substr(m,7)===Qs?(u=Qs,m+=7):(u=n,R===0&&F(ho)),u!==n&&(u=mo()),c=u,c===n))){if(c=m,i.substr(m,7)===Ys?(u=Ys,m+=7):(u=n,R===0&&F(go)),u!==n){if(v=[],_=G(),_!==n)for(;_!==n;)v.push(_),_=G();else v=n;v!==n?(_=he(),_!==n?(u=xo(_),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===Js?(u=Js,m+=2):(u=n,R===0&&F(vo)),u!==n){if(v=[],_=G(),_!==n)for(;_!==n;)v.push(_),_=G();else v=n;v!==n?(_=he(),_!==n?(u=_o(_),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,2)===Xs?(u=Xs,m+=2):(u=n,R===0&&F(jo)),u!==n&&(u=yo()),c=u,c===n&&(c=m,i.substr(m,8)===Zs?(u=Zs,m+=8):(u=n,R===0&&F(bo)),u!==n&&(u=wo()),c=u,c===n&&(c=m,i.substr(m,8)===en?(u=en,m+=8):(u=n,R===0&&F(So)),u!==n&&(u=$o()),c=u,c===n&&(c=m,i.substr(m,7)===tn?(u=tn,m+=7):(u=n,R===0&&F(Co)),u!==n&&(u=No()),c=u,c===n))))){if(c=m,i.substr(m,4)===sn?(u=sn,m+=4):(u=n,R===0&&F(ko)),u!==n){if(v=[],_=G(),_!==n)for(;_!==n;)v.push(_),_=G();else v=n;v!==n?(_=he(),_!==n?(u=Eo(_),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,2)===nn?(u=nn,m+=2):(u=n,R===0&&F(To)),u!==n&&(u=Ro()),c=u,c===n&&(c=m,i.substr(m,4)===rn?(u=rn,m+=4):(u=n,R===0&&F(Ao)),u!==n&&(u=Do()),c=u,c===n&&(c=m,i.substr(m,4)===on?(u=on,m+=4):(u=n,R===0&&F(Fo)),u!==n&&(u=Io()),c=u,c===n)))){if(c=m,i.substr(m,3)===ln?(u=ln,m+=3):(u=n,R===0&&F(Lo)),u!==n){if(v=[],_=G(),_!==n)for(;_!==n;)v.push(_),_=G();else v=n;v!==n?(_=he(),_!==n?(u=Po(_),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===cn?(u=cn,m+=3):(u=n,R===0&&F(Mo)),u!==n){if(v=[],_=G(),_!==n)for(;_!==n;)v.push(_),_=G();else v=n;v!==n?(_=he(),_!==n?(u=Oo(_),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===an?(u=an,m+=2):(u=n,R===0&&F(qo)),u!==n){if(v=[],_=G(),_!==n)for(;_!==n;)v.push(_),_=G();else v=n;v!==n?(_=he(),_!==n?(u=Ho(_),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===dn?(u=dn,m+=2):(u=n,R===0&&F(Vo)),u!==n){if(v=[],_=G(),_!==n)for(;_!==n;)v.push(_),_=G();else v=n;v!==n?(_=he(),_!==n?(u=fn(_),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;c===n&&(c=m,i.substr(m,10)===un?(u=un,m+=10):(u=n,R===0&&F(Uo)),u!==n&&(u=Bo()),c=u,c===n&&(c=m,u=he(),u!==n&&(u=fn(u)),c=u))}}}}}}}}}}}}}}}}}return c}function pl(){var c,u,v,_;if(R++,c=m,pn.test(i.charAt(m))?(u=i.charAt(m),m++):(u=n,R===0&&F(hn)),u===n&&(u=null),u!==n){if(v=[],mn.test(i.charAt(m))?(_=i.charAt(m),m++):(_=n,R===0&&F(gn)),_!==n)for(;_!==n;)v.push(_),mn.test(i.charAt(m))?(_=i.charAt(m),m++):(_=n,R===0&&F(gn));else v=n;v!==n?(pn.test(i.charAt(m))?(_=i.charAt(m),m++):(_=n,R===0&&F(hn)),_===n&&(_=null),_!==n?(u=Ko(v),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;return R--,c===n&&(u=n,R===0&&F(Wo)),c}function he(){var c,u,v,_;if(R++,c=m,i.charCodeAt(m)===34?(u=xn,m++):(u=n,R===0&&F(vn)),u!==n){for(v=[],_=Cn();_!==n;)v.push(_),_=Cn();v!==n?(i.charCodeAt(m)===34?(_=xn,m++):(_=n,R===0&&F(vn)),_!==n?(u=ss(v),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.charCodeAt(m)===39?(u=_n,m++):(u=n,R===0&&F(jn)),u!==n){for(v=[],_=Nn();_!==n;)v.push(_),_=Nn();v!==n?(i.charCodeAt(m)===39?(_=_n,m++):(_=n,R===0&&F(jn)),_!==n?(u=ss(v),c=u):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n)if(c=m,u=m,R++,v=dl(),R--,v===n?u=void 0:(m=u,u=n),u!==n){if(v=[],_=kn(),_!==n)for(;_!==n;)v.push(_),_=kn();else v=n;v!==n?(u=ss(v),c=u):(m=c,c=n)}else m=c,c=n}return R--,c===n&&(u=n,R===0&&F(zo)),c}function Cn(){var c,u,v;return c=m,u=m,R++,Go.test(i.charAt(m))?(v=i.charAt(m),m++):(v=n,R===0&&F(Qo)),R--,v===n?u=void 0:(m=u,u=n),u!==n?(i.length>m?(v=i.charAt(m),m++):(v=n,R===0&&F(ns)),v!==n?(u=vt(v),c=u):(m=c,c=n)):(m=c,c=n),c===n&&(c=m,i.charCodeAt(m)===92?(u=yn,m++):(u=n,R===0&&F(bn)),u!==n?(v=En(),v!==n?(u=vt(v),c=u):(m=c,c=n)):(m=c,c=n)),c}function Nn(){var c,u,v;return c=m,u=m,R++,Yo.test(i.charAt(m))?(v=i.charAt(m),m++):(v=n,R===0&&F(Jo)),R--,v===n?u=void 0:(m=u,u=n),u!==n?(i.length>m?(v=i.charAt(m),m++):(v=n,R===0&&F(ns)),v!==n?(u=vt(v),c=u):(m=c,c=n)):(m=c,c=n),c===n&&(c=m,i.charCodeAt(m)===92?(u=yn,m++):(u=n,R===0&&F(bn)),u!==n?(v=En(),v!==n?(u=vt(v),c=u):(m=c,c=n)):(m=c,c=n)),c}function kn(){var c,u,v;return c=m,u=m,R++,v=G(),R--,v===n?u=void 0:(m=u,u=n),u!==n?(i.length>m?(v=i.charAt(m),m++):(v=n,R===0&&F(ns)),v!==n?(u=vt(v),c=u):(m=c,c=n)):(m=c,c=n),c}function En(){var c,u;return Xo.test(i.charAt(m))?(c=i.charAt(m),m++):(c=n,R===0&&F(Zo)),c===n&&(c=m,i.charCodeAt(m)===110?(u=el,m++):(u=n,R===0&&F(tl)),u!==n&&(u=sl()),c=u,c===n&&(c=m,i.charCodeAt(m)===114?(u=nl,m++):(u=n,R===0&&F(il)),u!==n&&(u=rl()),c=u,c===n&&(c=m,i.charCodeAt(m)===116?(u=ol,m++):(u=n,R===0&&F(ll)),u!==n&&(u=cl()),c=u))),c}function hl(c,u){function v(){return c.apply(this,arguments)||u.apply(this,arguments)}return v.desc=c.desc+" or "+u.desc,v}function ml(c,u){function v(){return c.apply(this,arguments)&&u.apply(this,arguments)}return v.desc=c.desc+" and "+u.desc,v}function gl(c){function u(){return!c.apply(this,arguments)}return u.desc="not "+c.desc,u}function xl(c){function u(){return c.apply(this,arguments)}return u.desc="("+c.desc+")",u}function Tn(c){return!0}Tn.desc="all flows";var Rn=[new RegExp("text/javascript"),new RegExp("application/x-javascript"),new RegExp("application/javascript"),new RegExp("text/css"),new RegExp("image/.*"),new RegExp("font/.*"),new RegExp("application/font.*")];function An(c){if(c.response){for(var u=mt.getContentType(c.response),v=Rn.length;v--;)if(Rn[v].test(u))return!0}return!1}An.desc="is asset";function vl(c){c=new RegExp(c,"i");function u(v){return!0}return u.desc="body matches "+c,u}function _l(c){c=new RegExp(c,"i");function u(v){return!0}return u.desc="body request matches "+c,u}function jl(c){c=new RegExp(c,"i");function u(v){return!0}return u.desc="body response matches "+c,u}function yl(c){function u(v){return v.response&&v.response.status_code===c}return u.desc="resp. code is "+c,u}function bl(c){c=new RegExp(c,"i");function u(v){return c.test(v.comment)}return u.desc="comment matches "+c,u}function wl(c){c=new RegExp(c,"i");function u(v){return v.request&&(c.test(v.request.host)||c.test(v.request.pretty_host))}return u.desc="domain matches "+c,u}function Dn(c){return c.type==="dns"}Dn.desc="is a DNS Flow";function Sl(c){c=new RegExp(c,"i");function u(v){return!!v.server_conn.address&&c.test(v.server_conn.address[0]+":"+v.server_conn.address[1])}return u.desc="destination address matches "+c,u}function Fn(c){return!!c.error}Fn.desc="has error";function $l(c){c=new RegExp(c,"i");function u(v){return v.request&&ct.match_header(v.request,c)||v.response&&mt.match_header(v.response,c)}return u.desc="header matches "+c,u}function Cl(c){c=new RegExp(c,"i");function u(v){return v.request&&ct.match_header(v.request,c)}return u.desc="req. header matches "+c,u}function Nl(c){c=new RegExp(c,"i");function u(v){return v.response&&mt.match_header(v.response,c)}return u.desc="resp. header matches "+c,u}function In(c){return c.type==="http"}In.desc="is an HTTP Flow";function Ln(c){return c.marked}Ln.desc="is marked";function kl(c){c=new RegExp(c,"i");function u(v){return c.test(v.marked)}return u.desc="marker matches "+c,u}function El(c){c=new RegExp(c,"i");function u(v){return v.request&&c.test(v.request.method)}return u.desc="method matches "+c,u}function Pn(c){return c.request&&!c.response}Pn.desc="has no response";function Mn(c){return c.is_replay==="request"}Mn.desc="request has been replayed";function On(c){return c.is_replay==="response"}On.desc="response has been replayed";function qn(c){return!!c.is_replay}qn.desc="flow has been replayed";function Tl(c){c=new RegExp(c,"i");function u(v){return!!v.client_conn.peername&&c.test(v.client_conn.peername[0]+":"+v.client_conn.peername[1])}return u.desc="source address matches "+c,u}function Hn(c){return!!c.response}Hn.desc="has response";function Vn(c){return c.type==="tcp"}Vn.desc="is a TCP Flow";function Un(c){return c.type==="udp"}Un.desc="is a UDP Flow";function Rl(c){c=new RegExp(c,"i");function u(v){return v.request&&c.test(ct.getContentType(v.request))}return u.desc="req. content type matches "+c,u}function Al(c){c=new RegExp(c,"i");function u(v){return v.response&&c.test(mt.getContentType(v.response))}return u.desc="resp. content type matches "+c,u}function Dl(c){c=new RegExp(c,"i");function u(v){return v.request&&c.test(ct.getContentType(v.request))||v.response&&c.test(mt.getContentType(v.response))}return u.desc="content type matches "+c,u}function Fl(c){c=new RegExp(c,"i");function u(v){if(v.type==="dns"){const _=v.request?.questions[0];return _&&c.test(_.name)}return v.request&&c.test(ct.pretty_url(v.request))}return u.desc="url matches "+c,u}function Bn(c){return!!c.websocket}if(Bn.desc="is a Websocket Flow",Lt=a(),Lt!==n&&m===i.length)return Lt;throw Lt!==n&&m<i.length&&F({type:"end",description:"end of input"}),al(null,is,Oe<i.length?i.charAt(Oe):null,Oe<i.length?Sn(Oe,Oe+1):Sn(Oe,Oe))}return{SyntaxError:e,parse:s}}();class Qe extends I.Component{static xhr;static doc;constructor(e,s){super(e,s),this.state={doc:Qe.doc}}componentDidMount(){Qe.xhr||(Qe.xhr=ne("/filter-help").then(e=>e.json()),Qe.xhr.catch(()=>{Qe.xhr=null})),this.state.doc||Qe.xhr.then(e=>{Qe.doc=e,this.setState({doc:e})})}render(){const{doc:e}=this.state;return e?o.jsx("table",{className:"table table-condensed",children:o.jsxs("tbody",{children:[e.commands.map(s=>o.jsxs("tr",{onClick:()=>this.props.selectHandler(s[0].split(" ")[0]+" "),children:[o.jsx("td",{children:s[0].replace(" "," ")}),o.jsx("td",{children:s[1]})]},s[1])),o.jsx("tr",{children:o.jsx("td",{colSpan:2,children:o.jsxs("a",{href:"https://mitmproxy.org/docs/latest/concepts-filters/",target:"_blank",rel:"noreferrer",children:[o.jsx("i",{className:"fa fa-external-link"}),"  mitmproxy docs"]})})},"docs-link")]})}):o.jsx("i",{className:"fa fa-spinner fa-spin"})}}var Zt=(t=>(t.SEARCH="search",t.HIGHLIGHT="tag",t.INTERCEPT="pause",t))(Zt||{});class zs extends I.Component{inputRef=Ee.createRef();constructor(e,s){super(e,s),this.state={value:this.props.value,focus:!1,mousefocus:!1},this.onChange=this.onChange.bind(this),this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.selectFilter=this.selectFilter.bind(this)}UNSAFE_componentWillReceiveProps(e){this.setState({value:e.value})}isValid(e){try{return e&&pi.parse(e),!0}catch{return!1}}getDesc(){if(!this.state.value)return o.jsx(Qe,{selectHandler:this.selectFilter});try{return pi.parse(this.state.value).desc}catch(e){return""+e}}onChange(e){const s=e.target.value;this.setState({value:s}),this.isValid(s)&&this.props.onChange(s)}onFocus(){this.setState({focus:!0})}onBlur(){this.setState({focus:!1})}onMouseEnter(){this.setState({mousefocus:!0})}onMouseLeave(){this.setState({mousefocus:!1})}onKeyDown(e){(e.key==="Escape"||e.key==="Enter")&&(this.blur(),this.setState({mousefocus:!1})),e.stopPropagation()}selectFilter(e){this.setState({value:e}),this.inputRef.current?.focus()}blur(){this.inputRef.current?.blur()}select(){this.inputRef.current?.select()}render(){const{icon:e,color:s,placeholder:i}=this.props,{value:r,focus:n,mousefocus:l}=this.state;return o.jsxs("div",{className:_e("filter-input input-group",{"has-error":!this.isValid(r)}),children:[o.jsx("span",{className:"input-group-addon",children:o.jsx("i",{className:"fa fa-fw fa-"+e,style:{color:s}})}),o.jsx("input",{type:"text",ref:this.inputRef,placeholder:i,className:"form-control",value:r,onChange:this.onChange,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown}),(n||l)&&o.jsxs("div",{className:"popover bottom",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[o.jsx("div",{className:"arrow"}),o.jsx("div",{className:"popover-content",children:this.getDesc()})]})]})}}co.title="Flow List";function co(){const t=E.c(2);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=o.jsxs("div",{className:"menu-group",children:[o.jsxs("div",{className:"menu-content",children:[o.jsx(iu,{}),o.jsx(ou,{})]}),o.jsx("div",{className:"menu-legend",children:"Find"})]}),t[0]=e):e=t[0];let s;return t[1]===Symbol.for("react.memo_cache_sentinel")?(s=o.jsxs("div",{className:"main-menu",children:[e,o.jsxs("div",{className:"menu-group",children:[o.jsxs("div",{className:"menu-content",children:[o.jsx(su,{}),o.jsx(cu,{})]}),o.jsx("div",{className:"menu-legend",children:"Intercept"})]})]}),t[1]=s):s=t[1],s}function su(){const t=E.c(5),e=Q(),i=D(nu)||"";let r;t[0]!==e?(r=l=>e(As("intercept",l)),t[0]=e,t[1]=r):r=t[1];let n;return t[2]!==i||t[3]!==r?(n=o.jsx(zs,{value:i,placeholder:"Intercept",icon:Zt.INTERCEPT,color:"hsl(208, 56%, 53%)",onChange:r}),t[2]=i,t[3]=r,t[4]=n):n=t[4],n}function nu(t){return t.options.intercept}function iu(){const t=E.c(5),e=Q(),s=D(ru);let i;t[0]!==e?(i=n=>e(qi(n)),t[0]=e,t[1]=i):i=t[1];let r;return t[2]!==i||t[3]!==s?(r=o.jsx(zs,{value:s,placeholder:"Search",icon:Zt.SEARCH,color:"black",onChange:i}),t[2]=i,t[3]=s,t[4]=r):r=t[4],r}function ru(t){return t.ui.filter[xe.Search]}function ou(){const t=E.c(5),e=Q(),s=D(lu);let i;t[0]!==e?(i=n=>e(Hi(n)),t[0]=e,t[1]=i):i=t[1];let r;return t[2]!==i||t[3]!==s?(r=o.jsx(zs,{value:s,placeholder:"Highlight",icon:Zt.HIGHLIGHT,color:"hsl(48, 100%, 50%)",onChange:i}),t[2]=i,t[3]=s,t[4]=r):r=t[4],r}function lu(t){return t.ui.filter[xe.Highlight]}function cu(){const t=E.c(2),e=Q();let s;return t[0]!==e?(s=o.jsx(ue,{className:"btn-sm",title:"[a]ccept all",icon:"fa-forward text-success",onClick:()=>e(Vi()),children:"Resume All"}),t[0]=e,t[1]=s):s=t[1],s}function Gs(t){const e=E.c(6),{value:s,onChange:i,children:r}=t;let n;e[0]!==i||e[1]!==s?(n=o.jsx("input",{type:"checkbox",checked:s,onChange:i}),e[0]=i,e[1]=s,e[2]=n):n=e[2];let l;return e[3]!==r||e[4]!==n?(l=o.jsx("div",{className:"menu-entry",children:o.jsxs("label",{children:[n,r]})}),e[3]=r,e[4]=n,e[5]=l):l=e[5],l}function ds(t){const e=E.c(10),{name:s,children:i}=t,r=Q();let n;e[0]!==s?(n=h=>h.options[s],e[0]=s,e[1]=n):n=e[1];const l=D(n),a=!!l;let d;e[2]!==r||e[3]!==s||e[4]!==l?(d=()=>r(As(s,!l)),e[2]=r,e[3]=s,e[4]=l,e[5]=d):d=e[5];let f;return e[6]!==i||e[7]!==a||e[8]!==d?(f=o.jsx(Gs,{value:a,onChange:d,children:i}),e[6]=i,e[7]=a,e[8]=d,e[9]=f):f=e[9],f}function au(){const t=E.c(5),e=Q(),s=D(du);let i;t[0]!==e?(i=()=>e(Qt()),t[0]=e,t[1]=i):i=t[1];let r;return t[2]!==i||t[3]!==s?(r=o.jsx(Gs,{value:s,onChange:i,children:"Display Event Log"}),t[2]=i,t[3]=s,t[4]=r):r=t[4],r}function du(t){return t.eventLog.visible}function fu(){const t=E.c(5),e=Q(),s=D(uu);let i;t[0]!==e?(i=()=>e(rr()),t[0]=e,t[1]=i):i=t[1];let r;return t[2]!==i||t[3]!==s?(r=o.jsx(Gs,{value:s,onChange:i,children:"Display Command Bar"}),t[2]=i,t[3]=s,t[4]=r):r=t[4],r}function uu(t){return t.commandBar.visible}function fs(t){const e=E.c(5),{children:s,resource:i}=t,r=`https://docs.mitmproxy.org/stable/${i}`;let n;e[0]!==s?(n=s||o.jsx("i",{className:"fa fa-question-circle"}),e[0]=s,e[1]=n):n=e[1];let l;return e[2]!==n||e[3]!==r?(l=o.jsx("a",{target:"_blank",href:r,rel:"noreferrer",children:n}),e[2]=n,e[3]=r,e[4]=l):l=e[4],l}ao.title="Options";function ao(){const t=E.c(16),e=Q(),s=pu;let i;t[0]!==e?(i=()=>e(s()),t[0]=e,t[1]=i):i=t[1];let r;t[2]===Symbol.for("react.memo_cache_sentinel")?(r=o.jsx("sup",{children:"alpha"}),t[2]=r):r=t[2];let n;t[3]!==i?(n=o.jsx("div",{className:"menu-content",children:o.jsxs(ue,{title:"Open Options",icon:"fa-cogs text-primary",onClick:i,children:["Edit Options ",r]})}),t[3]=i,t[4]=n):n=t[4];let l;t[5]===Symbol.for("react.memo_cache_sentinel")?(l=o.jsx("div",{className:"menu-legend",children:"Options Editor"}),t[5]=l):l=t[5];let a;t[6]!==n?(a=o.jsxs("div",{className:"menu-group",children:[n,l]}),t[6]=n,t[7]=a):a=t[7];let d;t[8]===Symbol.for("react.memo_cache_sentinel")?(d=o.jsxs(ds,{name:"anticache",children:["Strip cache headers"," ",o.jsx(fs,{resource:"overview/features/#anticache"})]}),t[8]=d):d=t[8];let f;t[9]===Symbol.for("react.memo_cache_sentinel")?(f=o.jsxs(ds,{name:"showhost",children:["Use host header for display"," ",o.jsx(fs,{resource:"concepts/options/#showhost"})]}),t[9]=f):f=t[9];let h;t[10]===Symbol.for("react.memo_cache_sentinel")?(h=o.jsxs("div",{className:"menu-group",children:[o.jsxs("div",{className:"menu-content",children:[d,f,o.jsxs(ds,{name:"ssl_insecure",children:["Don't verify server certificates"," ",o.jsx(fs,{resource:"concepts/options/#ssl_insecure"})]})]}),o.jsx("div",{className:"menu-legend",children:"Quick Options"})]}),t[10]=h):h=t[10];let p;t[11]!==a?(p=o.jsxs(gt,{children:[a,h]}),t[11]=a,t[12]=p):p=t[12];let g;t[13]===Symbol.for("react.memo_cache_sentinel")?(g=o.jsxs("div",{className:"menu-group",children:[o.jsxs("div",{className:"menu-content",children:[o.jsx(au,{}),o.jsx(fu,{})]}),o.jsx("div",{className:"menu-legend",children:"View Options"})]}),t[13]=g):g=t[13];let x;return t[14]!==p?(x=o.jsxs("div",{children:[p,g]}),t[14]=p,t[15]=x):x=t[15],x}function pu(){return Cc("OptionModal")}const bt=async(t,e)=>{const s=(async()=>{const i=await Kt("export",e,`@${t.id}`);if(i.value)return i.value;throw i.error?i.error:i})();try{await $i(s)}catch(i){alert(i)}};fo.title="Flow";function fo(){const t=E.c(63),e=Q(),s=D(hu),i=s[0];let r;t[0]!==s?(r=s.some($s),t[0]=s,t[1]=r):r=t[1];const n=r;if(s.length===0){let Z;return t[2]===Symbol.for("react.memo_cache_sentinel")?(Z=o.jsx("div",{}),t[2]=Z):Z=t[2],Z}let l;t[3]!==e||t[4]!==s?(l=()=>e(ks(s)),t[3]=e,t[4]=s,t[5]=l):l=t[5];let a;t[6]!==s?(a=s.some(Ss),t[6]=s,t[7]=a):a=t[7];const d=!a;let f;t[8]!==l||t[9]!==d?(f=o.jsx(ue,{title:"[r]eplay flow",icon:"fa-repeat text-primary",onClick:l,disabled:d,children:"Replay"}),t[8]=l,t[9]=d,t[10]=f):f=t[10];let h;t[11]!==e||t[12]!==s?(h=o.jsx(ue,{title:"[D]uplicate flow",icon:"fa-copy text-info",onClick:()=>e(Wi(s)),children:"Duplicate"}),t[11]=e,t[12]=s,t[13]=h):h=t[13];let p;t[14]!==s?(p=s.some(Ai),t[14]=s,t[15]=p):p=t[15];const g=!p;let x;t[16]!==e||t[17]!==s?(x=()=>e(Ki(s)),t[16]=e,t[17]=s,t[18]=x):x=t[18];let j;t[19]!==g||t[20]!==x?(j=o.jsx(ue,{disabled:g,title:"revert changes to flow [V]",icon:"fa-history text-warning",onClick:x,children:"Revert"}),t[19]=g,t[20]=x,t[21]=j):j=t[21];let y;t[22]!==e||t[23]!==s?(y=o.jsx(ue,{title:"[d]elete flow",icon:"fa-trash text-danger",onClick:()=>{e(Bi(s))},children:"Delete"}),t[22]=e,t[23]=s,t[24]=y):y=t[24];let b;t[25]!==s?(b=o.jsx(wu,{flows:s}),t[25]=s,t[26]=b):b=t[26];let $;t[27]!==y||t[28]!==b||t[29]!==f||t[30]!==h||t[31]!==j?($=o.jsxs("div",{className:"menu-content",children:[f,h,j,y,b]}),t[27]=y,t[28]=b,t[29]=f,t[30]=h,t[31]=j,t[32]=$):$=t[32];let C;t[33]===Symbol.for("react.memo_cache_sentinel")?(C=o.jsx("div",{className:"menu-legend",children:"Flow Modification"}),t[33]=C):C=t[33];let k;t[34]!==$?(k=o.jsx(gt,{children:o.jsxs("div",{className:"menu-group",children:[$,C]})}),t[34]=$,t[35]=k):k=t[35];let T;t[36]!==i?(T=o.jsxs("div",{className:"menu-content",children:[o.jsx(mu,{flow:i}),o.jsx(_u,{flow:i})]}),t[36]=i,t[37]=T):T=t[37];let P;t[38]===Symbol.for("react.memo_cache_sentinel")?(P=o.jsx("div",{className:"menu-legend",children:"Export"}),t[38]=P):P=t[38];let L;t[39]!==T?(L=o.jsxs("div",{className:"menu-group",children:[T,P]}),t[39]=T,t[40]=L):L=t[40];const M=!n;let O;t[41]!==e||t[42]!==s?(O=()=>e(Ns(s)),t[41]=e,t[42]=s,t[43]=O):O=t[43];let H;t[44]!==M||t[45]!==O?(H=o.jsx(ue,{disabled:M,title:"[a]ccept intercepted flow",icon:"fa-play text-success",onClick:O,children:"Resume"}),t[44]=M,t[45]=O,t[46]=H):H=t[46];const q=!n;let B;t[47]!==e||t[48]!==s?(B=()=>e(Ui(s)),t[47]=e,t[48]=s,t[49]=B):B=t[49];let z;t[50]!==q||t[51]!==B?(z=o.jsx(ue,{disabled:q,title:"kill intercepted flow [x]",icon:"fa-times text-danger",onClick:B,children:"Abort"}),t[50]=q,t[51]=B,t[52]=z):z=t[52];let W;t[53]!==H||t[54]!==z?(W=o.jsxs("div",{className:"menu-content",children:[H,z]}),t[53]=H,t[54]=z,t[55]=W):W=t[55];let J;t[56]===Symbol.for("react.memo_cache_sentinel")?(J=o.jsx("div",{className:"menu-legend",children:"Interception"}),t[56]=J):J=t[56];let Y;t[57]!==W?(Y=o.jsx(gt,{children:o.jsxs("div",{className:"menu-group",children:[W,J]})}),t[57]=W,t[58]=Y):Y=t[58];let X;return t[59]!==k||t[60]!==L||t[61]!==Y?(X=o.jsxs("div",{className:"flow-menu",children:[k,L,Y]}),t[59]=k,t[60]=L,t[61]=Y,t[62]=X):X=t[62],X}function hu(t){return t.flows.selected}const Vt=t=>{const e=window.open(t,"_blank","noopener,noreferrer");e&&(e.opener=null)};function mu(t){const e=E.c(24),{flow:s}=t,i=D(vu);if(s.type!=="http"){let r;return e[0]===Symbol.for("react.memo_cache_sentinel")?(r=o.jsx(ue,{icon:"fa-download",onClick:xu,disabled:!0,children:"Download"}),e[0]=r):r=e[0],r}if(s.request.contentLength&&!s.response?.contentLength){let r;e[1]!==s?(r=()=>Vt(je.getContentURL(s,s.request)),e[1]=s,e[2]=r):r=e[2];const n=!i;let l;return e[3]!==r||e[4]!==n?(l=o.jsx(ue,{icon:"fa-download",onClick:r,disabled:n,children:"Download"}),e[3]=r,e[4]=n,e[5]=l):l=e[5],l}if(s.response){const r=s.response;if(!s.request.contentLength&&s.response.contentLength){let n;e[6]!==s||e[7]!==r?(n=()=>Vt(je.getContentURL(s,r)),e[6]=s,e[7]=r,e[8]=n):n=e[8];const l=!i;let a;return e[9]!==n||e[10]!==l?(a=o.jsx(ue,{icon:"fa-download",onClick:n,disabled:l,children:"Download"}),e[9]=n,e[10]=l,e[11]=a):a=e[11],a}if(s.request.contentLength&&s.response.contentLength){const n=!i;let l;e[12]!==n?(l=o.jsx(ue,{icon:"fa-download",onClick:gu,disabled:n,children:"Download▾"}),e[12]=n,e[13]=l):l=e[13];let a;e[14]===Symbol.for("react.memo_cache_sentinel")?(a={placement:"bottom-start"},e[14]=a):a=e[14];let d;e[15]!==s?(d=o.jsx(Ne,{onClick:()=>Vt(je.getContentURL(s,s.request)),children:"Download request"}),e[15]=s,e[16]=d):d=e[16];let f;e[17]!==s||e[18]!==r?(f=o.jsx(Ne,{onClick:()=>Vt(je.getContentURL(s,r)),children:"Download response"}),e[17]=s,e[18]=r,e[19]=f):f=e[19];let h;return e[20]!==l||e[21]!==d||e[22]!==f?(h=o.jsxs(Rt,{text:l,options:a,children:[d,f]}),e[20]=l,e[21]=d,e[22]=f,e[23]=h):h=e[23],h}}return null}function gu(){return 1}function xu(){return 0}function vu(t){return t.flows.selected.length===1}function _u(t){const e=E.c(20),{flow:s}=t,i=D(yu),r=s.type!=="http"||!i;let n;e[0]!==r?(n=o.jsx(ue,{title:"Export flow.",icon:"fa-clone",onClick:ju,disabled:r,children:"Export▾"}),e[0]=r,e[1]=n):n=e[1];let l;e[2]===Symbol.for("react.memo_cache_sentinel")?(l={placement:"bottom-start"},e[2]=l):l=e[2];let a;e[3]!==s?(a=o.jsx(Ne,{onClick:()=>bt(s,"raw_request"),children:"Copy raw request"}),e[3]=s,e[4]=a):a=e[4];let d;e[5]!==s?(d=o.jsx(Ne,{onClick:()=>bt(s,"raw_response"),children:"Copy raw response"}),e[5]=s,e[6]=d):d=e[6];let f;e[7]!==s?(f=o.jsx(Ne,{onClick:()=>bt(s,"raw"),children:"Copy raw request and response"}),e[7]=s,e[8]=f):f=e[8];let h;e[9]!==s?(h=o.jsx(Ne,{onClick:()=>bt(s,"curl"),children:"Copy as cURL"}),e[9]=s,e[10]=h):h=e[10];let p;e[11]!==s?(p=o.jsx(Ne,{onClick:()=>bt(s,"httpie"),children:"Copy as HTTPie"}),e[11]=s,e[12]=p):p=e[12];let g;return e[13]!==n||e[14]!==a||e[15]!==d||e[16]!==f||e[17]!==h||e[18]!==p?(g=o.jsxs(Rt,{className:"",text:n,options:l,children:[a,d,f,h,p]}),e[13]=n,e[14]=a,e[15]=d,e[16]=f,e[17]=h,e[18]=p,e[19]=g):g=e[19],g}function ju(){return 1}function yu(t){return t.flows.selected.length===1}const bu={":red_circle:":"🔴",":orange_circle:":"🟠",":yellow_circle:":"🟡",":green_circle:":"🟢",":large_blue_circle:":"🔵",":purple_circle:":"🟣",":brown_circle:":"🟤"};function wu(t){const e=E.c(5),{flows:s}=t,i=Q();let r,n;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=o.jsx(ue,{title:"mark flow",icon:"fa-paint-brush text-success",onClick:Su,children:"Mark▾"}),n={placement:"bottom-start"},e[0]=r,e[1]=n):(r=e[0],n=e[1]);let l;return e[2]!==i||e[3]!==s?(l=o.jsxs(Rt,{className:"",text:r,options:n,children:[o.jsx(Ne,{onClick:()=>i(Zn(s,"")),children:"⚪ (no marker)"}),Object.entries(bu).map(a=>{const[d,f]=a;return o.jsxs(Ne,{onClick:()=>i(Zn(s,d)),children:[f," ",d.replace(/[:_]/g," ")]},d)})]}),e[2]=i,e[3]=s,e[4]=l):l=e[4],l}function Su(){return 1}function uo(){const t=E.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=o.jsx("div",{className:"menu-row",children:o.jsx("div",{className:"menu-group",children:o.jsx("div",{className:"menu-content",children:o.jsx("span",{className:"menu-legend",children:"📊 Network Metrics Dashboard"})})})}),t[0]=e):e=t[0],e}uo.title="Metrics";const hi={[fe.Capture]:lo,[fe.FlowList]:co,[fe.Options]:ao,[fe.Flow]:fo,[fe.Metrics]:uo};function $u(){const t=E.c(26),e=Q(),s=D(Nu),i=D(Cu),[r,n]=I.useState(!1);let l;t[0]!==i.length?(l=[fe.Capture,fe.FlowList,fe.Options,fe.Metrics],i.length>0&&l.push(fe.Flow),t[0]=i.length,t[1]=l):l=t[1];let a;t[2]!==s||t[3]!==e||t[4]!==i.length||t[5]!==r?(a=()=>{i.length>0&&!r?(e(Bt(fe.Flow)),n(!0)):i.length===0&&(r&&n(!1),s===fe.Flow&&e(Bt(fe.FlowList)))},t[2]=s,t[3]=e,t[4]=i.length,t[5]=r,t[6]=a):a=t[6];let d;t[7]!==s||t[8]!==i||t[9]!==r?(d=[i,r,s],t[7]=s,t[8]=i,t[9]=r,t[10]=d):d=t[10],I.useEffect(a,d);let f;t[11]!==e?(f=function(k,T){T.preventDefault(),e(Bt(k))},t[11]=e,t[12]=f):f=t[12];const h=f,p=hi[s];let g;t[13]===Symbol.for("react.memo_cache_sentinel")?(g=o.jsx(Qf,{}),t[13]=g):g=t[13];let x;t[14]!==s||t[15]!==l||t[16]!==h?(x=l.map(C=>o.jsx("a",{href:"#",className:_e({active:C===s}),onClick:k=>h(C,k),children:hi[C].title},C)),t[14]=s,t[15]=l,t[16]=h,t[17]=x):x=t[17];let j;t[18]===Symbol.for("react.memo_cache_sentinel")?(j=o.jsx(gt,{children:o.jsx(Zf,{})}),t[18]=j):j=t[18];let y;t[19]!==x?(y=o.jsxs("nav",{className:"nav-tabs nav-tabs-lg",children:[g,x,j]}),t[19]=x,t[20]=y):y=t[20];let b;t[21]!==p?(b=o.jsx("div",{children:o.jsx(p,{})}),t[21]=p,t[22]=b):b=t[22];let $;return t[23]!==y||t[24]!==b?($=o.jsxs("header",{children:[y,b]}),t[23]=y,t[24]=b,t[25]=$):$=t[25],$}function Cu(t){return t.flows.selected}function Nu(t){return t.ui.tabs.current}const us=function(){function t(i,r){function n(){this.constructor=i}n.prototype=r.prototype,i.prototype=new n}function e(i,r,n,l){this.message=i,this.expected=r,this.found=n,this.location=l,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,e)}t(e,Error);function s(i){var r=arguments.length>1?arguments[1]:{},n={},l={Expr:Te},a=Te,d=function(w,S){return[w,...S]},f=function(w){return[w]},h=function(){return""},p={type:"other",description:"string"},g='"',x={type:"literal",value:'"',description:'"\\""'},j=function(w){return w.join("")},y="'",b={type:"literal",value:"'",description:`"'"`},$=/^["\\]/,C={type:"class",value:'["\\\\]',description:'["\\\\]'},k={type:"any",description:"any character"},T=function(w){return w},P="\\",L={type:"literal",value:"\\",description:'"\\\\"'},M=/^['\\]/,O={type:"class",value:"['\\\\]",description:"['\\\\]"},H=/^['"\\]/,q={type:"class",value:`['"\\\\]`,description:`['"\\\\]`},B="n",z={type:"literal",value:"n",description:'"n"'},W=function(){return`
`},J="r",Y={type:"literal",value:"r",description:'"r"'},X=function(){return"\r"},Z="t",ee={type:"literal",value:"t",description:'"t"'},de=function(){return"	"},ge={type:"other",description:"whitespace"},be=/^[ \t\n\r]/,Be={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},Le={type:"other",description:"control character"},we=/^[|&!()~"]/,ke={type:"class",value:'[|&!()~"]',description:'[|&!()~"]'},N=0,pe=[{line:1,column:1,seenCR:!1}],K=0,oe=[],V=0,Se;if("startRule"in r){if(!(r.startRule in l))throw new Error(`Can't start parsing from rule "`+r.startRule+'".');a=l[r.startRule]}function We(w){var S=pe[w],A,U;if(S)return S;for(A=w-1;!pe[A];)A--;for(S=pe[A],S={line:S.line,column:S.column,seenCR:S.seenCR};A<w;)U=i.charAt(A),U===`
`?(S.seenCR||S.line++,S.column=1,S.seenCR=!1):U==="\r"||U==="\u2028"||U==="\u2029"?(S.line++,S.column=1,S.seenCR=!0):(S.column++,S.seenCR=!1),A++;return pe[w]=S,S}function Pe(w,S){var A=We(w),U=We(S);return{start:{offset:w,line:A.line,column:A.column},end:{offset:S,line:U.line,column:U.column}}}function te(w){N<K||(N>K&&(K=N,oe=[]),oe.push(w))}function Me(w,S,A,U){function At($e){var Ae=1;for($e.sort(function(ft,Ke){return ft.description<Ke.description?-1:ft.description>Ke.description?1:0});Ae<$e.length;)$e[Ae-1]===$e[Ae]?$e.splice(Ae,1):Ae++}function ts($e,Ae){function ft(Ft){function ut(De){return De.charCodeAt(0).toString(16).toUpperCase()}return Ft.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(De){return"\\x0"+ut(De)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(De){return"\\x"+ut(De)}).replace(/[\u0100-\u0FFF]/g,function(De){return"\\u0"+ut(De)}).replace(/[\u1000-\uFFFF]/g,function(De){return"\\u"+ut(De)})}var Ke=new Array($e.length),xt,Dt,it;for(it=0;it<$e.length;it++)Ke[it]=$e[it].description;return xt=$e.length>1?Ke.slice(0,-1).join(", ")+" or "+Ke[$e.length-1]:Ke[0],Dt=Ae?'"'+ft(Ae)+'"':"end of input","Expected "+xt+" but "+Dt+" found."}return S!==null&&At(S),new e(ts(S,A),S,A,U)}function Te(){var w,S,A,U;if(w=N,S=re(),S!==n){if(A=[],U=Ye(),U!==n)for(;U!==n;)A.push(U),U=Ye();else A=n;A!==n?(U=Te(),U!==n?(S=d(S,U),w=S):(N=w,w=n)):(N=w,w=n)}else N=w,w=n;if(w===n&&(w=N,S=re(),S!==n&&(S=f(S)),w=S,w===n)){for(w=N,S=[],A=Ye();A!==n;)S.push(A),A=Ye();S!==n&&(S=h()),w=S}return w}function re(){var w,S,A,U;if(V++,w=N,i.charCodeAt(N)===34?(S=g,N++):(S=n,V===0&&te(x)),S!==n){for(A=[],U=ce();U!==n;)A.push(U),U=ce();A!==n?(i.charCodeAt(N)===34?(U=g,N++):(U=n,V===0&&te(x)),U!==n?(S=j(A),w=S):(N=w,w=n)):(N=w,w=n)}else N=w,w=n;if(w===n){if(w=N,i.charCodeAt(N)===39?(S=y,N++):(S=n,V===0&&te(b)),S!==n){for(A=[],U=me();U!==n;)A.push(U),U=me();A!==n?(i.charCodeAt(N)===39?(U=y,N++):(U=n,V===0&&te(b)),U!==n?(S=j(A),w=S):(N=w,w=n)):(N=w,w=n)}else N=w,w=n;if(w===n){if(w=N,S=N,V++,A=es(),V--,A===n?S=void 0:(N=S,S=n),S!==n){if(A=[],U=Re(),U!==n)for(;U!==n;)A.push(U),U=Re();else A=n;A!==n?(S=j(A),w=S):(N=w,w=n)}else N=w,w=n;if(w===n){if(w=N,i.charCodeAt(N)===34?(S=g,N++):(S=n,V===0&&te(x)),S!==n){for(A=[],U=ce();U!==n;)A.push(U),U=ce();A!==n?(S=j(A),w=S):(N=w,w=n)}else N=w,w=n;if(w===n)if(w=N,i.charCodeAt(N)===39?(S=y,N++):(S=n,V===0&&te(b)),S!==n){for(A=[],U=me();U!==n;)A.push(U),U=me();A!==n?(S=j(A),w=S):(N=w,w=n)}else N=w,w=n}}}return V--,w===n&&(S=n,V===0&&te(p)),w}function ce(){var w,S,A;return w=N,S=N,V++,$.test(i.charAt(N))?(A=i.charAt(N),N++):(A=n,V===0&&te(C)),V--,A===n?S=void 0:(N=S,S=n),S!==n?(i.length>N?(A=i.charAt(N),N++):(A=n,V===0&&te(k)),A!==n?(S=T(A),w=S):(N=w,w=n)):(N=w,w=n),w===n&&(w=N,i.charCodeAt(N)===92?(S=P,N++):(S=n,V===0&&te(L)),S!==n?(A=nt(),A!==n?(S=T(A),w=S):(N=w,w=n)):(N=w,w=n)),w}function me(){var w,S,A;return w=N,S=N,V++,M.test(i.charAt(N))?(A=i.charAt(N),N++):(A=n,V===0&&te(O)),V--,A===n?S=void 0:(N=S,S=n),S!==n?(i.length>N?(A=i.charAt(N),N++):(A=n,V===0&&te(k)),A!==n?(S=T(A),w=S):(N=w,w=n)):(N=w,w=n),w===n&&(w=N,i.charCodeAt(N)===92?(S=P,N++):(S=n,V===0&&te(L)),S!==n?(A=nt(),A!==n?(S=T(A),w=S):(N=w,w=n)):(N=w,w=n)),w}function Re(){var w,S,A;return w=N,S=N,V++,A=Ye(),V--,A===n?S=void 0:(N=S,S=n),S!==n?(i.length>N?(A=i.charAt(N),N++):(A=n,V===0&&te(k)),A!==n?(S=T(A),w=S):(N=w,w=n)):(N=w,w=n),w}function nt(){var w,S;return H.test(i.charAt(N))?(w=i.charAt(N),N++):(w=n,V===0&&te(q)),w===n&&(w=N,i.charCodeAt(N)===110?(S=B,N++):(S=n,V===0&&te(z)),S!==n&&(S=W()),w=S,w===n&&(w=N,i.charCodeAt(N)===114?(S=J,N++):(S=n,V===0&&te(Y)),S!==n&&(S=X()),w=S,w===n&&(w=N,i.charCodeAt(N)===116?(S=Z,N++):(S=n,V===0&&te(ee)),S!==n&&(S=de()),w=S))),w}function Ye(){var w;return V++,be.test(i.charAt(N))?(w=i.charAt(N),N++):(w=n,V===0&&te(Be)),V--,w===n&&V===0&&te(ge),w}function es(){var w;return V++,we.test(i.charAt(N))?(w=i.charAt(N),N++):(w=n,V===0&&te(ke)),V--,w===n&&V===0&&te(Le),w}if(Se=a(),Se!==n&&N===i.length)return Se;throw Se!==n&&N<i.length&&te({type:"end",description:"end of input"}),Me(null,oe,K<i.length?i.charAt(K):null,K<i.length?Pe(K,K+1):Pe(K,K))}return{SyntaxError:e,parse:s}}();function ps(t,e=""){if(!t)return[];const s=[];for(const i of Object.keys(t))i.startsWith(e)&&s.push(i);return s}function ku(t){const e=E.c(6),{results:s}=t,i=I.useRef(null);let r,n;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=()=>{i&&i.current.addEventListener("DOMNodeInserted",Tu)},n=[],e[0]=r,e[1]=n):(r=e[0],n=e[1]),I.useEffect(r,n);let l;e[2]!==s?(l=s.map(Eu),e[2]=s,e[3]=l):l=e[3];let a;return e[4]!==l?(a=o.jsx("div",{className:"command-result",ref:i,children:l}),e[4]=l,e[5]=a):a=e[5],a}function Eu(t,e){return o.jsxs("div",{children:[o.jsx("div",{children:o.jsxs("strong",{children:["$ ",t.command]})}),t.result]},e)}function Tu(t){const e=t.currentTarget;e.scroll({top:e.scrollHeight,behavior:"auto"})}function Ru(t){const e=E.c(20),{nextArgs:s,currentArg:i,help:r,description:n,availableCommands:l}=t;let a;if(e[0]!==i||e[1]!==s){a=[];for(let b=0;b<s.length;b++){if(b==i){a.push(o.jsx("mark",{children:s[b]},b));continue}a.push(o.jsxs("span",{children:[s[b]," "]},b))}e[0]=i,e[1]=s,e[2]=a}else a=e[2];let d;e[3]===Symbol.for("react.memo_cache_sentinel")?(d=o.jsx("div",{className:"arrow"}),e[3]=d):d=e[3];let f;e[4]!==a?(f=a.length>0&&o.jsxs("div",{children:[o.jsx("strong",{children:"Argument suggestion:"})," ",a]}),e[4]=a,e[5]=f):f=e[5];let h;e[6]!==r?(h=r?.includes("->")&&o.jsxs("div",{children:[o.jsx("strong",{children:"Signature help: "}),r]}),e[6]=r,e[7]=h):h=e[7];let p;e[8]!==n?(p=n&&o.jsxs("div",{children:["# ",n]}),e[8]=n,e[9]=p):p=e[9];let g;e[10]===Symbol.for("react.memo_cache_sentinel")?(g=o.jsx("strong",{children:"Available Commands: "}),e[10]=g):g=e[10];let x;e[11]!==l?(x=JSON.stringify(l),e[11]=l,e[12]=x):x=e[12];let j;e[13]!==x?(j=o.jsxs("div",{children:[g,o.jsx("p",{className:"available-commands",children:x})]}),e[13]=x,e[14]=j):j=e[14];let y;return e[15]!==f||e[16]!==h||e[17]!==p||e[18]!==j?(y=o.jsxs("div",{className:"argument-suggestion popover top",children:[d,o.jsxs("div",{className:"popover-content",children:[f,h,p,j]})]}),e[15]=f,e[16]=h,e[17]=p,e[18]=j,e[19]=y):y=e[19],y}function Au(){const t=E.c(45),[e,s]=I.useState(""),[i,r]=I.useState(""),[n,l]=I.useState(0);let a;t[0]===Symbol.for("react.memo_cache_sentinel")?(a=[],t[0]=a):a=t[0];const[d,f]=I.useState(a);let h;t[1]===Symbol.for("react.memo_cache_sentinel")?(h=[],t[1]=h):h=t[1];const[p,g]=I.useState(h);let x;t[2]===Symbol.for("react.memo_cache_sentinel")?(x={},t[2]=x):x=t[2];const[j,y]=I.useState(x);let b;t[3]===Symbol.for("react.memo_cache_sentinel")?(b=[],t[3]=b):b=t[3];const[$,C]=I.useState(b),[k,T]=I.useState(0),[P,L]=I.useState(""),[M,O]=I.useState("");let H;t[4]===Symbol.for("react.memo_cache_sentinel")?(H=[],t[4]=H):H=t[4];const[q,B]=I.useState(H);let z;t[5]===Symbol.for("react.memo_cache_sentinel")?(z=[],t[5]=z):z=t[5];const[W,J]=I.useState(z),[Y,X]=I.useState(void 0);let Z,ee;t[6]===Symbol.for("react.memo_cache_sentinel")?(Z=()=>{ne("/commands",{method:"GET"}).then(Mu).then(re=>{y(re),f(ps(re)),g(Object.keys(re))}).catch(Pu)},ee=[],t[6]=Z,t[7]=ee):(Z=t[6],ee=t[7]),I.useEffect(Z,ee);let de,ge;t[8]===Symbol.for("react.memo_cache_sentinel")?(de=()=>{Kt("commands.history.get").then(re=>{J(re.value)}).catch(Lu)},ge=[],t[8]=de,t[9]=ge):(de=t[8],ge=t[9]),I.useEffect(de,ge);let be;t[10]!==j?(be=(re,ce)=>{const me=us.parse(ce),Re=us.parse(re);L(j[me[0]]?.signature_help),O(j[me[0]]?.help||""),f(ps(j,Re[0])),g(ps(j,me[0]));const nt=j[me[0]]?.parameters.map(Iu);nt&&(C([me[0],...nt]),T(me.length-1))},t[10]=j,t[11]=be):be=t[11];const Be=be;let Le;t[12]===Symbol.for("react.memo_cache_sentinel")?(Le=re=>{s(re.target.value),r(re.target.value),l(0)},t[12]=Le):Le=t[12];const we=Le;let ke;t[13]!==p||t[14]!==d||t[15]!==n||t[16]!==Y||t[17]!==W||t[18]!==e||t[19]!==q?(ke=re=>{if(re.key==="Enter"){const[ce,...me]=us.parse(e);J([...W,e]),Kt("commands.history.add",e).catch(Fu),ne.post(`/commands/${ce}`,{arguments:me}).then(Du).then(Re=>{X(void 0),C([]),B([...q,{command:e,result:JSON.stringify(Re.value||Re.error)}])}).catch(Re=>{X(void 0),C([]),B([...q,{command:e,result:Re.toString()}])}),L(""),O(""),s(""),r(""),l(0),f(p)}if(re.key==="ArrowUp"){let ce;Y===void 0?ce=W.length-1:ce=Math.max(0,Y-1),s(W[ce]),r(W[ce]),X(ce)}if(re.key==="ArrowDown"){if(Y===void 0)return;if(Y==W.length-1)s(""),r(""),X(void 0);else{const ce=Y+1;s(W[ce]),r(W[ce]),X(ce)}}re.key==="Tab"&&(s(d[n]),l((n+1)%d.length),re.preventDefault()),re.stopPropagation()},t[13]=p,t[14]=d,t[15]=n,t[16]=Y,t[17]=W,t[18]=e,t[19]=q,t[20]=ke):ke=t[20];const N=ke;let pe;t[21]!==j||t[22]!==e||t[23]!==i||t[24]!==Be?(pe=re=>{if(!e){g(Object.keys(j));return}Be(i,e),re.stopPropagation()},t[21]=j,t[22]=e,t[23]=i,t[24]=Be,t[25]=pe):pe=t[25];const K=pe;let oe;t[26]===Symbol.for("react.memo_cache_sentinel")?(oe=o.jsx("div",{className:"command-title",children:"Command Result"}),t[26]=oe):oe=t[26];let V;t[27]!==q?(V=o.jsx(ku,{results:q}),t[27]=q,t[28]=V):V=t[28];let Se;t[29]!==p||t[30]!==k||t[31]!==M||t[32]!==$||t[33]!==P?(Se=o.jsx(Ru,{nextArgs:$,currentArg:k,help:P,description:M,availableCommands:p}),t[29]=p,t[30]=k,t[31]=M,t[32]=$,t[33]=P,t[34]=Se):Se=t[34];let We;t[35]===Symbol.for("react.memo_cache_sentinel")?(We=_e("command-input input-group"),t[35]=We):We=t[35];let Pe;t[36]===Symbol.for("react.memo_cache_sentinel")?(Pe=o.jsx("span",{className:"input-group-addon",children:o.jsx("i",{className:"fa fa-fw fa-terminal"})}),t[36]=Pe):Pe=t[36];const te=e||"";let Me;t[37]!==N||t[38]!==K||t[39]!==te?(Me=o.jsxs("div",{className:We,children:[Pe,o.jsx("input",{type:"text",placeholder:"Enter command",className:"form-control",value:te,onChange:we,onKeyDown:N,onKeyUp:K})]}),t[37]=N,t[38]=K,t[39]=te,t[40]=Me):Me=t[40];let Te;return t[41]!==V||t[42]!==Se||t[43]!==Me?(Te=o.jsxs("div",{className:"command",children:[oe,V,Se,Me]}),t[41]=V,t[42]=Se,t[43]=Me,t[44]=Te):Te=t[44],Te}function Du(t){return t.json()}function Fu(){return 0}function Iu(t){return t.name}function Lu(t){return console.error(t)}function Pu(t){return console.error(t)}function Mu(t){return t.json()}function Ou(t){const e=E.c(7),{checked:s,onToggle:i,text:r}=t,n="btn btn-toggle "+(s?"btn-primary":"btn-default"),l="fa fa-fw "+(s?"fa-check-square-o":"fa-square-o");let a;e[0]!==l?(a=o.jsx("i",{className:l}),e[0]=l,e[1]=a):a=e[1];let d;return e[2]!==i||e[3]!==n||e[4]!==a||e[5]!==r?(d=o.jsxs("div",{className:n,onClick:i,children:[a," ",r]}),e[2]=i,e[3]=n,e[4]=a,e[5]=r,e[6]=d):d=e[6],d}class qu extends I.Component{static defaultProps={rowHeight:18};heights;viewport=Ee.createRef();constructor(e){super(e),this.heights={},this.state={vScroll:Et()},this.onViewportUpdate=this.onViewportUpdate.bind(this)}componentDidMount(){window.addEventListener("resize",this.onViewportUpdate),this.onViewportUpdate()}componentWillUnmount(){window.removeEventListener("resize",this.onViewportUpdate)}getSnapshotBeforeUpdate(){return Is(this.viewport)}componentDidUpdate(e,s,i){i&&ro(this.viewport),this.onViewportUpdate()}onViewportUpdate(){const e=this.viewport.current,s=Et({itemCount:this.props.events.length,rowHeight:this.props.rowHeight,viewportTop:e.scrollTop,viewportHeight:e.offsetHeight,itemHeights:this.props.events.map(i=>this.heights[i.id])});Gt(this.state.vScroll,s)||this.setState({vScroll:s})}setHeight(e,s){if(s&&!this.heights[e]){const i=s.offsetHeight;this.heights[e]!==i&&(this.heights[e]=i,this.onViewportUpdate())}}render(){const{vScroll:e}=this.state,{events:s}=this.props;return o.jsxs("pre",{ref:this.viewport,onScroll:this.onViewportUpdate,children:[o.jsx("div",{style:{height:e.paddingTop}}),s.slice(e.start,e.end).map(i=>o.jsxs("div",{ref:r=>{this.setHeight(i.id,r)},children:[o.jsx(Hu,{event:i}),i.message]},i.id)),o.jsx("div",{style:{height:e.paddingBottom}})]})}}function Hu(t){const e=E.c(4),{event:s}=t;let i;e[0]!==s.level?(i={web:"html5",debug:"bug",warn:"exclamation-triangle",error:"ban"}[s.level]||"info",e[0]=s.level,e[1]=i):i=e[1];const n=`fa fa-fw fa-${i}`;let l;return e[2]!==n?(l=o.jsx("i",{className:n}),e[2]=n,e[3]=l):l=e[3],l}class Vu extends I.Component{static defaultProps={defaultHeight:200};dragStart;constructor(e,s){super(e,s),this.state={height:this.props.defaultHeight},this.onDragStart=this.onDragStart.bind(this),this.onDragMove=this.onDragMove.bind(this),this.onDragStop=this.onDragStop.bind(this)}onDragStart(e){e.preventDefault(),this.dragStart=this.state.height+e.pageY,window.addEventListener("mousemove",this.onDragMove),window.addEventListener("mouseup",this.onDragStop),window.addEventListener("dragend",this.onDragStop)}onDragMove(e){e.preventDefault(),this.setState({height:this.dragStart-e.pageY})}onDragStop(e){e.preventDefault(),window.removeEventListener("mousemove",this.onDragMove)}render(){const{height:e}=this.state,{filters:s,events:i,toggleFilter:r,close:n}=this.props;return o.jsxs("div",{className:"eventlog",style:{height:e},children:[o.jsxs("div",{onMouseDown:this.onDragStart,children:["Eventlog",o.jsxs("div",{className:"pull-right",children:[Object.values(nr).map(l=>o.jsx(Ou,{text:l,checked:s[l],onToggle:()=>r(l)},l)),o.jsx("i",{onClick:n,className:"fa fa-close"})]})]}),o.jsx(qu,{events:i})]})}}const Uu=Tt(t=>({filters:t.eventLog.filters,events:t.eventLog.view}),{close:Qt,toggleFilter:sr})(Vu);function Bu(){const t=E.c(52),e=D(Ku),{mode:s,intercept:i,showhost:r,upstream_cert:n,rawtcp:l,http2:a,websocket:d,anticache:f,anticomp:h,stickyauth:p,stickycookie:g,stream_large_bodies:x,listen_host:j,listen_port:y,server:b,ssl_insecure:$}=D(Wu);let C;t[0]!==s?(C=s&&(s.length!==1||s[0]!=="regular")&&o.jsx("span",{className:"label label-success",children:s.join(",")}),t[0]=s,t[1]=C):C=t[1];let k;t[2]!==i?(k=i&&o.jsxs("span",{className:"label label-success",children:["Intercept: ",i]}),t[2]=i,t[3]=k):k=t[3];let T;t[4]!==$?(T=$&&o.jsx("span",{className:"label label-danger",children:"ssl_insecure"}),t[4]=$,t[5]=T):T=t[5];let P;t[6]!==r?(P=r&&o.jsx("span",{className:"label label-success",children:"showhost"}),t[6]=r,t[7]=P):P=t[7];let L;t[8]!==n?(L=!n&&o.jsx("span",{className:"label label-success",children:"no-upstream-cert"}),t[8]=n,t[9]=L):L=t[9];let M;t[10]!==l?(M=!l&&o.jsx("span",{className:"label label-success",children:"no-raw-tcp"}),t[10]=l,t[11]=M):M=t[11];let O;t[12]!==a?(O=!a&&o.jsx("span",{className:"label label-success",children:"no-http2"}),t[12]=a,t[13]=O):O=t[13];let H;t[14]!==d?(H=!d&&o.jsx("span",{className:"label label-success",children:"no-websocket"}),t[14]=d,t[15]=H):H=t[15];let q;t[16]!==f?(q=f&&o.jsx("span",{className:"label label-success",children:"anticache"}),t[16]=f,t[17]=q):q=t[17];let B;t[18]!==h?(B=h&&o.jsx("span",{className:"label label-success",children:"anticomp"}),t[18]=h,t[19]=B):B=t[19];let z;t[20]!==p?(z=p&&o.jsxs("span",{className:"label label-success",children:["stickyauth: ",p]}),t[20]=p,t[21]=z):z=t[21];let W;t[22]!==g?(W=g&&o.jsxs("span",{className:"label label-success",children:["stickycookie: ",g]}),t[22]=g,t[23]=W):W=t[23];let J;t[24]!==x?(J=x&&o.jsxs("span",{className:"label label-success",children:["stream: ",wi(x)]}),t[24]=x,t[25]=J):J=t[25];let Y;t[26]!==j||t[27]!==y||t[28]!==b?(Y=b&&o.jsxs("span",{className:"label label-primary",title:"HTTP Proxy Server Address",children:[j||"*",":",y||8080]}),t[26]=j,t[27]=y,t[28]=b,t[29]=Y):Y=t[29];let X;t[30]!==Y?(X=o.jsx(gt,{children:Y}),t[30]=Y,t[31]=X):X=t[31];let Z;t[32]!==e?(Z=o.jsxs("span",{className:"label label-default",title:"Mitmproxy Version",children:["mitmproxy ",e]}),t[32]=e,t[33]=Z):Z=t[33];let ee;t[34]!==X||t[35]!==Z?(ee=o.jsxs("div",{className:"pull-right",children:[X,Z]}),t[34]=X,t[35]=Z,t[36]=ee):ee=t[36];let de;return t[37]!==C||t[38]!==k||t[39]!==z||t[40]!==W||t[41]!==J||t[42]!==ee||t[43]!==T||t[44]!==P||t[45]!==L||t[46]!==M||t[47]!==O||t[48]!==H||t[49]!==q||t[50]!==B?(de=o.jsxs("footer",{children:[C,k,T,P,L,M,O,H,q,B,z,W,J,ee]}),t[37]=C,t[38]=k,t[39]=z,t[40]=W,t[41]=J,t[42]=ee,t[43]=T,t[44]=P,t[45]=L,t[46]=M,t[47]=O,t[48]=H,t[49]=q,t[50]=B,t[51]=de):de=t[51],de}function Wu(t){return t.options}function Ku(t){return t.backendState.version}function zu(t){const e=E.c(3),{children:s}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=o.jsx("div",{className:"modal-backdrop fade in"}),e[0]=i):i=e[0];let r;return e[1]!==s?(r=o.jsxs("div",{children:[i,o.jsx("div",{className:"modal modal-visible",id:"optionsModal",tabIndex:-1,role:"dialog","aria-labelledby":"options",children:o.jsx("div",{className:"modal-dialog modal-lg",role:"document",children:o.jsx("div",{className:"modal-content",children:s})})})]}),e[1]=s,e[2]=r):r=e[2],r}const Gu=t=>{t.key!=="Escape"&&t.stopPropagation()};function po(t){const e=E.c(10);let s,i,r;e[0]!==t?({value:r,onChange:s,...i}=t,e[0]=t,e[1]=s,e[2]=i,e[3]=r):(s=e[1],i=e[2],r=e[3]);let n;e[4]!==s?(n=a=>s(a.target.checked),e[4]=s,e[5]=n):n=e[5];let l;return e[6]!==i||e[7]!==n||e[8]!==r?(l=o.jsx("div",{className:"checkbox",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:r,onChange:n,...i}),"Enable"]})}),e[6]=i,e[7]=n,e[8]=r,e[9]=l):l=e[9],l}function mi(t){const e=E.c(10);let s,i,r;e[0]!==t?({value:r,onChange:s,...i}=t,e[0]=t,e[1]=s,e[2]=i,e[3]=r):(s=e[1],i=e[2],r=e[3]);const n=r||"";let l;e[4]!==s?(l=d=>s(d.target.value),e[4]=s,e[5]=l):l=e[5];let a;return e[6]!==i||e[7]!==n||e[8]!==l?(a=o.jsx("input",{type:"text",value:n,onChange:l,...i}),e[6]=i,e[7]=n,e[8]=l,e[9]=a):a=e[9],a}function gi(t){return function({onChange:s,...i}){return o.jsx(t,{onChange:r=>s(r||null),...i})}}function xi(t){const e=E.c(10);let s,i,r;e[0]!==t?({value:r,onChange:s,...i}=t,e[0]=t,e[1]=s,e[2]=i,e[3]=r):(s=e[1],i=e[2],r=e[3]);let n;e[4]!==s?(n=a=>s(parseInt(a.target.value)),e[4]=s,e[5]=n):n=e[5];let l;return e[6]!==i||e[7]!==n||e[8]!==r?(l=o.jsx("input",{type:"number",value:r,onChange:n,...i}),e[6]=i,e[7]=n,e[8]=r,e[9]=l):l=e[9],l}function Qu(t){const e=E.c(12);let s,i,r,n;if(e[0]!==t){const{value:d,onChange:f,choices:h,...p}=t;n=d,s=h,i=p,r=g=>f(g.target.value),e[0]=t,e[1]=s,e[2]=i,e[3]=r,e[4]=n}else s=e[1],i=e[2],r=e[3],n=e[4];let l;e[5]!==s?(l=s.map(Yu),e[5]=s,e[6]=l):l=e[6];let a;return e[7]!==i||e[8]!==r||e[9]!==l||e[10]!==n?(a=o.jsx("select",{onChange:r,value:n,...i,children:l}),e[7]=i,e[8]=r,e[9]=l,e[10]=n,e[11]=a):a=e[11],a}function Yu(t){return o.jsx("option",{value:t,children:t},t)}function Ju(t){const e=E.c(13);let s,i,r;e[0]!==t?({value:r,onChange:s,...i}=t,e[0]=t,e[1]=s,e[2]=i,e[3]=r):(s=e[1],i=e[2],r=e[3]);const n=Math.max(r.length,1);let l;e[4]!==r?(l=r.join(`
`),e[4]=r,e[5]=l):l=e[5];const[a,d]=Ee.useState(l);let f;e[6]!==s?(f=g=>{const x=g.target.value;d(x),s(x.split(`
`).map(Zu).filter(Xu))},e[6]=s,e[7]=f):f=e[7];const h=f;let p;return e[8]!==h||e[9]!==n||e[10]!==i||e[11]!==a?(p=o.jsx("textarea",{rows:n,value:a,onChange:h,...i}),e[8]=h,e[9]=n,e[10]=i,e[11]=a,e[12]=p):p=e[12],p}function Xu(t){return t!==""}function Zu(t){return t.trim()}const ep={bool:po,str:mi,int:xi,"optional str":gi(mi),"optional int":gi(xi),"sequence of str":Ju};function tp(t){const e=E.c(16),{choices:s,type:i,value:r,onChange:n,name:l,error:a}=t;let d,f;if(e[0]!==d||e[1]!==s||e[2]!==n||e[3]!==i||e[4]!==r){if(f={onChange:n,value:r},s)d=Qu,f.choices=s;else if(d=ep[i],!d)throw`unknown option type ${i}`;d!==po&&(f.className="form-control"),e[0]=d,e[1]=s,e[2]=n,e[3]=i,e[4]=r,e[5]=f,e[6]=d}else f=e[5],d=e[6];let h;e[7]!==a?(h=_e({"has-error":a}),e[7]=a,e[8]=h):h=e[8];let p;e[9]!==d||e[10]!==l||e[11]!==f?(p=o.jsx(d,{name:l,onKeyDown:Gu,...f}),e[9]=d,e[10]=l,e[11]=f,e[12]=p):p=e[12];let g;return e[13]!==h||e[14]!==p?(g=o.jsx("div",{className:h,children:p}),e[13]=h,e[14]=p,e[15]=g):g=e[15],g}function sp(t){const e=E.c(18),{name:s}=t,i=Q();let r;e[0]!==s?(r=j=>j.options_meta[s]?.choices,e[0]=s,e[1]=r):r=e[1];const n=D(r);let l;e[2]!==s?(l=j=>j.options_meta[s]?.type,e[2]=s,e[3]=l):l=e[3];const a=D(l);let d;e[4]!==s?(d=j=>{const y=j.ui.optionsEditor[s];return y?y.value:j.options_meta[s]?.value},e[4]=s,e[5]=d):d=e[5];const f=D(d);let h;e[6]!==s?(h=j=>j.ui.optionsEditor[s]?.error,e[6]=s,e[7]=h):h=e[7];const p=D(h);let g;e[8]!==i||e[9]!==s?(g=j=>i(As(s,j)),e[8]=i,e[9]=s,e[10]=g):g=e[10];let x;return e[11]!==n||e[12]!==p||e[13]!==s||e[14]!==g||e[15]!==a||e[16]!==f?(x=o.jsx(tp,{name:s,choices:n,type:a,value:f,error:p,onChange:g}),e[11]=n,e[12]=p,e[13]=s,e[14]=g,e[15]=a,e[16]=f,e[17]=x):x=e[17],x}function np(t){const e=E.c(4),{name:s}=t;let i;e[0]!==s?(i=l=>l.options_meta[s]?.help,e[0]=s,e[1]=i):i=e[1];const r=D(i);let n;return e[2]!==r?(n=o.jsx("div",{className:"help-block small",children:r}),e[2]=r,e[3]=n):n=e[3],n}function ip(t){const e=E.c(4),{name:s}=t;let i;e[0]!==s?(i=l=>l.options_meta[s]?.error,e[0]=s,e[1]=i):i=e[1];const r=D(i);if(!r)return null;let n;return e[2]!==r?(n=o.jsx("div",{className:"small text-danger",children:r}),e[2]=r,e[3]=n):n=e[3],n}function rp(t){const e=E.c(2);let{value:s,defaultVal:i}=t;if(s===i)return null;{if(typeof i=="boolean")i=i?"true":"false";else if(Array.isArray(i)){if(Ut.isEmpty(Ut.compact(s))&&Ut.isEmpty(i))return null;i="[ ]"}else i===""?i='""':i===null&&(i="null");let r;return e[0]!==i?(r=o.jsxs("div",{className:"small",children:["Default: ",o.jsxs("strong",{children:[" ",i," "]})," "]}),e[0]=i,e[1]=r):r=e[1],r}}const op=Tt((t,{name:e})=>({value:t.options[e],defaultVal:t.options_meta[e]?.default}))(rp);function lp(){const t=E.c(24),e=Q(),s=D(ap,Gt);let i,r,n,l;if(t[0]!==e||t[1]!==s){const p=s.sort();let g;t[6]!==e?(g=()=>e(er()),t[6]=e,t[7]=g):g=t[7];let x;t[8]===Symbol.for("react.memo_cache_sentinel")?(x=o.jsx("i",{className:"fa fa-fw fa-times"}),t[8]=x):x=t[8];let j;t[9]!==g?(j=o.jsx("button",{type:"button",className:"close","data-dismiss":"modal",onClick:g,children:x}),t[9]=g,t[10]=j):j=t[10];let y;t[11]===Symbol.for("react.memo_cache_sentinel")?(y=o.jsx("div",{className:"modal-title",children:o.jsx("h4",{children:"Options"})}),t[11]=y):y=t[11],t[12]!==j?(l=o.jsxs("div",{className:"modal-header",children:[j,y]}),t[12]=j,t[13]=l):l=t[13],n="modal-body",i="form-horizontal",r=p.map(cp),t[0]=e,t[1]=s,t[2]=i,t[3]=r,t[4]=n,t[5]=l}else i=t[2],r=t[3],n=t[4],l=t[5];let a;t[14]!==i||t[15]!==r?(a=o.jsx("div",{className:i,children:r}),t[14]=i,t[15]=r,t[16]=a):a=t[16];let d;t[17]!==n||t[18]!==a?(d=o.jsx("div",{className:n,children:a}),t[17]=n,t[18]=a,t[19]=d):d=t[19];let f;t[20]===Symbol.for("react.memo_cache_sentinel")?(f=o.jsx("div",{className:"modal-footer"}),t[20]=f):f=t[20];let h;return t[21]!==l||t[22]!==d?(h=o.jsxs("div",{children:[l,d,f]}),t[21]=l,t[22]=d,t[23]=h):h=t[23],h}function cp(t){return o.jsxs("div",{className:"form-group",children:[o.jsxs("div",{className:"col-xs-6",children:[o.jsx("label",{htmlFor:t,children:t}),o.jsx(np,{name:t})]}),o.jsxs("div",{className:"col-xs-6",children:[o.jsx(sp,{name:t}),o.jsx(ip,{name:t}),o.jsx(op,{name:t})]})]},t)}function ap(t){return Object.keys(t.options_meta)}function dp(){const t=E.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=o.jsx(zu,{children:o.jsx(lp,{})}),t[0]=e):e=t[0],e}const fp={OptionModal:dp};function up(){const t=E.c(3),e=D(pp),s=e?fp[e]:void 0;if(s){let i;return t[0]!==s?(i=o.jsx(s,{}),t[0]=s,t[1]=i):i=t[1],i}else{let i;return t[2]===Symbol.for("react.memo_cache_sentinel")?(i=o.jsx(o.Fragment,{}),t[2]=i):i=t[2],i}}function pp(t){return t.ui.modal.activeModal}class hp extends I.Component{state={};render=()=>{const{showEventLog:e,showCommandBar:s}=this.props;return this.state.error?(console.log("ERR",this.state),o.jsxs("div",{className:"container",children:[o.jsx("h1",{children:"mitmproxy has crashed."}),o.jsxs("pre",{children:[this.state.error.stack,o.jsx("br",{}),o.jsx("br",{}),"Component Stack:",this.state.errorInfo?.componentStack]}),o.jsxs("p",{children:["Please lodge a bug report at"," ",o.jsx("a",{href:"https://github.com/mitmproxy/mitmproxy/issues",children:"https://github.com/mitmproxy/mitmproxy/issues"}),"."]})]})):o.jsxs("div",{id:"container",tabIndex:0,children:[o.jsx($u,{}),o.jsx(Wf,{}),s&&o.jsx(Au,{},"commandbar"),e&&o.jsx(Uu,{},"eventlog"),o.jsx(Bu,{}),o.jsx(up,{})]})};componentDidMount(){window.addEventListener("keydown",this.props.onKeyDown)}componentWillUnmount(){window.removeEventListener("keydown",this.props.onKeyDown)}componentDidCatch(e,s){this.setState({error:e,errorInfo:s})}}const mp=Tt(t=>({showEventLog:t.eventLog.visible,showCommandBar:t.commandBar.visible}),{onKeyDown:bd})(hp),Ze={SEARCH:"s",HIGHLIGHT:"h",SHOW_EVENTLOG:"e",SHOW_COMMANDBAR:"c"};function gp(t){const[e,s]=window.location.hash.substr(1).split("?",2),i=e.substr(1).split("/");if(i[0]==="flows"){if(i.length==3){const[r,n]=i.slice(1);t.dispatch(Wt(n));const l=()=>{const d=t.getState().flows.byId.get(r);d!==void 0&&(a(),t.dispatch(He([d])))},a=t.subscribe(l);l()}}else i[0]==="capture"&&t.dispatch(Bt(fe.Capture));s&&s.split("&").forEach(r=>{const[n,l]=r.split("=",2),a=decodeURIComponent(l);switch(n){case Ze.SEARCH:t.dispatch(qi(a));break;case Ze.HIGHLIGHT:t.dispatch(Hi(a));break;case Ze.SHOW_EVENTLOG:t.getState().eventLog.visible||t.dispatch(Qt());break;case Ze.SHOW_COMMANDBAR:t.getState().commandBar.visible||t.dispatch(rr());break;default:console.error(`unimplemented query arg: ${r}`)}})}function xp(t){const e=t.getState(),s={[Ze.SEARCH]:e.ui.filter[xe.Search],[Ze.HIGHLIGHT]:e.ui.filter[xe.Highlight],[Ze.SHOW_EVENTLOG]:e.eventLog.visible,[Ze.SHOW_COMMANDBAR]:e.commandBar.visible},i=Object.keys(s).filter(l=>s[l]).map(l=>`${l}=${encodeURIComponent(s[l])}`).join("&");let r;e.ui.tabs.current===fe.Capture?r="/capture":e.flows.selected.length>0?r=`/flows/${e.flows.selected[0].id}/${e.ui.flow.tab}`:r="/flows",i&&(r+="?"+i);let n=window.location.pathname;n==="blank"&&(n="/"),window.location.hash.substr(1)!==r&&history.replaceState(void 0,"",`${n}#${r}`)}function vp(t){gp(t),t.subscribe(()=>xp(t))}var lt=(t=>(t.State="state",t.Flows="flows",t.Events="events",t.Options="options",t))(lt||{});class _p{activeFetches;store;filterState;socket;messageQueue;constructor(e){this.activeFetches={},this.store=e,this.filterState=Oi,this.messageQueue=[],this.connect(),this.store.subscribe(this.onStoreUpdate.bind(this))}connect(){this.socket=new WebSocket(location.origin.replace("http","ws")+location.pathname.replace(/\/$/,"")+"/updates"),this.socket.addEventListener("open",()=>this.onOpen()),this.socket.addEventListener("close",e=>this.onClose(e)),this.socket.addEventListener("message",e=>this.onMessage(JSON.parse(e.data))),this.socket.addEventListener("error",e=>this.onError(e))}async onOpen(){for(const e of this.messageQueue)this.socket.send(JSON.stringify(e));this.messageQueue=[],this.store.dispatch(Vc()),await Promise.all([this.fetchData("state"),this.fetchData("flows"),this.fetchData("events"),this.fetchData("options")]),this.store.dispatch(Uc())}onStoreUpdate(){const e=this.store.getState().ui.filter;if(e!==this.filterState){for(const s of Object.values(xe))this.filterState[s]!==e[s]&&this.sendMessage({type:"flows/updateFilter",payload:{name:s,expr:e[s]}});this.filterState=e}}fetchData(e){const s=[];return this.activeFetches[e]=s,ne(`./${e}`).then(i=>i.json()).then(i=>{this.activeFetches[e]===s&&this.receive(e,i)})}onMessage(e){switch(e.type){case"flows/add":return this.queueOrDispatch("flows",Gi(e.payload));case"flows/update":return this.queueOrDispatch("flows",Qi(e.payload));case"flows/filterUpdate":return this.queueOrDispatch("flows",Ji(e.payload));case"flows/remove":return this.queueOrDispatch("flows",Yi(e.payload));case"events/add":return this.queueOrDispatch("events",Ts(e.payload));case"options/update":return this.queueOrDispatch("options",Rs(e.payload));case"state/update":return this.queueOrDispatch("state",Ue(e.payload));case"flows/reset":return this.fetchData("flows");case"events/reset":return this.fetchData("events");default:Nt(e.type)}}sendMessage(e){this.socket.readyState===WebSocket.OPEN?this.socket.send(JSON.stringify(e)):this.socket.readyState===WebSocket.CONNECTING?this.messageQueue.push(e):console.error("WebSocket is not open. Cannot send:",e)}queueOrDispatch(e,s){const i=this.activeFetches[e];i!==void 0?i.push(s):this.store.dispatch(s)}receive(e,s){switch(e){case"state":this.store.dispatch(Ve(s));break;case"options":this.store.dispatch(Yt(s));break;case"events":this.store.dispatch(tr(s));break;case"flows":this.store.dispatch(Es(s));break;default:Nt(e)}const i=this.activeFetches[e];delete this.activeFetches[e],i.forEach(r=>this.store.dispatch(r))}onClose(e){this.store.dispatch(Bc(`Connection closed at ${new Date().toUTCString()} with error code ${e.code}.`)),console.error("websocket connection closed",e)}onError(...e){console.error("websocket connection errored",e)}}class jp{store;constructor(e){this.store=e,this.onOpen()}onOpen(){this.fetchData(lt.Flows),this.fetchData(lt.Options)}fetchData(e){ne(`./${e}`).then(s=>s.json()).then(s=>{this.receive(e,s)})}receive(e,s){switch(e){case lt.Flows:this.store.dispatch(Es(s));break;case lt.Options:this.store.dispatch(Yt(s));break;case lt.State:throw"unreachable";case lt.Events:throw"unreachable";default:Nt(e)}}}window.MITMWEB_STATIC?window.backend=new jp(kt):window.backend=new _p(kt);vp(kt);window.addEventListener("error",t=>{kt.dispatch(Tc(`${t.message}
${t.error.stack}`))});document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("mitmproxy");Zl.createRoot(t).render(o.jsx(ec,{store:kt,children:o.jsx(mp,{})}))});
