import{c as pe,R as Wo,a as je,r as M,b as Se,d as ye,j as r,e as E,f as $i,u as zo,g as Qo,h as Ci,s as Gt,i as Go,l as Bt,k as Yo,m as Jo,n as Xo,y as Zo,o as ec,p as tc,q as vt,Q as sc,C as Ni,X as ki,Y as ms,T as ws,L as Ss,t as nc,v as $s,w as ic,P as rc,x as lc,z as oc,B as Jn,A as cc,D as ac,E as dc}from"./vendor-CV_2_uTW.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const n of l)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function s(l){const n={};return l.integrity&&(n.integrity=l.integrity),l.referrerPolicy&&(n.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?n.credentials="include":l.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(l){if(l.ep)return;l.ep=!0;const n=s(l);fetch(l.href,n)}})();const uc={tab:"request",contentViewFor:{}},fc=pe({name:"ui/flow",initialState:uc,reducers:{selectTab(t,e){t.tab=e.payload},setContentViewFor(t,e){t.contentViewFor[e.payload.messageId]=e.payload.contentView}}}),{actions:pc,reducer:hc}=fc,{selectTab:Wt,setContentViewFor:Ei}=pc;window.React=Wo;const Ti=function(t){if(t===0)return"0";const e=["b","kb","mb","gb","tb"];let s=0;for(;s<e.length&&!(Math.pow(1024,s+1)>t);s++);let i;return t%Math.pow(1024,s)===0?i=0:i=1,(t/Math.pow(1024,s)).toFixed(i)+e[s]},Ri=function(t){let e=t;const s=["ms","s","min","h"],i=[1e3,60,60];let l=0;for(;Math.abs(e)>=i[l]&&l<i.length;)e=e/i[l],l++;return Math.round(e)+s[l]},dt=function(t,{includeMilliseconds:e=!0}={}){const s=new Date(t*1e3),i=String(s.getFullYear()),l=String(s.getMonth()+1).padStart(2,"0"),n=String(s.getDate()).padStart(2,"0"),o=String(s.getHours()).padStart(2,"0"),a=String(s.getMinutes()).padStart(2,"0"),d=String(s.getSeconds()).padStart(2,"0"),u=String(s.getMilliseconds()).padStart(3,"0");let p=`${i}-${l}-${n} ${o}:${a}:${d}`;return e&&(p+=`.${u}`),p};function Xn(t){return t[0].includes(":")?`[${t[0]}]:${t[1]}`:`${t[0]}:${t[1]}`}function mc(t){const e=document.cookie.match(new RegExp("\\b"+t+"=([^;]*)\\b"));return e?e[1]:void 0}let gs=()=>{const t=mc("_xsrf");return gs=()=>t,gs()};function ne(t,e={}){return e.method&&e.method!=="GET"&&(e.headers=e.headers||{},e.headers["X-XSRFToken"]=gs()),t.startsWith("/")&&(t="."+t),fetch(t,{credentials:"same-origin",...e})}ne.put=(t,e,s={})=>ne(t,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),...s});ne.post=(t,e,s={})=>ne(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),...s});async function zt(t,...e){return await(await ne(`/commands/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({arguments:e})})).json()}async function Ai(t){try{await navigator.clipboard.write([new ClipboardItem({"text/plain":t})]);return}catch(i){console.warn(i)}const e=await t;try{await navigator.clipboard.writeText(e);return}catch(i){console.warn(i)}const s=document.createElement("textarea");s.value=e,s.style.position="absolute",s.style.opacity="0",document.body.appendChild(s);try{if(s.focus(),s.select(),!document.execCommand("copy"))throw"failed to copy"}catch{alert(e)}finally{s.remove()}}async function gc(t){await Ai(Promise.resolve(t?.text||""))}function xs(t,e){const s=t.lastIndexOf(e);if(s===-1)return["",t];const i=t.slice(0,s),l=t.slice(s+e.length);return[i,l]}function Di(t,e){const s=t.indexOf(e);if(s===-1)return[t,""];const i=t.slice(0,s),l=t.slice(s+e.length);return[i,l]}function Et(t){throw new Error(`Unreachable: ${JSON.stringify(t)}`)}const Ii={http:80,https:443},Zn=new WeakMap;class we{static getContentType(e){const s=we.get_first_header(e,/^Content-Type$/i);if(s)return s.split(";")[0].trim()}static get_first_header(e,s){let i=Zn.get(e);i||(i=new Map,Zn.set(e,i));let l=i.get(s);if(l===void 0){const n=e.headers.find(([o,a])=>s.test(o));l=n?n[1]:!1,i.set(s,l)}return l!==!1?l:void 0}static match_header(e,s){const i=e.headers;if(!i)return!1;let l=i.length;for(;l--;)if(s.test(i[l].join(" ")))return i[l];return!1}static getContentURL(e,s,i,l){e.type==="http"&&s===e.request?s="request":e.type==="http"&&s===e.response&&(s="response");const n=l?`?lines=${l}`:"";return`./flows/${e.id}/${s}/`+(i?`content/${encodeURIComponent(i)}.json${n}`:"content.data")}}class at extends we{static pretty_url(e){let s="";return Ii[e.scheme]!==e.port&&(s=":"+e.port),e.scheme+"://"+e.pretty_host+s+e.path}}class gt extends we{}const xc=/^(?:(https?):\/\/)?([^/:]+)?(?::(\d+))?(\/.*)?$/i,Fi=function(t){const e=xc.exec(t);if(!e)return;const s=e[1],i=e[2],l=parseInt(e[3]),n=e[4],o=s?l||Ii[s]:l,a={};return s&&(a.scheme=s),i&&(a.host=i),o&&(a.port=o),n&&(a.path=n),a},vc=/^HTTP\/\d+(\.\d+)*$/i,Li=function(t){return vc.test(t)};function Qt(t){switch(t.type){case"http":return t.request.timestamp_start;case"tcp":case"udp":return t.client_conn.timestamp_start;case"dns":return t.request.timestamp}}function Pi(t){switch(t.type){case"http":if(t.websocket){if(t.websocket.timestamp_end)return t.websocket.timestamp_end;if(t.websocket.messages_meta.timestamp_last)return t.websocket.messages_meta.timestamp_last}return t.response?t.response.timestamp_end:void 0;case"tcp":return t.server_conn?.timestamp_end;case"udp":return t.messages_meta.timestamp_last;case"dns":return t.response?.timestamp}}const Mi=t=>{switch(t.type){case"http":{let e=t.request.contentLength||0;return t.response&&(e+=t.response.contentLength||0),t.websocket&&(e+=t.websocket.messages_meta.contentLength||0),e}case"tcp":case"udp":return t.messages_meta.contentLength||0;case"dns":return t.response?.size??0}},Cs=t=>t.type==="http"&&!t.websocket,Oi=t=>t.modified,Ns=t=>t.intercepted,qi=t=>{if(t.type!=="http")return t.client_conn.tls_version==="QUICv1"?"resource-icon-quic":`resource-icon-${t.type}`;if(t.websocket)return"resource-icon-websocket";if(!t.response)return"resource-icon-plain";const e=gt.getContentType(t.response)||"";return t.response.status_code===304?"resource-icon-not-modified":300<=t.response.status_code&&t.response.status_code<400?"resource-icon-redirect":e.indexOf("image")>=0?"resource-icon-image":e.indexOf("javascript")>=0?"resource-icon-js":e.indexOf("css")>=0?"resource-icon-css":e.indexOf("html")>=0?"resource-icon-document":"resource-icon-plain"},Hi=t=>{switch(t.type){case"http":return at.pretty_url(t.request);case"tcp":case"udp":return`${t.client_conn.peername.join(":")} ↔ ${t.server_conn?.address?.join(":")}`;case"dns":return`${t.request.questions.map(e=>`${e.name} ${e.type}`).join(", ")} = ${(t.response?.answers.map(e=>e.data).join(", ")??"...")||"?"}`}},Vi=t=>{switch(t.type){case"http":return t.response?.status_code;case"dns":return t.response?.response_code;default:return}},Ui=t=>{switch(t.type){case"http":return t.websocket?t.client_conn.tls_established?"WSS":"WS":t.request.method;case"dns":return t.request.op_code;default:return t.type.toUpperCase()}},Bi=t=>{switch(t.type){case"http":return t.request.http_version;default:return""}},Ki={tls:t=>t.type==="http"&&t.request.scheme,icon:qi,index:()=>0,path:Hi,method:Ui,version:Bi,status:Vi,size:Mi,time:t=>{const e=Qt(t),s=Pi(t);return e&&s&&s-e},timestamp:Qt,quickactions:()=>0,comment:t=>t.comment};function _c(t){return t in Ki}var _e=(t=>(t.Search="search",t.Highlight="highlight",t))(_e||{});const Wi={search:"",highlight:""},jc=pe({name:"ui/filters",initialState:Wi,reducers:{setFilter(t,e){t.search=e.payload},setHighlight(t,e){t.highlight=e.payload}}}),{actions:yc,reducer:bc}=jc,{setFilter:zi,setHighlight:Qi}=yc;function os(t,e){return t.toSorted?t.toSorted(e):[...t].sort(e)}function ks(t,...e){if(t.toSpliced)return t.toSpliced(...e);{const s=[...t];return s.splice(...e),s}}function bt(t){return new Map(t.map((e,s)=>[e.id,s]))}function cs(t){return new Set(t.map(e=>e.id))}function ei(t,e){return t.has(e)&&(t=new Set(t),t.delete(e)),t}function ti(t,e,s){const i=ks(t,s,1),l=new Map(e);l.delete(t[s].id);for(let n=i.length-1;n>=s;n--)l.set(i[n].id,n);return{view:i,_viewIndex:l}}function wc(t,e,s,i){const l=[...t],n=l.length;let o=e,a=o.get(s.id);if(a+1<n&&i(s,l[a+1])>0){o=new Map(o);do{const d=l[a+1];l[a]=d,o.set(d.id,a),a++}while(a+1<n&&i(s,l[a+1])>0);o.set(s.id,a)}else if(a>0&&i(s,l[a-1])<0){o=new Map(o);do{const d=l[a-1];l[a]=d,o.set(d.id,a),a--}while(a>0&&i(s,l[a-1])<0);o.set(s.id,a)}return l[a]=s,{view:l,_viewIndex:o}}function si(t,e,s,i){const l=Sc(t,s,i),n=ks(t,l,0,s),o=new Map(e);for(let a=n.length-1;a>=l;a--)o.set(n[a].id,a);return{view:n,_viewIndex:o}}function Sc(t,e,s){let i=0,l=t.length;if(l===0||s(t[l-1],e)<=0)return l;for(;i<l;){const n=i+l>>>1;s(e,t[n])>=0?i=n+1:l=n}return i}function Es(t){return t=t.filter(Ns),()=>Promise.all(t.map(e=>ne(`/flows/${e.id}/resume`,{method:"POST"})))}function Gi(){return()=>ne("/flows/resume",{method:"POST"})}function Yi(t){return t=t.filter(Ns),()=>Promise.all(t.map(e=>ne(`/flows/${e.id}/kill`,{method:"POST"})))}function $c(){return()=>ne("/flows/kill",{method:"POST"})}function Ji(t){return()=>Promise.all(t.map(e=>ne(`/flows/${e.id}`,{method:"DELETE"})))}function Xi(t){return()=>Promise.all(t.map(e=>ne(`/flows/${e.id}/duplicate`,{method:"POST"})))}function Ts(t){return t=t.filter(Cs),()=>Promise.all(t.map(e=>ne(`/flows/${e.id}/replay`,{method:"POST"})))}function Zi(t){return t=t.filter(Oi),()=>Promise.all(t.map(e=>ne(`/flows/${e.id}/revert`,{method:"POST"})))}function ni(t,e){return()=>Promise.all(t.map(s=>Me(s,{marked:e})()))}function Me(t,e){return()=>ne.put(`/flows/${t.id}`,e)}function Cc(t,e,s){const i=new FormData;return e=new window.Blob([e],{type:"plain/text"}),i.append("file",e),()=>ne(`/flows/${t.id}/${s}/content.data`,{method:"POST",body:i})}function er(){return()=>ne("/clear",{method:"POST"})}function Nc(t){const e=new FormData;return e.append("file",t),()=>ne("/flows/dump",{method:"POST",body:e})}const tr=je("flows/add"),sr=je("flows/update"),nr=je("flows/remove"),Rs=je("flows/receive"),ir=je("flows/filterUpdate"),rr=je("flows/sort"),Ue=je("flows/select"),kc={list:[],_listIndex:new Map,byId:new Map,view:[],_viewIndex:new Map,sort:{column:void 0,desc:!1},selected:[],selectedIds:new Set,highlightedIds:new Set};function Ec(t=kc,e){if(Rs.match(e)){const{sort:s}=t,i=e.payload,l=bt(i),n=new Map(i.map(h=>[h.id,h])),o=os(i,ht(s)),a=bt(o),d=t.selected.map(h=>n.get(h.id)).filter(h=>h!==void 0),u=cs(d);return{list:i,_listIndex:l,byId:n,view:o,_viewIndex:a,sort:s,selected:d,selectedIds:u,highlightedIds:new Set}}else if(tr.match(e)){const{flow:s,matching_filters:i}=e.payload;if(t._listIndex.has(s.id))return t;const{sort:l,selected:n,selectedIds:o}=t;let{view:a,_viewIndex:d,highlightedIds:u}=t;const p=new Map(t._listIndex);p.set(s.id,t.list.length);const h=[...t.list,s],g=new Map(t.byId);return g.set(s.id,s),(i[_e.Search]===!0||i[_e.Search]===void 0)&&({view:a,_viewIndex:d}=si(a,d,s,ht(l))),i[_e.Highlight]===!0&&(u=new Set(u),u.add(s.id)),{list:h,_listIndex:p,byId:g,view:a,_viewIndex:d,sort:l,selected:n,selectedIds:o,highlightedIds:u}}else if(sr.match(e)){const{flow:s,matching_filters:i}=e.payload,{_listIndex:l,sort:n,selectedIds:o}=t;let{view:a,_viewIndex:d,selected:u,highlightedIds:p}=t;const h=t._listIndex.get(s.id),g=[...t.list];h!==void 0?g[h]=s:g.push(s);const x=new Map(t.byId);x.set(s.id,s);const j=d.get(s.id),y=j!==void 0,b=i[_e.Search]===!0||i[_e.Search]===void 0;return b&&!y?{view:a,_viewIndex:d}=si(a,d,s,ht(n)):!b&&y?{view:a,_viewIndex:d}=ti(a,d,j):b&&y&&({view:a,_viewIndex:d}=wc(a,d,s,ht(n))),o.has(s.id)&&(u=u.map(S=>S.id===s.id?s:S)),i[_e.Highlight]===!0?p.has(s.id)||(p=new Set(p),p.add(s.id)):p=ei(p,s.id),{list:g,_listIndex:l,byId:x,view:a,_viewIndex:d,sort:n,selected:u,selectedIds:o,highlightedIds:p}}else if(nr.match(e)){const s=e.payload,{sort:i}=t;let{view:l,_viewIndex:n,selected:o,selectedIds:a}=t;const d=t._listIndex.get(s);if(d===void 0)return t;const u=ks(t.list,d,1),p=bt(u),h=new Map(t.byId);h.delete(s);const g=n.get(s);if(g!==void 0&&({view:l,_viewIndex:n}=ti(l,n,g)),a.has(s)){if(o.length===1&&g!==void 0){const j=l[g]??l[g-1];o=j?[j]:[]}else o=o.filter(j=>j.id!==s);a=cs(o)}const x=ei(t.highlightedIds,s);return{list:u,_listIndex:p,byId:h,view:l,_viewIndex:n,sort:i,selected:o,selectedIds:a,highlightedIds:x}}else if(ir.match(e)){const{name:s,matching_flow_ids:i}=e.payload;switch(s){case _e.Search:{const l=os(i===null?t.list:i.map(o=>t.byId.get(o)).filter(o=>o!==void 0),ht(t.sort)),n=bt(l);return{...t,view:l,_viewIndex:n}}case _e.Highlight:return{...t,highlightedIds:new Set(i)};default:Et(s)}}else if(rr.match(e)){const s=e.payload;let i;s.column?i=os(t.view,ht(s)):i=t.list.filter(n=>t._viewIndex.has(n.id));const l=bt(i);return{...t,sort:s,view:i,_viewIndex:l}}else return Ue.match(e)?{...t,selected:e.payload,selectedIds:cs(e.payload)}:t}function ht({column:t,desc:e}){if(!t)return(i,l)=>0;const s=Ki[t];return(i,l)=>{const n=s(i),o=s(l);return n>o?e?-1:1:n<o?e?1:-1:0}}function mt(t,e){const s=t.selected[t.selected.length-1],i=t._viewIndex.get(s?.id),l=0,n=t.view.length-1;let o;i===void 0?o=e<0?l:n:(o=i+e,o=window.Math.max(o,l),o=window.Math.min(o,n));const a=t.view[o];return Ue(a?[a]:[])}function Tc(t){return(e,s)=>{const{flows:i}=s();i.selectedIds.has(t.id)?e(Ue(i.selected.filter(l=>l!==t))):e(Ue([...i.selected,t]))}}function Rc(t){return(e,s)=>{const{flows:i}=s(),l=i.selected[i.selected.length-1],n=i._viewIndex.get(t.id),o=i._viewIndex.get(l?.id);if(n===void 0||o===void 0)return e(Ue([t]));let a;return n<=o?a=i.view.slice(n,o+1):(a=i.view.slice(o+1,n+1),a.push(l)),e(Ue(a))}}const Ac={activeModal:void 0},lr=pe({name:"ui/modal",initialState:Ac,reducers:{setActiveModal(t,e){t.activeModal=e.payload},hideModal(t){t.activeModal=void 0}}}),{actions:Dc,reducer:Ic}=lr,Fc=lr.actions.hideModal.type,{setActiveModal:Lc,hideModal:or}=Dc,ii=(()=>{const t=document.createElement("div");return t.setAttribute("contenteditable","PLAINTEXT-ONLY"),t.contentEditable==="plaintext-only"?"plaintext-only":"true"})();class ae extends M.Component{input=Se.createRef();render(){const e=ye("inline-input",this.props.className);return r.jsx("span",{ref:this.input,tabIndex:0,className:e,placeholder:this.props.placeholder,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onInput:this.onInput,onPaste:this.onPaste,onMouseDown:this.onMouseDown,onClick:this.onClick,children:this.props.content})}componentDidUpdate(e){e.content!==this.props.content&&this.props.onInput?.(this.props.content)}isEditing=()=>this.input.current?.contentEditable===ii;startEditing=()=>{if(!this.input.current)return console.error("unreachable");this.isEditing()||(this.suppress_events=!0,this.input.current.blur(),this.input.current.contentEditable=ii,window.requestAnimationFrame(()=>{if(this.input.current){if(this.input.current.focus(),this.suppress_events=!1,this.props.selectAllOnClick){const e=document.createRange();e.selectNodeContents(this.input.current);const s=window.getSelection();s?.removeAllRanges(),s?.addRange(e)}this.props.onEditStart?.()}}))};resetValue=()=>{if(!this.input.current)return console.error("unreachable");this.input.current.textContent=this.props.content,this.props.onInput?.(this.props.content)};finishEditing=()=>{if(!this.input.current)return console.error("unreachable");this.props.onEditDone(this.input.current.textContent||""),this.input.current.blur(),this.input.current.contentEditable="inherit"};onPaste=e=>{e.preventDefault();const s=e.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,s)};suppress_events=!1;onMouseDown=e=>{this.suppress_events=!0,window.addEventListener("mouseup",this.onMouseUp,{once:!0})};onMouseUp=e=>{const s=e.target===this.input.current,i=!window.getSelection()?.toString();this.props.selectAllOnClick?s&&i&&this.startEditing():s&&this.startEditing(),this.suppress_events=!1};onClick=e=>{};onFocus=e=>{if(!this.input.current)throw"unreachable";this.suppress_events||this.startEditing()};onInput=e=>{this.props.onInput?.(this.input.current?.textContent||"")};onBlur=e=>{this.suppress_events||this.finishEditing()};onKeyDown=e=>{switch(e.stopPropagation(),e.key){case"Escape":e.preventDefault(),this.resetValue(),this.finishEditing();break;case"Enter":e.shiftKey||(e.preventDefault(),this.finishEditing());break}this.props.onKeyDown?.(e)}}function Ct(t){const e=E.c(15);let s;e[0]!==t.content||e[1]!==t.isValid?(s=t.isValid(t.content),e[0]=t.content,e[1]=t.isValid,e[2]=s):s=e[2];const[i,l]=M.useState(s),n=M.useRef(null);let o;e[3]!==t?(o=x=>{t.isValid(x)?t.onEditDone(x):n.current?.resetValue()},e[3]=t,e[4]=o):o=e[4];const a=o,d=i?"has-success":"has-warning";let u;e[5]!==t.className||e[6]!==d?(u=ye(t.className,d),e[5]=t.className,e[6]=d,e[7]=u):u=e[7];const p=u;let h;e[8]!==t?(h=x=>l(t.isValid(x)),e[8]=t,e[9]=h):h=e[9];let g;return e[10]!==p||e[11]!==a||e[12]!==t||e[13]!==h?(g=r.jsx(ae,{...t,className:p,onInput:h,onEditDone:a,ref:n}),e[10]=p,e[11]=a,e[12]=t,e[13]=h,e[14]=g):g=e[14],g}const ee=()=>zo(),F=Qo,Pc=$i.withTypes(),As=je("EVENTS_ADD"),cr=je("EVENTS_RECEIVE"),Yt=je("events/toggleVisibility"),ar=je("events/toggleFilter");var dr=(t=>(t.debug="debug",t.info="info",t.web="web",t.warn="warn",t.error="error",t))(dr||{});const Mc={visible:!1,filters:{debug:!1,info:!0,web:!0,warn:!0,error:!0},list:[],view:[]};function Oc(t=Mc,e){if(As.match(e)){const s=e.payload;return{...t,list:[...t.list,s],view:t.filters[s.level]?[...t.view,s]:t.view}}else{if(cr.match(e))return{...t,list:e.payload,view:e.payload.filter(s=>t.filters[s.level])};if(Yt.match(e))return{...t,visible:!t.visible};if(ar.match(e)){const s={...t.filters,[e.payload]:!t.filters[e.payload]};return{...t,filters:s,view:t.list.filter(i=>s[i.level])}}else return t}}function qc(t,e="web"){return As({id:Math.random().toString(),message:t,level:e})}const ri={},Hc=pe({name:"ui/optionsEditor",initialState:ri,reducers:{startUpdate(t,e){t[e.payload.option]={isUpdating:!0,value:e.payload.value,error:!1}},updateSuccess(t,e){t[e.payload.option]=void 0},updateError(t,e){let s=t[e.payload.option].value;typeof s=="boolean"&&(s=!s),t[e.payload.option]={value:s,isUpdating:!1,error:e.payload.error}}},extraReducers:t=>{t.addCase(Fc,()=>ri)}}),{actions:Vc,reducer:Uc}=Hc,{startUpdate:Bc,updateSuccess:Kc,updateError:Wc}=Vc;var de=(t=>(t[t.Capture=0]="Capture",t[t.FlowList=1]="FlowList",t[t.Options=2]="Options",t[t.Flow=3]="Flow",t[t.Metrics=4]="Metrics",t[t.AdTracking=5]="AdTracking",t))(de||{});const zc=pe({name:"ui/tabs",initialState:{current:1},reducers:{setCurrent(t,e){t.current=e.payload}}}),{actions:Qc,reducer:Gc}=zc,{setCurrent:Kt}=Qc,Yc=Ci({flow:hc,modal:Ic,optionsEditor:Uc,tabs:Gc,filter:bc});var $t=(t=>(t.INIT="CONNECTION_INIT",t.FETCHING="CONNECTION_FETCHING",t.ESTABLISHED="CONNECTION_ESTABLISHED",t.ERROR="CONNECTION_ERROR",t))($t||{});const Jc={state:"CONNECTION_INIT",message:void 0},ur=pe({name:"connection",initialState:Jc,reducers:{startFetching:t=>{t.state==="CONNECTION_INIT"&&(t.state="CONNECTION_FETCHING")},finishFetching:t=>{t.state==="CONNECTION_FETCHING"&&(t.state="CONNECTION_ESTABLISHED")},connectionError:(t,e)=>{t.state="CONNECTION_ERROR",t.message=e.payload}}}),{startFetching:Xc,finishFetching:Zc,connectionError:ea}=ur.actions,ta=ur.reducer,sa={add_upstream_certs_to_client_chain:!1,allow_hosts:[],anticache:!1,anticomp:!1,block_global:!0,block_list:[],block_private:!1,body_size_limit:void 0,cert_passphrase:void 0,certs:[],ciphers_client:void 0,ciphers_server:void 0,client_certs:void 0,client_replay:[],client_replay_concurrency:1,command_history:!0,confdir:"~/.mitmproxy",connect_addr:void 0,connection_strategy:"eager",console_focus_follow:!1,content_view_lines_cutoff:512,dns_name_servers:[],dns_use_hosts_file:!0,export_preserve_original_ip:!1,hardump:"",http2:!0,http2_ping_keepalive:58,http3:!0,http_connect_send_host_header:!0,ignore_hosts:[],intercept:void 0,intercept_active:!1,keep_alt_svc_header:!1,keep_host_header:!1,key_size:2048,listen_host:"",listen_port:void 0,map_local:[],map_remote:[],mode:["regular"],modify_body:[],modify_headers:[],normalize_outbound_headers:!0,onboarding:!0,onboarding_host:"mitm.it",protobuf_definitions:void 0,proxy_debug:!1,proxyauth:void 0,rawtcp:!0,readfile_filter:void 0,request_client_cert:!1,rfile:void 0,save_stream_file:void 0,save_stream_filter:void 0,scripts:[],server:!0,server_replay:[],server_replay_extra:"forward",server_replay_ignore_content:!1,server_replay_ignore_host:!1,server_replay_ignore_params:[],server_replay_ignore_payload_params:[],server_replay_ignore_port:!1,server_replay_kill_extra:!1,server_replay_nopop:!1,server_replay_refresh:!0,server_replay_reuse:!1,server_replay_use_headers:[],show_ignored_hosts:!1,showhost:!1,ssl_insecure:!1,ssl_verify_upstream_trusted_ca:void 0,ssl_verify_upstream_trusted_confdir:void 0,stickyauth:void 0,stickycookie:void 0,store_streamed_bodies:!1,stream_large_bodies:void 0,strip_ech:!0,tcp_hosts:[],tcp_timeout:600,termlog_verbosity:"info",tls_ecdh_curve_client:void 0,tls_ecdh_curve_server:void 0,tls_version_client_max:"UNBOUNDED",tls_version_client_min:"TLS1_2",tls_version_server_max:"UNBOUNDED",tls_version_server_min:"TLS1_2",udp_hosts:[],upstream_auth:void 0,upstream_cert:!0,validate_inbound_headers:!0,view_filter:void 0,view_order:"time",view_order_reversed:!1,web_columns:["tls","icon","path","method","status","size","time"],web_debug:!1,web_host:"127.0.0.1",web_open_browser:!0,web_password:"",web_port:8081,web_static_viewer:"",websocket:!0},Jt=je("OPTIONS_RECEIVE"),Ds=je("OPTIONS_UPDATE"),na=pe({name:"options",initialState:sa,reducers:{},extraReducers:t=>{t.addCase(Jt,(e,s)=>{const i={};for(const[l,{value:n}]of Object.entries(s.payload))i[l]=n;return i}).addCase(Ds,(e,s)=>{for(const[i,{value:l}]of Object.entries(s.payload))e[i]=l})}}),ia=na.reducer;async function ra(t,e,s){try{const i=await ne.put("/options",{[t]:e});if(i.status===200)s(Kc({option:t}));else throw await i.text()}catch(i){s(Wc({option:t,error:i.toString()}))}}const la=ra;function Is(t,e){return s=>{s(Bc({option:t,value:e})),la(t,e,s)}}const oa={visible:!1},ca=pe({name:"commandBar",initialState:oa,reducers:{toggleVisibility(t){t.visible=!t.visible}}}),{actions:aa,reducer:da}=ca,{toggleVisibility:fr}=aa,Be=je("STATE_RECEIVE"),Ke=je("STATE_UPDATE"),ua={available:!1,version:"",contentViews:[],servers:{},platform:"",localModeUnavailable:null},fa=pe({name:"backendState",initialState:ua,reducers:{},extraReducers:t=>{t.addCase(Be,(e,s)=>({...e,available:!0,...s.payload})).addCase(Ke,(e,s)=>({...e,...s.payload}))}}),pa=fa.reducer,ha={},ma=pe({name:"optionsMeta",initialState:ha,reducers:{},extraReducers:t=>{t.addCase(Jt,(e,s)=>s.payload).addCase(Ds,(e,s)=>({...e,...s.payload}))}}),ga=ma.reducer,ut=(t,e)=>e.listen_host&&e.listen_port?`${t}@${e.listen_host}:${e.listen_port}`:e.listen_port?`${t}@${e.listen_port}`:t,pr=t=>{let[e,s]=xs(t,"@");e||(e=s,s="");const[i,l]=Di(e,":");let n,o;if(s){let a;if(s.includes(":")?[n,a]=xs(s,":"):(n="",a=s),a&&(o=parseInt(a,10),isNaN(o)||o<0||o>65535))throw new Error(`invalid port: ${a}`)}return{full_spec:t,name:i,data:l,listen_host:n,listen_port:o}},hr=t=>ut("regular",t),li=({listen_host:t,listen_port:e})=>({ui_id:Math.random(),active:!0,listen_host:t,listen_port:e}),mr=t=>t.selectedProcesses?`local:${t.selectedProcesses}`:"local",oi=({data:t})=>({ui_id:Math.random(),active:!0,selectedProcesses:t}),gr=t=>{const e=t.file_path?`wireguard:${t.file_path}`:"wireguard";return ut(e,t)},ci=({data:t,listen_host:e,listen_port:s})=>({ui_id:Math.random(),active:!0,listen_host:e,listen_port:s,file_path:t});var Xt=(t=>(t.HTTP="http",t.HTTPS="https",t.HTTP3="http3",t.TLS="tls",t.DTLS="dtls",t.TCP="tcp",t.UDP="udp",t.DNS="dns",t.QUIC="quic",t))(Xt||{}),ot=(t=>(t.CSS="css",t.JAVASCRIPT="javascript",t.XML="xml",t.YAML="yaml",t.NONE="none",t.ERROR="error",t))(ot||{});const vs=()=>({active:!1,protocol:Xt.HTTPS,destination:"",ui_id:Math.random()}),Fs=t=>ut(`reverse:${t.protocol}://${t.destination}`,t),xa=({data:t,listen_host:e,listen_port:s})=>{let[i,l]=Di(t,"://");return l||(l=i,i=Xt.HTTPS),{ui_id:Math.random(),active:!0,protocol:i,destination:l,listen_host:e,listen_port:s}},xr=t=>ut("transparent",t),ai=({listen_host:t,listen_port:e})=>({ui_id:Math.random(),active:!0,listen_host:t,listen_port:e}),vr=t=>ut("socks5",t),di=({listen_host:t,listen_port:e})=>({ui_id:Math.random(),active:!0,listen_host:t,listen_port:e}),_r=t=>ut(`upstream:${t.destination}`,t),ui=({data:t,listen_host:e,listen_port:s})=>({ui_id:Math.random(),active:!0,destination:t||"",listen_host:e,listen_port:s}),jr=t=>ut("dns",t),fi=({listen_host:t,listen_port:e})=>({ui_id:Math.random(),active:!0,listen_host:t,listen_port:e}),Ze=t=>t.active&&!t.error;async function va(t,e){const s=e.getState().modes,i=[...s.regular.filter(Ze).map(hr),...s.local.filter(Ze).map(mr),...s.wireguard.filter(Ze).map(gr),...s.reverse.filter(Ze).map(Fs),...s.transparent.filter(Ze).map(xr),...s.socks.filter(Ze).map(vr),...s.upstream.filter(Ze).map(_r),...s.dns.filter(Ze).map(jr)],l=await ne.put("/options",{mode:i});if(l.status!==200)throw new Error(await l.text())}function ie(t){return Pc(t,va)}function se(t,e,s){t.addCase(s.pending,(i,l)=>{const{server:n,value:o}=l.meta.arg,a=i.findIndex(d=>d.ui_id===n.ui_id);a>=0&&(i[a][e]=o,i[a].error=void 0)}),t.addCase(s.rejected,(i,l)=>{const{server:n}=l.meta.arg,o=i.findIndex(a=>a.ui_id===n.ui_id);o>=0&&(i[o].error=l.error.message)})}function $e(t,e){return function(i,l){if(l.payload.servers){const n=Object.values(l.payload.servers).filter(o=>o.type===t).map(o=>pr(o.full_spec));if(n.length>0)return n.map(e);for(const o of i)o.active=!1}}}const yr=ie("modes/regular/setActive"),br=ie("modes/regular/setListenHost"),wr=ie("modes/regular/setListenPort"),_a=[{active:!0,ui_id:Math.random()}],ja=pe({name:"modes/regular",initialState:_a,reducers:{},extraReducers:t=>{se(t,"active",yr),se(t,"listen_host",br),se(t,"listen_port",wr),t.addCase(Be,$e("regular",li)),t.addCase(Ke,$e("regular",li))}}),ya=ja.reducer,Sr=ie("modes/local/setActive"),Nt=ie("modes/local/setSelectedProcesses"),ba=[{active:!1,selectedProcesses:"",ui_id:Math.random()}],wa=pe({name:"modes/local",initialState:ba,reducers:{},extraReducers:t=>{se(t,"active",Sr),se(t,"selectedProcesses",Nt),t.addCase(Be,$e("local",oi)),t.addCase(Ke,$e("local",oi))}}),Sa=wa.reducer,$r=ie("modes/wireguard/setActive"),Cr=ie("modes/wireguard/setListenHost"),Nr=ie("modes/wireguard/setListenPort"),kr=ie("modes/wireguard/setFilePath"),$a=[{active:!1,ui_id:Math.random()}],Ca=pe({name:"modes/wireguard",initialState:$a,reducers:{},extraReducers:t=>{se(t,"active",$r),se(t,"listen_host",Cr),se(t,"listen_port",Nr),se(t,"file_path",kr),t.addCase(Be,$e("wireguard",ci)),t.addCase(Ke,$e("wireguard",ci))}}),Na=Ca.reducer,_s=ie("modes/reverse/setActive"),Er=ie("modes/reverse/setListenHost"),Tr=ie("modes/reverse/setListenPort"),Rr=ie("modes/reverse/setProtocol"),Ar=ie("modes/reverse/setDestination"),ka=[vs()],Dr=pe({name:"modes/reverse",initialState:ka,reducers:{addServer:t=>{t.push(vs())},removeServer:(t,e)=>{const s=t.findIndex(i=>i.ui_id===e.payload.ui_id);s!==-1&&(t[s].active&&console.error("servers should be deactivated before removal"),t.splice(s,1))}},extraReducers:t=>{se(t,"active",_s),se(t,"listen_host",Er),se(t,"listen_port",Tr),se(t,"protocol",Rr),se(t,"destination",Ar),t.addCase(Be,e),t.addCase(Ke,e);function e(s,i){if(i.payload.servers){const l=Object.fromEntries(Object.entries(i.payload.servers).filter(([o,a])=>a.type==="reverse").map(([o,a])=>[o,pr(o)])),n=[];for(const o of s){const a=Fs(o),d=a in l;delete l[a],n.push({...o,active:d})}for(const o of Object.values(l))n.push(xa(o));return n.length>1&&Gt({...n[0],ui_id:void 0},{...vs(),ui_id:void 0})&&n.shift(),n}}}}),{addServer:Ea,removeServer:Ta}=Dr.actions,Ra=Dr.reducer,Ir=ie("modes/transparent/setActive"),Fr=ie("modes/transparent/setListenHost"),Lr=ie("modes/transparent/setListenPort"),Aa=[{active:!1,ui_id:Math.random()}],Da=pe({name:"modes/transparent",initialState:Aa,reducers:{},extraReducers:t=>{se(t,"active",Ir),se(t,"listen_host",Fr),se(t,"listen_port",Lr),t.addCase(Be,$e("transparent",ai)),t.addCase(Ke,$e("transparent",ai))}}),Ia=Da.reducer,Pr=ie("modes/socks5/setActive"),Mr=ie("modes/socks5/setListenHost"),Or=ie("modes/socks5/setListenPort"),Fa=[{active:!1,ui_id:Math.random()}],La=pe({name:"modes/socks5",initialState:Fa,reducers:{},extraReducers:t=>{se(t,"active",Pr),se(t,"listen_host",Mr),se(t,"listen_port",Or),t.addCase(Be,$e("socks5",di)),t.addCase(Ke,$e("socks5",di))}}),Pa=La.reducer,qr=ie("modes/upstream/setActive"),Hr=ie("modes/upstream/setListenHost"),Vr=ie("modes/upstream/setListenPort"),Ur=ie("modes/upstream/setDestination"),Ma=[{active:!1,destination:"",ui_id:Math.random()}],Oa=pe({name:"modes/upstream",initialState:Ma,reducers:{},extraReducers:t=>{se(t,"active",qr),se(t,"listen_host",Hr),se(t,"listen_port",Vr),se(t,"destination",Ur),t.addCase(Be,$e("upstream",ui)),t.addCase(Ke,$e("upstream",ui))}}),qa=Oa.reducer,Br=ie("modes/dns/setActive"),Kr=ie("modes/dns/setListenHost"),Wr=ie("modes/dns/setListenPort"),Ha=[{active:!0,ui_id:Math.random()}],Va=pe({name:"modes/dns",initialState:Ha,reducers:{},extraReducers:t=>{se(t,"active",Br),se(t,"listen_host",Kr),se(t,"listen_port",Wr),t.addCase(Be,$e("dns",fi)),t.addCase(Ke,$e("dns",fi))}}),Ua=Va.reducer,Ba=Ci({regular:ya,local:Sa,wireguard:Na,reverse:Ra,transparent:Ia,socks:Pa,upstream:qa,dns:Ua}),kt=$i("fetchProcesses",async(t,{rejectWithValue:e})=>{try{return(await ne("/processes")).json()}catch(s){return e(s.message)}}),Ka={currentProcesses:[],isLoading:!1},Wa=pe({name:"processes",initialState:Ka,reducers:{},extraReducers:t=>{t.addCase(kt.pending,e=>{e.isLoading=!0,e.error=void 0}),t.addCase(kt.fulfilled,(e,s)=>{e.isLoading=!1,e.currentProcesses=s.payload}),t.addCase(kt.rejected,(e,s)=>{e.isLoading=!1,e.error=s.payload})}}),za=Wa.reducer,Qa={commandBar:da,eventLog:Oc,flows:Ec,connection:ta,modes:Ba,ui:Yc,options:ia,options_meta:ga,backendState:pa,processes:za},Ga={immutableCheck:{warnAfter:5e5},serializableCheck:{warnAfter:5e5,ignoredPaths:["flows"]}},Tt=Go({reducer:Qa,middleware:t=>t(Ga),devTools:!1});class Ya extends M.Component{container=Se.createRef();nameInput=Se.createRef();valueInput=Se.createRef();render=()=>{const[e,s]=this.props.item;return r.jsxs("div",{ref:this.container,className:"kv-row",onClick:this.onClick,onKeyDownCapture:this.onKeyDown,children:[r.jsx(ae,{ref:this.nameInput,className:"kv-key",content:e,onEditStart:this.props.onEditStart,onEditDone:i=>this.props.onEditDone([i,s]),selectAllOnClick:!0}),": ",r.jsx(ae,{ref:this.valueInput,className:"kv-value",content:s,onEditStart:this.props.onEditStart,onEditDone:i=>this.props.onEditDone([e,i]),placeholder:"empty",selectAllOnClick:!0})]})};onClick=e=>{e.target===this.container.current&&this.props.onClickEmptyArea()};onKeyDown=e=>{e.target===this.valueInput.current?.input.current&&e.key==="Tab"&&this.props.onTabNext()}}class zr extends M.Component{rowRefs={};currentlyEditing;justFinishedEditing;state={currentList:this.props.data||[],initialList:this.props.data};static getDerivedStateFromProps(e,s){return e.data!==s.initialList?{currentList:e.data||[],initialList:e.data}:null}render=()=>{this.rowRefs={};const e=this.state.currentList.map((s,i)=>r.jsx(Ya,{item:s,onEditStart:()=>this.currentlyEditing=i,onEditDone:l=>this.onEditDone(i,l),onClickEmptyArea:()=>this.onClickEmptyArea(i),onTabNext:()=>this.onTabNext(i),ref:l=>{this.rowRefs[i]=l}},i));return r.jsxs("div",{className:ye("kv-editor",this.props.className),onMouseDown:this.onMouseDown,children:[e,r.jsx("div",{onClick:s=>{s.preventDefault(),this.onClickEmptyArea(this.state.currentList.length-1)},className:"kv-add-row fa fa-plus-square-o",role:"button","aria-label":"Add"})]})};onEditDone=(e,s)=>{const i=[...this.state.currentList];s[0]?i[e]=s:i.splice(e,1),this.currentlyEditing=void 0,Bt.isEqual(this.state.currentList,i)||this.props.onChange(i),this.setState({currentList:i})};onClickEmptyArea=e=>{if(this.justFinishedEditing)return;const s=[...this.state.currentList];s.splice(e+1,0,["",""]),this.setState({currentList:s},()=>this.rowRefs[e+1]?.nameInput.current?.startEditing())};onTabNext=e=>{e==this.state.currentList.length-1&&this.onClickEmptyArea(e)};onMouseDown=e=>{this.justFinishedEditing=this.currentlyEditing}}function Qr(t,e){const s=E.c(6),[i,l]=M.useState(),[n,o]=M.useState();let a;s[0]!==n||s[1]!==t?(a=()=>{n&&n.abort();const u=new AbortController;return ne(t,{signal:u.signal}).then(Ja).then(p=>{l(p)}).catch(p=>{u.signal.aborted||l(`Error getting content: ${p}.`)}),o(u),()=>{u.signal.aborted||u.abort()}},s[0]=n,s[1]=t,s[2]=a):a=s[2];let d;return s[3]!==e||s[4]!==t?(d=[t,e],s[3]=e,s[4]=t,s[5]=d):d=s[5],M.useEffect(a,d),i}function Ja(t){if(!t.ok)throw`${t.status} ${t.statusText}`.trim();return t.text()}function Gr(t,e,s,i,l){const n=E.c(11);let o;n[0]!==t||n[1]!==i||n[2]!==e||n[3]!==s?(o=we.getContentURL(t,e,s,i),n[0]=t,n[1]=i,n[2]=e,n[3]=s,n[4]=o):o=n[4];const d=Qr(o,l);let u;if(d)try{let p;n[5]!==d?(p=JSON.parse(d),n[5]=d,n[6]=p):p=n[6],u=p}catch{let p;n[7]!==d?(p={text:d,description:"Network Error",syntax_highlight:"error",view_name:"raw"},n[7]=d,n[8]=p):p=n[8];const h=p;if(e==="messages"){let g;n[9]!==h?(g=[h],n[9]=h,n[10]=g):g=n[10],u=g}else u=h}else u=void 0;return u}const Yr=Se.memo(function({icon:e,text:s,className:i,title:l,onOpenFile:n,onClick:o}){let a;return r.jsxs("a",{href:"#",onClick:d=>{a.click(),o&&o(d)},className:i,title:l,children:[r.jsx("i",{className:"fa fa-fw "+e}),s,r.jsx("input",{ref:d=>{a=d},className:"hidden",type:"file",onChange:d=>{d.preventDefault(),d.target.files&&d.target.files.length>0&&n(d.target.files[0]),a.value=""}})]})});function he(t){const e=E.c(11),{onClick:s,children:i,icon:l,disabled:n,className:o,title:a}=t;let d;e[0]!==o?(d=ye(o,"btn btn-default"),e[0]=o,e[1]=d):d=e[1];const u=n?void 0:s;let p;e[2]!==l?(p=l&&r.jsxs(r.Fragment,{children:[r.jsx("i",{className:"fa "+l})," "]}),e[2]=l,e[3]=p):p=e[3];let h;return e[4]!==i||e[5]!==n||e[6]!==d||e[7]!==u||e[8]!==p||e[9]!==a?(h=r.jsxs("button",{className:d,onClick:u,disabled:n,title:a,children:[p,i]}),e[4]=i,e[5]=n,e[6]=d,e[7]=u,e[8]=p,e[9]=a,e[10]=h):h=e[10],h}function Xa(t){const e=E.c(11),{initialContent:s,onChange:i,language:l,readonly:n}=t,o=n===void 0?!1:n,a=Za;let d;e:switch(l){case ot.YAML:{let h;e[0]===Symbol.for("react.memo_cache_sentinel")?(h=[Zo()],e[0]=h):h=e[0],d=h;break e}case ot.XML:{let h;e[1]===Symbol.for("react.memo_cache_sentinel")?(h=[Xo()],e[1]=h):h=e[1],d=h;break e}case ot.JAVASCRIPT:{let h;e[2]===Symbol.for("react.memo_cache_sentinel")?(h=[Jo()],e[2]=h):h=e[2],d=h;break e}case ot.CSS:{let h;e[3]===Symbol.for("react.memo_cache_sentinel")?(h=[Yo()],e[3]=h):h=e[3],d=h;break e}case void 0:case null:case ot.NONE:case ot.ERROR:{let h;e[4]===Symbol.for("react.memo_cache_sentinel")?(h=[],e[4]=h):h=e[4],d=h;break e}default:{console.error("Unexpected syntax highlighting language: ",l);let g;e[5]===Symbol.for("react.memo_cache_sentinel")?(g=[],e[5]=g):g=e[5],d=g}}const u=d;let p;return e[6]!==u||e[7]!==s||e[8]!==i||e[9]!==o?(p=r.jsx("div",{className:"codeeditor",onKeyDown:a,children:r.jsx(ec,{value:s,onChange:i,readOnly:o,extensions:u})}),e[6]=u,e[7]=s,e[8]=i,e[9]=o,e[10]=p):p=e[10],p}function Za(t){return t.stopPropagation()}const Jr=Se.memo(function(e){const s=E.c(9),{content:i,maxLines:l,showMore:n}=e;if(i.length===0)return null;let o;if(s[0]!==i||s[1]!==l||s[2]!==n){let d;s[4]!==l||s[5]!==n?(d=(u,p)=>p===l?r.jsxs("button",{onClick:n,className:"btn btn-xs btn-info",children:[r.jsx("i",{className:"fa fa-angle-double-down","aria-hidden":"true"})," ","Show more"]},"showmore"):r.jsx("div",{children:u},p),s[4]=l,s[5]=n,s[6]=d):d=s[6],o=i.split(`
`).map(d),s[0]=i,s[1]=l,s[2]=n,s[3]=o}else o=s[3];let a;return s[7]!==o?(a=r.jsx("pre",{children:o}),s[7]=o,s[8]=a):a=s[8],a}),ed=()=>{const t=E.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=r.jsx("li",{role:"separator",className:"divider"}),t[0]=e):e=t[0],e};function Re(t){const e=E.c(8);let s,i,l;if(e[0]!==t){const{onClick:a,children:d,...u}=t;i=d,s=u,l=p=>{p.preventDefault(),a()},e[0]=t,e[1]=s,e[2]=i,e[3]=l}else s=e[1],i=e[2],l=e[3];const n=l;let o;return e[4]!==s||e[5]!==i||e[6]!==n?(o=r.jsx("li",{children:r.jsx("a",{href:"#",onClick:n,...s,children:i})}),e[4]=s,e[5]=i,e[6]=n,e[7]=o):o=e[7],o}const At=Se.memo(function({text:e,children:s,options:i,className:l,onOpen:n,...o}){const[a,d]=M.useState(!1),{refs:u,floatingStyles:p}=tc(i),h=x=>{d(x),n&&n(x)};M.useEffect(()=>{u.floating.current&&document.addEventListener("click",x=>{u.floating.current?.contains(x.target)?document.addEventListener("click",()=>h(!1),{once:!0}):(x.preventDefault(),x.stopPropagation(),h(!1))},{once:!0,capture:!0})},[u.floating.current]);let g;return a?g=r.jsx("ul",{className:"dropdown-menu show",ref:u.setFloating,style:p,children:s}):g=null,r.jsxs(r.Fragment,{children:[r.jsx("a",{href:"#",ref:u.setReference,className:ye(l,{open:a}),onClick:x=>{x.preventDefault(),h(!0)},...o,children:e}),g]})});function Xr(t){const e=E.c(16),{value:s,onChange:i}=t,l=F(td);let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("i",{className:"fa fa-fw fa-files-o"}),e[0]=n):n=e[0];let o;e[1]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsx("b",{children:"View:"}),e[1]=o):o=e[1];let a;e[2]!==s?(a=s.toLowerCase(),e[2]=s,e[3]=a):a=e[3];let d;e[4]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx("span",{className:"caret"}),e[4]=d):d=e[4];let u;e[5]!==a?(u=r.jsxs("span",{children:[n," ",o," ",a," ",d]}),e[5]=a,e[6]=u):u=e[6];const p=u;let h;e[7]===Symbol.for("react.memo_cache_sentinel")?(h={placement:"top-end"},e[7]=h):h=e[7];let g;if(e[8]!==l||e[9]!==i){let j;e[11]!==i?(j=y=>r.jsx(Re,{onClick:()=>i(y),children:y.toLowerCase().replace("_"," ")},y),e[11]=i,e[12]=j):j=e[12],g=l.map(j),e[8]=l,e[9]=i,e[10]=g}else g=e[10];let x;return e[13]!==p||e[14]!==g?(x=r.jsx(At,{text:p,className:"btn btn-default btn-xs",options:h,children:g}),e[13]=p,e[14]=g,e[15]=x):x=e[15],x}function td(t){return t.backendState.contentViews||[]}function sd(t){const e=E.c(8),{flow:s,message:i}=t,[l,n]=M.useState(!1);if(l){let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=()=>n(!1),e[0]=o):o=e[0];let a;return e[1]!==s||e[2]!==i?(a=r.jsx(nd,{flow:s,message:i,stopEdit:o}),e[1]=s,e[2]=i,e[3]=a):a=e[3],a}else{let o;e[4]===Symbol.for("react.memo_cache_sentinel")?(o=()=>n(!0),e[4]=o):o=e[4];let a;return e[5]!==s||e[6]!==i?(a=r.jsx(id,{flow:s,message:i,startEdit:o}),e[5]=s,e[6]=i,e[7]=a):a=e[7],a}}function nd(t){const e=E.c(23),{flow:s,message:i,stopEdit:l}=t,n=ee(),o=s.request===i?"request":"response";let a;e[0]!==s||e[1]!==i?(a=we.getContentURL(s,i),e[0]=s,e[1]=i,e[2]=a):a=e[2];const u=Qr(a,i.contentHash),[p,h]=M.useState();let g;e[3]!==u||e[4]!==n||e[5]!==p||e[6]!==s||e[7]!==o||e[8]!==l?(g=async()=>{await n(Me(s,{[o]:{content:p||u||""}})),l()},e[3]=u,e[4]=n,e[5]=p,e[6]=s,e[7]=o,e[8]=l,e[9]=g):g=e[9];const x=g;let j;e[10]===Symbol.for("react.memo_cache_sentinel")?(j=r.jsx("h5",{children:"[Editing]"}),e[10]=j):j=e[10];let y;e[11]!==x?(y=r.jsx(he,{onClick:x,icon:"fa-check text-success",className:"btn-xs",children:"Done"}),e[11]=x,e[12]=y):y=e[12];let b;e[13]!==l?(b=r.jsx(he,{onClick:()=>l(),icon:"fa-times text-danger",className:"btn-xs",children:"Cancel"}),e[13]=l,e[14]=b):b=e[14];let S;e[15]!==y||e[16]!==b?(S=r.jsxs("div",{className:"controls",children:[j,y," ",b]}),e[15]=y,e[16]=b,e[17]=S):S=e[17];const C=u||"";let N;e[18]!==C?(N=r.jsx(Xa,{initialContent:C,onChange:h}),e[18]=C,e[19]=N):N=e[19];let T;return e[20]!==S||e[21]!==N?(T=r.jsxs("div",{className:"contentview",children:[S,N]},"edit"),e[20]=S,e[21]=N,e[22]=T):T=e[22],T}function id(t){const e=E.c(43),{flow:s,message:i,startEdit:l}=t,n=ee(),o=s.request===i?"request":"response";let a;e[0]!==s.id||e[1]!==o?(a=q=>q.ui.flow.contentViewFor[s.id+o]||"Auto",e[0]=s.id,e[1]=o,e[2]=a):a=e[2];const d=F(a),[u,p]=M.useState(F(rd));let h;e[3]!==u?(h=()=>p(Math.max(1024,u*2)),e[3]=u,e[4]=h):h=e[4];const g=h,x=Gr(s,i,d,u+1,i.contentHash);let j;if(i.contentLength===0)j="No content";else if(x===void 0)j="Loading...";else{const q=`${x.view_name} ${x.description}`;let V;e[5]!==q?(V=q.trimEnd(),e[5]=q,e[6]=V):V=e[6],j=V}let y;e[7]!==j?(y=r.jsx("h5",{children:j}),e[7]=j,e[8]=y):y=e[8];let b;e[9]!==x||e[10]!==s||e[11]!==i?(b=x&&x?.text.length>0&&r.jsx(ld,{flow:s,message:i}),e[9]=x,e[10]=s,e[11]=i,e[12]=b):b=e[12];let S;e[13]!==l?(S=r.jsx(he,{onClick:l,icon:"fa-edit",className:"btn-xs",children:"Edit"}),e[13]=l,e[14]=S):S=e[14];let C;e[15]!==n||e[16]!==s||e[17]!==o?(C=r.jsx(Yr,{icon:"fa-upload",text:"Replace",title:"Upload a file to replace the content.",onOpenFile:q=>n(Cc(s,q,o)),className:"btn btn-default btn-xs"}),e[15]=n,e[16]=s,e[17]=o,e[18]=C):C=e[18];let N;e[19]!==n||e[20]!==s.id||e[21]!==o?(N=q=>n(Ei({messageId:s.id+o,contentView:q})),e[19]=n,e[20]=s.id,e[21]=o,e[22]=N):N=e[22];let T;e[23]!==d||e[24]!==N?(T=r.jsx(Xr,{value:d,onChange:N}),e[23]=d,e[24]=N,e[25]=T):T=e[25];let I;e[26]!==y||e[27]!==b||e[28]!==S||e[29]!==C||e[30]!==T?(I=r.jsxs("div",{className:"controls",children:[y,b," ",S," ",C," ",T]}),e[26]=y,e[27]=b,e[28]=S,e[29]=C,e[30]=T,e[31]=I):I=e[31];let D;e[32]!==s||e[33]!==i?(D=js.matches(i)&&r.jsx(js,{flow:s,message:i}),e[32]=s,e[33]=i,e[34]=D):D=e[34];const O=x?.text??"";let L;e[35]!==u||e[36]!==g||e[37]!==O?(L=r.jsx(Jr,{content:O,maxLines:u,showMore:g}),e[35]=u,e[36]=g,e[37]=O,e[38]=L):L=e[38];let H;return e[39]!==D||e[40]!==L||e[41]!==I?(H=r.jsxs("div",{className:"contentview",children:[I,D,L]},"view"),e[39]=D,e[40]=L,e[41]=I,e[42]=H):H=e[42],H}function rd(t){return t.options.content_view_lines_cutoff}function ld({flow:t,message:e}){const s=t.request===e?"request":"response",i=F(u=>u.ui.flow.contentViewFor[t.id+s]||"Auto"),[l,n]=M.useState(!1),[o,a]=M.useState(!1),d=async()=>{try{const u=we.getContentURL(t,e,i);a(!0);const p=await ne(u);if(!p.ok)throw new Error(`${p.status} ${p.statusText}`.trim());const h=await p.json();await gc(h),n(!0),setTimeout(()=>n(!1),2e3)}catch(u){console.error(u)}finally{a(!1)}};return r.jsx(he,{onClick:d,icon:"fa-clipboard",className:"btn-xs",disabled:o,children:l?"Copied!":"Copy"})}const od=/^image\/(png|jpe?g|gif|webp|vnc.microsoft.icon|x-icon|svg\+xml)$/i;js.matches=t=>od.test(we.getContentType(t)||"");function js(t){const e=E.c(5),{flow:s,message:i}=t;let l;e[0]!==s||e[1]!==i?(l=we.getContentURL(s,i),e[0]=s,e[1]=i,e[2]=l):l=e[2];let n;return e[3]!==l?(n=r.jsx("div",{className:"flowview-image",children:r.jsx("img",{src:l,alt:"preview",className:"img-thumbnail"})}),e[3]=l,e[4]=n):n=e[4],n}function cd(t){const e=E.c(24),{flow:s}=t,i=ee();let l;e[0]!==i||e[1]!==s?(l=g=>i(Me(s,{request:{method:g}})),e[0]=i,e[1]=s,e[2]=l):l=e[2];let n;e[3]!==s.request.method||e[4]!==l?(n=r.jsx(Ct,{content:s.request.method,onEditDone:l,isValid:dd,selectAllOnClick:!0}),e[3]=s.request.method,e[4]=l,e[5]=n):n=e[5];let o;e[6]!==s.request?(o=at.pretty_url(s.request),e[6]=s.request,e[7]=o):o=e[7];let a;e[8]!==i||e[9]!==s?(a=g=>i(Me(s,{request:{path:"",...Fi(g)}})),e[8]=i,e[9]=s,e[10]=a):a=e[10];let d;e[11]!==o||e[12]!==a?(d=r.jsx(Ct,{content:o,onEditDone:a,isValid:ad}),e[11]=o,e[12]=a,e[13]=d):d=e[13];let u;e[14]!==i||e[15]!==s?(u=g=>i(Me(s,{request:{http_version:g}})),e[14]=i,e[15]=s,e[16]=u):u=e[16];let p;e[17]!==s.request.http_version||e[18]!==u?(p=r.jsx(Ct,{content:s.request.http_version,onEditDone:u,isValid:Li,selectAllOnClick:!0}),e[17]=s.request.http_version,e[18]=u,e[19]=p):p=e[19];let h;return e[20]!==n||e[21]!==d||e[22]!==p?(h=r.jsx("div",{className:"first-line request-line",children:r.jsxs("div",{children:[n," ",d," ",p]})}),e[20]=n,e[21]=d,e[22]=p,e[23]=h):h=e[23],h}function ad(t){return!!Fi(t)?.host}function dd(t){return t.length>0}function ud(t){const e=E.c(19),{flow:s}=t,i=ee();let l;e[0]!==i||e[1]!==s?(l=h=>i(Me(s,{response:{http_version:h}})),e[0]=i,e[1]=s,e[2]=l):l=e[2];let n;e[3]!==s.response.http_version||e[4]!==l?(n=r.jsx(Ct,{content:s.response.http_version,onEditDone:l,isValid:Li,selectAllOnClick:!0}),e[3]=s.response.http_version,e[4]=l,e[5]=n):n=e[5];const o=s.response.status_code+"";let a;e[6]!==i||e[7]!==s?(a=h=>i(Me(s,{response:{code:parseInt(h)}})),e[6]=i,e[7]=s,e[8]=a):a=e[8];let d;e[9]!==o||e[10]!==a?(d=r.jsx(Ct,{content:o,onEditDone:a,isValid:fd,selectAllOnClick:!0}),e[9]=o,e[10]=a,e[11]=d):d=e[11];let u;e[12]!==i||e[13]!==s?(u=s.response.http_version!=="HTTP/2.0"&&r.jsxs(r.Fragment,{children:[" ",r.jsx(ae,{content:s.response.reason,onEditDone:h=>i(Me(s,{response:{msg:h}})),selectAllOnClick:!0})]}),e[12]=i,e[13]=s,e[14]=u):u=e[14];let p;return e[15]!==n||e[16]!==d||e[17]!==u?(p=r.jsxs("div",{className:"first-line response-line",children:[n," ",d,u]}),e[15]=n,e[16]=d,e[17]=u,e[18]=p):p=e[18],p}function fd(t){return/^\d+$/.test(t)}function pd(t){const e=E.c(7),{flow:s,message:i}=t,l=ee(),n=s.request===i?"request":"response";let o;e[0]!==l||e[1]!==s||e[2]!==n?(o=d=>l(Me(s,{[n]:{headers:d}})),e[0]=l,e[1]=s,e[2]=n,e[3]=o):o=e[3];let a;return e[4]!==i.headers||e[5]!==o?(a=r.jsx(zr,{className:"headers",data:i.headers,onChange:o}),e[4]=i.headers,e[5]=o,e[6]=a):a=e[6],a}function hd(t){const e=E.c(9),{flow:s,message:i}=t,l=ee(),n=s.request===i?"request":"response";if(!!!we.get_first_header(i,/^trailer$/i))return null;let a,d;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("hr",{}),d=r.jsx("h5",{children:"HTTP Trailers"}),e[0]=a,e[1]=d):(a=e[0],d=e[1]);let u;e[2]!==l||e[3]!==s||e[4]!==n?(u=h=>l(Me(s,{[n]:{trailers:h}})),e[2]=l,e[3]=s,e[4]=n,e[5]=u):u=e[5];let p;return e[6]!==i.trailers||e[7]!==u?(p=r.jsxs(r.Fragment,{children:[a,d,r.jsx(zr,{className:"trailers",data:i.trailers,onChange:u})]}),e[6]=i.trailers,e[7]=u,e[8]=p):p=e[8],p}const Zr=M.memo(function(e){const s=E.c(20),{flow:i,message:l}=e,n=i.request===l?"request":"response",o=i.request===l?cd:ud;let a;s[0]!==o||s[1]!==i?(a=r.jsx(o,{flow:i}),s[0]=o,s[1]=i,s[2]=a):a=s[2];let d;s[3]!==i||s[4]!==l?(d=r.jsx(pd,{flow:i,message:l}),s[3]=i,s[4]=l,s[5]=d):d=s[5];let u;s[6]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("hr",{}),s[6]=u):u=s[6];const p=i.id+n;let h;s[7]!==i||s[8]!==l||s[9]!==p?(h=r.jsx(sd,{flow:i,message:l},p),s[7]=i,s[8]=l,s[9]=p,s[10]=h):h=s[10];let g;s[11]!==i||s[12]!==l?(g=r.jsx(hd,{flow:i,message:l}),s[11]=i,s[12]=l,s[13]=g):g=s[13];let x;return s[14]!==n||s[15]!==a||s[16]!==d||s[17]!==h||s[18]!==g?(x=r.jsxs("section",{className:n,children:[a,d,u,h,g]}),s[14]=n,s[15]=a,s[16]=d,s[17]=h,s[18]=g,s[19]=x):x=s[19],x});function el(){const t=E.c(2),e=F(md);let s;return t[0]!==e?(s=r.jsx(Zr,{flow:e,message:e.request}),t[0]=e,t[1]=s):s=t[1],s}function md(t){return t.flows.selected[0]}el.displayName="Request";function tl(){const t=E.c(2),e=F(gd);let s;return t[0]!==e?(s=r.jsx(Zr,{flow:e,message:e.response}),t[0]=e,t[1]=s):s=t[1],s}function gd(t){return t.flows.selected[0]}tl.displayName="Response";const xd=t=>{const e=E.c(3),{message:s}=t,i=s.query?s.op_code:s.response_code,l=s.truncation?"(Truncated)":"";let n;return e[0]!==i||e[1]!==l?(n=r.jsxs("div",{children:[i," ",l]}),e[0]=i,e[1]=l,e[2]=n):n=e[2],n},vd=t=>{const e=E.c(10),{message:s}=t,i=s.recursion_desired?"Recursive ":"";let l;e[0]!==i?(l=r.jsxs("h5",{children:[i,"Question"]}),e[0]=i,e[1]=l):l=e[1];let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{children:"Type"}),r.jsx("th",{children:"Class"})]})}),e[2]=n):n=e[2];let o;e[3]!==s.questions?(o=s.questions.map(yd),e[3]=s.questions,e[4]=o):o=e[4];let a;e[5]!==o?(a=r.jsxs("table",{children:[n,r.jsx("tbody",{children:o})]}),e[5]=o,e[6]=a):a=e[6];let d;return e[7]!==l||e[8]!==a?(d=r.jsxs(r.Fragment,{children:[l,a]}),e[7]=l,e[8]=a,e[9]=d):d=e[9],d},as=t=>{const e=E.c(7),{name:s,values:i}=t;let l;e[0]!==s?(l=r.jsx("h5",{children:s}),e[0]=s,e[1]=l):l=e[1];let n;e[2]!==i?(n=i.length>0?r.jsxs("table",{children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{children:"Type"}),r.jsx("th",{children:"Class"}),r.jsx("th",{children:"TTL"}),r.jsx("th",{children:"Data"})]})}),r.jsx("tbody",{children:i.map(bd)})]}):"—",e[2]=i,e[3]=n):n=e[3];let o;return e[4]!==l||e[5]!==n?(o=r.jsxs(r.Fragment,{children:[l,n]}),e[4]=l,e[5]=n,e[6]=o):o=e[6],o},sl=t=>{const e=E.c(24),{type:s,message:i}=t,l="dns-"+s,n=`first-line ${s}-line`;let o;e[0]!==i?(o=r.jsx(xd,{message:i}),e[0]=i,e[1]=o):o=e[1];let a;e[2]!==n||e[3]!==o?(a=r.jsx("div",{className:n,children:o}),e[2]=n,e[3]=o,e[4]=a):a=e[4];let d;e[5]!==i?(d=r.jsx(vd,{message:i}),e[5]=i,e[6]=d):d=e[6];let u;e[7]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("hr",{}),e[7]=u):u=e[7];const p=`${i.authoritative_answer?"Authoritative ":""}${i.recursion_available?"Recursive ":""}Answer`;let h;e[8]!==i.answers||e[9]!==p?(h=r.jsx(as,{name:p,values:i.answers}),e[8]=i.answers,e[9]=p,e[10]=h):h=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("hr",{}),e[11]=g):g=e[11];let x;e[12]!==i.authorities?(x=r.jsx(as,{name:"Authority",values:i.authorities}),e[12]=i.authorities,e[13]=x):x=e[13];let j;e[14]===Symbol.for("react.memo_cache_sentinel")?(j=r.jsx("hr",{}),e[14]=j):j=e[14];let y;e[15]!==i.additionals?(y=r.jsx(as,{name:"Additional",values:i.additionals}),e[15]=i.additionals,e[16]=y):y=e[16];let b;return e[17]!==l||e[18]!==x||e[19]!==y||e[20]!==a||e[21]!==d||e[22]!==h?(b=r.jsxs("section",{className:l,children:[a,d,u,h,g,x,j,y]}),e[17]=l,e[18]=x,e[19]=y,e[20]=a,e[21]=d,e[22]=h,e[23]=b):b=e[23],b};function nl(){const t=E.c(2),e=F(_d);let s;return t[0]!==e.request?(s=r.jsx(sl,{type:"request",message:e.request}),t[0]=e.request,t[1]=s):s=t[1],s}function _d(t){return t.flows.selected[0]}nl.displayName="Request";function il(){const t=E.c(2),e=F(jd);let s;return t[0]!==e.response?(s=r.jsx(sl,{type:"response",message:e.response}),t[0]=e.response,t[1]=s):s=t[1],s}function jd(t){return t.flows.selected[0]}il.displayName="Response";function yd(t,e){return r.jsxs("tr",{children:[r.jsx("td",{children:t.name}),r.jsx("td",{children:t.type}),r.jsx("td",{children:t.class})]},e)}function bd(t,e){return r.jsxs("tr",{children:[r.jsx("td",{children:t.name}),r.jsx("td",{children:t.type}),r.jsx("td",{children:t.class}),r.jsx("td",{children:t.ttl}),r.jsx("td",{children:JSON.stringify(t.data).replace(/^"|"$/g,"")})]},e)}function Vt(t,e){return e?(e=[e[0],e[1]],e[0].includes(":")&&(e[0]=`[${e[0]}]`),r.jsxs("tr",{children:[r.jsxs("td",{children:[t,":"]}),r.jsx("td",{children:e.join(":")})]})):r.jsx(r.Fragment,{})}function pi(t){const e=E.c(26),{conn:s}=t;let i;if("address"in s){let u;e[0]!==s.address?(u=Vt("Address",s.address),e[0]=s.address,e[1]=u):u=e[1];let p;e[2]!==s.peername?(p=Vt("Resolved address",s.peername),e[2]=s.peername,e[3]=p):p=e[3];let h;e[4]!==s.sockname?(h=Vt("Source address",s.sockname),e[4]=s.sockname,e[5]=h):h=e[5];let g;e[6]!==u||e[7]!==p||e[8]!==h?(g=r.jsxs(r.Fragment,{children:[u,p,h]}),e[6]=u,e[7]=p,e[8]=h,e[9]=g):g=e[9],i=g}else{let u;e[10]!==s.peername?(u=Vt("Address",s.peername),e[10]=s.peername,e[11]=u):u=e[11],i=u}let l;e[12]!==s.sni?(l=s.sni?r.jsxs("tr",{children:[r.jsxs("td",{children:[r.jsx("abbr",{title:"TLS Server Name Indication",children:"SNI"}),":"]}),r.jsx("td",{children:s.sni})]}):null,e[12]=s.sni,e[13]=l):l=e[13];let n;e[14]!==s.alpn?(n=s.alpn?r.jsxs("tr",{children:[r.jsxs("td",{children:[r.jsx("abbr",{title:"ALPN protocol negotiated",children:"ALPN"}),":"]}),r.jsx("td",{children:s.alpn})]}):null,e[14]=s.alpn,e[15]=n):n=e[15];let o;e[16]!==s.tls_version?(o=s.tls_version?r.jsxs("tr",{children:[r.jsx("td",{children:"TLS Version:"}),r.jsx("td",{children:s.tls_version})]}):null,e[16]=s.tls_version,e[17]=o):o=e[17];let a;e[18]!==s.cipher?(a=s.cipher?r.jsxs("tr",{children:[r.jsx("td",{children:"TLS Cipher:"}),r.jsx("td",{children:s.cipher})]}):null,e[18]=s.cipher,e[19]=a):a=e[19];let d;return e[20]!==i||e[21]!==l||e[22]!==n||e[23]!==o||e[24]!==a?(d=r.jsx("table",{className:"connection-table",children:r.jsxs("tbody",{children:[i,l,n,o,a]})}),e[20]=i,e[21]=l,e[22]=n,e[23]=o,e[24]=a,e[25]=d):d=e[25],d}function hi(t){return r.jsx("dl",{className:"cert-attributes",children:t.map(([e,s])=>r.jsxs(M.Fragment,{children:[r.jsx("dt",{children:e}),r.jsx("dd",{children:s})]},e))})}function wd(t){const e=E.c(46),{flow:s}=t,i=s.server_conn?.cert;if(!i){let V;return e[0]===Symbol.for("react.memo_cache_sentinel")?(V=r.jsx(r.Fragment,{}),e[0]=V):V=e[0],V}let l;e[1]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("h4",{children:"Server Certificate"},"name"),e[1]=l):l=e[1];let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("td",{children:"Type"}),e[2]=n):n=e[2];let o;e[3]!==i.keyinfo[0]||e[4]!==i.keyinfo[1]?(o=r.jsxs("tr",{children:[n,r.jsxs("td",{children:[i.keyinfo[0],", ",i.keyinfo[1]," bits"]})]}),e[3]=i.keyinfo[0],e[4]=i.keyinfo[1],e[5]=o):o=e[5];let a;e[6]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("td",{children:"SHA256 digest"}),e[6]=a):a=e[6];let d;e[7]!==i.sha256?(d=r.jsxs("tr",{children:[a,r.jsx("td",{children:i.sha256})]}),e[7]=i.sha256,e[8]=d):d=e[8];let u;e[9]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("td",{children:"Valid from"}),e[9]=u):u=e[9];let p;e[10]!==i.notbefore?(p=dt(i.notbefore,{includeMilliseconds:!1}),e[10]=i.notbefore,e[11]=p):p=e[11];let h;e[12]!==p?(h=r.jsxs("tr",{children:[u,r.jsx("td",{children:p})]}),e[12]=p,e[13]=h):h=e[13];let g;e[14]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("td",{children:"Valid to"}),e[14]=g):g=e[14];let x;e[15]!==i.notafter?(x=dt(i.notafter,{includeMilliseconds:!1}),e[15]=i.notafter,e[16]=x):x=e[16];let j;e[17]!==x?(j=r.jsxs("tr",{children:[g,r.jsx("td",{children:x})]}),e[17]=x,e[18]=j):j=e[18];let y;e[19]===Symbol.for("react.memo_cache_sentinel")?(y=r.jsx("td",{children:"Subject Alternative Names"}),e[19]=y):y=e[19];let b;e[20]!==i.altnames?(b=i.altnames.join(", "),e[20]=i.altnames,e[21]=b):b=e[21];let S;e[22]!==b?(S=r.jsxs("tr",{children:[y,r.jsx("td",{children:b})]}),e[22]=b,e[23]=S):S=e[23];let C;e[24]===Symbol.for("react.memo_cache_sentinel")?(C=r.jsx("td",{children:"Subject"}),e[24]=C):C=e[24];let N;e[25]!==i.subject?(N=hi(i.subject),e[25]=i.subject,e[26]=N):N=e[26];let T;e[27]!==N?(T=r.jsxs("tr",{children:[C,r.jsx("td",{children:N})]}),e[27]=N,e[28]=T):T=e[28];let I;e[29]===Symbol.for("react.memo_cache_sentinel")?(I=r.jsx("td",{children:"Issuer"}),e[29]=I):I=e[29];let D;e[30]!==i.issuer?(D=hi(i.issuer),e[30]=i.issuer,e[31]=D):D=e[31];let O;e[32]!==D?(O=r.jsxs("tr",{children:[I,r.jsx("td",{children:D})]}),e[32]=D,e[33]=O):O=e[33];let L;e[34]===Symbol.for("react.memo_cache_sentinel")?(L=r.jsx("td",{children:"Serial"}),e[34]=L):L=e[34];let H;e[35]!==i.serial?(H=r.jsxs("tr",{children:[L,r.jsx("td",{children:i.serial})]}),e[35]=i.serial,e[36]=H):H=e[36];let q;return e[37]!==j||e[38]!==S||e[39]!==T||e[40]!==O||e[41]!==H||e[42]!==o||e[43]!==d||e[44]!==h?(q=r.jsxs(r.Fragment,{children:[l,r.jsx("table",{className:"certificate-table",children:r.jsxs("tbody",{children:[o,d,h,j,S,T,O,H]})})]}),e[37]=j,e[38]=S,e[39]=T,e[40]=O,e[41]=H,e[42]=o,e[43]=d,e[44]=h,e[45]=q):q=e[45],q}function rl(t){const e=E.c(11),{flow:s}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=r.jsx("h4",{children:"Client Connection"}),e[0]=i):i=e[0];let l;e[1]!==s.client_conn?(l=r.jsx(pi,{conn:s.client_conn}),e[1]=s.client_conn,e[2]=l):l=e[2];let n;e[3]!==s.server_conn?(n=s.server_conn?.address&&r.jsxs(r.Fragment,{children:[r.jsx("h4",{children:"Server Connection"}),r.jsx(pi,{conn:s.server_conn})]}),e[3]=s.server_conn,e[4]=n):n=e[4];let o;e[5]!==s?(o=r.jsx(wd,{flow:s}),e[5]=s,e[6]=o):o=e[6];let a;return e[7]!==l||e[8]!==n||e[9]!==o?(a=r.jsxs("section",{className:"detail",children:[i,l,n,o]}),e[7]=l,e[8]=n,e[9]=o,e[10]=a):a=e[10],a}rl.displayName="Connection";function ll(t){const e=E.c(7),{flow:s}=t,i=s.error.msg;let l;e[0]!==s.error.timestamp?(l=dt(s.error.timestamp),e[0]=s.error.timestamp,e[1]=l):l=e[1];let n;e[2]!==l?(n=r.jsx("div",{children:r.jsx("small",{children:l})}),e[2]=l,e[3]=n):n=e[3];let o;return e[4]!==s.error.msg||e[5]!==n?(o=r.jsx("section",{className:"error",children:r.jsxs("div",{className:"alert alert-warning",children:[i,n]})}),e[4]=s.error.msg,e[5]=n,e[6]=o):o=e[6],o}ll.displayName="Error";function Sd(t){const e=E.c(4),{t:s,deltaTo:i,title:l}=t;let n;return e[0]!==i||e[1]!==s||e[2]!==l?(n=s?r.jsxs("tr",{children:[r.jsxs("td",{children:[l,":"]}),r.jsxs("td",{children:[dt(s),i&&r.jsxs("span",{className:"text-muted",children:["(",Ri(1e3*(s-i)),")"]})]})]}):r.jsx("tr",{}),e[0]=i,e[1]=s,e[2]=l,e[3]=n):n=e[3],n}function ol(t){const e=E.c(26),{flow:s}=t;let i;s.type==="http"?i=s.request.timestamp_start:i=s.client_conn.timestamp_start;const l=s.server_conn?.timestamp_start;let n,o,a,d;if(e[0]!==s.client_conn.timestamp_end||e[1]!==s.client_conn.timestamp_start||e[2]!==s.client_conn.timestamp_tls_setup||e[3]!==s.request||e[4]!==s.response?.timestamp_end||e[5]!==s.response?.timestamp_start||e[6]!==s.server_conn?.timestamp_end||e[7]!==s.server_conn?.timestamp_tcp_setup||e[8]!==s.server_conn?.timestamp_tls_setup||e[9]!==s.type||e[10]!==i||e[11]!==l){const g=[{title:"Server conn. initiated",t:l,deltaTo:i},{title:"Server conn. TCP handshake",t:s.server_conn?.timestamp_tcp_setup,deltaTo:i},{title:"Server conn. TLS handshake",t:s.server_conn?.timestamp_tls_setup,deltaTo:i},{title:"Server conn. closed",t:s.server_conn?.timestamp_end,deltaTo:i},{title:"Client conn. established",t:s.client_conn.timestamp_start,deltaTo:s.type==="http"?i:void 0},{title:"Client conn. TLS handshake",t:s.client_conn.timestamp_tls_setup,deltaTo:i},{title:"Client conn. closed",t:s.client_conn.timestamp_end,deltaTo:i}];s.type==="http"&&g.push({title:"First request byte",t:s.request.timestamp_start},{title:"Request complete",t:s.request.timestamp_end,deltaTo:i},{title:"First response byte",t:s.response?.timestamp_start,deltaTo:i},{title:"Response complete",t:s.response?.timestamp_end,deltaTo:i}),a="timing",e[16]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx("h4",{children:"Timing"}),e[16]=d):d=e[16],o="timing-table",n=g.filter(Nd).sort(Cd).map($d),e[0]=s.client_conn.timestamp_end,e[1]=s.client_conn.timestamp_start,e[2]=s.client_conn.timestamp_tls_setup,e[3]=s.request,e[4]=s.response?.timestamp_end,e[5]=s.response?.timestamp_start,e[6]=s.server_conn?.timestamp_end,e[7]=s.server_conn?.timestamp_tcp_setup,e[8]=s.server_conn?.timestamp_tls_setup,e[9]=s.type,e[10]=i,e[11]=l,e[12]=n,e[13]=o,e[14]=a,e[15]=d}else n=e[12],o=e[13],a=e[14],d=e[15];let u;e[17]!==n?(u=r.jsx("tbody",{children:n}),e[17]=n,e[18]=u):u=e[18];let p;e[19]!==o||e[20]!==u?(p=r.jsx("table",{className:o,children:u}),e[19]=o,e[20]=u,e[21]=p):p=e[21];let h;return e[22]!==a||e[23]!==d||e[24]!==p?(h=r.jsxs("section",{className:a,children:[d,p]}),e[22]=a,e[23]=d,e[24]=p,e[25]=h):h=e[25],h}function $d(t){const{title:e,t:s,deltaTo:i}=t;return r.jsx(Sd,{title:e,t:s,deltaTo:i},e)}function Cd(t,e){return t.t-e.t}function Nd(t){return!!t.t}ol.displayName="Timing";function Ls({flow:t,messages_meta:e}){const s=ee(),i=F(u=>u.ui.flow.contentViewFor[t.id+"messages"]||"Auto"),[l,n]=M.useState(F(u=>u.options.content_view_lines_cutoff)),o=M.useCallback(()=>n(Math.max(1024,l*2)),[l]),a=Gr(t,"messages",i,l+1,t.id+e.count)??[];let d=l;return r.jsxs("div",{className:"contentview",children:[r.jsxs("div",{className:"controls",children:[r.jsxs("h5",{children:[e.count," Messages"]}),r.jsx(Xr,{value:i,onChange:u=>s(Ei({messageId:t.id+"messages",contentView:u}))})]}),a.map((u,p)=>{const h=`fa fa-fw fa-arrow-${u.from_client?"right text-primary":"left text-danger"}`,g=r.jsxs("div",{children:[r.jsxs("small",{children:[r.jsx("i",{className:h}),r.jsx("span",{className:"pull-right",children:u.timestamp&&dt(u.timestamp)})]}),r.jsx(Jr,{content:u.text,maxLines:d,showMore:o})]},p);return d-=u.text.split(`
`).length,g})]})}function cl(t){const e=E.c(8),{flow:s}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=r.jsx("h4",{children:"WebSocket"}),e[0]=i):i=e[0];let l;e[1]!==s?(l=r.jsx(Ls,{flow:s,messages_meta:s.websocket.messages_meta}),e[1]=s,e[2]=l):l=e[2];let n;e[3]!==s.websocket?(n=r.jsx(kd,{websocket:s.websocket}),e[3]=s.websocket,e[4]=n):n=e[4];let o;return e[5]!==l||e[6]!==n?(o=r.jsxs("section",{className:"websocket",children:[i,l,n]}),e[5]=l,e[6]=n,e[7]=o):o=e[7],o}cl.displayName="WebSocket";function kd(t){const e=E.c(10),{websocket:s}=t;if(!s.timestamp_end)return null;const i=s.close_reason?`(${s.close_reason})`:"";let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("i",{className:"fa fa-fw fa-window-close text-muted"}),e[0]=l):l=e[0];const n=s.closed_by_client?"client":"server",o=s.close_code;let a;e[1]!==s.timestamp_end?(a=dt(s.timestamp_end),e[1]=s.timestamp_end,e[2]=a):a=e[2];let d;e[3]!==a?(d=r.jsx("small",{className:"pull-right",children:a}),e[3]=a,e[4]=d):d=e[4];let u;return e[5]!==i||e[6]!==n||e[7]!==d||e[8]!==s.close_code?(u=r.jsxs("div",{children:[l,"  Closed by ",n," ","with code ",o," ",i,".",d]}),e[5]=i,e[6]=n,e[7]=d,e[8]=s.close_code,e[9]=u):u=e[9],u}function al(t){const e=E.c(7),{flow:s}=t,i=ee();let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("h4",{children:"Comment"}),e[0]=l):l=e[0];let n;e[1]!==i||e[2]!==s?(n=a=>{i(Me(s,{comment:a}))},e[1]=i,e[2]=s,e[3]=n):n=e[3];let o;return e[4]!==s.comment||e[5]!==n?(o=r.jsxs("section",{className:"timing",children:[l,r.jsx(ae,{className:"kv-value",content:s.comment,onEditDone:n,placeholder:"empty",selectAllOnClick:!0})]}),e[4]=s.comment,e[5]=n,e[6]=o):o=e[6],o}al.displayName="Comment";function dl(t){const e=E.c(2),{flow:s}=t;let i;return e[0]!==s?(i=r.jsx("section",{className:"tcp",children:r.jsx(Ls,{flow:s,messages_meta:s.messages_meta})}),e[0]=s,e[1]=i):i=e[1],i}dl.displayName="Stream Data";function ul(t){const e=E.c(2),{flow:s}=t;let i;return e[0]!==s?(i=r.jsx("section",{className:"udp",children:r.jsx(Ls,{flow:s,messages_meta:s.messages_meta})}),e[0]=s,e[1]=i):i=e[1],i}ul.displayName="Datagrams";const mi={request:el,response:tl,error:ll,connection:rl,timing:ol,websocket:cl,tcpmessages:dl,udpmessages:ul,dnsrequest:nl,dnsresponse:il,comment:al};function ys(t){let e;switch(t.type){case"http":e=["request","response","websocket"].filter(s=>t[s]);break;case"tcp":e=["tcpmessages"];break;case"udp":e=["udpmessages"];break;case"dns":e=["request","response"].filter(s=>t[s]).map(s=>"dns"+s);break}return t.error&&e.push("error"),e.push("connection"),e.push("timing"),e.push("comment"),e}function Ed(){const t=E.c(15),e=ee(),s=F(Rd);let i=F(Td);if(s==null){let y;return t[0]===Symbol.for("react.memo_cache_sentinel")?(y=r.jsx(r.Fragment,{}),t[0]=y):y=t[0],y}const l=ys(s);l.indexOf(i)<0&&(i==="response"&&s.error?i="error":i==="error"&&"response"in s?i="response":i=l[0]);const n=mi[i],o="flow-detail",a="nav-tabs nav-tabs-sm";let d;t[1]!==e?(d=()=>e(Ue([])),t[1]=e,t[2]=d):d=t[2];let u;t[3]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("i",{className:"fa fa-times-circle"}),t[3]=u):u=t[3];let p;t[4]!==d?(p=r.jsx("button",{"data-testid":"close-button-id",className:"close-button",onClick:d,children:u}),t[4]=d,t[5]=p):p=t[5];const h=l.map(y=>r.jsx("a",{href:"#",className:ye({active:i===y}),onClick:b=>{b.preventDefault(),e(Wt(y))},children:mi[y].displayName},y));let g;t[6]!==p||t[7]!==h?(g=r.jsxs("nav",{className:a,children:[p,h]}),t[6]=p,t[7]=h,t[8]=g):g=t[8];let x;t[9]!==n||t[10]!==s?(x=r.jsx(n,{flow:s}),t[9]=n,t[10]=s,t[11]=x):x=t[11];let j;return t[12]!==g||t[13]!==x?(j=r.jsxs("div",{className:o,children:[g,x]}),t[12]=g,t[13]=x,t[14]=j):j=t[14],j}function Td(t){return t.ui.flow.tab}function Rd(t){return t.flows.selected[0]}function Ad(t){if(t.ctrlKey||t.metaKey)return()=>{};const e=t.key;return t.preventDefault(),(s,i)=>{const{flows:l}=i(),n=l.selected,o=n[0];switch(e){case"k":case"ArrowUp":s(mt(l,-1));break;case"j":case"ArrowDown":s(mt(l,1));break;case" ":case"PageDown":s(mt(l,10));break;case"PageUp":s(mt(l,-10));break;case"End":s(mt(l,1e10));break;case"Home":s(mt(l,-1e10));break;case"Escape":i().ui.modal.activeModal?s(or()):s(Ue([]));break;case"ArrowLeft":{if(!o)break;const a=ys(o),d=i().ui.flow.tab,u=a[(Math.max(0,a.indexOf(d))-1+a.length)%a.length];s(Wt(u));break}case"Tab":case"ArrowRight":{if(!o)break;const a=ys(o),d=i().ui.flow.tab,u=a[(Math.max(0,a.indexOf(d))+1)%a.length];s(Wt(u));break}case"Delete":case"d":{s(Ji(n));break}case"n":{zt("view.flows.create","get","https://example.com/");break}case"D":{s(Xi(n));break}case"a":{s(Es(n));break}case"A":{s(Gi());break}case"r":{s(Ts(n));break}case"v":{s(Zi(n));break}case"x":{s(Yi(n));break}case"X":{s($c());break}case"z":{s(er());break}default:return}}}class Dd extends M.Component{static defaultProps={axis:"x"};node=Se.createRef();constructor(e,s){super(e,s),this.state={applied:!1,startPos:0,dragPointer:.1},this.onLostPointerCapture=this.onLostPointerCapture.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this)}onPointerDown(e){this.state.dragPointer===.1&&(e.target.setPointerCapture(e.pointerId),this.setState({startPos:this.props.axis==="x"?e.pageX:e.pageY,dragPointer:e.pointerId}))}onLostPointerCapture(e){if(this.state.dragPointer!==e.pointerId)return;const s=this.node.current,i=s.previousElementSibling,l=s.nextElementSibling;s.style.transform="",i.style.flex=`0 0 ${Math.max(0,(this.props.axis==="x"?i.offsetWidth+e.pageX:i.offsetHeight+e.pageY)-this.state.startPos)}px`,l.style.flex="1 1 auto",this.setState({applied:!0,dragPointer:.1}),this.onResize()}onPointerMove(e){this.state.dragPointer===e.pointerId&&(this.node.current.style.transform=this.props.axis==="x"?`translateX(${e.pageX-this.state.startPos}px)`:`translateY(${e.pageY-this.state.startPos}px)`)}onResize(){window.setTimeout(()=>window.dispatchEvent(new CustomEvent("resize")),1)}reset(e){this.state.applied&&(this.node.current?.previousElementSibling instanceof HTMLElement&&(this.node.current.previousElementSibling.style.flex=""),this.node.current?.nextElementSibling instanceof HTMLElement&&(this.node.current.nextElementSibling.style.flex=""),e||this.setState({applied:!1}),this.onResize())}componentWillUnmount(){this.reset(!0)}render(){return r.jsx("div",{ref:this.node,className:ye("splitter",this.props.axis==="x"?"splitter-x":"splitter-y"),children:r.jsx("div",{onLostPointerCapture:this.onLostPointerCapture,onPointerDown:this.onPointerDown,onPointerMove:this.onPointerMove})})}}const Ps=t=>{const e=t.current;return e===null||e.scrollTop===0?!1:Math.ceil(e.scrollTop)+e.clientHeight>=e.scrollHeight},fl=t=>{t.current&&!Ps(t)&&(t.current.scrollTop=t.current.scrollHeight)};function Rt(t=void 0){if(!t)return{start:0,end:0,paddingTop:0,paddingBottom:0};const{itemCount:e,rowHeight:s,viewportTop:i,viewportHeight:l,itemHeights:n}=t,o=i+l;let a=0,d=0,u=0,p=0;if(n){let h=0;for(let g=0;g<e;g++){const x=n[g]||s;h<=i&&g%2===0&&(u=h,a=g),h<=o?d=g+1:p+=x,h+=x}if(i>0&&h<i+l)return Rt({itemCount:e,rowHeight:s,viewportTop:h-l,viewportHeight:l,itemHeights:n})}else{const h=Math.min(i,Math.max(0,e*s-l));a=Math.max(0,Math.floor(h/s)-1)&-2,d=Math.min(e,a+Math.ceil(l/s)+2),u=a*s,p=(e-d)*s}return{start:a,end:d,paddingTop:u,paddingBottom:p}}const Ms=({flow:t})=>r.jsx("td",{className:ye("col-tls",t.client_conn.tls_established?"col-tls-https":"col-tls-http")});Ms.headerName="";const Os=({flow:t})=>{const e=F(s=>s.flows._listIndex.get(t.id));return r.jsx("td",{className:"col-index",children:e+1})};Os.headerName="#";const qs=({flow:t})=>r.jsx("td",{className:"col-icon",children:r.jsx("div",{className:ye("resource-icon",qi(t))})});qs.headerName="";const Hs=({flow:t})=>{let e;return t.error&&(t.error.msg==="Connection killed."?e=r.jsx("i",{className:"fa fa-fw fa-times pull-right"}):e=r.jsx("i",{className:"fa fa-fw fa-exclamation pull-right"})),r.jsxs("td",{className:"col-path",children:[t.is_replay==="request"&&r.jsx("i",{className:"fa fa-fw fa-repeat pull-right"}),t.intercepted&&r.jsx("i",{className:"fa fa-fw fa-pause pull-right"}),e,r.jsx("span",{className:"marker pull-right",children:t.marked}),Hi(t)]})};Hs.headerName="Path";const Vs=({flow:t})=>r.jsx("td",{className:"col-method",children:Ui(t)});Vs.headerName="Method";const Us=({flow:t})=>r.jsx("td",{className:"col-http-version",children:Bi(t)});Us.headerName="Version";const Bs=({flow:t})=>{let e="darkred";return t.type!=="http"&&t.type!="dns"||!t.response?r.jsx("td",{className:"col-status"}):(100<=t.response.status_code&&t.response.status_code<200?e="green":200<=t.response.status_code&&t.response.status_code<300?e="darkgreen":300<=t.response.status_code&&t.response.status_code<400?e="lightblue":(400<=t.response.status_code&&t.response.status_code<500||500<=t.response.status_code&&t.response.status_code<600)&&(e="red"),r.jsx("td",{className:"col-status",style:{color:e},children:Vi(t)}))};Bs.headerName="Status";const Ks=({flow:t})=>r.jsx("td",{className:"col-size",children:Ti(Mi(t))});Ks.headerName="Size";const Ws=({flow:t})=>{const e=Qt(t),s=Pi(t);return r.jsx("td",{className:"col-time",children:e&&s?Ri(1e3*(s-e)):"..."})};Ws.headerName="Time";const zs=({flow:t})=>{const e=Qt(t);return r.jsx("td",{className:"col-timestamp",children:e?dt(e):"..."})};zs.headerName="Start time";const Zt=({flow:t})=>{const e=ee();let s=null;return t.intercepted?s=r.jsx("a",{href:"#",className:"quickaction",onClick:()=>e(Es([t])),children:r.jsx("i",{className:"fa fa-fw fa-play text-success"})}):Cs(t)&&(s=r.jsx("a",{href:"#",className:"quickaction",onClick:()=>e(Ts([t])),children:r.jsx("i",{className:"fa fa-fw fa-repeat text-primary"})})),r.jsx("td",{className:"col-quickactions",children:s?r.jsx("div",{children:s}):r.jsx(r.Fragment,{})})};Zt.headerName="";const Qs=({flow:t})=>{const e=t.comment;return r.jsx("td",{className:"col-comment",children:e})};Qs.headerName="Comment";const pl={icon:qs,index:Os,method:Vs,version:Us,path:Hs,quickactions:Zt,size:Ks,status:Bs,time:Ws,timestamp:zs,tls:Ms,comment:Qs},Id=Object.freeze(Object.defineProperty({__proto__:null,comment:Qs,default:pl,icon:qs,index:Os,method:Vs,path:Hs,quickactions:Zt,size:Ks,status:Bs,time:Ws,timestamp:zs,tls:Ms,version:Us},Symbol.toStringTag,{value:"Module"})),Fd=M.memo(function(){const e=E.c(13),s=ee(),i=F(Ld),l=F(Pd),n=F(Md),o=i?"sort-desc":"sort-asc";let a;if(e[0]!==s||e[1]!==n||e[2]!==l||e[3]!==i||e[4]!==o){const u=n.filter(_c).concat("quickactions");let p;e[6]!==s||e[7]!==l||e[8]!==i||e[9]!==o?(p=h=>r.jsx("th",{className:ye(`col-${h}`,l===h&&o),onClick:()=>s(rr({column:h===l&&i?void 0:h,desc:h!==l?!1:!i})),children:pl[h].headerName},h),e[6]=s,e[7]=l,e[8]=i,e[9]=o,e[10]=p):p=e[10],a=u.map(p),e[0]=s,e[1]=n,e[2]=l,e[3]=i,e[4]=o,e[5]=a}else a=e[5];let d;return e[11]!==a?(d=r.jsx("tr",{children:a}),e[11]=a,e[12]=d):d=e[12],d});function Ld(t){return t.flows.sort.desc}function Pd(t){return t.flows.sort.column}function Md(t){return t.options.web_columns}const Od=Se.memo(function({flow:e,selected:s,highlighted:i}){const l=ee(),n=F(u=>u.options.web_columns),o=ye({selected:s,highlighted:i,intercepted:e.intercepted,"has-request":e.type==="http"&&e.request,"has-response":e.type==="http"&&e.response}),a=M.useCallback(u=>{let p=u.target;for(;p.parentNode;){if(p.classList.contains("col-quickactions"))return;p=p.parentNode}u.metaKey||u.ctrlKey?l(Tc(e)):u.shiftKey?(window.getSelection()?.empty(),l(Rc(e))):l(Ue([e]))},[e]),d=n.map(u=>Id[u]).filter(u=>u).concat(Zt);return r.jsx("tr",{className:o,onClick:a,children:d.map(u=>r.jsx(u,{flow:e},u.name))})});class qd extends M.Component{static defaultProps={rowHeight:32};viewport=M.createRef();head=M.createRef();constructor(e,s){super(e,s),this.state={vScroll:Rt(),viewportTop:0},this.onViewportUpdate=this.onViewportUpdate.bind(this)}componentDidMount(){window.addEventListener("resize",this.onViewportUpdate),this.onViewportUpdate()}componentWillUnmount(){window.removeEventListener("resize",this.onViewportUpdate)}getSnapshotBeforeUpdate(){return Ps(this.viewport)}componentDidUpdate(e,s,i){i&&fl(this.viewport),this.onViewportUpdate();const{onlySelectedId:l}=this.props;if(l&&l!==e.onlySelectedId){const{rowHeight:o,firstSelectedIndex:a}=this.props,d=this.viewport.current,u=this.head.current,p=u?u.offsetHeight:0,h=a*o+p,g=h+o,x=d.scrollTop,j=d.offsetHeight;h-p<x?d.scrollTop=h-p:g>x+j&&(d.scrollTop=g-j),this.onViewportUpdate()}}onViewportUpdate(){const e=this.viewport.current,s=e.scrollTop||0,i=Rt({viewportTop:s,viewportHeight:e.offsetHeight||0,itemCount:this.props.flowView.length,rowHeight:this.props.rowHeight});if(this.state.viewportTop!==s||!Gt(this.state.vScroll,i)){const l=Math.min(s,i.end*this.props.rowHeight);this.setState({vScroll:i,viewportTop:l})}}render(){const{vScroll:e,viewportTop:s}=this.state,{flowView:i,selectedIds:l,highlightedIds:n}=this.props;return r.jsx("div",{className:"flow-table",onScroll:this.onViewportUpdate,ref:this.viewport,children:r.jsxs("table",{children:[r.jsx("thead",{ref:this.head,style:{transform:`translateY(${s}px)`},children:r.jsx(Fd,{})}),r.jsxs("tbody",{children:[r.jsx("tr",{style:{height:e.paddingTop}}),i.slice(e.start,e.end).map(o=>r.jsx(Od,{flow:o,selected:l.has(o.id),highlighted:n.has(o.id)},o.id)),r.jsx("tr",{style:{height:e.paddingBottom}})]})]})})}}const Hd=vt(t=>({flowView:t.flows.view,highlightedIds:t.flows.highlightedIds,selectedIds:t.flows.selectedIds,onlySelectedId:t.flows.selected.length===1&&t.flows.selected[0].id,firstSelectedIndex:t.flows._viewIndex.get(t.flows.selected[0]?.id)}))(qd);function Vd(){const t=E.c(3);let e,s;t[0]===Symbol.for("react.memo_cache_sentinel")?(e={padding:"1em 2em"},s=r.jsx("h3",{children:"mitmproxy is running."}),t[0]=e,t[1]=s):(e=t[0],s=t[1]);let i;return t[2]===Symbol.for("react.memo_cache_sentinel")?(i=r.jsxs("div",{style:e,children:[s,r.jsxs("p",{children:["No flows have been recorded yet.",r.jsx("br",{}),"To start capturing traffic, please configure your settings in the Capture tab."]})]}),t[2]=i):i=t[2],i}function Ud(t){const e=E.c(20);let{description:s,listen_addrs:i,is_running:l,wireguard_conf:n,type:o}=t;const a=M.useRef(null);let d,u;e[0]!==n?(d=()=>{n&&a.current&&sc.toCanvas(a.current,n,{margin:0,scale:3})},u=[n],e[0]=n,e[1]=d,e[2]=u):(d=e[1],u=e[2]),M.useEffect(d,u);let p;const h=i.length===1||i.length===2&&i[0][1]===i[1][1],g=i.every(Bd);if(h&&g){let y;e[3]!==i[0][1]?(y=Xn(["*",i[0][1]]),e[3]=i[0][1],e[4]=y):y=e[4],p=y}else{let y;e[5]!==i?(y=i.map(Xn).join(" and "),e[5]=i,e[6]=y):y=e[6],p=y}s=s[0].toUpperCase()+s.substr(1);let x;if(l){let y;e[9]!==s||e[10]!==p||e[11]!==o?(y=o==="local"?r.jsxs("div",{className:"text-success",children:[s," is active."]}):r.jsxs("div",{className:"text-success",children:[s," listening at ",p,"."]}),e[9]=s,e[10]=p,e[11]=o,e[12]=y):y=e[12];let b;e[13]!==n?(b=n&&r.jsxs("div",{className:"wireguard-config",children:[r.jsx("pre",{children:n}),r.jsx("canvas",{ref:a})]}),e[13]=n,e[14]=b):b=e[14];let S;e[15]!==y||e[16]!==b?(S=r.jsxs(r.Fragment,{children:[y,b]}),e[15]=y,e[16]=b,e[17]=S):S=e[17],x=S}else{let y;e[7]!==s?(y=r.jsx(r.Fragment,{children:r.jsxs("div",{className:"text-warning",children:[s," starting..."]})}),e[7]=s,e[8]=y):y=e[8],x=y}let j;return e[18]!==x?(j=r.jsx("div",{children:x}),e[18]=x,e[19]=j):j=e[19],j}function Bd(t){return["::","0.0.0.0"].includes(t[0])}function tt(t){const e=E.c(5),{error:s,backendState:i}=t;let l;e[0]!==i||e[1]!==s?(l=s?r.jsx("div",{className:"text-danger",children:s}):i&&r.jsx(Ud,{...i}),e[0]=i,e[1]=s,e[2]=l):l=e[2];let n;return e[3]!==l?(n=r.jsx("div",{className:"mode-status",children:l}),e[3]=l,e[4]=n):n=e[4],n}function st(t){const e=E.c(13),{value:s,onChange:i,children:l,label:n}=t,o=M.useId(),a=`mode-checkbox-${o}`,d=`mode-checkbox-${o}`;let u;e[0]!==i||e[1]!==a||e[2]!==d||e[3]!==s?(u=r.jsx("input",{type:"checkbox",name:a,id:d,checked:s,onChange:i}),e[0]=i,e[1]=a,e[2]=d,e[3]=s,e[4]=u):u=e[4];const p=`mode-checkbox-${o}`;let h;e[5]===Symbol.for("react.memo_cache_sentinel")?(h={marginBottom:0,fontWeight:"normal"},e[5]=h):h=e[5];let g;e[6]!==n||e[7]!==p?(g=r.jsx("label",{htmlFor:p,style:h,children:n}),e[6]=n,e[7]=p,e[8]=g):g=e[8];let x;return e[9]!==l||e[10]!==u||e[11]!==g?(x=r.jsxs("div",{className:"mode-entry",children:[u,g,l]}),e[9]=l,e[10]=u,e[11]=g,e[12]=x):x=e[12],x}function nt(t){const e=E.c(22),{children:s,iconClass:i,classname:l,isVisible:n}=t,o=M.useId();let a;e[0]!==o?(a=[...o].map(Kd),e[0]=o,e[1]=a):a=e[1];const d="--"+a.join(""),u=M.useRef(null),p=M.useRef(null);let h;e[2]!==d?(h=()=>{u.current.style.anchorName=d,p.current.style.positionAnchor=d},e[2]=d,e[3]=h):h=e[3];let g;e[4]===Symbol.for("react.memo_cache_sentinel")?(g=[],e[4]=g):g=e[4],M.useEffect(h,g);let x;e[5]!==o||e[6]!==n?(x=()=>{n===!0&&document.getElementById(o)?.showPopover()},e[5]=o,e[6]=n,e[7]=x):x=e[7];let j;e[8]!==n?(j=[n],e[8]=n,e[9]=j):j=e[9],M.useEffect(x,j);const y=l?`mode-popover ${l}`:"mode-popover";let b;e[10]!==i?(b=r.jsx("i",{className:i,"aria-hidden":"true"}),e[10]=i,e[11]=b):b=e[11];let S;e[12]!==o||e[13]!==b?(S=r.jsx("button",{popoverTarget:o,ref:u,children:b}),e[12]=o,e[13]=b,e[14]=S):S=e[14];let C;e[15]!==s||e[16]!==o?(C=r.jsx("div",{id:o,popover:"auto",ref:p,children:s}),e[15]=s,e[16]=o,e[17]=C):C=e[17];let N;return e[18]!==y||e[19]!==S||e[20]!==C?(N=r.jsxs("div",{className:y,children:[S,C]}),e[18]=y,e[19]=S,e[20]=C,e[21]=N):N=e[21],N}function Kd(t){return t.charCodeAt(0).toString(16)}function Wd(t){const e=E.c(44),{server:s}=t,{currentProcesses:i,isLoading:l}=F(Gd),{selectedProcesses:n}=F(Qd);let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=[],e[0]=o):o=e[0];const[a,d]=M.useState(o),[u,p]=M.useState(""),h=ee(),{platform:g}=F(zd);let x;e[1]===Symbol.for("react.memo_cache_sentinel")?(x=z=>{p(z.target.value)},e[1]=x):x=e[1];const j=x;let y;e[2]!==g?(y=z=>{const ce=g.startsWith("win32")?"\\":"/";return xs(z.executable,ce)[1]},e[2]=g,e[3]=y):y=e[3];const b=y;let S;e[4]!==h||e[5]!==b||e[6]!==n||e[7]!==s?(S=z=>{const ce=typeof z=="string"?z:b(z),B=n?`${n}, ${ce}`:ce;h(Nt({server:s,value:B}))},e[4]=h,e[5]=b,e[6]=n,e[7]=s,e[8]=S):S=e[8];const C=S;let N;e[9]!==h||e[10]!==b||e[11]!==n||e[12]!==s?(N=z=>{const ce=n?.split(/,\s*/).filter(B=>B!==b(z)).join(", ");h(Nt({server:s,value:ce}))},e[9]=h,e[10]=b,e[11]=n,e[12]=s,e[13]=N):N=e[13];const T=N,I=z=>{D(z)&&n?T(z):C(z)},D=z=>{const ce=b(z);return n?.includes(ce)};let O;e[14]!==i||e[15]!==h?(O=()=>{i.length===0&&h(kt())},e[14]=i,e[15]=h,e[16]=O):O=e[16];let L;e[17]===Symbol.for("react.memo_cache_sentinel")?(L=[],e[17]=L):L=e[17],M.useEffect(O,L);let H;e[18]!==i||e[19]!==u||e[20]!==b||e[21]!==a?(H=()=>{if(u){const z=i.filter(ce=>b(ce).toLowerCase().includes(u.toLowerCase()));d(z)}else a!==i&&d(i)},e[18]=i,e[19]=u,e[20]=b,e[21]=a,e[22]=H):H=e[22];let q;e[23]!==i||e[24]!==u?(q=[u,i],e[23]=i,e[24]=u,e[25]=q):q=e[25],M.useEffect(H,q);let V;e[26]!==C||e[27]!==u?(V=z=>{z.stopPropagation(),z.key==="Enter"&&(C(u),p(""))},e[26]=C,e[27]=u,e[28]=V):V=e[28];const W=V,[U,Q]=M.useState(!1),G="local-dropdown",J="dropdown-header",X=n&&n?.length>0?"Add more":"all applications";let Z,re;e[29]===Symbol.for("react.memo_cache_sentinel")?(Z=()=>Q(!0),re=()=>Q(!1),e[29]=Z,e[30]=re):(Z=e[29],re=e[30]);let ue;e[31]!==u||e[32]!==W||e[33]!==X?(ue=r.jsx("input",{type:"text",className:"autocomplete-input",placeholder:X,value:u,onChange:j,onKeyDown:W,onClick:Z,onBlur:re}),e[31]=u,e[32]=W,e[33]=X,e[34]=ue):ue=e[34];const oe=nt,be="fa fa-chevron-down",Ce="local-popover";let Ne;e[35]===Symbol.for("react.memo_cache_sentinel")?(Ne=r.jsx("h4",{children:"Current Applications running on machine"}),e[35]=Ne):Ne=e[35];const Ae=l?r.jsx("i",{className:"fa fa-spinner","aria-hidden":"true"}):a.length>0?r.jsxs("ul",{className:"dropdown-list",children:[r.jsxs("li",{className:`dropdown-item ${n===""?"selected":""}`,onClick:()=>{h(Nt({server:s,value:""}))},role:"menuitem",children:[r.jsxs("div",{className:"process-details",children:[r.jsx("div",{className:"process-icon"}),r.jsx("span",{className:"process-name",children:"All applications"})]}),n===""&&r.jsx("i",{className:"fa fa-check","aria-hidden":"true"})]}),r.jsx("hr",{className:"process-separator"}),a.map((z,ce)=>r.jsxs("li",{className:`dropdown-item ${D(z)?"selected":""}`,onClick:()=>I(z),role:"menuitem",children:[r.jsxs("div",{className:"process-details",children:[r.jsx("img",{className:"process-icon",src:`./executable-icon?path=${z.executable}`,loading:"lazy"}),r.jsx("span",{className:"process-name",children:b(z)})]}),D(z)&&r.jsx("i",{className:"fa fa-check","aria-hidden":"true"})]},ce))]}):r.jsxs("span",{children:["Press ",r.jsx("strong",{children:"Enter"})," to capture traffic for programs matching: ",r.jsx("strong",{children:u})]});let k;e[36]!==oe||e[37]!==U||e[38]!==Ne||e[39]!==Ae?(k=r.jsxs(oe,{iconClass:be,classname:Ce,isVisible:U,children:[Ne,Ae]}),e[36]=oe,e[37]=U,e[38]=Ne,e[39]=Ae,e[40]=k):k=e[40];let ge;return e[41]!==ue||e[42]!==k?(ge=r.jsx("div",{className:G,children:r.jsxs("div",{className:J,children:[ue,k]})}),e[41]=ue,e[42]=k,e[43]=ge):ge=e[43],ge}function zd(t){return t.backendState}function Qd(t){return t.modes.local[0]}function Gd(t){return t.processes}function Yd(){const t=E.c(9),e=F(Xd),s=F(Jd);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(Zd,{server:u,backendState:s[mr(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n,o;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"Local Applications"}),o=r.jsx("p",{className:"mode-description",children:"Transparently Intercept local application(s)."}),t[5]=n,t[6]=o):(n=t[5],o=t[6]);let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function Jd(t){return t.backendState.servers}function Xd(t){return t.modes.local}function Zd(t){const e=E.c(31),{server:s,backendState:i}=t,l=ee(),n=F(tu),o=s.error||i?.last_exception||n||void 0;let a;e[0]!==l||e[1]!==s?(a=N=>{const T=s.selectedProcesses?.split(/,\s*/).filter(I=>I!==N).join(", ");l(Nt({server:s,value:T}))},e[0]=l,e[1]=s,e[2]=a):a=e[2];const d=a;let u;e[3]!==l||e[4]!==s?(u=()=>l(Sr({server:s,value:!s.active})),e[3]=l,e[4]=s,e[5]=u):u=e[5];let p;e[6]!==d||e[7]!==s.selectedProcesses?(p=s.selectedProcesses?.split(/,\s*/).filter(eu).map(N=>r.jsxs("div",{className:"selected-process",children:[N,r.jsx("i",{className:"fa fa-times","aria-hidden":"true",onClick:()=>d(N)})]},N)),e[6]=d,e[7]=s.selectedProcesses,e[8]=p):p=e[8];let h;e[9]!==p?(h=r.jsx("div",{className:"selected-processes",children:p}),e[9]=p,e[10]=h):h=e[10];let g;e[11]!==s?(g=r.jsx(Wd,{server:s}),e[11]=s,e[12]=g):g=e[12];let x;e[13]!==l?(x=r.jsx("i",{className:"fa fa-refresh","aria-hidden":"true",onClick:()=>l(kt())}),e[13]=l,e[14]=x):x=e[14];let j;e[15]!==g||e[16]!==x?(j=r.jsxs("div",{className:"dropdown-container",children:[g,x]}),e[15]=g,e[16]=x,e[17]=j):j=e[17];let y;e[18]!==h||e[19]!==j?(y=r.jsxs("div",{className:"processes-container",children:[h,j]}),e[18]=h,e[19]=j,e[20]=y):y=e[20];let b;e[21]!==s.active||e[22]!==u||e[23]!==y?(b=r.jsx(st,{value:s.active,label:"Intercept traffic for",onChange:u,children:y}),e[21]=s.active,e[22]=u,e[23]=y,e[24]=b):b=e[24];let S;e[25]!==i||e[26]!==o?(S=r.jsx(tt,{error:o,backendState:i}),e[25]=i,e[26]=o,e[27]=S):S=e[27];let C;return e[28]!==S||e[29]!==b?(C=r.jsxs("div",{className:"mode-local",children:[b,S]}),e[28]=S,e[29]=b,e[30]=C):C=e[30],C}function eu(t){return t.trim()!==""}function tu(t){return t.processes.error}function su(){const t=E.c(9),e=F(iu),s=F(nu);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(ru,{server:u,backendState:s[hr(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n,o;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"Explicit HTTP(S) Proxy"}),o=r.jsx("p",{className:"mode-description",children:"You manually configure your client application or device to use an HTTP(S) proxy."}),t[5]=n,t[6]=o):(n=t[5],o=t[6]);let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function nu(t){return t.backendState.servers}function iu(t){return t.modes.regular}function ru(t){const e=E.c(33),{server:s,backendState:i}=t,l=ee(),n=s.error||i?.last_exception||void 0;let o;e[0]!==l||e[1]!==s?(o=()=>l(yr({server:s,value:!s.active})),e[0]=l,e[1]=s,e[2]=o):o=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("h4",{children:"Advanced Configuration"}),d=r.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const u=s.listen_host||"";let p;e[5]!==l||e[6]!==s?(p=T=>l(br({server:s,value:T})),e[5]=l,e[6]=s,e[7]=p):p=e[7];let h;e[8]!==u||e[9]!==p?(h=r.jsx(ae,{className:"mode-input",content:u,onEditDone:p}),e[8]=u,e[9]=p,e[10]=h):h=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==l||e[15]!==s?(j=T=>l(wr({server:s,value:parseInt(T)})),e[14]=l,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=r.jsx(ae,{className:"mode-input",content:x,placeholder:"8080",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]!==y||e[21]!==h?(b=r.jsxs(nt,{iconClass:"fa fa-cog",children:[a,d,h,g,y]}),e[20]=y,e[21]=h,e[22]=b):b=e[22];let S;e[23]!==s.active||e[24]!==o||e[25]!==b?(S=r.jsx(st,{value:s.active,label:"Run HTTP/S Proxy",onChange:o,children:b}),e[23]=s.active,e[24]=o,e[25]=b,e[26]=S):S=e[26];let C;e[27]!==i||e[28]!==n?(C=r.jsx(tt,{error:n,backendState:i}),e[27]=i,e[28]=n,e[29]=C):C=e[29];let N;return e[30]!==S||e[31]!==C?(N=r.jsxs("div",{children:[S,C]}),e[30]=S,e[31]=C,e[32]=N):N=e[32],N}function lu(){const t=E.c(9),e=F(cu),s=F(ou);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(au,{server:u,backendState:s[gr(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n,o;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"WireGuard Server"}),o=r.jsx("p",{className:"mode-description",children:"Start a WireGuard™ server and connect an external device for transparent proxying."}),t[5]=n,t[6]=o):(n=t[5],o=t[6]);let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function ou(t){return t.backendState.servers}function cu(t){return t.modes.wireguard}function au(t){const e=E.c(41),{server:s,backendState:i}=t,l=ee(),n=s.error||i?.last_exception||void 0;let o;e[0]!==l||e[1]!==s?(o=()=>l($r({server:s,value:!s.active})),e[0]=l,e[1]=s,e[2]=o):o=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("h4",{children:"Advanced Configuration"}),d=r.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const u=s.listen_host||"";let p;e[5]!==l||e[6]!==s?(p=L=>l(Cr({server:s,value:L})),e[5]=l,e[6]=s,e[7]=p):p=e[7];let h;e[8]!==u||e[9]!==p?(h=r.jsx(ae,{className:"mode-input",content:u,placeholder:"(all interfaces)",onEditDone:p}),e[8]=u,e[9]=p,e[10]=h):h=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==l||e[15]!==s?(j=L=>l(Nr({server:s,value:parseInt(L)})),e[14]=l,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=r.jsx(ae,{className:"mode-input",content:x,placeholder:"51820",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]===Symbol.for("react.memo_cache_sentinel")?(b=r.jsx("p",{children:"Configuration File"}),e[20]=b):b=e[20];const S=s.file_path||"";let C;e[21]!==l||e[22]!==s?(C=L=>l(kr({server:s,value:L})),e[21]=l,e[22]=s,e[23]=C):C=e[23];let N;e[24]!==S||e[25]!==C?(N=r.jsx(ae,{className:"mode-input",content:S,placeholder:"~/.mitmproxy/wireguard.conf",onEditDone:C}),e[24]=S,e[25]=C,e[26]=N):N=e[26];let T;e[27]!==y||e[28]!==N||e[29]!==h?(T=r.jsxs(nt,{iconClass:"fa fa-cog",children:[a,d,h,g,y,b,N]}),e[27]=y,e[28]=N,e[29]=h,e[30]=T):T=e[30];let I;e[31]!==s.active||e[32]!==o||e[33]!==T?(I=r.jsx(st,{value:s.active,label:"Run WireGuard Server",onChange:o,children:T}),e[31]=s.active,e[32]=o,e[33]=T,e[34]=I):I=e[34];let D;e[35]!==i||e[36]!==n?(D=r.jsx(tt,{error:n,backendState:i}),e[35]=i,e[36]=n,e[37]=D):D=e[37];let O;return e[38]!==I||e[39]!==D?(O=r.jsxs("div",{children:[I,D]}),e[38]=I,e[39]=D,e[40]=O):O=e[40],O}function du(){const t=E.c(15),e=ee(),s=F(fu),i=F(uu);let l,n;t[0]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("h4",{className:"mode-title",children:"Reverse Proxy"}),n=r.jsx("p",{className:"mode-description",children:"Requests are forwarded to a preconfigured destination."}),t[0]=l,t[1]=n):(l=t[0],n=t[1]);let o;if(t[2]!==i||t[3]!==s){let h;t[5]!==i?(h=(g,x)=>r.jsx(pu,{removable:x>0,server:g,backendState:i[Fs(g)]},g.ui_id),t[5]=i,t[6]=h):h=t[6],o=s.map(h),t[2]=i,t[3]=s,t[4]=o}else o=t[4];let a;t[7]!==e?(a=()=>e(Ea()),t[7]=e,t[8]=a):a=t[8];let d;t[9]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx("i",{className:"fa fa-plus-square-o","aria-hidden":"true"}),t[9]=d):d=t[9];let u;t[10]!==a?(u=r.jsxs("div",{className:"mode-reverse-add-server",onClick:a,children:[d,"Add additional server"]}),t[10]=a,t[11]=u):u=t[11];let p;return t[12]!==o||t[13]!==u?(p=r.jsxs("div",{children:[l,n,r.jsxs("div",{className:"mode-reverse-servers",children:[o,u]})]}),t[12]=o,t[13]=u,t[14]=p):p=t[14],p}function uu(t){return t.backendState.servers}function fu(t){return t.modes.reverse}function pu(t){const e=E.c(56),{removable:s,server:i,backendState:l}=t,n=ee();let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=Object.values(Xt),e[0]=o):o=e[0];const a=o;let d;e[1]!==n||e[2]!==i?(d=async()=>{i.active&&await n(_s({server:i,value:!1})).unwrap(),await n(Ta(i))},e[1]=n,e[2]=i,e[3]=d):d=e[3];const u=d,p=i.error||l?.last_exception||void 0,h=i.active;let g;e[4]!==n||e[5]!==i?(g=()=>{n(_s({server:i,value:!i.active}))},e[4]=n,e[5]=i,e[6]=g):g=e[6];const x=i.protocol;let j;e[7]!==n||e[8]!==i?(j=Z=>{n(Rr({server:i,value:Z.target.value}))},e[7]=n,e[8]=i,e[9]=j):j=e[9];let y;e[10]===Symbol.for("react.memo_cache_sentinel")?(y=a.map(hu),e[10]=y):y=e[10];let b;e[11]!==i.protocol||e[12]!==j?(b=r.jsx("select",{name:"protocols",className:"mode-reverse-dropdown",value:x,onChange:j,children:y}),e[11]=i.protocol,e[12]=j,e[13]=b):b=e[13];let S;e[14]!==i.destination?(S=i.destination?.toString()||"",e[14]=i.destination,e[15]=S):S=e[15];let C;e[16]!==n||e[17]!==i?(C=Z=>n(Ar({server:i,value:Z})),e[16]=n,e[17]=i,e[18]=C):C=e[18];let N;e[19]!==C||e[20]!==S?(N=r.jsx(ae,{className:"mode-reverse-input",content:S,onEditDone:C,placeholder:"example.com"}),e[19]=C,e[20]=S,e[21]=N):N=e[21];let T,I;e[22]===Symbol.for("react.memo_cache_sentinel")?(T=r.jsx("h4",{children:"Advanced Configuration"}),I=r.jsx("p",{children:"Listen Host"}),e[22]=T,e[23]=I):(T=e[22],I=e[23]);const D=i.listen_host||"";let O;e[24]!==n||e[25]!==i?(O=Z=>n(Er({server:i,value:Z})),e[24]=n,e[25]=i,e[26]=O):O=e[26];let L;e[27]!==D||e[28]!==O?(L=r.jsx(ae,{className:"mode-input",content:D,onEditDone:O,placeholder:"*"}),e[27]=D,e[28]=O,e[29]=L):L=e[29];let H;e[30]===Symbol.for("react.memo_cache_sentinel")?(H=r.jsx("p",{children:"Listen Port"}),e[30]=H):H=e[30];const q=String(i.listen_port||"");let V;e[31]!==n||e[32]!==i?(V=Z=>n(Tr({server:i,value:Z})),e[31]=n,e[32]=i,e[33]=V):V=e[33];let W;e[34]!==q||e[35]!==V?(W=r.jsx(ae,{className:"mode-input",content:q,onEditDone:V,placeholder:"8080"}),e[34]=q,e[35]=V,e[36]=W):W=e[36];let U;e[37]!==L||e[38]!==W?(U=r.jsxs(nt,{iconClass:"fa fa-cog",children:[T,I,L,H,W]}),e[37]=L,e[38]=W,e[39]=U):U=e[39];let Q;e[40]!==u||e[41]!==s?(Q=s&&r.jsx("i",{className:"fa fa-fw fa-trash fa-lg","aria-hidden":"true",onClick:u}),e[40]=u,e[41]=s,e[42]=Q):Q=e[42];let G;e[43]!==i.active||e[44]!==N||e[45]!==U||e[46]!==Q||e[47]!==g||e[48]!==b?(G=r.jsxs(st,{value:h,label:"Forward",onChange:g,children:[b,"traffic to",N,U,Q]}),e[43]=i.active,e[44]=N,e[45]=U,e[46]=Q,e[47]=g,e[48]=b,e[49]=G):G=e[49];let J;e[50]!==l||e[51]!==p?(J=r.jsx(tt,{error:p,backendState:l}),e[50]=l,e[51]=p,e[52]=J):J=e[52];let X;return e[53]!==G||e[54]!==J?(X=r.jsxs("div",{children:[G,J]}),e[53]=G,e[54]=J,e[55]=X):X=e[55],X}function hu(t){return r.jsx("option",{value:t,children:t},t)}function mu(){const t=E.c(9),e=F(xu),s=F(gu);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(vu,{server:u,backendState:s[xr(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"Transparent Proxy"}),t[5]=n):n=t[5];let o;t[6]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsxs("p",{className:"mode-description",children:["You"," ",r.jsx("a",{href:"https://docs.mitmproxy.org/stable/howto-transparent/",style:{textDecoration:"underline",color:"inherit"},children:"configure your routing table"})," ","to send traffic through mitmproxy."]}),t[6]=o):o=t[6];let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function gu(t){return t.backendState.servers}function xu(t){return t.modes.transparent}function vu(t){const e=E.c(33),{server:s,backendState:i}=t,l=ee(),n=s.error||i?.last_exception||void 0;let o;e[0]!==l||e[1]!==s?(o=()=>l(Ir({server:s,value:!s.active})),e[0]=l,e[1]=s,e[2]=o):o=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("h4",{children:"Advanced Configuration"}),d=r.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const u=s.listen_host||"";let p;e[5]!==l||e[6]!==s?(p=T=>l(Fr({server:s,value:T})),e[5]=l,e[6]=s,e[7]=p):p=e[7];let h;e[8]!==u||e[9]!==p?(h=r.jsx(ae,{className:"mode-input",content:u,onEditDone:p}),e[8]=u,e[9]=p,e[10]=h):h=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==l||e[15]!==s?(j=T=>l(Lr({server:s,value:parseInt(T)})),e[14]=l,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=r.jsx(ae,{className:"mode-input",content:x,placeholder:"8080",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]!==y||e[21]!==h?(b=r.jsxs(nt,{iconClass:"fa fa-cog",children:[a,d,h,g,y]}),e[20]=y,e[21]=h,e[22]=b):b=e[22];let S;e[23]!==s.active||e[24]!==o||e[25]!==b?(S=r.jsx(st,{value:s.active,label:"Run Transparent Proxy",onChange:o,children:b}),e[23]=s.active,e[24]=o,e[25]=b,e[26]=S):S=e[26];let C;e[27]!==i||e[28]!==n?(C=r.jsx(tt,{error:n,backendState:i}),e[27]=i,e[28]=n,e[29]=C):C=e[29];let N;return e[30]!==S||e[31]!==C?(N=r.jsxs("div",{children:[S,C]}),e[30]=S,e[31]=C,e[32]=N):N=e[32],N}function _u(){const t=E.c(9),e=F(yu),s=F(ju);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(bu,{server:u,backendState:s[vr(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n,o;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"SOCKS Proxy"}),o=r.jsx("p",{className:"mode-description",children:"You manually configure your client application or device to use a SOCKS5 proxy."}),t[5]=n,t[6]=o):(n=t[5],o=t[6]);let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function ju(t){return t.backendState.servers}function yu(t){return t.modes.socks}function bu(t){const e=E.c(33),{server:s,backendState:i}=t,l=ee(),n=s.error||i?.last_exception||void 0;let o;e[0]!==l||e[1]!==s?(o=()=>l(Pr({server:s,value:!s.active})),e[0]=l,e[1]=s,e[2]=o):o=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("h4",{children:"Advanced Configuration"}),d=r.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const u=s.listen_host||"";let p;e[5]!==l||e[6]!==s?(p=T=>l(Mr({server:s,value:T})),e[5]=l,e[6]=s,e[7]=p):p=e[7];let h;e[8]!==u||e[9]!==p?(h=r.jsx(ae,{className:"mode-input",content:u,onEditDone:p}),e[8]=u,e[9]=p,e[10]=h):h=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==l||e[15]!==s?(j=T=>l(Or({server:s,value:parseInt(T)})),e[14]=l,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=r.jsx(ae,{className:"mode-input",content:x,placeholder:"8080",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]!==y||e[21]!==h?(b=r.jsxs(nt,{iconClass:"fa fa-cog",children:[a,d,h,g,y]}),e[20]=y,e[21]=h,e[22]=b):b=e[22];let S;e[23]!==s.active||e[24]!==o||e[25]!==b?(S=r.jsx(st,{value:s.active,label:"Run SOCKS Proxy",onChange:o,children:b}),e[23]=s.active,e[24]=o,e[25]=b,e[26]=S):S=e[26];let C;e[27]!==i||e[28]!==n?(C=r.jsx(tt,{error:n,backendState:i}),e[27]=i,e[28]=n,e[29]=C):C=e[29];let N;return e[30]!==S||e[31]!==C?(N=r.jsxs("div",{children:[S,C]}),e[30]=S,e[31]=C,e[32]=N):N=e[32],N}function wu(){const t=E.c(9),e=F($u),s=F(Su);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(Cu,{server:u,backendState:s[_r(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n,o;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"Explicit HTTP(S) Proxy (With Upstream Proxy)"}),o=r.jsx("p",{className:"mode-description",children:"All requests are forwarded to a second HTTP(S) proxy server."}),t[5]=n,t[6]=o):(n=t[5],o=t[6]);let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function Su(t){return t.backendState.servers}function $u(t){return t.modes.upstream}function Cu(t){const e=E.c(42),{server:s,backendState:i}=t,l=ee(),n=s.error||i?.last_exception||void 0;let o;e[0]!==l||e[1]!==s?(o=()=>{l(qr({server:s,value:!s.active}))},e[0]=l,e[1]=s,e[2]=o):o=e[2];let a;e[3]!==s.destination?(a=s.destination?.toString()||"",e[3]=s.destination,e[4]=a):a=e[4];let d;e[5]!==l||e[6]!==s?(d=O=>l(Ur({server:s,value:O})),e[5]=l,e[6]=s,e[7]=d):d=e[7];let u;e[8]!==a||e[9]!==d?(u=r.jsx(ae,{className:"mode-upstream-input",content:a,onEditDone:d,placeholder:"http://example.com:8080"}),e[8]=a,e[9]=d,e[10]=u):u=e[10];let p,h;e[11]===Symbol.for("react.memo_cache_sentinel")?(p=r.jsx("h4",{children:"Advanced Configuration"}),h=r.jsx("p",{children:"Listen Host"}),e[11]=p,e[12]=h):(p=e[11],h=e[12]);const g=s.listen_host||"";let x;e[13]!==l||e[14]!==s?(x=O=>l(Hr({server:s,value:O})),e[13]=l,e[14]=s,e[15]=x):x=e[15];let j;e[16]!==g||e[17]!==x?(j=r.jsx(ae,{className:"mode-input",content:g,onEditDone:x}),e[16]=g,e[17]=x,e[18]=j):j=e[18];let y;e[19]===Symbol.for("react.memo_cache_sentinel")?(y=r.jsx("p",{children:"Listen Port"}),e[19]=y):y=e[19];let b;e[20]!==s.listen_port?(b=s.listen_port?s.listen_port.toString():"",e[20]=s.listen_port,e[21]=b):b=e[21];let S;e[22]!==l||e[23]!==s?(S=O=>l(Vr({server:s,value:parseInt(O)})),e[22]=l,e[23]=s,e[24]=S):S=e[24];let C;e[25]!==b||e[26]!==S?(C=r.jsx(ae,{className:"mode-input",content:b,placeholder:"8080",onEditDone:S}),e[25]=b,e[26]=S,e[27]=C):C=e[27];let N;e[28]!==C||e[29]!==j?(N=r.jsxs(nt,{iconClass:"fa fa-cog",children:[p,h,j,y,C]}),e[28]=C,e[29]=j,e[30]=N):N=e[30];let T;e[31]!==s.active||e[32]!==o||e[33]!==N||e[34]!==u?(T=r.jsxs(st,{value:s.active,label:"Run HTTP/S Proxy and forward requests to",onChange:o,children:[u,N]}),e[31]=s.active,e[32]=o,e[33]=N,e[34]=u,e[35]=T):T=e[35];let I;e[36]!==i||e[37]!==n?(I=r.jsx(tt,{error:n,backendState:i}),e[36]=i,e[37]=n,e[38]=I):I=e[38];let D;return e[39]!==T||e[40]!==I?(D=r.jsxs("div",{children:[T,I]}),e[39]=T,e[40]=I,e[41]=D):D=e[41],D}function Nu(){const t=E.c(9),e=F(Eu),s=F(ku);let i;if(t[0]!==s||t[1]!==e){let d;t[3]!==s?(d=u=>r.jsx(Tu,{server:u,backendState:s[jr(u)]},u.ui_id),t[3]=s,t[4]=d):d=t[4],i=e.map(d),t[0]=s,t[1]=e,t[2]=i}else i=t[2];const l=i;let n,o;t[5]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h4",{className:"mode-title",children:"DNS Server"}),o=r.jsx("p",{className:"mode-description",children:"A recursive DNS resolver using the host's DNS configuration."}),t[5]=n,t[6]=o):(n=t[5],o=t[6]);let a;return t[7]!==l?(a=r.jsxs("div",{children:[n,o,l]}),t[7]=l,t[8]=a):a=t[8],a}function ku(t){return t.backendState.servers}function Eu(t){return t.modes.dns}function Tu(t){const e=E.c(33),{server:s,backendState:i}=t,l=ee(),n=s.error||i?.last_exception||void 0;let o;e[0]!==l||e[1]!==s?(o=()=>l(Br({server:s,value:!s.active})),e[0]=l,e[1]=s,e[2]=o):o=e[2];let a,d;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx("h4",{children:"Advanced Configuration"}),d=r.jsx("p",{children:"Listen Host"}),e[3]=a,e[4]=d):(a=e[3],d=e[4]);const u=s.listen_host||"";let p;e[5]!==l||e[6]!==s?(p=T=>l(Kr({server:s,value:T})),e[5]=l,e[6]=s,e[7]=p):p=e[7];let h;e[8]!==u||e[9]!==p?(h=r.jsx(ae,{className:"mode-input",content:u,onEditDone:p}),e[8]=u,e[9]=p,e[10]=h):h=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("p",{children:"Listen Port"}),e[11]=g):g=e[11];let x;e[12]!==s.listen_port?(x=s.listen_port?s.listen_port.toString():"",e[12]=s.listen_port,e[13]=x):x=e[13];let j;e[14]!==l||e[15]!==s?(j=T=>l(Wr({server:s,value:parseInt(T)})),e[14]=l,e[15]=s,e[16]=j):j=e[16];let y;e[17]!==x||e[18]!==j?(y=r.jsx(ae,{className:"mode-input",content:x,placeholder:"8080",onEditDone:j}),e[17]=x,e[18]=j,e[19]=y):y=e[19];let b;e[20]!==y||e[21]!==h?(b=r.jsxs(nt,{iconClass:"fa fa-cog",children:[a,d,h,g,y]}),e[20]=y,e[21]=h,e[22]=b):b=e[22];let S;e[23]!==s.active||e[24]!==o||e[25]!==b?(S=r.jsx(st,{value:s.active,label:"Run DNS Server",onChange:o,children:b}),e[23]=s.active,e[24]=o,e[25]=b,e[26]=S):S=e[26];let C;e[27]!==i||e[28]!==n?(C=r.jsx(tt,{error:n,backendState:i}),e[27]=i,e[28]=n,e[29]=C):C=e[29];let N;return e[30]!==S||e[31]!==C?(N=r.jsxs("div",{children:[S,C]}),e[30]=S,e[31]=C,e[32]=N):N=e[32],N}function gi(t){const e=E.c(10),{title:s,description:i}=t;let l;e[0]!==s?(l=r.jsx("h4",{className:"mode-title",children:s}),e[0]=s,e[1]=l):l=e[1];let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("i",{className:"fa fa-exclamation-triangle","aria-hidden":"true"}),e[2]=n):n=e[2];let o;e[3]!==l?(o=r.jsxs("div",{className:"title-icon-container",children:[l,n]}),e[3]=l,e[4]=o):o=e[4];let a;e[5]!==i?(a=r.jsx("p",{className:"mode-description",children:i}),e[5]=i,e[6]=a):a=e[6];let d;return e[7]!==o||e[8]!==a?(d=r.jsxs("div",{className:"missing-mode-container",children:[o,a]}),e[7]=o,e[8]=a,e[9]=d):d=e[9],d}function Ru(){const t=E.c(19),{platform:e,localModeUnavailable:s}=F(Au);let i,l;t[0]===Symbol.for("react.memo_cache_sentinel")?(i=r.jsx("h2",{children:"Intercept Traffic"}),l=r.jsx("p",{children:"Configure how you want to intercept traffic with mitmproxy."}),t[0]=i,t[1]=l):(i=t[0],l=t[1]);let n;t[2]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h3",{children:"Recommended"}),t[2]=n):n=t[2];let o;t[3]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsx(su,{}),t[3]=o):o=t[3];let a;t[4]!==s?(a=s!==null?r.jsx(gi,{title:"Local Redirect Mode",description:s}):r.jsx(Yd,{}),t[4]=s,t[5]=a):a=t[5];let d,u;t[6]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx(lu,{}),u=r.jsx(du,{}),t[6]=d,t[7]=u):(d=t[6],u=t[7]);let p;t[8]!==a?(p=r.jsxs("div",{className:"modes-category green-left-border",children:[n,r.jsxs("div",{className:"modes-container",children:[o,a,d,u]})]}),t[8]=a,t[9]=p):p=t[9];let h;t[10]===Symbol.for("react.memo_cache_sentinel")?(h=r.jsx("h3",{children:"Advanced"}),t[10]=h):h=t[10];let g,x,j;t[11]===Symbol.for("react.memo_cache_sentinel")?(j=r.jsx(_u,{}),g=r.jsx(wu,{}),x=r.jsx(Nu,{}),t[11]=g,t[12]=x,t[13]=j):(g=t[11],x=t[12],j=t[13]);let y;t[14]!==e?(y=r.jsxs("div",{className:"modes-category gray-left-border",children:[h,r.jsxs("div",{className:"modes-container",children:[j,g,x,e.startsWith("win32")?r.jsx(gi,{title:"Transparent Proxy",description:"This mode is only supported on Linux and MacOS."}):r.jsx(mu,{})]})]}),t[14]=e,t[15]=y):y=t[15];let b;return t[16]!==y||t[17]!==p?(b=r.jsxs("div",{className:"modes",children:[i,l,p,y]}),t[16]=y,t[17]=p,t[18]=b):b=t[18],b}function Au(t){return t.backendState}function Du(t){const e=t.filter(d=>d.type==="http"),s=e.length,i=e.filter(d=>d.response&&d.response.status_code>=400).length,l=s>0?i/s*100:0,n=e.filter(d=>d.response?.timestamp_end&&d.request?.timestamp_start).map(d=>{const u=d.request.timestamp_start;return(d.response.timestamp_end-u)*1e3}),o=n.length>0?n.reduce((d,u)=>d+u,0)/n.length:0,a=n.filter(d=>d>1e3).length;return{totalRequests:s,errorRate:l,avgResponseTime:o,slowQueries:a}}function Iu(t){const e=t.filter(i=>i.type==="http"),s=new Map;return e.forEach(i=>{if(i.response){const l=i.response.status_code;s.set(l,(s.get(l)||0)+1)}}),Array.from(s.entries()).map(([i,l])=>({code:i,count:l})).sort((i,l)=>l.count-i.count).slice(0,10)}function Fu(t){const e=t.filter(i=>i.type==="http"),s=new Map;return e.forEach(i=>{const l=i.request.pretty_host,n=s.get(l)||{count:0,totalTime:0};if(n.count+=1,i.response?.timestamp_end&&i.request?.timestamp_start){const o=(i.response.timestamp_end-i.request.timestamp_start)*1e3;n.totalTime+=o}s.set(l,n)}),Array.from(s.entries()).map(([i,l])=>({domain:i,count:l.count,avgTime:l.count>0?l.totalTime/l.count:0})).sort((i,l)=>l.count-i.count).slice(0,10)}function Lu(t,e=5e3){const s=t.filter(l=>l.type==="http"),i=new Map;return s.forEach(l=>{if(l.response?.timestamp_end&&l.request?.timestamp_start){const n=Math.floor(l.request.timestamp_start*1e3),o=Math.floor(n/e)*e,a=(l.response.timestamp_end-l.request.timestamp_start)*1e3;i.has(o)||i.set(o,[]),i.get(o).push(a)}}),Array.from(i.entries()).map(([l,n])=>({timestamp:l,time:n.reduce((o,a)=>o+a,0)/n.length})).sort((l,n)=>l.timestamp-n.timestamp).slice(-50)}function ds(t){return t.toLocaleString()}function Pu(t){return t<1e3?`${Math.round(t)}ms`:`${(t/1e3).toFixed(2)}s`}function Mu(t){return`${t.toFixed(1)}%`}function Ou(t){const e=E.c(13),{flows:s}=t;let i;e[0]!==s?(i=Lu(s),e[0]=s,e[1]=i):i=e[1];const l=i;if(l.length===0){let j;return e[2]===Symbol.for("react.memo_cache_sentinel")?(j=r.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"No response time data available"}),e[2]=j):j=e[2],j}let n;e[3]===Symbol.for("react.memo_cache_sentinel")?(n={width:"100%",height:300},e[3]=n):n=e[3];let o,a;e[4]===Symbol.for("react.memo_cache_sentinel")?(o={top:5,right:30,left:20,bottom:5},a=r.jsx(Ni,{strokeDasharray:"3 3"}),e[4]=o,e[5]=a):(o=e[4],a=e[5]);let d;e[6]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx(ki,{dataKey:"timestamp",tickFormatter:Vu,label:{value:"Time",position:"insideBottom",offset:-5}}),e[6]=d):d=e[6];let u,p,h,g;e[7]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx(ms,{label:{value:"Response Time (ms)",angle:-90,position:"insideLeft"}}),p=r.jsx(ws,{labelFormatter:Hu,formatter:qu}),h=r.jsx(Ss,{}),g=r.jsx(nc,{type:"monotone",dataKey:"time",stroke:"#8884d8",strokeWidth:2,dot:!1,name:"Response Time"}),e[7]=u,e[8]=p,e[9]=h,e[10]=g):(u=e[7],p=e[8],h=e[9],g=e[10]);let x;return e[11]!==l?(x=r.jsx("div",{style:n,children:r.jsx($s,{children:r.jsxs(ic,{data:l,margin:o,children:[a,d,u,p,h,g]})})}),e[11]=l,e[12]=x):x=e[12],x}function qu(t){return[`${t.toFixed(2)}ms`,"Avg Response Time"]}function Hu(t){return new Date(t).toLocaleTimeString()}function Vu(t){const e=new Date(t);return`${e.getHours()}:${String(e.getMinutes()).padStart(2,"0")}`}const wt={"2xx":"#10b981","3xx":"#3b82f6","4xx":"#f59e0b","5xx":"#ef4444",default:"#6b7280"};function Uu(t){return t>=200&&t<300?wt["2xx"]:t>=300&&t<400?wt["3xx"]:t>=400&&t<500?wt["4xx"]:t>=500&&t<600?wt["5xx"]:wt.default}function Bu(t){const e=E.c(13),{flows:s}=t;let i;e[0]!==s?(i=Iu(s).map(Gu),e[0]=s,e[1]=i):i=e[1];const l=i;if(l.length===0){let h;return e[2]===Symbol.for("react.memo_cache_sentinel")?(h=r.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"No status code data available"}),e[2]=h):h=e[2],h}let n;e[3]===Symbol.for("react.memo_cache_sentinel")?(n={width:"100%",height:300},e[3]=n):n=e[3];let o;e[4]!==l?(o=l.map(zu),e[4]=l,e[5]=o):o=e[5];let a;e[6]!==l||e[7]!==o?(a=r.jsx(rc,{data:l,cx:"50%",cy:"50%",labelLine:!1,label:Qu,outerRadius:80,fill:"#8884d8",dataKey:"value",children:o}),e[6]=l,e[7]=o,e[8]=a):a=e[8];let d,u;e[9]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx(ws,{formatter:Wu}),u=r.jsx(Ss,{formatter:Ku}),e[9]=d,e[10]=u):(d=e[9],u=e[10]);let p;return e[11]!==a?(p=r.jsx("div",{style:n,children:r.jsx($s,{children:r.jsxs(lc,{children:[a,d,u]})})}),e[11]=a,e[12]=p):p=e[12],p}function Ku(t,e){return`${t} (${e.payload.value})`}function Wu(t,e){return[`${t} requests`,`Status ${e}`]}function zu(t,e){return r.jsx(oc,{fill:t.fill},`cell-${e}`)}function Qu(t){const{name:e,percent:s}=t;return`${e} (${(s*100).toFixed(0)}%)`}function Gu(t){return{name:`${t.code}`,value:t.count,fill:Uu(t.code)}}function Yu(t){const e=E.c(15),{flows:s}=t;let i;e[0]!==s?(i=Fu(s),e[0]=s,e[1]=i):i=e[1];const l=i;if(l.length===0){let b;return e[2]===Symbol.for("react.memo_cache_sentinel")?(b=r.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"No domain data available"}),e[2]=b):b=e[2],b}let n;e[3]===Symbol.for("react.memo_cache_sentinel")?(n={width:"100%",height:300},e[3]=n):n=e[3];let o,a;e[4]===Symbol.for("react.memo_cache_sentinel")?(o={top:5,right:30,left:20,bottom:60},a=r.jsx(Ni,{strokeDasharray:"3 3"}),e[4]=o,e[5]=a):(o=e[4],a=e[5]);let d;e[6]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx(ki,{dataKey:"domain",angle:-45,textAnchor:"end",height:100,interval:0,tick:{fontSize:10}}),e[6]=d):d=e[6];let u;e[7]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx(ms,{yAxisId:"left",label:{value:"Request Count",angle:-90,position:"insideLeft"}}),e[7]=u):u=e[7];let p,h,g,x,j;e[8]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx(ms,{yAxisId:"right",orientation:"right",label:{value:"Avg Time (ms)",angle:90,position:"insideRight"}}),x=r.jsx(ws,{formatter:Ju}),j=r.jsx(Ss,{}),p=r.jsx(Jn,{yAxisId:"left",dataKey:"count",fill:"#8884d8",name:"Request Count"}),h=r.jsx(Jn,{yAxisId:"right",dataKey:"avgTime",fill:"#82ca9d",name:"Avg Response Time"}),e[8]=p,e[9]=h,e[10]=g,e[11]=x,e[12]=j):(p=e[8],h=e[9],g=e[10],x=e[11],j=e[12]);let y;return e[13]!==l?(y=r.jsx("div",{style:n,children:r.jsx($s,{children:r.jsxs(cc,{data:l,margin:o,children:[a,d,u,g,x,j,p,h]})})}),e[13]=l,e[14]=y):y=e[14],y}function Ju(t,e){return e==="count"?[`${t} requests`,"Count"]:[`${t.toFixed(2)}ms`,"Avg Time"]}function Xu(t){const e=E.c(52),{flows:s}=t;let i;e[0]!==s?(i=Du(s),e[0]=s,e[1]=i):i=e[1];const l=i;let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx("h2",{children:"📊 Network Metrics"}),e[2]=n):n=e[2];let o;e[3]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsx("div",{className:"metric-label",children:"Total Requests"}),e[3]=o):o=e[3];let a;e[4]!==l.totalRequests?(a=ds(l.totalRequests),e[4]=l.totalRequests,e[5]=a):a=e[5];let d;e[6]!==a?(d=r.jsxs("div",{className:"metric-card",children:[o,r.jsx("div",{className:"metric-value",children:a})]}),e[6]=a,e[7]=d):d=e[7];let u;e[8]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("div",{className:"metric-label",children:"Error Rate"}),e[8]=u):u=e[8];let p;e[9]!==l.errorRate?(p=Mu(l.errorRate),e[9]=l.errorRate,e[10]=p):p=e[10];let h;e[11]!==p?(h=r.jsxs("div",{className:"metric-card",children:[u,r.jsx("div",{className:"metric-value",children:p})]}),e[11]=p,e[12]=h):h=e[12];let g;e[13]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("div",{className:"metric-label",children:"Avg Response Time"}),e[13]=g):g=e[13];let x;e[14]!==l.avgResponseTime?(x=Pu(l.avgResponseTime),e[14]=l.avgResponseTime,e[15]=x):x=e[15];let j;e[16]!==x?(j=r.jsxs("div",{className:"metric-card",children:[g,r.jsx("div",{className:"metric-value",children:x})]}),e[16]=x,e[17]=j):j=e[17];let y;e[18]===Symbol.for("react.memo_cache_sentinel")?(y=r.jsx("div",{className:"metric-label",children:"Slow Queries (>1s)"}),e[18]=y):y=e[18];let b;e[19]!==l.slowQueries?(b=ds(l.slowQueries),e[19]=l.slowQueries,e[20]=b):b=e[20];let S;e[21]!==b?(S=r.jsxs("div",{className:"metric-card",children:[y,r.jsx("div",{className:"metric-value",children:b})]}),e[21]=b,e[22]=S):S=e[22];let C;e[23]!==j||e[24]!==S||e[25]!==d||e[26]!==h?(C=r.jsxs("div",{className:"metrics-grid",children:[d,h,j,S]}),e[23]=j,e[24]=S,e[25]=d,e[26]=h,e[27]=C):C=e[27];let N;e[28]===Symbol.for("react.memo_cache_sentinel")?(N=r.jsx("h3",{children:"Response Time Over Time"}),e[28]=N):N=e[28];let T;e[29]!==s?(T=r.jsxs("div",{className:"chart-container",children:[N,r.jsx(Ou,{flows:s})]}),e[29]=s,e[30]=T):T=e[30];let I;e[31]===Symbol.for("react.memo_cache_sentinel")?(I=r.jsx("h3",{children:"Status Code Distribution"}),e[31]=I):I=e[31];let D;e[32]!==s?(D=r.jsxs("div",{className:"chart-container",children:[I,r.jsx(Bu,{flows:s})]}),e[32]=s,e[33]=D):D=e[33];let O;e[34]===Symbol.for("react.memo_cache_sentinel")?(O=r.jsx("h3",{children:"Top Domains by Request Count"}),e[34]=O):O=e[34];let L;e[35]!==s?(L=r.jsxs("div",{className:"chart-container",children:[O,r.jsx(Yu,{flows:s})]}),e[35]=s,e[36]=L):L=e[36];let H;e[37]!==D||e[38]!==L?(H=r.jsxs("div",{className:"charts-row",children:[D,L]}),e[37]=D,e[38]=L,e[39]=H):H=e[39];let q;e[40]!==T||e[41]!==H?(q=r.jsxs("div",{className:"charts-section",children:[T,H]}),e[40]=T,e[41]=H,e[42]=q):q=e[42];let V;e[43]===Symbol.for("react.memo_cache_sentinel")?(V=r.jsx("p",{children:"✨ Kidsnote mitmweb - Network Debugging Tool"}),e[43]=V):V=e[43];let W;e[44]!==s.length?(W=ds(s.length),e[44]=s.length,e[45]=W):W=e[45];let U;e[46]!==W?(U=r.jsxs("div",{className:"metrics-info",children:[V,r.jsxs("p",{children:["🚀 Phase 1: MVP - Real-time metrics from ",W," ","flows"]})]}),e[46]=W,e[47]=U):U=e[47];let Q;return e[48]!==C||e[49]!==q||e[50]!==U?(Q=r.jsxs("div",{className:"kidsnote-metrics-panel",children:[n,C,q,U]}),e[48]=C,e[49]=q,e[50]=U,e[51]=Q):Q=e[51],Q}const Zu=vt(t=>({flows:t.flows.list}))(Xu);var bs=(t=>(t.REQUEST="request",t.IMPRESSION="impression",t.CLICK="click",t))(bs||{}),me=(t=>(t.REQUESTED="requested",t.IMPRESSED="impressed",t.CLICKED="clicked",t))(me||{});const ef="ads-api-kcsandbox-01.kidsnote.com",Gs={REQUEST:/\/api\/v1\/kidsnote_benefit\/benefit\/req$/,IMPRESSION:/\/api\/v1\/kidsnote_benefit\/benefit\/imp$/,CLICK:/\/api\/v2\/kidsnote_benefit\/benefit\/click$/};function Ys(t){return t.type!=="http"?!1:t.request.pretty_host===ef}function tf(t){if(!Ys(t))return!1;const e=t.request.path;return Gs.REQUEST.test(e)}function hl(t){if(!Ys(t))return!1;const e=t.request.path;return Gs.IMPRESSION.test(e)}function ml(t){if(!Ys(t))return!1;const e=t.request.path;return Gs.CLICK.test(e)}function sf(t){const e=new Map;try{new URL(t,"http://dummy.com").searchParams.forEach((i,l)=>{e.set(l,i)})}catch{}return e}function xi(t){if(!hl(t)&&!ml(t))return null;try{const e=`${t.request.scheme}://${t.request.pretty_host}${t.request.path}`;return sf(e).get("adsid")||null}catch(e){return console.error("Failed to extract adsid:",e),null}}function vi(t,e){return{type:e,timestamp:t.request.timestamp_start*1e3,flowId:t.id}}function _i(t){return t?new Date(t).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3}):"-"}function nf(t){switch(t){case me.REQUESTED:return"요청됨";case me.IMPRESSED:return"노출됨";case me.CLICKED:return"클릭됨";default:return t}}function rf(t){switch(t){case me.REQUESTED:return"#6b7280";case me.IMPRESSED:return"#3b82f6";case me.CLICKED:return"#10b981";default:return"#6b7280"}}function lf(t){const e=new Map;return t.forEach(s=>{if(s.type!=="http")return;const i=s;if(tf(i)&&i.response,hl(i)){const l=xi(i);if(l){const n=e.get(l)||{adsid:l,title:`Ad ${l.substring(0,8)}...`,status:me.REQUESTED},o=vi(i,bs.IMPRESSION);e.set(l,{...n,impressionEvent:o,impressionTime:o.timestamp,status:me.IMPRESSED})}}if(ml(i)){const l=xi(i);if(l){const n=e.get(l)||{adsid:l,title:`Ad ${l.substring(0,8)}...`,status:me.REQUESTED},o=vi(i,bs.CLICK);e.set(l,{...n,clickEvent:o,clickTime:o.timestamp,status:me.CLICKED})}}}),e}function of(t){const e=E.c(50),{flows:s}=t,[i,l]=Se.useState(""),[n,o]=Se.useState("all");let a;e[0]!==s?(a=lf(s),e[0]=s,e[1]=a):a=e[1];const d=a;let u;if(e[2]!==d||e[3]!==i||e[4]!==n){let oe=Array.from(d.values());if(i){const be=i.toLowerCase();oe=oe.filter(Ce=>Ce.adsid.toLowerCase().includes(be)||Ce.title.toLowerCase().includes(be))}n!=="all"&&(oe=oe.filter(be=>be.status===n)),u=oe.sort(pf),e[2]=d,e[3]=i,e[4]=n,e[5]=u}else u=e[5];const p=u,h=ff;let g;e[6]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsxs("div",{className:"ad-tracking-header",children:[r.jsx("h2",{children:"📱 Kidsnote Ad Tracking Analysis"}),r.jsx("p",{className:"description",children:"키즈노트 광고 트래킹 분석 대시보드 - 광고 요청(req), 노출(imp), 클릭(click)을 자동으로 추적합니다"})]}),e[6]=g):g=e[6];let x;e[7]===Symbol.for("react.memo_cache_sentinel")?(x=oe=>l(oe.target.value),e[7]=x):x=e[7];let j;e[8]!==i?(j=r.jsx("div",{className:"search-box",children:r.jsx("input",{type:"text",placeholder:"🔍 Ad ID 또는 제목 검색...",value:i,onChange:x,className:"search-input"})}),e[8]=i,e[9]=j):j=e[9];let y;e[10]===Symbol.for("react.memo_cache_sentinel")?(y=oe=>o(oe.target.value),e[10]=y):y=e[10];let b,S,C,N;e[11]===Symbol.for("react.memo_cache_sentinel")?(S=r.jsx("option",{value:"all",children:"모든 상태"}),C=r.jsx("option",{value:me.REQUESTED,children:"요청됨"}),N=r.jsx("option",{value:me.IMPRESSED,children:"노출됨"}),b=r.jsx("option",{value:me.CLICKED,children:"클릭됨"}),e[11]=b,e[12]=S,e[13]=C,e[14]=N):(b=e[11],S=e[12],C=e[13],N=e[14]);let T;e[15]!==n?(T=r.jsx("div",{className:"filter-box",children:r.jsxs("select",{value:n,onChange:y,className:"status-filter",children:[S,C,N,b]})}),e[15]=n,e[16]=T):T=e[16];let I;e[17]===Symbol.for("react.memo_cache_sentinel")?(I=r.jsx("button",{onClick:h,className:"clear-button",children:"🗑️ 초기화"}),e[17]=I):I=e[17];let D;e[18]!==T||e[19]!==j?(D=r.jsxs("div",{className:"ad-tracking-controls",children:[j,T,I]}),e[18]=T,e[19]=j,e[20]=D):D=e[20];let O;e[21]===Symbol.for("react.memo_cache_sentinel")?(O=r.jsx("div",{className:"stat-label",children:"총 광고"}),e[21]=O):O=e[21];let L;e[22]!==d.size?(L=r.jsxs("div",{className:"stat-card",children:[O,r.jsx("div",{className:"stat-value",children:d.size})]}),e[22]=d.size,e[23]=L):L=e[23];let H;e[24]===Symbol.for("react.memo_cache_sentinel")?(H=r.jsx("div",{className:"stat-label",children:"노출됨"}),e[24]=H):H=e[24];let q;e[25]!==d?(q=Array.from(d.values()).filter(uf),e[25]=d,e[26]=q):q=e[26];let V;e[27]!==q.length?(V=r.jsxs("div",{className:"stat-card",children:[H,r.jsx("div",{className:"stat-value",children:q.length})]}),e[27]=q.length,e[28]=V):V=e[28];let W;e[29]===Symbol.for("react.memo_cache_sentinel")?(W=r.jsx("div",{className:"stat-label",children:"클릭됨"}),e[29]=W):W=e[29];let U;e[30]!==d?(U=Array.from(d.values()).filter(df),e[30]=d,e[31]=U):U=e[31];let Q;e[32]!==U.length?(Q=r.jsxs("div",{className:"stat-card",children:[W,r.jsx("div",{className:"stat-value",children:U.length})]}),e[32]=U.length,e[33]=Q):Q=e[33];let G;e[34]===Symbol.for("react.memo_cache_sentinel")?(G=r.jsx("div",{className:"stat-label",children:"CTR"}),e[34]=G):G=e[34];let J;e[35]!==d?(J=d.size>0?(Array.from(d.values()).filter(af).length/d.size*100).toFixed(1)+"%":"-",e[35]=d,e[36]=J):J=e[36];let X;e[37]!==J?(X=r.jsxs("div",{className:"stat-card",children:[G,r.jsx("div",{className:"stat-value",children:J})]}),e[37]=J,e[38]=X):X=e[38];let Z;e[39]!==L||e[40]!==V||e[41]!==Q||e[42]!==X?(Z=r.jsxs("div",{className:"ad-tracking-stats",children:[L,V,Q,X]}),e[39]=L,e[40]=V,e[41]=Q,e[42]=X,e[43]=Z):Z=e[43];let re;e[44]!==p?(re=r.jsx("div",{className:"ad-tracking-table-container",children:p.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("p",{children:"📭 광고 트래킹 데이터가 없습니다"}),r.jsx("p",{className:"hint",children:"키즈노트 앱에서 광고를 요청하면 자동으로 추적됩니다"})]}):r.jsxs("table",{className:"ad-tracking-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Ad ID"}),r.jsx("th",{children:"광고 제목"}),r.jsx("th",{children:"상태"}),r.jsx("th",{children:"노출 시간"}),r.jsx("th",{children:"클릭 시간"})]})}),r.jsx("tbody",{children:p.map(cf)})]})}),e[44]=p,e[45]=re):re=e[45];let ue;return e[46]!==D||e[47]!==Z||e[48]!==re?(ue=r.jsxs("div",{className:"kidsnote-ad-tracking-panel",children:[g,D,Z,re]}),e[46]=D,e[47]=Z,e[48]=re,e[49]=ue):ue=e[49],ue}function cf(t){return r.jsxs("tr",{children:[r.jsx("td",{className:"ad-id",children:r.jsx("code",{children:t.adsid})}),r.jsx("td",{className:"ad-title",children:t.title}),r.jsx("td",{className:"ad-status",children:r.jsx("span",{className:"status-badge",style:{backgroundColor:rf(t.status)},children:nf(t.status)})}),r.jsx("td",{className:"ad-time",children:_i(t.impressionTime)}),r.jsx("td",{className:"ad-time",children:_i(t.clickTime)})]},t.adsid)}function af(t){return t.status===me.CLICKED}function df(t){return t.status===me.CLICKED}function uf(t){return t.status===me.IMPRESSED||t.status===me.CLICKED}function ff(){confirm("모든 광고 트래킹 데이터를 삭제하시겠습니까?")&&window.location.reload()}function pf(t,e){const s=t.requestTime||t.impressionTime||t.clickTime||0;return(e.requestTime||e.impressionTime||e.clickTime||0)-s}const hf=vt(t=>({flows:t.flows.list}))(of);function mf(){const t=E.c(4),e=F(vf),s=F(xf),i=F(gf);let l;return t[0]!==i||t[1]!==s||t[2]!==e?(l=r.jsx("div",{className:"main-view",children:i===de.Capture?r.jsx(Ru,{}):i===de.Metrics?r.jsx(Zu,{}):i===de.AdTracking?r.jsx(hf,{}):r.jsxs(r.Fragment,{children:[s?r.jsx(Hd,{}):r.jsx(Vd,{}),e&&r.jsxs(r.Fragment,{children:[r.jsx(Dd,{},"splitter"),r.jsx(Ed,{},"flowDetails")]})]})}),t[0]=i,t[1]=s,t[2]=e,t[3]=l):l=t[3],l}function gf(t){return t.ui.tabs.current}function xf(t){return t.flows.list.length>0}function vf(t){return t.flows.selected.length===1}function xt(t){const e=E.c(2),{children:s}=t;let i;return e[0]!==s?(i=window.MITMWEB_STATIC?null:r.jsx(r.Fragment,{children:s}),e[0]=s,e[1]=i):i=e[1],i}const _f=M.memo(function(){const e=E.c(20),s=ee(),i=F(jf);let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l={placement:"bottom-start"},e[0]=l):l=e[0];let n;e[1]!==s?(n=r.jsx("li",{children:r.jsx(Yr,{icon:"fa-folder-open",text:" Open...",onClick:yf,onOpenFile:b=>{s(Nc(b)),document.body.click()}})}),e[1]=s,e[2]=n):n=e[2];let o;e[3]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsxs(Re,{onClick:bf,children:[r.jsx("i",{className:"fa fa-fw fa-floppy-o"})," Save"]}),e[3]=o):o=e[3];let a;e[4]!==i?(a=()=>location.replace("/flows/dump?filter="+i),e[4]=i,e[5]=a):a=e[5];let d;e[6]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx("i",{className:"fa fa-fw fa-floppy-o"}),e[6]=d):d=e[6];let u;e[7]!==a?(u=r.jsxs(Re,{onClick:a,children:[d," Save filtered"]}),e[7]=a,e[8]=u):u=e[8];let p;e[9]!==s?(p=()=>confirm("Delete all flows?")&&s(er()),e[9]=s,e[10]=p):p=e[10];let h;e[11]===Symbol.for("react.memo_cache_sentinel")?(h=r.jsx("i",{className:"fa fa-fw fa-trash"}),e[11]=h):h=e[11];let g;e[12]!==p?(g=r.jsxs(Re,{onClick:p,children:[h," Clear All"]}),e[12]=p,e[13]=g):g=e[13];let x;e[14]===Symbol.for("react.memo_cache_sentinel")?(x=r.jsx(ed,{}),e[14]=x):x=e[14];let j;e[15]===Symbol.for("react.memo_cache_sentinel")?(j=r.jsxs(xt,{children:[x,r.jsx("li",{children:r.jsxs("a",{href:"http://mitm.it/",target:"_blank",rel:"noreferrer",children:[r.jsx("i",{className:"fa fa-fw fa-external-link"})," Install Certificates..."]})})]}),e[15]=j):j=e[15];let y;return e[16]!==n||e[17]!==u||e[18]!==g?(y=r.jsxs(At,{className:"pull-left special",text:"File",options:l,children:[n,o,u,g,j]}),e[16]=n,e[17]=u,e[18]=g,e[19]=y):y=e[19],y});function jf(t){return t.ui.filter[_e.Search]}function yf(t){return t.stopPropagation()}function bf(){return location.replace("/flows/dump")}const wf=M.memo(function(){const e=E.c(5),s=F(Sf),i=F($f);switch(s){case $t.INIT:{let l;return e[0]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("span",{className:"connection-indicator init",children:"connecting…"}),e[0]=l):l=e[0],l}case $t.FETCHING:{let l;return e[1]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("span",{className:"connection-indicator fetching",children:"fetching data…"}),e[1]=l):l=e[1],l}case $t.ESTABLISHED:{let l;return e[2]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("span",{className:"connection-indicator established",children:"connected"}),e[2]=l):l=e[2],l}case $t.ERROR:{let l;return e[3]!==i?(l=r.jsx("span",{className:"connection-indicator error",title:i,children:"connection lost"}),e[3]=i,e[4]=l):l=e[4],l}default:Et(s)}});function Sf(t){return t.connection.state}function $f(t){return t.connection.message}gl.title="Capture";function gl(){const t=E.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=r.jsx(r.Fragment,{}),t[0]=e):e=t[0],e}const ji=function(){function t(i,l){function n(){this.constructor=i}n.prototype=l.prototype,i.prototype=new n}function e(i,l,n,o){this.message=i,this.expected=l,this.found=n,this.location=o,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,e)}t(e,Error);function s(i){var l=arguments.length>1?arguments[1]:{},n={},o={start:En},a=En,d={type:"other",description:"filter expression"},u=function(c){return c},p={type:"other",description:"whitespace"},h=/^[ \t\n\r]/,g={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},x={type:"other",description:"control character"},j=/^[|&!()~"]/,y={type:"class",value:'[|&!()~"]',description:'[|&!()~"]'},b={type:"other",description:"optional whitespace"},S="|",C={type:"literal",value:"|",description:'"|"'},N=function(c,f){return So(c,f)},T="&",I={type:"literal",value:"&",description:'"&"'},D=function(c,f){return $o(c,f)},O="!",L={type:"literal",value:"!",description:'"!"'},H=function(c){return Co(c)},q="(",V={type:"literal",value:"(",description:'"("'},W=")",U={type:"literal",value:")",description:'")"'},Q=function(c){return No(c)},G="~all",J={type:"literal",value:"~all",description:'"~all"'},X=function(){return In},Z="~a",re={type:"literal",value:"~a",description:'"~a"'},ue=function(){return Ln},oe="~b",be={type:"literal",value:"~b",description:'"~b"'},Ce=function(c){return ko(c)},Ne="~bq",Ae={type:"literal",value:"~bq",description:'"~bq"'},k=function(c){return Eo(c)},ge="~bs",z={type:"literal",value:"~bs",description:'"~bs"'},ce=function(c){return To(c)},B="~c",ke={type:"literal",value:"~c",description:'"~c"'},We=function(c){return Ro(c)},Oe="~comment",te={type:"literal",value:"~comment",description:'"~comment"'},qe=function(c){return Ao(c)},De="~d",le={type:"literal",value:"~d",description:'"~d"'},fe=function(c){return Do(c)},ve="~dns",Ie={type:"literal",value:"~dns",description:'"~dns"'},it=function(){return Pn},Je="~dst",ts={type:"literal",value:"~dst",description:'"~dst"'},w=function(c){return Io(c)},$="~e",A={type:"literal",value:"~e",description:'"~e"'},K=function(){return Mn},Dt="~h",ss={type:"literal",value:"~h",description:'"~h"'},Ee=function(c){return Fo(c)},Fe="~hq",ft={type:"literal",value:"~hq",description:'"~hq"'},ze=function(c){return Lo(c)},_t="~hs",It={type:"literal",value:"~hs",description:'"~hs"'},rt=function(c){return Po(c)},Ft="~http",pt={type:"literal",value:"~http",description:'"~http"'},Le=function(){return On},Zs="~marked",wl={type:"literal",value:"~marked",description:'"~marked"'},Sl=function(){return qn},en="~marker",$l={type:"literal",value:"~marker",description:'"~marker"'},Cl=function(c){return Mo(c)},tn="~m",Nl={type:"literal",value:"~m",description:'"~m"'},kl=function(c){return Oo(c)},sn="~q",El={type:"literal",value:"~q",description:'"~q"'},Tl=function(){return Hn},nn="~replayq",Rl={type:"literal",value:"~replayq",description:'"~replayq"'},Al=function(){return Vn},rn="~replays",Dl={type:"literal",value:"~replays",description:'"~replays"'},Il=function(){return Un},ln="~replay",Fl={type:"literal",value:"~replay",description:'"~replay"'},Ll=function(){return Bn},on="~src",Pl={type:"literal",value:"~src",description:'"~src"'},Ml=function(c){return qo(c)},cn="~s",Ol={type:"literal",value:"~s",description:'"~s"'},ql=function(){return Kn},an="~tcp",Hl={type:"literal",value:"~tcp",description:'"~tcp"'},Vl=function(){return Wn},dn="~udp",Ul={type:"literal",value:"~udp",description:'"~udp"'},Bl=function(){return zn},un="~tq",Kl={type:"literal",value:"~tq",description:'"~tq"'},Wl=function(c){return Ho(c)},fn="~ts",zl={type:"literal",value:"~ts",description:'"~ts"'},Ql=function(c){return Vo(c)},pn="~t",Gl={type:"literal",value:"~t",description:'"~t"'},Yl=function(c){return Uo(c)},hn="~u",Jl={type:"literal",value:"~u",description:'"~u"'},mn=function(c){return Bo(c)},gn="~websocket",Xl={type:"literal",value:"~websocket",description:'"~websocket"'},Zl=function(){return Qn},eo={type:"other",description:"integer"},xn=/^['"]/,vn={type:"class",value:`['"]`,description:`['"]`},_n=/^[0-9]/,jn={type:"class",value:"[0-9]",description:"[0-9]"},to=function(c){return parseInt(c.join(""),10)},so={type:"other",description:"string"},yn='"',bn={type:"literal",value:'"',description:'"\\""'},ns=function(c){return c.join("")},wn="'",Sn={type:"literal",value:"'",description:`"'"`},no=/^["\\]/,io={type:"class",value:'["\\\\]',description:'["\\\\]'},is={type:"any",description:"any character"},jt=function(c){return c},$n="\\",Cn={type:"literal",value:"\\",description:'"\\\\"'},ro=/^['\\]/,lo={type:"class",value:"['\\\\]",description:"['\\\\]"},oo=/^['"\\]/,co={type:"class",value:`['"\\\\]`,description:`['"\\\\]`},ao="n",uo={type:"literal",value:"n",description:'"n"'},fo=function(){return`
`},po="r",ho={type:"literal",value:"r",description:'"r"'},mo=function(){return"\r"},go="t",xo={type:"literal",value:"t",description:'"t"'},vo=function(){return"	"},m=0,Lt=[{line:1,column:1,seenCR:!1}],He=0,rs=[],R=0,Pt;if("startRule"in l){if(!(l.startRule in o))throw new Error(`Can't start parsing from rule "`+l.startRule+'".');a=o[l.startRule]}function Nn(c){var f=Lt[c],v,_;if(f)return f;for(v=c-1;!Lt[v];)v--;for(f=Lt[v],f={line:f.line,column:f.column,seenCR:f.seenCR};v<c;)_=i.charAt(v),_===`
`?(f.seenCR||f.line++,f.column=1,f.seenCR=!1):_==="\r"||_==="\u2028"||_==="\u2029"?(f.line++,f.column=1,f.seenCR=!0):(f.column++,f.seenCR=!1),v++;return Lt[c]=f,f}function kn(c,f){var v=Nn(c),_=Nn(f);return{start:{offset:c,line:v.line,column:v.column},end:{offset:f,line:_.line,column:_.column}}}function P(c){m<He||(m>He&&(He=m,rs=[]),rs.push(c))}function _o(c,f,v,_){function Ve(Pe){var Xe=1;for(Pe.sort(function(qt,lt){return qt.description<lt.description?-1:qt.description>lt.description?1:0});Xe<Pe.length;)Pe[Xe-1]===Pe[Xe]?Pe.splice(Xe,1):Xe++}function Te(Pe,Xe){function qt(Ko){function Ht(Ge){return Ge.charCodeAt(0).toString(16).toUpperCase()}return Ko.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(Ge){return"\\x0"+Ht(Ge)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(Ge){return"\\x"+Ht(Ge)}).replace(/[\u0100-\u0FFF]/g,function(Ge){return"\\u0"+Ht(Ge)}).replace(/[\u1000-\uFFFF]/g,function(Ge){return"\\u"+Ht(Ge)})}var lt=new Array(Pe.length),Gn,Yn,yt;for(yt=0;yt<Pe.length;yt++)lt[yt]=Pe[yt].description;return Gn=Pe.length>1?lt.slice(0,-1).join(", ")+" or "+lt[Pe.length-1]:lt[0],Yn=Xe?'"'+qt(Xe)+'"':"end of input","Expected "+Gn+" but "+Yn+" found."}return f!==null&&Ve(f),new e(Te(f,v),f,v,_)}function En(){var c,f,v,_;return R++,c=m,f=Qe(),f!==n?(v=ls(),v!==n?(_=Qe(),_!==n?(f=u(v),c=f):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),R--,c===n&&(f=n,R===0&&P(d)),c}function Y(){var c;return R++,h.test(i.charAt(m))?(c=i.charAt(m),m++):(c=n,R===0&&P(g)),R--,c===n&&R===0&&P(p),c}function jo(){var c;return R++,j.test(i.charAt(m))?(c=i.charAt(m),m++):(c=n,R===0&&P(y)),R--,c===n&&R===0&&P(x),c}function Qe(){var c,f;for(R++,c=[],f=Y();f!==n;)c.push(f),f=Y();return R--,c===n&&(f=n,R===0&&P(b)),c}function ls(){var c,f,v,_,Ve,Te;return c=m,f=Mt(),f!==n?(v=Qe(),v!==n?(i.charCodeAt(m)===124?(_=S,m++):(_=n,R===0&&P(C)),_!==n?(Ve=Qe(),Ve!==n?(Te=ls(),Te!==n?(f=N(f,Te),c=f):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),c===n&&(c=Mt()),c}function Mt(){var c,f,v,_,Ve,Te;if(c=m,f=Ot(),f!==n?(v=Qe(),v!==n?(i.charCodeAt(m)===38?(_=T,m++):(_=n,R===0&&P(I)),_!==n?(Ve=Qe(),Ve!==n?(Te=Mt(),Te!==n?(f=D(f,Te),c=f):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),c===n){if(c=m,f=Ot(),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=Mt(),_!==n?(f=D(f,_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;c===n&&(c=Ot())}return c}function Ot(){var c,f,v,_;return c=m,i.charCodeAt(m)===33?(f=O,m++):(f=n,R===0&&P(L)),f!==n?(v=Qe(),v!==n?(_=Ot(),_!==n?(f=H(_),c=f):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),c===n&&(c=yo()),c}function yo(){var c,f,v,_,Ve,Te;return c=m,i.charCodeAt(m)===40?(f=q,m++):(f=n,R===0&&P(V)),f!==n?(v=Qe(),v!==n?(_=ls(),_!==n?(Ve=Qe(),Ve!==n?(i.charCodeAt(m)===41?(Te=W,m++):(Te=n,R===0&&P(U)),Te!==n?(f=Q(_),c=f):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n)):(m=c,c=n),c===n&&(c=bo()),c}function bo(){var c,f,v,_;if(c=m,i.substr(m,4)===G?(f=G,m+=4):(f=n,R===0&&P(J)),f!==n&&(f=X()),c=f,c===n&&(c=m,i.substr(m,2)===Z?(f=Z,m+=2):(f=n,R===0&&P(re)),f!==n&&(f=ue()),c=f,c===n)){if(c=m,i.substr(m,2)===oe?(f=oe,m+=2):(f=n,R===0&&P(be)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=xe(),_!==n?(f=Ce(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===Ne?(f=Ne,m+=3):(f=n,R===0&&P(Ae)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=xe(),_!==n?(f=k(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===ge?(f=ge,m+=3):(f=n,R===0&&P(z)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=xe(),_!==n?(f=ce(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===B?(f=B,m+=2):(f=n,R===0&&P(ke)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=wo(),_!==n?(f=We(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,8)===Oe?(f=Oe,m+=8):(f=n,R===0&&P(te)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=xe(),_!==n?(f=qe(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===De?(f=De,m+=2):(f=n,R===0&&P(le)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=xe(),_!==n?(f=fe(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,4)===ve?(f=ve,m+=4):(f=n,R===0&&P(Ie)),f!==n&&(f=it()),c=f,c===n)){if(c=m,i.substr(m,4)===Je?(f=Je,m+=4):(f=n,R===0&&P(ts)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=xe(),_!==n?(f=w(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,2)===$?(f=$,m+=2):(f=n,R===0&&P(A)),f!==n&&(f=K()),c=f,c===n)){if(c=m,i.substr(m,2)===Dt?(f=Dt,m+=2):(f=n,R===0&&P(ss)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=xe(),_!==n?(f=Ee(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===Fe?(f=Fe,m+=3):(f=n,R===0&&P(ft)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=xe(),_!==n?(f=ze(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===_t?(f=_t,m+=3):(f=n,R===0&&P(It)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=xe(),_!==n?(f=rt(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,5)===Ft?(f=Ft,m+=5):(f=n,R===0&&P(pt)),f!==n&&(f=Le()),c=f,c===n&&(c=m,i.substr(m,7)===Zs?(f=Zs,m+=7):(f=n,R===0&&P(wl)),f!==n&&(f=Sl()),c=f,c===n))){if(c=m,i.substr(m,7)===en?(f=en,m+=7):(f=n,R===0&&P($l)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=xe(),_!==n?(f=Cl(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===tn?(f=tn,m+=2):(f=n,R===0&&P(Nl)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=xe(),_!==n?(f=kl(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,2)===sn?(f=sn,m+=2):(f=n,R===0&&P(El)),f!==n&&(f=Tl()),c=f,c===n&&(c=m,i.substr(m,8)===nn?(f=nn,m+=8):(f=n,R===0&&P(Rl)),f!==n&&(f=Al()),c=f,c===n&&(c=m,i.substr(m,8)===rn?(f=rn,m+=8):(f=n,R===0&&P(Dl)),f!==n&&(f=Il()),c=f,c===n&&(c=m,i.substr(m,7)===ln?(f=ln,m+=7):(f=n,R===0&&P(Fl)),f!==n&&(f=Ll()),c=f,c===n))))){if(c=m,i.substr(m,4)===on?(f=on,m+=4):(f=n,R===0&&P(Pl)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=xe(),_!==n?(f=Ml(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n&&(c=m,i.substr(m,2)===cn?(f=cn,m+=2):(f=n,R===0&&P(Ol)),f!==n&&(f=ql()),c=f,c===n&&(c=m,i.substr(m,4)===an?(f=an,m+=4):(f=n,R===0&&P(Hl)),f!==n&&(f=Vl()),c=f,c===n&&(c=m,i.substr(m,4)===dn?(f=dn,m+=4):(f=n,R===0&&P(Ul)),f!==n&&(f=Bl()),c=f,c===n)))){if(c=m,i.substr(m,3)===un?(f=un,m+=3):(f=n,R===0&&P(Kl)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=xe(),_!==n?(f=Wl(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,3)===fn?(f=fn,m+=3):(f=n,R===0&&P(zl)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=xe(),_!==n?(f=Ql(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===pn?(f=pn,m+=2):(f=n,R===0&&P(Gl)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=xe(),_!==n?(f=Yl(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.substr(m,2)===hn?(f=hn,m+=2):(f=n,R===0&&P(Jl)),f!==n){if(v=[],_=Y(),_!==n)for(;_!==n;)v.push(_),_=Y();else v=n;v!==n?(_=xe(),_!==n?(f=mn(_),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;c===n&&(c=m,i.substr(m,10)===gn?(f=gn,m+=10):(f=n,R===0&&P(Xl)),f!==n&&(f=Zl()),c=f,c===n&&(c=m,f=xe(),f!==n&&(f=mn(f)),c=f))}}}}}}}}}}}}}}}}}return c}function wo(){var c,f,v,_;if(R++,c=m,xn.test(i.charAt(m))?(f=i.charAt(m),m++):(f=n,R===0&&P(vn)),f===n&&(f=null),f!==n){if(v=[],_n.test(i.charAt(m))?(_=i.charAt(m),m++):(_=n,R===0&&P(jn)),_!==n)for(;_!==n;)v.push(_),_n.test(i.charAt(m))?(_=i.charAt(m),m++):(_=n,R===0&&P(jn));else v=n;v!==n?(xn.test(i.charAt(m))?(_=i.charAt(m),m++):(_=n,R===0&&P(vn)),_===n&&(_=null),_!==n?(f=to(v),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;return R--,c===n&&(f=n,R===0&&P(eo)),c}function xe(){var c,f,v,_;if(R++,c=m,i.charCodeAt(m)===34?(f=yn,m++):(f=n,R===0&&P(bn)),f!==n){for(v=[],_=Tn();_!==n;)v.push(_),_=Tn();v!==n?(i.charCodeAt(m)===34?(_=yn,m++):(_=n,R===0&&P(bn)),_!==n?(f=ns(v),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n){if(c=m,i.charCodeAt(m)===39?(f=wn,m++):(f=n,R===0&&P(Sn)),f!==n){for(v=[],_=Rn();_!==n;)v.push(_),_=Rn();v!==n?(i.charCodeAt(m)===39?(_=wn,m++):(_=n,R===0&&P(Sn)),_!==n?(f=ns(v),c=f):(m=c,c=n)):(m=c,c=n)}else m=c,c=n;if(c===n)if(c=m,f=m,R++,v=jo(),R--,v===n?f=void 0:(m=f,f=n),f!==n){if(v=[],_=An(),_!==n)for(;_!==n;)v.push(_),_=An();else v=n;v!==n?(f=ns(v),c=f):(m=c,c=n)}else m=c,c=n}return R--,c===n&&(f=n,R===0&&P(so)),c}function Tn(){var c,f,v;return c=m,f=m,R++,no.test(i.charAt(m))?(v=i.charAt(m),m++):(v=n,R===0&&P(io)),R--,v===n?f=void 0:(m=f,f=n),f!==n?(i.length>m?(v=i.charAt(m),m++):(v=n,R===0&&P(is)),v!==n?(f=jt(v),c=f):(m=c,c=n)):(m=c,c=n),c===n&&(c=m,i.charCodeAt(m)===92?(f=$n,m++):(f=n,R===0&&P(Cn)),f!==n?(v=Dn(),v!==n?(f=jt(v),c=f):(m=c,c=n)):(m=c,c=n)),c}function Rn(){var c,f,v;return c=m,f=m,R++,ro.test(i.charAt(m))?(v=i.charAt(m),m++):(v=n,R===0&&P(lo)),R--,v===n?f=void 0:(m=f,f=n),f!==n?(i.length>m?(v=i.charAt(m),m++):(v=n,R===0&&P(is)),v!==n?(f=jt(v),c=f):(m=c,c=n)):(m=c,c=n),c===n&&(c=m,i.charCodeAt(m)===92?(f=$n,m++):(f=n,R===0&&P(Cn)),f!==n?(v=Dn(),v!==n?(f=jt(v),c=f):(m=c,c=n)):(m=c,c=n)),c}function An(){var c,f,v;return c=m,f=m,R++,v=Y(),R--,v===n?f=void 0:(m=f,f=n),f!==n?(i.length>m?(v=i.charAt(m),m++):(v=n,R===0&&P(is)),v!==n?(f=jt(v),c=f):(m=c,c=n)):(m=c,c=n),c}function Dn(){var c,f;return oo.test(i.charAt(m))?(c=i.charAt(m),m++):(c=n,R===0&&P(co)),c===n&&(c=m,i.charCodeAt(m)===110?(f=ao,m++):(f=n,R===0&&P(uo)),f!==n&&(f=fo()),c=f,c===n&&(c=m,i.charCodeAt(m)===114?(f=po,m++):(f=n,R===0&&P(ho)),f!==n&&(f=mo()),c=f,c===n&&(c=m,i.charCodeAt(m)===116?(f=go,m++):(f=n,R===0&&P(xo)),f!==n&&(f=vo()),c=f))),c}function So(c,f){function v(){return c.apply(this,arguments)||f.apply(this,arguments)}return v.desc=c.desc+" or "+f.desc,v}function $o(c,f){function v(){return c.apply(this,arguments)&&f.apply(this,arguments)}return v.desc=c.desc+" and "+f.desc,v}function Co(c){function f(){return!c.apply(this,arguments)}return f.desc="not "+c.desc,f}function No(c){function f(){return c.apply(this,arguments)}return f.desc="("+c.desc+")",f}function In(c){return!0}In.desc="all flows";var Fn=[new RegExp("text/javascript"),new RegExp("application/x-javascript"),new RegExp("application/javascript"),new RegExp("text/css"),new RegExp("image/.*"),new RegExp("font/.*"),new RegExp("application/font.*")];function Ln(c){if(c.response){for(var f=gt.getContentType(c.response),v=Fn.length;v--;)if(Fn[v].test(f))return!0}return!1}Ln.desc="is asset";function ko(c){c=new RegExp(c,"i");function f(v){return!0}return f.desc="body matches "+c,f}function Eo(c){c=new RegExp(c,"i");function f(v){return!0}return f.desc="body request matches "+c,f}function To(c){c=new RegExp(c,"i");function f(v){return!0}return f.desc="body response matches "+c,f}function Ro(c){function f(v){return v.response&&v.response.status_code===c}return f.desc="resp. code is "+c,f}function Ao(c){c=new RegExp(c,"i");function f(v){return c.test(v.comment)}return f.desc="comment matches "+c,f}function Do(c){c=new RegExp(c,"i");function f(v){return v.request&&(c.test(v.request.host)||c.test(v.request.pretty_host))}return f.desc="domain matches "+c,f}function Pn(c){return c.type==="dns"}Pn.desc="is a DNS Flow";function Io(c){c=new RegExp(c,"i");function f(v){return!!v.server_conn.address&&c.test(v.server_conn.address[0]+":"+v.server_conn.address[1])}return f.desc="destination address matches "+c,f}function Mn(c){return!!c.error}Mn.desc="has error";function Fo(c){c=new RegExp(c,"i");function f(v){return v.request&&at.match_header(v.request,c)||v.response&&gt.match_header(v.response,c)}return f.desc="header matches "+c,f}function Lo(c){c=new RegExp(c,"i");function f(v){return v.request&&at.match_header(v.request,c)}return f.desc="req. header matches "+c,f}function Po(c){c=new RegExp(c,"i");function f(v){return v.response&&gt.match_header(v.response,c)}return f.desc="resp. header matches "+c,f}function On(c){return c.type==="http"}On.desc="is an HTTP Flow";function qn(c){return c.marked}qn.desc="is marked";function Mo(c){c=new RegExp(c,"i");function f(v){return c.test(v.marked)}return f.desc="marker matches "+c,f}function Oo(c){c=new RegExp(c,"i");function f(v){return v.request&&c.test(v.request.method)}return f.desc="method matches "+c,f}function Hn(c){return c.request&&!c.response}Hn.desc="has no response";function Vn(c){return c.is_replay==="request"}Vn.desc="request has been replayed";function Un(c){return c.is_replay==="response"}Un.desc="response has been replayed";function Bn(c){return!!c.is_replay}Bn.desc="flow has been replayed";function qo(c){c=new RegExp(c,"i");function f(v){return!!v.client_conn.peername&&c.test(v.client_conn.peername[0]+":"+v.client_conn.peername[1])}return f.desc="source address matches "+c,f}function Kn(c){return!!c.response}Kn.desc="has response";function Wn(c){return c.type==="tcp"}Wn.desc="is a TCP Flow";function zn(c){return c.type==="udp"}zn.desc="is a UDP Flow";function Ho(c){c=new RegExp(c,"i");function f(v){return v.request&&c.test(at.getContentType(v.request))}return f.desc="req. content type matches "+c,f}function Vo(c){c=new RegExp(c,"i");function f(v){return v.response&&c.test(gt.getContentType(v.response))}return f.desc="resp. content type matches "+c,f}function Uo(c){c=new RegExp(c,"i");function f(v){return v.request&&c.test(at.getContentType(v.request))||v.response&&c.test(gt.getContentType(v.response))}return f.desc="content type matches "+c,f}function Bo(c){c=new RegExp(c,"i");function f(v){if(v.type==="dns"){const _=v.request?.questions[0];return _&&c.test(_.name)}return v.request&&c.test(at.pretty_url(v.request))}return f.desc="url matches "+c,f}function Qn(c){return!!c.websocket}if(Qn.desc="is a Websocket Flow",Pt=a(),Pt!==n&&m===i.length)return Pt;throw Pt!==n&&m<i.length&&P({type:"end",description:"end of input"}),_o(null,rs,He<i.length?i.charAt(He):null,He<i.length?kn(He,He+1):kn(He,He))}return{SyntaxError:e,parse:s}}();class Ye extends M.Component{static xhr;static doc;constructor(e,s){super(e,s),this.state={doc:Ye.doc}}componentDidMount(){Ye.xhr||(Ye.xhr=ne("/filter-help").then(e=>e.json()),Ye.xhr.catch(()=>{Ye.xhr=null})),this.state.doc||Ye.xhr.then(e=>{Ye.doc=e,this.setState({doc:e})})}render(){const{doc:e}=this.state;return e?r.jsx("table",{className:"table table-condensed",children:r.jsxs("tbody",{children:[e.commands.map(s=>r.jsxs("tr",{onClick:()=>this.props.selectHandler(s[0].split(" ")[0]+" "),children:[r.jsx("td",{children:s[0].replace(" "," ")}),r.jsx("td",{children:s[1]})]},s[1])),r.jsx("tr",{children:r.jsx("td",{colSpan:2,children:r.jsxs("a",{href:"https://mitmproxy.org/docs/latest/concepts-filters/",target:"_blank",rel:"noreferrer",children:[r.jsx("i",{className:"fa fa-external-link"}),"  mitmproxy docs"]})})},"docs-link")]})}):r.jsx("i",{className:"fa fa-spinner fa-spin"})}}var es=(t=>(t.SEARCH="search",t.HIGHLIGHT="tag",t.INTERCEPT="pause",t))(es||{});class Js extends M.Component{inputRef=Se.createRef();constructor(e,s){super(e,s),this.state={value:this.props.value,focus:!1,mousefocus:!1},this.onChange=this.onChange.bind(this),this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.selectFilter=this.selectFilter.bind(this)}UNSAFE_componentWillReceiveProps(e){this.setState({value:e.value})}isValid(e){try{return e&&ji.parse(e),!0}catch{return!1}}getDesc(){if(!this.state.value)return r.jsx(Ye,{selectHandler:this.selectFilter});try{return ji.parse(this.state.value).desc}catch(e){return""+e}}onChange(e){const s=e.target.value;this.setState({value:s}),this.isValid(s)&&this.props.onChange(s)}onFocus(){this.setState({focus:!0})}onBlur(){this.setState({focus:!1})}onMouseEnter(){this.setState({mousefocus:!0})}onMouseLeave(){this.setState({mousefocus:!1})}onKeyDown(e){(e.key==="Escape"||e.key==="Enter")&&(this.blur(),this.setState({mousefocus:!1})),e.stopPropagation()}selectFilter(e){this.setState({value:e}),this.inputRef.current?.focus()}blur(){this.inputRef.current?.blur()}select(){this.inputRef.current?.select()}render(){const{icon:e,color:s,placeholder:i}=this.props,{value:l,focus:n,mousefocus:o}=this.state;return r.jsxs("div",{className:ye("filter-input input-group",{"has-error":!this.isValid(l)}),children:[r.jsx("span",{className:"input-group-addon",children:r.jsx("i",{className:"fa fa-fw fa-"+e,style:{color:s}})}),r.jsx("input",{type:"text",ref:this.inputRef,placeholder:i,className:"form-control",value:l,onChange:this.onChange,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown}),(n||o)&&r.jsxs("div",{className:"popover bottom",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[r.jsx("div",{className:"arrow"}),r.jsx("div",{className:"popover-content",children:this.getDesc()})]})]})}}xl.title="Flow List";function xl(){const t=E.c(2);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=r.jsxs("div",{className:"menu-group",children:[r.jsxs("div",{className:"menu-content",children:[r.jsx(kf,{}),r.jsx(Tf,{})]}),r.jsx("div",{className:"menu-legend",children:"Find"})]}),t[0]=e):e=t[0];let s;return t[1]===Symbol.for("react.memo_cache_sentinel")?(s=r.jsxs("div",{className:"main-menu",children:[e,r.jsxs("div",{className:"menu-group",children:[r.jsxs("div",{className:"menu-content",children:[r.jsx(Cf,{}),r.jsx(Af,{})]}),r.jsx("div",{className:"menu-legend",children:"Intercept"})]})]}),t[1]=s):s=t[1],s}function Cf(){const t=E.c(5),e=ee(),i=F(Nf)||"";let l;t[0]!==e?(l=o=>e(Is("intercept",o)),t[0]=e,t[1]=l):l=t[1];let n;return t[2]!==i||t[3]!==l?(n=r.jsx(Js,{value:i,placeholder:"Intercept",icon:es.INTERCEPT,color:"hsl(208, 56%, 53%)",onChange:l}),t[2]=i,t[3]=l,t[4]=n):n=t[4],n}function Nf(t){return t.options.intercept}function kf(){const t=E.c(5),e=ee(),s=F(Ef);let i;t[0]!==e?(i=n=>e(zi(n)),t[0]=e,t[1]=i):i=t[1];let l;return t[2]!==i||t[3]!==s?(l=r.jsx(Js,{value:s,placeholder:"Search",icon:es.SEARCH,color:"black",onChange:i}),t[2]=i,t[3]=s,t[4]=l):l=t[4],l}function Ef(t){return t.ui.filter[_e.Search]}function Tf(){const t=E.c(5),e=ee(),s=F(Rf);let i;t[0]!==e?(i=n=>e(Qi(n)),t[0]=e,t[1]=i):i=t[1];let l;return t[2]!==i||t[3]!==s?(l=r.jsx(Js,{value:s,placeholder:"Highlight",icon:es.HIGHLIGHT,color:"hsl(48, 100%, 50%)",onChange:i}),t[2]=i,t[3]=s,t[4]=l):l=t[4],l}function Rf(t){return t.ui.filter[_e.Highlight]}function Af(){const t=E.c(2),e=ee();let s;return t[0]!==e?(s=r.jsx(he,{className:"btn-sm",title:"[a]ccept all",icon:"fa-forward text-success",onClick:()=>e(Gi()),children:"Resume All"}),t[0]=e,t[1]=s):s=t[1],s}function Xs(t){const e=E.c(6),{value:s,onChange:i,children:l}=t;let n;e[0]!==i||e[1]!==s?(n=r.jsx("input",{type:"checkbox",checked:s,onChange:i}),e[0]=i,e[1]=s,e[2]=n):n=e[2];let o;return e[3]!==l||e[4]!==n?(o=r.jsx("div",{className:"menu-entry",children:r.jsxs("label",{children:[n,l]})}),e[3]=l,e[4]=n,e[5]=o):o=e[5],o}function us(t){const e=E.c(10),{name:s,children:i}=t,l=ee();let n;e[0]!==s?(n=p=>p.options[s],e[0]=s,e[1]=n):n=e[1];const o=F(n),a=!!o;let d;e[2]!==l||e[3]!==s||e[4]!==o?(d=()=>l(Is(s,!o)),e[2]=l,e[3]=s,e[4]=o,e[5]=d):d=e[5];let u;return e[6]!==i||e[7]!==a||e[8]!==d?(u=r.jsx(Xs,{value:a,onChange:d,children:i}),e[6]=i,e[7]=a,e[8]=d,e[9]=u):u=e[9],u}function Df(){const t=E.c(5),e=ee(),s=F(If);let i;t[0]!==e?(i=()=>e(Yt()),t[0]=e,t[1]=i):i=t[1];let l;return t[2]!==i||t[3]!==s?(l=r.jsx(Xs,{value:s,onChange:i,children:"Display Event Log"}),t[2]=i,t[3]=s,t[4]=l):l=t[4],l}function If(t){return t.eventLog.visible}function Ff(){const t=E.c(5),e=ee(),s=F(Lf);let i;t[0]!==e?(i=()=>e(fr()),t[0]=e,t[1]=i):i=t[1];let l;return t[2]!==i||t[3]!==s?(l=r.jsx(Xs,{value:s,onChange:i,children:"Display Command Bar"}),t[2]=i,t[3]=s,t[4]=l):l=t[4],l}function Lf(t){return t.commandBar.visible}function fs(t){const e=E.c(5),{children:s,resource:i}=t,l=`https://docs.mitmproxy.org/stable/${i}`;let n;e[0]!==s?(n=s||r.jsx("i",{className:"fa fa-question-circle"}),e[0]=s,e[1]=n):n=e[1];let o;return e[2]!==n||e[3]!==l?(o=r.jsx("a",{target:"_blank",href:l,rel:"noreferrer",children:n}),e[2]=n,e[3]=l,e[4]=o):o=e[4],o}vl.title="Options";function vl(){const t=E.c(16),e=ee(),s=Pf;let i;t[0]!==e?(i=()=>e(s()),t[0]=e,t[1]=i):i=t[1];let l;t[2]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx("sup",{children:"alpha"}),t[2]=l):l=t[2];let n;t[3]!==i?(n=r.jsx("div",{className:"menu-content",children:r.jsxs(he,{title:"Open Options",icon:"fa-cogs text-primary",onClick:i,children:["Edit Options ",l]})}),t[3]=i,t[4]=n):n=t[4];let o;t[5]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsx("div",{className:"menu-legend",children:"Options Editor"}),t[5]=o):o=t[5];let a;t[6]!==n?(a=r.jsxs("div",{className:"menu-group",children:[n,o]}),t[6]=n,t[7]=a):a=t[7];let d;t[8]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsxs(us,{name:"anticache",children:["Strip cache headers"," ",r.jsx(fs,{resource:"overview/features/#anticache"})]}),t[8]=d):d=t[8];let u;t[9]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsxs(us,{name:"showhost",children:["Use host header for display"," ",r.jsx(fs,{resource:"concepts/options/#showhost"})]}),t[9]=u):u=t[9];let p;t[10]===Symbol.for("react.memo_cache_sentinel")?(p=r.jsxs("div",{className:"menu-group",children:[r.jsxs("div",{className:"menu-content",children:[d,u,r.jsxs(us,{name:"ssl_insecure",children:["Don't verify server certificates"," ",r.jsx(fs,{resource:"concepts/options/#ssl_insecure"})]})]}),r.jsx("div",{className:"menu-legend",children:"Quick Options"})]}),t[10]=p):p=t[10];let h;t[11]!==a?(h=r.jsxs(xt,{children:[a,p]}),t[11]=a,t[12]=h):h=t[12];let g;t[13]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsxs("div",{className:"menu-group",children:[r.jsxs("div",{className:"menu-content",children:[r.jsx(Df,{}),r.jsx(Ff,{})]}),r.jsx("div",{className:"menu-legend",children:"View Options"})]}),t[13]=g):g=t[13];let x;return t[14]!==h?(x=r.jsxs("div",{children:[h,g]}),t[14]=h,t[15]=x):x=t[15],x}function Pf(){return Lc("OptionModal")}const St=async(t,e)=>{const s=(async()=>{const i=await zt("export",e,`@${t.id}`);if(i.value)return i.value;throw i.error?i.error:i})();try{await Ai(s)}catch(i){alert(i)}};_l.title="Flow";function _l(){const t=E.c(63),e=ee(),s=F(Mf),i=s[0];let l;t[0]!==s?(l=s.some(Ns),t[0]=s,t[1]=l):l=t[1];const n=l;if(s.length===0){let X;return t[2]===Symbol.for("react.memo_cache_sentinel")?(X=r.jsx("div",{}),t[2]=X):X=t[2],X}let o;t[3]!==e||t[4]!==s?(o=()=>e(Ts(s)),t[3]=e,t[4]=s,t[5]=o):o=t[5];let a;t[6]!==s?(a=s.some(Cs),t[6]=s,t[7]=a):a=t[7];const d=!a;let u;t[8]!==o||t[9]!==d?(u=r.jsx(he,{title:"[r]eplay flow",icon:"fa-repeat text-primary",onClick:o,disabled:d,children:"Replay"}),t[8]=o,t[9]=d,t[10]=u):u=t[10];let p;t[11]!==e||t[12]!==s?(p=r.jsx(he,{title:"[D]uplicate flow",icon:"fa-copy text-info",onClick:()=>e(Xi(s)),children:"Duplicate"}),t[11]=e,t[12]=s,t[13]=p):p=t[13];let h;t[14]!==s?(h=s.some(Oi),t[14]=s,t[15]=h):h=t[15];const g=!h;let x;t[16]!==e||t[17]!==s?(x=()=>e(Zi(s)),t[16]=e,t[17]=s,t[18]=x):x=t[18];let j;t[19]!==g||t[20]!==x?(j=r.jsx(he,{disabled:g,title:"revert changes to flow [V]",icon:"fa-history text-warning",onClick:x,children:"Revert"}),t[19]=g,t[20]=x,t[21]=j):j=t[21];let y;t[22]!==e||t[23]!==s?(y=r.jsx(he,{title:"[d]elete flow",icon:"fa-trash text-danger",onClick:()=>{e(Ji(s))},children:"Delete"}),t[22]=e,t[23]=s,t[24]=y):y=t[24];let b;t[25]!==s?(b=r.jsx(zf,{flows:s}),t[25]=s,t[26]=b):b=t[26];let S;t[27]!==y||t[28]!==b||t[29]!==u||t[30]!==p||t[31]!==j?(S=r.jsxs("div",{className:"menu-content",children:[u,p,j,y,b]}),t[27]=y,t[28]=b,t[29]=u,t[30]=p,t[31]=j,t[32]=S):S=t[32];let C;t[33]===Symbol.for("react.memo_cache_sentinel")?(C=r.jsx("div",{className:"menu-legend",children:"Flow Modification"}),t[33]=C):C=t[33];let N;t[34]!==S?(N=r.jsx(xt,{children:r.jsxs("div",{className:"menu-group",children:[S,C]})}),t[34]=S,t[35]=N):N=t[35];let T;t[36]!==i?(T=r.jsxs("div",{className:"menu-content",children:[r.jsx(Of,{flow:i}),r.jsx(Uf,{flow:i})]}),t[36]=i,t[37]=T):T=t[37];let I;t[38]===Symbol.for("react.memo_cache_sentinel")?(I=r.jsx("div",{className:"menu-legend",children:"Export"}),t[38]=I):I=t[38];let D;t[39]!==T?(D=r.jsxs("div",{className:"menu-group",children:[T,I]}),t[39]=T,t[40]=D):D=t[40];const O=!n;let L;t[41]!==e||t[42]!==s?(L=()=>e(Es(s)),t[41]=e,t[42]=s,t[43]=L):L=t[43];let H;t[44]!==O||t[45]!==L?(H=r.jsx(he,{disabled:O,title:"[a]ccept intercepted flow",icon:"fa-play text-success",onClick:L,children:"Resume"}),t[44]=O,t[45]=L,t[46]=H):H=t[46];const q=!n;let V;t[47]!==e||t[48]!==s?(V=()=>e(Yi(s)),t[47]=e,t[48]=s,t[49]=V):V=t[49];let W;t[50]!==q||t[51]!==V?(W=r.jsx(he,{disabled:q,title:"kill intercepted flow [x]",icon:"fa-times text-danger",onClick:V,children:"Abort"}),t[50]=q,t[51]=V,t[52]=W):W=t[52];let U;t[53]!==H||t[54]!==W?(U=r.jsxs("div",{className:"menu-content",children:[H,W]}),t[53]=H,t[54]=W,t[55]=U):U=t[55];let Q;t[56]===Symbol.for("react.memo_cache_sentinel")?(Q=r.jsx("div",{className:"menu-legend",children:"Interception"}),t[56]=Q):Q=t[56];let G;t[57]!==U?(G=r.jsx(xt,{children:r.jsxs("div",{className:"menu-group",children:[U,Q]})}),t[57]=U,t[58]=G):G=t[58];let J;return t[59]!==N||t[60]!==D||t[61]!==G?(J=r.jsxs("div",{className:"flow-menu",children:[N,D,G]}),t[59]=N,t[60]=D,t[61]=G,t[62]=J):J=t[62],J}function Mf(t){return t.flows.selected}const Ut=t=>{const e=window.open(t,"_blank","noopener,noreferrer");e&&(e.opener=null)};function Of(t){const e=E.c(24),{flow:s}=t,i=F(Vf);if(s.type!=="http"){let l;return e[0]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx(he,{icon:"fa-download",onClick:Hf,disabled:!0,children:"Download"}),e[0]=l):l=e[0],l}if(s.request.contentLength&&!s.response?.contentLength){let l;e[1]!==s?(l=()=>Ut(we.getContentURL(s,s.request)),e[1]=s,e[2]=l):l=e[2];const n=!i;let o;return e[3]!==l||e[4]!==n?(o=r.jsx(he,{icon:"fa-download",onClick:l,disabled:n,children:"Download"}),e[3]=l,e[4]=n,e[5]=o):o=e[5],o}if(s.response){const l=s.response;if(!s.request.contentLength&&s.response.contentLength){let n;e[6]!==s||e[7]!==l?(n=()=>Ut(we.getContentURL(s,l)),e[6]=s,e[7]=l,e[8]=n):n=e[8];const o=!i;let a;return e[9]!==n||e[10]!==o?(a=r.jsx(he,{icon:"fa-download",onClick:n,disabled:o,children:"Download"}),e[9]=n,e[10]=o,e[11]=a):a=e[11],a}if(s.request.contentLength&&s.response.contentLength){const n=!i;let o;e[12]!==n?(o=r.jsx(he,{icon:"fa-download",onClick:qf,disabled:n,children:"Download▾"}),e[12]=n,e[13]=o):o=e[13];let a;e[14]===Symbol.for("react.memo_cache_sentinel")?(a={placement:"bottom-start"},e[14]=a):a=e[14];let d;e[15]!==s?(d=r.jsx(Re,{onClick:()=>Ut(we.getContentURL(s,s.request)),children:"Download request"}),e[15]=s,e[16]=d):d=e[16];let u;e[17]!==s||e[18]!==l?(u=r.jsx(Re,{onClick:()=>Ut(we.getContentURL(s,l)),children:"Download response"}),e[17]=s,e[18]=l,e[19]=u):u=e[19];let p;return e[20]!==o||e[21]!==d||e[22]!==u?(p=r.jsxs(At,{text:o,options:a,children:[d,u]}),e[20]=o,e[21]=d,e[22]=u,e[23]=p):p=e[23],p}}return null}function qf(){return 1}function Hf(){return 0}function Vf(t){return t.flows.selected.length===1}function Uf(t){const e=E.c(20),{flow:s}=t,i=F(Kf),l=s.type!=="http"||!i;let n;e[0]!==l?(n=r.jsx(he,{title:"Export flow.",icon:"fa-clone",onClick:Bf,disabled:l,children:"Export▾"}),e[0]=l,e[1]=n):n=e[1];let o;e[2]===Symbol.for("react.memo_cache_sentinel")?(o={placement:"bottom-start"},e[2]=o):o=e[2];let a;e[3]!==s?(a=r.jsx(Re,{onClick:()=>St(s,"raw_request"),children:"Copy raw request"}),e[3]=s,e[4]=a):a=e[4];let d;e[5]!==s?(d=r.jsx(Re,{onClick:()=>St(s,"raw_response"),children:"Copy raw response"}),e[5]=s,e[6]=d):d=e[6];let u;e[7]!==s?(u=r.jsx(Re,{onClick:()=>St(s,"raw"),children:"Copy raw request and response"}),e[7]=s,e[8]=u):u=e[8];let p;e[9]!==s?(p=r.jsx(Re,{onClick:()=>St(s,"curl"),children:"Copy as cURL"}),e[9]=s,e[10]=p):p=e[10];let h;e[11]!==s?(h=r.jsx(Re,{onClick:()=>St(s,"httpie"),children:"Copy as HTTPie"}),e[11]=s,e[12]=h):h=e[12];let g;return e[13]!==n||e[14]!==a||e[15]!==d||e[16]!==u||e[17]!==p||e[18]!==h?(g=r.jsxs(At,{className:"",text:n,options:o,children:[a,d,u,p,h]}),e[13]=n,e[14]=a,e[15]=d,e[16]=u,e[17]=p,e[18]=h,e[19]=g):g=e[19],g}function Bf(){return 1}function Kf(t){return t.flows.selected.length===1}const Wf={":red_circle:":"🔴",":orange_circle:":"🟠",":yellow_circle:":"🟡",":green_circle:":"🟢",":large_blue_circle:":"🔵",":purple_circle:":"🟣",":brown_circle:":"🟤"};function zf(t){const e=E.c(5),{flows:s}=t,i=ee();let l,n;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=r.jsx(he,{title:"mark flow",icon:"fa-paint-brush text-success",onClick:Qf,children:"Mark▾"}),n={placement:"bottom-start"},e[0]=l,e[1]=n):(l=e[0],n=e[1]);let o;return e[2]!==i||e[3]!==s?(o=r.jsxs(At,{className:"",text:l,options:n,children:[r.jsx(Re,{onClick:()=>i(ni(s,"")),children:"⚪ (no marker)"}),Object.entries(Wf).map(a=>{const[d,u]=a;return r.jsxs(Re,{onClick:()=>i(ni(s,d)),children:[u," ",d.replace(/[:_]/g," ")]},d)})]}),e[2]=i,e[3]=s,e[4]=o):o=e[4],o}function Qf(){return 1}function jl(){const t=E.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=r.jsx("div",{className:"menu-row",children:r.jsx("div",{className:"menu-group",children:r.jsx("div",{className:"menu-content",children:r.jsx("span",{className:"menu-legend",children:"📊 Network Metrics Dashboard"})})})}),t[0]=e):e=t[0],e}jl.title="Metrics";function yl(){const t=E.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=r.jsx("div",{className:"menu-row",children:r.jsx("div",{className:"menu-group",children:r.jsx("div",{className:"menu-content",children:r.jsx("span",{className:"menu-legend",children:"📱 Kidsnote Ad Tracking Analysis"})})})}),t[0]=e):e=t[0],e}yl.title="Ad Tracking";const yi={[de.Capture]:gl,[de.FlowList]:xl,[de.Options]:vl,[de.Flow]:_l,[de.Metrics]:jl,[de.AdTracking]:yl};function Gf(){const t=E.c(26),e=ee(),s=F(Jf),i=F(Yf),[l,n]=M.useState(!1);let o;t[0]!==i.length?(o=[de.Capture,de.FlowList,de.Options,de.Metrics,de.AdTracking],i.length>0&&o.push(de.Flow),t[0]=i.length,t[1]=o):o=t[1];let a;t[2]!==s||t[3]!==e||t[4]!==i.length||t[5]!==l?(a=()=>{i.length>0&&!l?(e(Kt(de.Flow)),n(!0)):i.length===0&&(l&&n(!1),s===de.Flow&&e(Kt(de.FlowList)))},t[2]=s,t[3]=e,t[4]=i.length,t[5]=l,t[6]=a):a=t[6];let d;t[7]!==s||t[8]!==i||t[9]!==l?(d=[i,l,s],t[7]=s,t[8]=i,t[9]=l,t[10]=d):d=t[10],M.useEffect(a,d);let u;t[11]!==e?(u=function(N,T){T.preventDefault(),e(Kt(N))},t[11]=e,t[12]=u):u=t[12];const p=u,h=yi[s];let g;t[13]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx(_f,{}),t[13]=g):g=t[13];let x;t[14]!==s||t[15]!==o||t[16]!==p?(x=o.map(C=>r.jsx("a",{href:"#",className:ye({active:C===s}),onClick:N=>p(C,N),children:yi[C].title},C)),t[14]=s,t[15]=o,t[16]=p,t[17]=x):x=t[17];let j;t[18]===Symbol.for("react.memo_cache_sentinel")?(j=r.jsx(xt,{children:r.jsx(wf,{})}),t[18]=j):j=t[18];let y;t[19]!==x?(y=r.jsxs("nav",{className:"nav-tabs nav-tabs-lg",children:[g,x,j]}),t[19]=x,t[20]=y):y=t[20];let b;t[21]!==h?(b=r.jsx("div",{children:r.jsx(h,{})}),t[21]=h,t[22]=b):b=t[22];let S;return t[23]!==y||t[24]!==b?(S=r.jsxs("header",{children:[y,b]}),t[23]=y,t[24]=b,t[25]=S):S=t[25],S}function Yf(t){return t.flows.selected}function Jf(t){return t.ui.tabs.current}const ps=function(){function t(i,l){function n(){this.constructor=i}n.prototype=l.prototype,i.prototype=new n}function e(i,l,n,o){this.message=i,this.expected=l,this.found=n,this.location=o,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,e)}t(e,Error);function s(i){var l=arguments.length>1?arguments[1]:{},n={},o={Expr:De},a=De,d=function(w,$){return[w,...$]},u=function(w){return[w]},p=function(){return""},h={type:"other",description:"string"},g='"',x={type:"literal",value:'"',description:'"\\""'},j=function(w){return w.join("")},y="'",b={type:"literal",value:"'",description:`"'"`},S=/^["\\]/,C={type:"class",value:'["\\\\]',description:'["\\\\]'},N={type:"any",description:"any character"},T=function(w){return w},I="\\",D={type:"literal",value:"\\",description:'"\\\\"'},O=/^['\\]/,L={type:"class",value:"['\\\\]",description:"['\\\\]"},H=/^['"\\]/,q={type:"class",value:`['"\\\\]`,description:`['"\\\\]`},V="n",W={type:"literal",value:"n",description:'"n"'},U=function(){return`
`},Q="r",G={type:"literal",value:"r",description:'"r"'},J=function(){return"\r"},X="t",Z={type:"literal",value:"t",description:'"t"'},re=function(){return"	"},ue={type:"other",description:"whitespace"},oe=/^[ \t\n\r]/,be={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},Ce={type:"other",description:"control character"},Ne=/^[|&!()~"]/,Ae={type:"class",value:'[|&!()~"]',description:'[|&!()~"]'},k=0,ge=[{line:1,column:1,seenCR:!1}],z=0,ce=[],B=0,ke;if("startRule"in l){if(!(l.startRule in o))throw new Error(`Can't start parsing from rule "`+l.startRule+'".');a=o[l.startRule]}function We(w){var $=ge[w],A,K;if($)return $;for(A=w-1;!ge[A];)A--;for($=ge[A],$={line:$.line,column:$.column,seenCR:$.seenCR};A<w;)K=i.charAt(A),K===`
`?($.seenCR||$.line++,$.column=1,$.seenCR=!1):K==="\r"||K==="\u2028"||K==="\u2029"?($.line++,$.column=1,$.seenCR=!0):($.column++,$.seenCR=!1),A++;return ge[w]=$,$}function Oe(w,$){var A=We(w),K=We($);return{start:{offset:w,line:A.line,column:A.column},end:{offset:$,line:K.line,column:K.column}}}function te(w){k<z||(k>z&&(z=k,ce=[]),ce.push(w))}function qe(w,$,A,K){function Dt(Ee){var Fe=1;for(Ee.sort(function(ft,ze){return ft.description<ze.description?-1:ft.description>ze.description?1:0});Fe<Ee.length;)Ee[Fe-1]===Ee[Fe]?Ee.splice(Fe,1):Fe++}function ss(Ee,Fe){function ft(Ft){function pt(Le){return Le.charCodeAt(0).toString(16).toUpperCase()}return Ft.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(Le){return"\\x0"+pt(Le)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(Le){return"\\x"+pt(Le)}).replace(/[\u0100-\u0FFF]/g,function(Le){return"\\u0"+pt(Le)}).replace(/[\u1000-\uFFFF]/g,function(Le){return"\\u"+pt(Le)})}var ze=new Array(Ee.length),_t,It,rt;for(rt=0;rt<Ee.length;rt++)ze[rt]=Ee[rt].description;return _t=Ee.length>1?ze.slice(0,-1).join(", ")+" or "+ze[Ee.length-1]:ze[0],It=Fe?'"'+ft(Fe)+'"':"end of input","Expected "+_t+" but "+It+" found."}return $!==null&&Dt($),new e(ss($,A),$,A,K)}function De(){var w,$,A,K;if(w=k,$=le(),$!==n){if(A=[],K=Je(),K!==n)for(;K!==n;)A.push(K),K=Je();else A=n;A!==n?(K=De(),K!==n?($=d($,K),w=$):(k=w,w=n)):(k=w,w=n)}else k=w,w=n;if(w===n&&(w=k,$=le(),$!==n&&($=u($)),w=$,w===n)){for(w=k,$=[],A=Je();A!==n;)$.push(A),A=Je();$!==n&&($=p()),w=$}return w}function le(){var w,$,A,K;if(B++,w=k,i.charCodeAt(k)===34?($=g,k++):($=n,B===0&&te(x)),$!==n){for(A=[],K=fe();K!==n;)A.push(K),K=fe();A!==n?(i.charCodeAt(k)===34?(K=g,k++):(K=n,B===0&&te(x)),K!==n?($=j(A),w=$):(k=w,w=n)):(k=w,w=n)}else k=w,w=n;if(w===n){if(w=k,i.charCodeAt(k)===39?($=y,k++):($=n,B===0&&te(b)),$!==n){for(A=[],K=ve();K!==n;)A.push(K),K=ve();A!==n?(i.charCodeAt(k)===39?(K=y,k++):(K=n,B===0&&te(b)),K!==n?($=j(A),w=$):(k=w,w=n)):(k=w,w=n)}else k=w,w=n;if(w===n){if(w=k,$=k,B++,A=ts(),B--,A===n?$=void 0:(k=$,$=n),$!==n){if(A=[],K=Ie(),K!==n)for(;K!==n;)A.push(K),K=Ie();else A=n;A!==n?($=j(A),w=$):(k=w,w=n)}else k=w,w=n;if(w===n){if(w=k,i.charCodeAt(k)===34?($=g,k++):($=n,B===0&&te(x)),$!==n){for(A=[],K=fe();K!==n;)A.push(K),K=fe();A!==n?($=j(A),w=$):(k=w,w=n)}else k=w,w=n;if(w===n)if(w=k,i.charCodeAt(k)===39?($=y,k++):($=n,B===0&&te(b)),$!==n){for(A=[],K=ve();K!==n;)A.push(K),K=ve();A!==n?($=j(A),w=$):(k=w,w=n)}else k=w,w=n}}}return B--,w===n&&($=n,B===0&&te(h)),w}function fe(){var w,$,A;return w=k,$=k,B++,S.test(i.charAt(k))?(A=i.charAt(k),k++):(A=n,B===0&&te(C)),B--,A===n?$=void 0:(k=$,$=n),$!==n?(i.length>k?(A=i.charAt(k),k++):(A=n,B===0&&te(N)),A!==n?($=T(A),w=$):(k=w,w=n)):(k=w,w=n),w===n&&(w=k,i.charCodeAt(k)===92?($=I,k++):($=n,B===0&&te(D)),$!==n?(A=it(),A!==n?($=T(A),w=$):(k=w,w=n)):(k=w,w=n)),w}function ve(){var w,$,A;return w=k,$=k,B++,O.test(i.charAt(k))?(A=i.charAt(k),k++):(A=n,B===0&&te(L)),B--,A===n?$=void 0:(k=$,$=n),$!==n?(i.length>k?(A=i.charAt(k),k++):(A=n,B===0&&te(N)),A!==n?($=T(A),w=$):(k=w,w=n)):(k=w,w=n),w===n&&(w=k,i.charCodeAt(k)===92?($=I,k++):($=n,B===0&&te(D)),$!==n?(A=it(),A!==n?($=T(A),w=$):(k=w,w=n)):(k=w,w=n)),w}function Ie(){var w,$,A;return w=k,$=k,B++,A=Je(),B--,A===n?$=void 0:(k=$,$=n),$!==n?(i.length>k?(A=i.charAt(k),k++):(A=n,B===0&&te(N)),A!==n?($=T(A),w=$):(k=w,w=n)):(k=w,w=n),w}function it(){var w,$;return H.test(i.charAt(k))?(w=i.charAt(k),k++):(w=n,B===0&&te(q)),w===n&&(w=k,i.charCodeAt(k)===110?($=V,k++):($=n,B===0&&te(W)),$!==n&&($=U()),w=$,w===n&&(w=k,i.charCodeAt(k)===114?($=Q,k++):($=n,B===0&&te(G)),$!==n&&($=J()),w=$,w===n&&(w=k,i.charCodeAt(k)===116?($=X,k++):($=n,B===0&&te(Z)),$!==n&&($=re()),w=$))),w}function Je(){var w;return B++,oe.test(i.charAt(k))?(w=i.charAt(k),k++):(w=n,B===0&&te(be)),B--,w===n&&B===0&&te(ue),w}function ts(){var w;return B++,Ne.test(i.charAt(k))?(w=i.charAt(k),k++):(w=n,B===0&&te(Ae)),B--,w===n&&B===0&&te(Ce),w}if(ke=a(),ke!==n&&k===i.length)return ke;throw ke!==n&&k<i.length&&te({type:"end",description:"end of input"}),qe(null,ce,z<i.length?i.charAt(z):null,z<i.length?Oe(z,z+1):Oe(z,z))}return{SyntaxError:e,parse:s}}();function hs(t,e=""){if(!t)return[];const s=[];for(const i of Object.keys(t))i.startsWith(e)&&s.push(i);return s}function Xf(t){const e=E.c(6),{results:s}=t,i=M.useRef(null);let l,n;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=()=>{i&&i.current.addEventListener("DOMNodeInserted",ep)},n=[],e[0]=l,e[1]=n):(l=e[0],n=e[1]),M.useEffect(l,n);let o;e[2]!==s?(o=s.map(Zf),e[2]=s,e[3]=o):o=e[3];let a;return e[4]!==o?(a=r.jsx("div",{className:"command-result",ref:i,children:o}),e[4]=o,e[5]=a):a=e[5],a}function Zf(t,e){return r.jsxs("div",{children:[r.jsx("div",{children:r.jsxs("strong",{children:["$ ",t.command]})}),t.result]},e)}function ep(t){const e=t.currentTarget;e.scroll({top:e.scrollHeight,behavior:"auto"})}function tp(t){const e=E.c(20),{nextArgs:s,currentArg:i,help:l,description:n,availableCommands:o}=t;let a;if(e[0]!==i||e[1]!==s){a=[];for(let b=0;b<s.length;b++){if(b==i){a.push(r.jsx("mark",{children:s[b]},b));continue}a.push(r.jsxs("span",{children:[s[b]," "]},b))}e[0]=i,e[1]=s,e[2]=a}else a=e[2];let d;e[3]===Symbol.for("react.memo_cache_sentinel")?(d=r.jsx("div",{className:"arrow"}),e[3]=d):d=e[3];let u;e[4]!==a?(u=a.length>0&&r.jsxs("div",{children:[r.jsx("strong",{children:"Argument suggestion:"})," ",a]}),e[4]=a,e[5]=u):u=e[5];let p;e[6]!==l?(p=l?.includes("->")&&r.jsxs("div",{children:[r.jsx("strong",{children:"Signature help: "}),l]}),e[6]=l,e[7]=p):p=e[7];let h;e[8]!==n?(h=n&&r.jsxs("div",{children:["# ",n]}),e[8]=n,e[9]=h):h=e[9];let g;e[10]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("strong",{children:"Available Commands: "}),e[10]=g):g=e[10];let x;e[11]!==o?(x=JSON.stringify(o),e[11]=o,e[12]=x):x=e[12];let j;e[13]!==x?(j=r.jsxs("div",{children:[g,r.jsx("p",{className:"available-commands",children:x})]}),e[13]=x,e[14]=j):j=e[14];let y;return e[15]!==u||e[16]!==p||e[17]!==h||e[18]!==j?(y=r.jsxs("div",{className:"argument-suggestion popover top",children:[d,r.jsxs("div",{className:"popover-content",children:[u,p,h,j]})]}),e[15]=u,e[16]=p,e[17]=h,e[18]=j,e[19]=y):y=e[19],y}function sp(){const t=E.c(45),[e,s]=M.useState(""),[i,l]=M.useState(""),[n,o]=M.useState(0);let a;t[0]===Symbol.for("react.memo_cache_sentinel")?(a=[],t[0]=a):a=t[0];const[d,u]=M.useState(a);let p;t[1]===Symbol.for("react.memo_cache_sentinel")?(p=[],t[1]=p):p=t[1];const[h,g]=M.useState(p);let x;t[2]===Symbol.for("react.memo_cache_sentinel")?(x={},t[2]=x):x=t[2];const[j,y]=M.useState(x);let b;t[3]===Symbol.for("react.memo_cache_sentinel")?(b=[],t[3]=b):b=t[3];const[S,C]=M.useState(b),[N,T]=M.useState(0),[I,D]=M.useState(""),[O,L]=M.useState("");let H;t[4]===Symbol.for("react.memo_cache_sentinel")?(H=[],t[4]=H):H=t[4];const[q,V]=M.useState(H);let W;t[5]===Symbol.for("react.memo_cache_sentinel")?(W=[],t[5]=W):W=t[5];const[U,Q]=M.useState(W),[G,J]=M.useState(void 0);let X,Z;t[6]===Symbol.for("react.memo_cache_sentinel")?(X=()=>{ne("/commands",{method:"GET"}).then(cp).then(le=>{y(le),u(hs(le)),g(Object.keys(le))}).catch(op)},Z=[],t[6]=X,t[7]=Z):(X=t[6],Z=t[7]),M.useEffect(X,Z);let re,ue;t[8]===Symbol.for("react.memo_cache_sentinel")?(re=()=>{zt("commands.history.get").then(le=>{Q(le.value)}).catch(lp)},ue=[],t[8]=re,t[9]=ue):(re=t[8],ue=t[9]),M.useEffect(re,ue);let oe;t[10]!==j?(oe=(le,fe)=>{const ve=ps.parse(fe),Ie=ps.parse(le);D(j[ve[0]]?.signature_help),L(j[ve[0]]?.help||""),u(hs(j,Ie[0])),g(hs(j,ve[0]));const it=j[ve[0]]?.parameters.map(rp);it&&(C([ve[0],...it]),T(ve.length-1))},t[10]=j,t[11]=oe):oe=t[11];const be=oe;let Ce;t[12]===Symbol.for("react.memo_cache_sentinel")?(Ce=le=>{s(le.target.value),l(le.target.value),o(0)},t[12]=Ce):Ce=t[12];const Ne=Ce;let Ae;t[13]!==h||t[14]!==d||t[15]!==n||t[16]!==G||t[17]!==U||t[18]!==e||t[19]!==q?(Ae=le=>{if(le.key==="Enter"){const[fe,...ve]=ps.parse(e);Q([...U,e]),zt("commands.history.add",e).catch(ip),ne.post(`/commands/${fe}`,{arguments:ve}).then(np).then(Ie=>{J(void 0),C([]),V([...q,{command:e,result:JSON.stringify(Ie.value||Ie.error)}])}).catch(Ie=>{J(void 0),C([]),V([...q,{command:e,result:Ie.toString()}])}),D(""),L(""),s(""),l(""),o(0),u(h)}if(le.key==="ArrowUp"){let fe;G===void 0?fe=U.length-1:fe=Math.max(0,G-1),s(U[fe]),l(U[fe]),J(fe)}if(le.key==="ArrowDown"){if(G===void 0)return;if(G==U.length-1)s(""),l(""),J(void 0);else{const fe=G+1;s(U[fe]),l(U[fe]),J(fe)}}le.key==="Tab"&&(s(d[n]),o((n+1)%d.length),le.preventDefault()),le.stopPropagation()},t[13]=h,t[14]=d,t[15]=n,t[16]=G,t[17]=U,t[18]=e,t[19]=q,t[20]=Ae):Ae=t[20];const k=Ae;let ge;t[21]!==j||t[22]!==e||t[23]!==i||t[24]!==be?(ge=le=>{if(!e){g(Object.keys(j));return}be(i,e),le.stopPropagation()},t[21]=j,t[22]=e,t[23]=i,t[24]=be,t[25]=ge):ge=t[25];const z=ge;let ce;t[26]===Symbol.for("react.memo_cache_sentinel")?(ce=r.jsx("div",{className:"command-title",children:"Command Result"}),t[26]=ce):ce=t[26];let B;t[27]!==q?(B=r.jsx(Xf,{results:q}),t[27]=q,t[28]=B):B=t[28];let ke;t[29]!==h||t[30]!==N||t[31]!==O||t[32]!==S||t[33]!==I?(ke=r.jsx(tp,{nextArgs:S,currentArg:N,help:I,description:O,availableCommands:h}),t[29]=h,t[30]=N,t[31]=O,t[32]=S,t[33]=I,t[34]=ke):ke=t[34];let We;t[35]===Symbol.for("react.memo_cache_sentinel")?(We=ye("command-input input-group"),t[35]=We):We=t[35];let Oe;t[36]===Symbol.for("react.memo_cache_sentinel")?(Oe=r.jsx("span",{className:"input-group-addon",children:r.jsx("i",{className:"fa fa-fw fa-terminal"})}),t[36]=Oe):Oe=t[36];const te=e||"";let qe;t[37]!==k||t[38]!==z||t[39]!==te?(qe=r.jsxs("div",{className:We,children:[Oe,r.jsx("input",{type:"text",placeholder:"Enter command",className:"form-control",value:te,onChange:Ne,onKeyDown:k,onKeyUp:z})]}),t[37]=k,t[38]=z,t[39]=te,t[40]=qe):qe=t[40];let De;return t[41]!==B||t[42]!==ke||t[43]!==qe?(De=r.jsxs("div",{className:"command",children:[ce,B,ke,qe]}),t[41]=B,t[42]=ke,t[43]=qe,t[44]=De):De=t[44],De}function np(t){return t.json()}function ip(){return 0}function rp(t){return t.name}function lp(t){return console.error(t)}function op(t){return console.error(t)}function cp(t){return t.json()}function ap(t){const e=E.c(7),{checked:s,onToggle:i,text:l}=t,n="btn btn-toggle "+(s?"btn-primary":"btn-default"),o="fa fa-fw "+(s?"fa-check-square-o":"fa-square-o");let a;e[0]!==o?(a=r.jsx("i",{className:o}),e[0]=o,e[1]=a):a=e[1];let d;return e[2]!==i||e[3]!==n||e[4]!==a||e[5]!==l?(d=r.jsxs("div",{className:n,onClick:i,children:[a," ",l]}),e[2]=i,e[3]=n,e[4]=a,e[5]=l,e[6]=d):d=e[6],d}class dp extends M.Component{static defaultProps={rowHeight:18};heights;viewport=Se.createRef();constructor(e){super(e),this.heights={},this.state={vScroll:Rt()},this.onViewportUpdate=this.onViewportUpdate.bind(this)}componentDidMount(){window.addEventListener("resize",this.onViewportUpdate),this.onViewportUpdate()}componentWillUnmount(){window.removeEventListener("resize",this.onViewportUpdate)}getSnapshotBeforeUpdate(){return Ps(this.viewport)}componentDidUpdate(e,s,i){i&&fl(this.viewport),this.onViewportUpdate()}onViewportUpdate(){const e=this.viewport.current,s=Rt({itemCount:this.props.events.length,rowHeight:this.props.rowHeight,viewportTop:e.scrollTop,viewportHeight:e.offsetHeight,itemHeights:this.props.events.map(i=>this.heights[i.id])});Gt(this.state.vScroll,s)||this.setState({vScroll:s})}setHeight(e,s){if(s&&!this.heights[e]){const i=s.offsetHeight;this.heights[e]!==i&&(this.heights[e]=i,this.onViewportUpdate())}}render(){const{vScroll:e}=this.state,{events:s}=this.props;return r.jsxs("pre",{ref:this.viewport,onScroll:this.onViewportUpdate,children:[r.jsx("div",{style:{height:e.paddingTop}}),s.slice(e.start,e.end).map(i=>r.jsxs("div",{ref:l=>{this.setHeight(i.id,l)},children:[r.jsx(up,{event:i}),i.message]},i.id)),r.jsx("div",{style:{height:e.paddingBottom}})]})}}function up(t){const e=E.c(4),{event:s}=t;let i;e[0]!==s.level?(i={web:"html5",debug:"bug",warn:"exclamation-triangle",error:"ban"}[s.level]||"info",e[0]=s.level,e[1]=i):i=e[1];const n=`fa fa-fw fa-${i}`;let o;return e[2]!==n?(o=r.jsx("i",{className:n}),e[2]=n,e[3]=o):o=e[3],o}class fp extends M.Component{static defaultProps={defaultHeight:200};dragStart;constructor(e,s){super(e,s),this.state={height:this.props.defaultHeight},this.onDragStart=this.onDragStart.bind(this),this.onDragMove=this.onDragMove.bind(this),this.onDragStop=this.onDragStop.bind(this)}onDragStart(e){e.preventDefault(),this.dragStart=this.state.height+e.pageY,window.addEventListener("mousemove",this.onDragMove),window.addEventListener("mouseup",this.onDragStop),window.addEventListener("dragend",this.onDragStop)}onDragMove(e){e.preventDefault(),this.setState({height:this.dragStart-e.pageY})}onDragStop(e){e.preventDefault(),window.removeEventListener("mousemove",this.onDragMove)}render(){const{height:e}=this.state,{filters:s,events:i,toggleFilter:l,close:n}=this.props;return r.jsxs("div",{className:"eventlog",style:{height:e},children:[r.jsxs("div",{onMouseDown:this.onDragStart,children:["Eventlog",r.jsxs("div",{className:"pull-right",children:[Object.values(dr).map(o=>r.jsx(ap,{text:o,checked:s[o],onToggle:()=>l(o)},o)),r.jsx("i",{onClick:n,className:"fa fa-close"})]})]}),r.jsx(dp,{events:i})]})}}const pp=vt(t=>({filters:t.eventLog.filters,events:t.eventLog.view}),{close:Yt,toggleFilter:ar})(fp);function hp(){const t=E.c(52),e=F(gp),{mode:s,intercept:i,showhost:l,upstream_cert:n,rawtcp:o,http2:a,websocket:d,anticache:u,anticomp:p,stickyauth:h,stickycookie:g,stream_large_bodies:x,listen_host:j,listen_port:y,server:b,ssl_insecure:S}=F(mp);let C;t[0]!==s?(C=s&&(s.length!==1||s[0]!=="regular")&&r.jsx("span",{className:"label label-success",children:s.join(",")}),t[0]=s,t[1]=C):C=t[1];let N;t[2]!==i?(N=i&&r.jsxs("span",{className:"label label-success",children:["Intercept: ",i]}),t[2]=i,t[3]=N):N=t[3];let T;t[4]!==S?(T=S&&r.jsx("span",{className:"label label-danger",children:"ssl_insecure"}),t[4]=S,t[5]=T):T=t[5];let I;t[6]!==l?(I=l&&r.jsx("span",{className:"label label-success",children:"showhost"}),t[6]=l,t[7]=I):I=t[7];let D;t[8]!==n?(D=!n&&r.jsx("span",{className:"label label-success",children:"no-upstream-cert"}),t[8]=n,t[9]=D):D=t[9];let O;t[10]!==o?(O=!o&&r.jsx("span",{className:"label label-success",children:"no-raw-tcp"}),t[10]=o,t[11]=O):O=t[11];let L;t[12]!==a?(L=!a&&r.jsx("span",{className:"label label-success",children:"no-http2"}),t[12]=a,t[13]=L):L=t[13];let H;t[14]!==d?(H=!d&&r.jsx("span",{className:"label label-success",children:"no-websocket"}),t[14]=d,t[15]=H):H=t[15];let q;t[16]!==u?(q=u&&r.jsx("span",{className:"label label-success",children:"anticache"}),t[16]=u,t[17]=q):q=t[17];let V;t[18]!==p?(V=p&&r.jsx("span",{className:"label label-success",children:"anticomp"}),t[18]=p,t[19]=V):V=t[19];let W;t[20]!==h?(W=h&&r.jsxs("span",{className:"label label-success",children:["stickyauth: ",h]}),t[20]=h,t[21]=W):W=t[21];let U;t[22]!==g?(U=g&&r.jsxs("span",{className:"label label-success",children:["stickycookie: ",g]}),t[22]=g,t[23]=U):U=t[23];let Q;t[24]!==x?(Q=x&&r.jsxs("span",{className:"label label-success",children:["stream: ",Ti(x)]}),t[24]=x,t[25]=Q):Q=t[25];let G;t[26]!==j||t[27]!==y||t[28]!==b?(G=b&&r.jsxs("span",{className:"label label-primary",title:"HTTP Proxy Server Address",children:[j||"*",":",y||8080]}),t[26]=j,t[27]=y,t[28]=b,t[29]=G):G=t[29];let J;t[30]!==G?(J=r.jsx(xt,{children:G}),t[30]=G,t[31]=J):J=t[31];let X;t[32]!==e?(X=r.jsxs("span",{className:"label label-default",title:"Mitmproxy Version",children:["mitmproxy ",e]}),t[32]=e,t[33]=X):X=t[33];let Z;t[34]!==J||t[35]!==X?(Z=r.jsxs("div",{className:"pull-right",children:[J,X]}),t[34]=J,t[35]=X,t[36]=Z):Z=t[36];let re;return t[37]!==C||t[38]!==N||t[39]!==W||t[40]!==U||t[41]!==Q||t[42]!==Z||t[43]!==T||t[44]!==I||t[45]!==D||t[46]!==O||t[47]!==L||t[48]!==H||t[49]!==q||t[50]!==V?(re=r.jsxs("footer",{children:[C,N,T,I,D,O,L,H,q,V,W,U,Q,Z]}),t[37]=C,t[38]=N,t[39]=W,t[40]=U,t[41]=Q,t[42]=Z,t[43]=T,t[44]=I,t[45]=D,t[46]=O,t[47]=L,t[48]=H,t[49]=q,t[50]=V,t[51]=re):re=t[51],re}function mp(t){return t.options}function gp(t){return t.backendState.version}function xp(t){const e=E.c(3),{children:s}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=r.jsx("div",{className:"modal-backdrop fade in"}),e[0]=i):i=e[0];let l;return e[1]!==s?(l=r.jsxs("div",{children:[i,r.jsx("div",{className:"modal modal-visible",id:"optionsModal",tabIndex:-1,role:"dialog","aria-labelledby":"options",children:r.jsx("div",{className:"modal-dialog modal-lg",role:"document",children:r.jsx("div",{className:"modal-content",children:s})})})]}),e[1]=s,e[2]=l):l=e[2],l}const vp=t=>{t.key!=="Escape"&&t.stopPropagation()};function bl(t){const e=E.c(10);let s,i,l;e[0]!==t?({value:l,onChange:s,...i}=t,e[0]=t,e[1]=s,e[2]=i,e[3]=l):(s=e[1],i=e[2],l=e[3]);let n;e[4]!==s?(n=a=>s(a.target.checked),e[4]=s,e[5]=n):n=e[5];let o;return e[6]!==i||e[7]!==n||e[8]!==l?(o=r.jsx("div",{className:"checkbox",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",checked:l,onChange:n,...i}),"Enable"]})}),e[6]=i,e[7]=n,e[8]=l,e[9]=o):o=e[9],o}function bi(t){const e=E.c(10);let s,i,l;e[0]!==t?({value:l,onChange:s,...i}=t,e[0]=t,e[1]=s,e[2]=i,e[3]=l):(s=e[1],i=e[2],l=e[3]);const n=l||"";let o;e[4]!==s?(o=d=>s(d.target.value),e[4]=s,e[5]=o):o=e[5];let a;return e[6]!==i||e[7]!==n||e[8]!==o?(a=r.jsx("input",{type:"text",value:n,onChange:o,...i}),e[6]=i,e[7]=n,e[8]=o,e[9]=a):a=e[9],a}function wi(t){return function({onChange:s,...i}){return r.jsx(t,{onChange:l=>s(l||null),...i})}}function Si(t){const e=E.c(10);let s,i,l;e[0]!==t?({value:l,onChange:s,...i}=t,e[0]=t,e[1]=s,e[2]=i,e[3]=l):(s=e[1],i=e[2],l=e[3]);let n;e[4]!==s?(n=a=>s(parseInt(a.target.value)),e[4]=s,e[5]=n):n=e[5];let o;return e[6]!==i||e[7]!==n||e[8]!==l?(o=r.jsx("input",{type:"number",value:l,onChange:n,...i}),e[6]=i,e[7]=n,e[8]=l,e[9]=o):o=e[9],o}function _p(t){const e=E.c(12);let s,i,l,n;if(e[0]!==t){const{value:d,onChange:u,choices:p,...h}=t;n=d,s=p,i=h,l=g=>u(g.target.value),e[0]=t,e[1]=s,e[2]=i,e[3]=l,e[4]=n}else s=e[1],i=e[2],l=e[3],n=e[4];let o;e[5]!==s?(o=s.map(jp),e[5]=s,e[6]=o):o=e[6];let a;return e[7]!==i||e[8]!==l||e[9]!==o||e[10]!==n?(a=r.jsx("select",{onChange:l,value:n,...i,children:o}),e[7]=i,e[8]=l,e[9]=o,e[10]=n,e[11]=a):a=e[11],a}function jp(t){return r.jsx("option",{value:t,children:t},t)}function yp(t){const e=E.c(13);let s,i,l;e[0]!==t?({value:l,onChange:s,...i}=t,e[0]=t,e[1]=s,e[2]=i,e[3]=l):(s=e[1],i=e[2],l=e[3]);const n=Math.max(l.length,1);let o;e[4]!==l?(o=l.join(`
`),e[4]=l,e[5]=o):o=e[5];const[a,d]=Se.useState(o);let u;e[6]!==s?(u=g=>{const x=g.target.value;d(x),s(x.split(`
`).map(wp).filter(bp))},e[6]=s,e[7]=u):u=e[7];const p=u;let h;return e[8]!==p||e[9]!==n||e[10]!==i||e[11]!==a?(h=r.jsx("textarea",{rows:n,value:a,onChange:p,...i}),e[8]=p,e[9]=n,e[10]=i,e[11]=a,e[12]=h):h=e[12],h}function bp(t){return t!==""}function wp(t){return t.trim()}const Sp={bool:bl,str:bi,int:Si,"optional str":wi(bi),"optional int":wi(Si),"sequence of str":yp};function $p(t){const e=E.c(16),{choices:s,type:i,value:l,onChange:n,name:o,error:a}=t;let d,u;if(e[0]!==d||e[1]!==s||e[2]!==n||e[3]!==i||e[4]!==l){if(u={onChange:n,value:l},s)d=_p,u.choices=s;else if(d=Sp[i],!d)throw`unknown option type ${i}`;d!==bl&&(u.className="form-control"),e[0]=d,e[1]=s,e[2]=n,e[3]=i,e[4]=l,e[5]=u,e[6]=d}else u=e[5],d=e[6];let p;e[7]!==a?(p=ye({"has-error":a}),e[7]=a,e[8]=p):p=e[8];let h;e[9]!==d||e[10]!==o||e[11]!==u?(h=r.jsx(d,{name:o,onKeyDown:vp,...u}),e[9]=d,e[10]=o,e[11]=u,e[12]=h):h=e[12];let g;return e[13]!==p||e[14]!==h?(g=r.jsx("div",{className:p,children:h}),e[13]=p,e[14]=h,e[15]=g):g=e[15],g}function Cp(t){const e=E.c(18),{name:s}=t,i=ee();let l;e[0]!==s?(l=j=>j.options_meta[s]?.choices,e[0]=s,e[1]=l):l=e[1];const n=F(l);let o;e[2]!==s?(o=j=>j.options_meta[s]?.type,e[2]=s,e[3]=o):o=e[3];const a=F(o);let d;e[4]!==s?(d=j=>{const y=j.ui.optionsEditor[s];return y?y.value:j.options_meta[s]?.value},e[4]=s,e[5]=d):d=e[5];const u=F(d);let p;e[6]!==s?(p=j=>j.ui.optionsEditor[s]?.error,e[6]=s,e[7]=p):p=e[7];const h=F(p);let g;e[8]!==i||e[9]!==s?(g=j=>i(Is(s,j)),e[8]=i,e[9]=s,e[10]=g):g=e[10];let x;return e[11]!==n||e[12]!==h||e[13]!==s||e[14]!==g||e[15]!==a||e[16]!==u?(x=r.jsx($p,{name:s,choices:n,type:a,value:u,error:h,onChange:g}),e[11]=n,e[12]=h,e[13]=s,e[14]=g,e[15]=a,e[16]=u,e[17]=x):x=e[17],x}function Np(t){const e=E.c(4),{name:s}=t;let i;e[0]!==s?(i=o=>o.options_meta[s]?.help,e[0]=s,e[1]=i):i=e[1];const l=F(i);let n;return e[2]!==l?(n=r.jsx("div",{className:"help-block small",children:l}),e[2]=l,e[3]=n):n=e[3],n}function kp(t){const e=E.c(4),{name:s}=t;let i;e[0]!==s?(i=o=>o.options_meta[s]?.error,e[0]=s,e[1]=i):i=e[1];const l=F(i);if(!l)return null;let n;return e[2]!==l?(n=r.jsx("div",{className:"small text-danger",children:l}),e[2]=l,e[3]=n):n=e[3],n}function Ep(t){const e=E.c(2);let{value:s,defaultVal:i}=t;if(s===i)return null;{if(typeof i=="boolean")i=i?"true":"false";else if(Array.isArray(i)){if(Bt.isEmpty(Bt.compact(s))&&Bt.isEmpty(i))return null;i="[ ]"}else i===""?i='""':i===null&&(i="null");let l;return e[0]!==i?(l=r.jsxs("div",{className:"small",children:["Default: ",r.jsxs("strong",{children:[" ",i," "]})," "]}),e[0]=i,e[1]=l):l=e[1],l}}const Tp=vt((t,{name:e})=>({value:t.options[e],defaultVal:t.options_meta[e]?.default}))(Ep);function Rp(){const t=E.c(24),e=ee(),s=F(Dp,Gt);let i,l,n,o;if(t[0]!==e||t[1]!==s){const h=s.sort();let g;t[6]!==e?(g=()=>e(or()),t[6]=e,t[7]=g):g=t[7];let x;t[8]===Symbol.for("react.memo_cache_sentinel")?(x=r.jsx("i",{className:"fa fa-fw fa-times"}),t[8]=x):x=t[8];let j;t[9]!==g?(j=r.jsx("button",{type:"button",className:"close","data-dismiss":"modal",onClick:g,children:x}),t[9]=g,t[10]=j):j=t[10];let y;t[11]===Symbol.for("react.memo_cache_sentinel")?(y=r.jsx("div",{className:"modal-title",children:r.jsx("h4",{children:"Options"})}),t[11]=y):y=t[11],t[12]!==j?(o=r.jsxs("div",{className:"modal-header",children:[j,y]}),t[12]=j,t[13]=o):o=t[13],n="modal-body",i="form-horizontal",l=h.map(Ap),t[0]=e,t[1]=s,t[2]=i,t[3]=l,t[4]=n,t[5]=o}else i=t[2],l=t[3],n=t[4],o=t[5];let a;t[14]!==i||t[15]!==l?(a=r.jsx("div",{className:i,children:l}),t[14]=i,t[15]=l,t[16]=a):a=t[16];let d;t[17]!==n||t[18]!==a?(d=r.jsx("div",{className:n,children:a}),t[17]=n,t[18]=a,t[19]=d):d=t[19];let u;t[20]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("div",{className:"modal-footer"}),t[20]=u):u=t[20];let p;return t[21]!==o||t[22]!==d?(p=r.jsxs("div",{children:[o,d,u]}),t[21]=o,t[22]=d,t[23]=p):p=t[23],p}function Ap(t){return r.jsxs("div",{className:"form-group",children:[r.jsxs("div",{className:"col-xs-6",children:[r.jsx("label",{htmlFor:t,children:t}),r.jsx(Np,{name:t})]}),r.jsxs("div",{className:"col-xs-6",children:[r.jsx(Cp,{name:t}),r.jsx(kp,{name:t}),r.jsx(Tp,{name:t})]})]},t)}function Dp(t){return Object.keys(t.options_meta)}function Ip(){const t=E.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=r.jsx(xp,{children:r.jsx(Rp,{})}),t[0]=e):e=t[0],e}const Fp={OptionModal:Ip};function Lp(){const t=E.c(3),e=F(Pp),s=e?Fp[e]:void 0;if(s){let i;return t[0]!==s?(i=r.jsx(s,{}),t[0]=s,t[1]=i):i=t[1],i}else{let i;return t[2]===Symbol.for("react.memo_cache_sentinel")?(i=r.jsx(r.Fragment,{}),t[2]=i):i=t[2],i}}function Pp(t){return t.ui.modal.activeModal}class Mp extends M.Component{state={};render=()=>{const{showEventLog:e,showCommandBar:s}=this.props;return this.state.error?(console.log("ERR",this.state),r.jsxs("div",{className:"container",children:[r.jsx("h1",{children:"mitmproxy has crashed."}),r.jsxs("pre",{children:[this.state.error.stack,r.jsx("br",{}),r.jsx("br",{}),"Component Stack:",this.state.errorInfo?.componentStack]}),r.jsxs("p",{children:["Please lodge a bug report at"," ",r.jsx("a",{href:"https://github.com/mitmproxy/mitmproxy/issues",children:"https://github.com/mitmproxy/mitmproxy/issues"}),"."]})]})):r.jsxs("div",{id:"container",tabIndex:0,children:[r.jsx(Gf,{}),r.jsx(mf,{}),s&&r.jsx(sp,{},"commandbar"),e&&r.jsx(pp,{},"eventlog"),r.jsx(hp,{}),r.jsx(Lp,{})]})};componentDidMount(){window.addEventListener("keydown",this.props.onKeyDown)}componentWillUnmount(){window.removeEventListener("keydown",this.props.onKeyDown)}componentDidCatch(e,s){this.setState({error:e,errorInfo:s})}}const Op=vt(t=>({showEventLog:t.eventLog.visible,showCommandBar:t.commandBar.visible}),{onKeyDown:Ad})(Mp),et={SEARCH:"s",HIGHLIGHT:"h",SHOW_EVENTLOG:"e",SHOW_COMMANDBAR:"c"};function qp(t){const[e,s]=window.location.hash.substr(1).split("?",2),i=e.substr(1).split("/");if(i[0]==="flows"){if(i.length==3){const[l,n]=i.slice(1);t.dispatch(Wt(n));const o=()=>{const d=t.getState().flows.byId.get(l);d!==void 0&&(a(),t.dispatch(Ue([d])))},a=t.subscribe(o);o()}}else i[0]==="capture"&&t.dispatch(Kt(de.Capture));s&&s.split("&").forEach(l=>{const[n,o]=l.split("=",2),a=decodeURIComponent(o);switch(n){case et.SEARCH:t.dispatch(zi(a));break;case et.HIGHLIGHT:t.dispatch(Qi(a));break;case et.SHOW_EVENTLOG:t.getState().eventLog.visible||t.dispatch(Yt());break;case et.SHOW_COMMANDBAR:t.getState().commandBar.visible||t.dispatch(fr());break;default:console.error(`unimplemented query arg: ${l}`)}})}function Hp(t){const e=t.getState(),s={[et.SEARCH]:e.ui.filter[_e.Search],[et.HIGHLIGHT]:e.ui.filter[_e.Highlight],[et.SHOW_EVENTLOG]:e.eventLog.visible,[et.SHOW_COMMANDBAR]:e.commandBar.visible},i=Object.keys(s).filter(o=>s[o]).map(o=>`${o}=${encodeURIComponent(s[o])}`).join("&");let l;e.ui.tabs.current===de.Capture?l="/capture":e.flows.selected.length>0?l=`/flows/${e.flows.selected[0].id}/${e.ui.flow.tab}`:l="/flows",i&&(l+="?"+i);let n=window.location.pathname;n==="blank"&&(n="/"),window.location.hash.substr(1)!==l&&history.replaceState(void 0,"",`${n}#${l}`)}function Vp(t){qp(t),t.subscribe(()=>Hp(t))}var ct=(t=>(t.State="state",t.Flows="flows",t.Events="events",t.Options="options",t))(ct||{});class Up{activeFetches;store;filterState;socket;messageQueue;constructor(e){this.activeFetches={},this.store=e,this.filterState=Wi,this.messageQueue=[],this.connect(),this.store.subscribe(this.onStoreUpdate.bind(this))}connect(){this.socket=new WebSocket(location.origin.replace("http","ws")+location.pathname.replace(/\/$/,"")+"/updates"),this.socket.addEventListener("open",()=>this.onOpen()),this.socket.addEventListener("close",e=>this.onClose(e)),this.socket.addEventListener("message",e=>this.onMessage(JSON.parse(e.data))),this.socket.addEventListener("error",e=>this.onError(e))}async onOpen(){for(const e of this.messageQueue)this.socket.send(JSON.stringify(e));this.messageQueue=[],this.store.dispatch(Xc()),await Promise.all([this.fetchData("state"),this.fetchData("flows"),this.fetchData("events"),this.fetchData("options")]),this.store.dispatch(Zc())}onStoreUpdate(){const e=this.store.getState().ui.filter;if(e!==this.filterState){for(const s of Object.values(_e))this.filterState[s]!==e[s]&&this.sendMessage({type:"flows/updateFilter",payload:{name:s,expr:e[s]}});this.filterState=e}}fetchData(e){const s=[];return this.activeFetches[e]=s,ne(`./${e}`).then(i=>i.json()).then(i=>{this.activeFetches[e]===s&&this.receive(e,i)})}onMessage(e){switch(e.type){case"flows/add":return this.queueOrDispatch("flows",tr(e.payload));case"flows/update":return this.queueOrDispatch("flows",sr(e.payload));case"flows/filterUpdate":return this.queueOrDispatch("flows",ir(e.payload));case"flows/remove":return this.queueOrDispatch("flows",nr(e.payload));case"events/add":return this.queueOrDispatch("events",As(e.payload));case"options/update":return this.queueOrDispatch("options",Ds(e.payload));case"state/update":return this.queueOrDispatch("state",Ke(e.payload));case"flows/reset":return this.fetchData("flows");case"events/reset":return this.fetchData("events");default:Et(e.type)}}sendMessage(e){this.socket.readyState===WebSocket.OPEN?this.socket.send(JSON.stringify(e)):this.socket.readyState===WebSocket.CONNECTING?this.messageQueue.push(e):console.error("WebSocket is not open. Cannot send:",e)}queueOrDispatch(e,s){const i=this.activeFetches[e];i!==void 0?i.push(s):this.store.dispatch(s)}receive(e,s){switch(e){case"state":this.store.dispatch(Be(s));break;case"options":this.store.dispatch(Jt(s));break;case"events":this.store.dispatch(cr(s));break;case"flows":this.store.dispatch(Rs(s));break;default:Et(e)}const i=this.activeFetches[e];delete this.activeFetches[e],i.forEach(l=>this.store.dispatch(l))}onClose(e){this.store.dispatch(ea(`Connection closed at ${new Date().toUTCString()} with error code ${e.code}.`)),console.error("websocket connection closed",e)}onError(...e){console.error("websocket connection errored",e)}}class Bp{store;constructor(e){this.store=e,this.onOpen()}onOpen(){this.fetchData(ct.Flows),this.fetchData(ct.Options)}fetchData(e){ne(`./${e}`).then(s=>s.json()).then(s=>{this.receive(e,s)})}receive(e,s){switch(e){case ct.Flows:this.store.dispatch(Rs(s));break;case ct.Options:this.store.dispatch(Jt(s));break;case ct.State:throw"unreachable";case ct.Events:throw"unreachable";default:Et(e)}}}window.MITMWEB_STATIC?window.backend=new Bp(Tt):window.backend=new Up(Tt);Vp(Tt);window.addEventListener("error",t=>{Tt.dispatch(qc(`${t.message}
${t.error.stack}`))});document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("mitmproxy");ac.createRoot(t).render(r.jsx(dc,{store:Tt,children:r.jsx(Op,{})}))});
